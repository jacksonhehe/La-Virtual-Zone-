const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/Home-NomA3_67.js","assets/trending-up-B47Y7Bnl.js","assets/users-DwT6LgF3.js","assets/standingsHelpers-CVXwSs-T.js","assets/chevron-right-B_saB9ia.js","assets/calendar-ChXpFKNL.js","assets/award-DCWMy85e.js","assets/RecoverPassword-DMi2hRUo.js","assets/check-circle-BvKcvpo1.js","assets/UserPanel-DX5tEkTR.js","assets/clipboard-DI7aGxJX.js","assets/alert-triangle-DVGXW8FO.js","assets/activity-BmEYKeIw.js","assets/shopping-cart-BdM90zCr.js","assets/camera-1N57lJV-.js","assets/download-DIflQpOF.js","assets/star-DB3CJQtb.js","assets/map-pin-RGuVujtS.js","assets/globe-DFZ9ur1c.js","assets/heart-G8ndUO6L.js","assets/target-D4Ny21RF.js","assets/LigaMaster-5lXgx0Vd.js","assets/PageHeader-CDa_z5ok.js","assets/StatsCard-DWwuN--4.js","assets/briefcase-UXbZvjE0.js","assets/bar-chart-4-CB6zDijn.js","assets/crown-9ZDvvQOI.js","assets/home-BgtZMnTK.js","assets/Market-B1ldKt1i.js","assets/PlayerStatsModal-DiDpv2vH.js","assets/eye-DaKCNHEz.js","assets/send-DChXf5xe.js","assets/dollar-sign-zmu4S0bG.js","assets/zap-C2wVuIIo.js","assets/chevron-up-Byc-AYeP.js","assets/arrow-up-cT-bSRhx.js","assets/bar-chart-D-stTDCV.js","assets/usePagination-ao8LDY8Q.js","assets/bar-chart-3-5i4z2Yb8.js","assets/search-BFl4Rdls.js","assets/filter-CklMjZET.js","assets/Tournaments-DhjNRKF4.js","assets/TournamentDetail-BH5Mijq7.js","assets/chevron-left-DnlDT4R9.js","assets/image-CWVeUWZ1.js","assets/arrow-right-BaRtFOXo.js","assets/Blog-CXDRhpCc.js","assets/file-text-yxJkllfm.js","assets/BlogPost-DwpfN1R6.js","assets/Gallery-DyRy-4as.js","assets/plus-CV1eRhkB.js","assets/upload-DaXijVgU.js","assets/Help-DC6OHCzk.js","assets/AdminLayout-DURV24gs.js","assets/Dashboard-C7HGMq42.js","assets/refresh-cw-CppA1Gkr.js","assets/Tournaments-BVOlGXOK.js","assets/NewMatchModal-DGRI6wOS.js","assets/ConfirmDeleteModal-BmSQKAg0.js","assets/trash-DCyXKyGY.js","assets/Matches-D9SPVzPB.js","assets/News-DBmGaMLq.js","assets/Users-W3hJ9hdy.js","assets/user-plus-BoLAMYrr.js","assets/lock-VgGjsOq_.js","assets/ban-B8bwPRx5.js","assets/Clubs--CVb8C0H.js","assets/Players-eay0AgMY.js","assets/database-CtI3iE4B.js","assets/UserProfile-B1LRDJo7.js","assets/NotFound-gCMu_xZ5.js","assets/ClubProfile-BFS9J339.js","assets/ClubSquad-CTI51NLF.js","assets/arrow-down-e796ywrD.js","assets/ClubFinances-BKeMx2iN.js","assets/ClubPalmares-Bl9z1R47.js","assets/medal-DKNvpnNG.js","assets/HallOfFame-PvV9tSNN.js","assets/Rankings-Czp5pr4S.js","assets/Fixtures-DT1cfTZ_.js","assets/MarketTables-CKI6CEMW.js","assets/arrow-left-LIE-k1Kv.js","assets/Zones-DmXwB-A7.js","assets/Users-Ct_u-A56.js","assets/storage-BrZokJdf.js","assets/DtCommunity-DVIuh_M2.js","assets/Terms-C9V0n_Xq.js","assets/Privacy-Cw11vsdf.js","assets/AccountStatus-BHhaDH-1.js","assets/Reglamento-xKHS02Gi.js"])))=>i.map(i=>d[i]);
function qx(e,t){for(var r=0;r<t.length;r++){const n=t[r];if(typeof n!="string"&&!Array.isArray(n)){for(const a in n)if(a!=="default"&&!(a in e)){const s=Object.getOwnPropertyDescriptor(n,a);s&&Object.defineProperty(e,a,s.get?s:{enumerable:!0,get:()=>n[a]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))n(a);new MutationObserver(a=>{for(const s of a)if(s.type==="childList")for(const i of s.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&n(i)}).observe(document,{childList:!0,subtree:!0});function r(a){const s={};return a.integrity&&(s.integrity=a.integrity),a.referrerPolicy&&(s.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?s.credentials="include":a.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(a){if(a.ep)return;a.ep=!0;const s=r(a);fetch(a.href,s)}})();const JE="modulepreload",YE=function(e){return"/"+e},I1={},Z=function(t,r,n){let a=Promise.resolve();if(r&&r.length>0){let u=function(f){return Promise.all(f.map(h=>Promise.resolve(h).then(p=>({status:"fulfilled",value:p}),p=>({status:"rejected",reason:p}))))};document.getElementsByTagName("link");const i=document.querySelector("meta[property=csp-nonce]"),c=i?.nonce||i?.getAttribute("nonce");a=u(r.map(f=>{if(f=YE(f),f in I1)return;I1[f]=!0;const h=f.endsWith(".css"),p=h?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${f}"]${p}`))return;const m=document.createElement("link");if(m.rel=h?"stylesheet":JE,h||(m.as="script"),m.crossOrigin="",m.href=f,c&&m.setAttribute("nonce",c),document.head.appendChild(m),h)return new Promise((y,w)=>{m.addEventListener("load",y),m.addEventListener("error",()=>w(new Error(`Unable to preload CSS for ${f}`)))})}))}function s(i){const c=new Event("vite:preloadError",{cancelable:!0});if(c.payload=i,window.dispatchEvent(c),!c.defaultPrevented)throw i}return a.then(i=>{for(const c of i||[])c.status==="rejected"&&s(c.reason);return t().catch(s)})};function Qh(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function Kx(e){if(Object.prototype.hasOwnProperty.call(e,"__esModule"))return e;var t=e.default;if(typeof t=="function"){var r=function n(){var a=!1;try{a=this instanceof n}catch{}return a?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};r.prototype=t.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(e).forEach(function(n){var a=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(r,n,a.get?a:{enumerable:!0,get:function(){return e[n]}})}),r}var Td={exports:{}},yl={},Cd={exports:{}},it={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var O1;function QE(){if(O1)return it;O1=1;var e=Symbol.for("react.element"),t=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),s=Symbol.for("react.provider"),i=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),f=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),p=Symbol.iterator;function m(H){return H===null||typeof H!="object"?null:(H=p&&H[p]||H["@@iterator"],typeof H=="function"?H:null)}var y={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},w=Object.assign,x={};function _(H,A,G){this.props=H,this.context=A,this.refs=x,this.updater=G||y}_.prototype.isReactComponent={},_.prototype.setState=function(H,A){if(typeof H!="object"&&typeof H!="function"&&H!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,H,A,"setState")},_.prototype.forceUpdate=function(H){this.updater.enqueueForceUpdate(this,H,"forceUpdate")};function E(){}E.prototype=_.prototype;function k(H,A,G){this.props=H,this.context=A,this.refs=x,this.updater=G||y}var b=k.prototype=new E;b.constructor=k,w(b,_.prototype),b.isPureReactComponent=!0;var O=Array.isArray,z=Object.prototype.hasOwnProperty,L={current:null},P={key:!0,ref:!0,__self:!0,__source:!0};function J(H,A,G){var U,W={},ne=null,xe=null;if(A!=null)for(U in A.ref!==void 0&&(xe=A.ref),A.key!==void 0&&(ne=""+A.key),A)z.call(A,U)&&!P.hasOwnProperty(U)&&(W[U]=A[U]);var ve=arguments.length-2;if(ve===1)W.children=G;else if(1<ve){for(var me=Array(ve),ye=0;ye<ve;ye++)me[ye]=arguments[ye+2];W.children=me}if(H&&H.defaultProps)for(U in ve=H.defaultProps,ve)W[U]===void 0&&(W[U]=ve[U]);return{$$typeof:e,type:H,key:ne,ref:xe,props:W,_owner:L.current}}function V(H,A){return{$$typeof:e,type:H.type,key:A,ref:H.ref,props:H.props,_owner:H._owner}}function le(H){return typeof H=="object"&&H!==null&&H.$$typeof===e}function ee(H){var A={"=":"=0",":":"=2"};return"$"+H.replace(/[=:]/g,function(G){return A[G]})}var X=/\/+/g;function he(H,A){return typeof H=="object"&&H!==null&&H.key!=null?ee(""+H.key):A.toString(36)}function Ie(H,A,G,U,W){var ne=typeof H;(ne==="undefined"||ne==="boolean")&&(H=null);var xe=!1;if(H===null)xe=!0;else switch(ne){case"string":case"number":xe=!0;break;case"object":switch(H.$$typeof){case e:case t:xe=!0}}if(xe)return xe=H,W=W(xe),H=U===""?"."+he(xe,0):U,O(W)?(G="",H!=null&&(G=H.replace(X,"$&/")+"/"),Ie(W,A,G,"",function(ye){return ye})):W!=null&&(le(W)&&(W=V(W,G+(!W.key||xe&&xe.key===W.key?"":(""+W.key).replace(X,"$&/")+"/")+H)),A.push(W)),1;if(xe=0,U=U===""?".":U+":",O(H))for(var ve=0;ve<H.length;ve++){ne=H[ve];var me=U+he(ne,ve);xe+=Ie(ne,A,G,me,W)}else if(me=m(H),typeof me=="function")for(H=me.call(H),ve=0;!(ne=H.next()).done;)ne=ne.value,me=U+he(ne,ve++),xe+=Ie(ne,A,G,me,W);else if(ne==="object")throw A=String(H),Error("Objects are not valid as a React child (found: "+(A==="[object Object]"?"object with keys {"+Object.keys(H).join(", ")+"}":A)+"). If you meant to render a collection of children, use an array instead.");return xe}function Ee(H,A,G){if(H==null)return H;var U=[],W=0;return Ie(H,U,"","",function(ne){return A.call(G,ne,W++)}),U}function Te(H){if(H._status===-1){var A=H._result;A=A(),A.then(function(G){(H._status===0||H._status===-1)&&(H._status=1,H._result=G)},function(G){(H._status===0||H._status===-1)&&(H._status=2,H._result=G)}),H._status===-1&&(H._status=0,H._result=A)}if(H._status===1)return H._result.default;throw H._result}var oe={current:null},ge={transition:null},K={ReactCurrentDispatcher:oe,ReactCurrentBatchConfig:ge,ReactCurrentOwner:L};function fe(){throw Error("act(...) is not supported in production builds of React.")}return it.Children={map:Ee,forEach:function(H,A,G){Ee(H,function(){A.apply(this,arguments)},G)},count:function(H){var A=0;return Ee(H,function(){A++}),A},toArray:function(H){return Ee(H,function(A){return A})||[]},only:function(H){if(!le(H))throw Error("React.Children.only expected to receive a single React element child.");return H}},it.Component=_,it.Fragment=r,it.Profiler=a,it.PureComponent=k,it.StrictMode=n,it.Suspense=u,it.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=K,it.act=fe,it.cloneElement=function(H,A,G){if(H==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+H+".");var U=w({},H.props),W=H.key,ne=H.ref,xe=H._owner;if(A!=null){if(A.ref!==void 0&&(ne=A.ref,xe=L.current),A.key!==void 0&&(W=""+A.key),H.type&&H.type.defaultProps)var ve=H.type.defaultProps;for(me in A)z.call(A,me)&&!P.hasOwnProperty(me)&&(U[me]=A[me]===void 0&&ve!==void 0?ve[me]:A[me])}var me=arguments.length-2;if(me===1)U.children=G;else if(1<me){ve=Array(me);for(var ye=0;ye<me;ye++)ve[ye]=arguments[ye+2];U.children=ve}return{$$typeof:e,type:H.type,key:W,ref:ne,props:U,_owner:xe}},it.createContext=function(H){return H={$$typeof:i,_currentValue:H,_currentValue2:H,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},H.Provider={$$typeof:s,_context:H},H.Consumer=H},it.createElement=J,it.createFactory=function(H){var A=J.bind(null,H);return A.type=H,A},it.createRef=function(){return{current:null}},it.forwardRef=function(H){return{$$typeof:c,render:H}},it.isValidElement=le,it.lazy=function(H){return{$$typeof:h,_payload:{_status:-1,_result:H},_init:Te}},it.memo=function(H,A){return{$$typeof:f,type:H,compare:A===void 0?null:A}},it.startTransition=function(H){var A=ge.transition;ge.transition={};try{H()}finally{ge.transition=A}},it.unstable_act=fe,it.useCallback=function(H,A){return oe.current.useCallback(H,A)},it.useContext=function(H){return oe.current.useContext(H)},it.useDebugValue=function(){},it.useDeferredValue=function(H){return oe.current.useDeferredValue(H)},it.useEffect=function(H,A){return oe.current.useEffect(H,A)},it.useId=function(){return oe.current.useId()},it.useImperativeHandle=function(H,A,G){return oe.current.useImperativeHandle(H,A,G)},it.useInsertionEffect=function(H,A){return oe.current.useInsertionEffect(H,A)},it.useLayoutEffect=function(H,A){return oe.current.useLayoutEffect(H,A)},it.useMemo=function(H,A){return oe.current.useMemo(H,A)},it.useReducer=function(H,A,G){return oe.current.useReducer(H,A,G)},it.useRef=function(H){return oe.current.useRef(H)},it.useState=function(H){return oe.current.useState(H)},it.useSyncExternalStore=function(H,A,G){return oe.current.useSyncExternalStore(H,A,G)},it.useTransition=function(){return oe.current.useTransition()},it.version="18.3.1",it}var D1;function cc(){return D1||(D1=1,Cd.exports=QE()),Cd.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var F1;function ZE(){if(F1)return yl;F1=1;var e=cc(),t=Symbol.for("react.element"),r=Symbol.for("react.fragment"),n=Object.prototype.hasOwnProperty,a=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,s={key:!0,ref:!0,__self:!0,__source:!0};function i(c,u,f){var h,p={},m=null,y=null;f!==void 0&&(m=""+f),u.key!==void 0&&(m=""+u.key),u.ref!==void 0&&(y=u.ref);for(h in u)n.call(u,h)&&!s.hasOwnProperty(h)&&(p[h]=u[h]);if(c&&c.defaultProps)for(h in u=c.defaultProps,u)p[h]===void 0&&(p[h]=u[h]);return{$$typeof:t,type:c,key:m,ref:y,props:p,_owner:a.current}}return yl.Fragment=r,yl.jsx=i,yl.jsxs=i,yl}var R1;function eb(){return R1||(R1=1,Td.exports=ZE()),Td.exports}var R=eb(),ue=cc();const Xx=Qh(ue),tb=qx({__proto__:null,default:Xx},[ue]);var Fu={},Ad={exports:{}},ln={},Pd={exports:{}},Id={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var L1;function rb(){return L1||(L1=1,(function(e){function t(ge,K){var fe=ge.length;ge.push(K);e:for(;0<fe;){var H=fe-1>>>1,A=ge[H];if(0<a(A,K))ge[H]=K,ge[fe]=A,fe=H;else break e}}function r(ge){return ge.length===0?null:ge[0]}function n(ge){if(ge.length===0)return null;var K=ge[0],fe=ge.pop();if(fe!==K){ge[0]=fe;e:for(var H=0,A=ge.length,G=A>>>1;H<G;){var U=2*(H+1)-1,W=ge[U],ne=U+1,xe=ge[ne];if(0>a(W,fe))ne<A&&0>a(xe,W)?(ge[H]=xe,ge[ne]=fe,H=ne):(ge[H]=W,ge[U]=fe,H=U);else if(ne<A&&0>a(xe,fe))ge[H]=xe,ge[ne]=fe,H=ne;else break e}}return K}function a(ge,K){var fe=ge.sortIndex-K.sortIndex;return fe!==0?fe:ge.id-K.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;e.unstable_now=function(){return s.now()}}else{var i=Date,c=i.now();e.unstable_now=function(){return i.now()-c}}var u=[],f=[],h=1,p=null,m=3,y=!1,w=!1,x=!1,_=typeof setTimeout=="function"?setTimeout:null,E=typeof clearTimeout=="function"?clearTimeout:null,k=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function b(ge){for(var K=r(f);K!==null;){if(K.callback===null)n(f);else if(K.startTime<=ge)n(f),K.sortIndex=K.expirationTime,t(u,K);else break;K=r(f)}}function O(ge){if(x=!1,b(ge),!w)if(r(u)!==null)w=!0,Te(z);else{var K=r(f);K!==null&&oe(O,K.startTime-ge)}}function z(ge,K){w=!1,x&&(x=!1,E(J),J=-1),y=!0;var fe=m;try{for(b(K),p=r(u);p!==null&&(!(p.expirationTime>K)||ge&&!ee());){var H=p.callback;if(typeof H=="function"){p.callback=null,m=p.priorityLevel;var A=H(p.expirationTime<=K);K=e.unstable_now(),typeof A=="function"?p.callback=A:p===r(u)&&n(u),b(K)}else n(u);p=r(u)}if(p!==null)var G=!0;else{var U=r(f);U!==null&&oe(O,U.startTime-K),G=!1}return G}finally{p=null,m=fe,y=!1}}var L=!1,P=null,J=-1,V=5,le=-1;function ee(){return!(e.unstable_now()-le<V)}function X(){if(P!==null){var ge=e.unstable_now();le=ge;var K=!0;try{K=P(!0,ge)}finally{K?he():(L=!1,P=null)}}else L=!1}var he;if(typeof k=="function")he=function(){k(X)};else if(typeof MessageChannel<"u"){var Ie=new MessageChannel,Ee=Ie.port2;Ie.port1.onmessage=X,he=function(){Ee.postMessage(null)}}else he=function(){_(X,0)};function Te(ge){P=ge,L||(L=!0,he())}function oe(ge,K){J=_(function(){ge(e.unstable_now())},K)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(ge){ge.callback=null},e.unstable_continueExecution=function(){w||y||(w=!0,Te(z))},e.unstable_forceFrameRate=function(ge){0>ge||125<ge?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):V=0<ge?Math.floor(1e3/ge):5},e.unstable_getCurrentPriorityLevel=function(){return m},e.unstable_getFirstCallbackNode=function(){return r(u)},e.unstable_next=function(ge){switch(m){case 1:case 2:case 3:var K=3;break;default:K=m}var fe=m;m=K;try{return ge()}finally{m=fe}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(ge,K){switch(ge){case 1:case 2:case 3:case 4:case 5:break;default:ge=3}var fe=m;m=ge;try{return K()}finally{m=fe}},e.unstable_scheduleCallback=function(ge,K,fe){var H=e.unstable_now();switch(typeof fe=="object"&&fe!==null?(fe=fe.delay,fe=typeof fe=="number"&&0<fe?H+fe:H):fe=H,ge){case 1:var A=-1;break;case 2:A=250;break;case 5:A=1073741823;break;case 4:A=1e4;break;default:A=5e3}return A=fe+A,ge={id:h++,callback:K,priorityLevel:ge,startTime:fe,expirationTime:A,sortIndex:-1},fe>H?(ge.sortIndex=fe,t(f,ge),r(u)===null&&ge===r(f)&&(x?(E(J),J=-1):x=!0,oe(O,fe-H))):(ge.sortIndex=A,t(u,ge),w||y||(w=!0,Te(z))),ge},e.unstable_shouldYield=ee,e.unstable_wrapCallback=function(ge){var K=m;return function(){var fe=m;m=K;try{return ge.apply(this,arguments)}finally{m=fe}}}})(Id)),Id}var N1;function nb(){return N1||(N1=1,Pd.exports=rb()),Pd.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var M1;function ab(){if(M1)return ln;M1=1;var e=cc(),t=nb();function r(o){for(var l="https://reactjs.org/docs/error-decoder.html?invariant="+o,d=1;d<arguments.length;d++)l+="&args[]="+encodeURIComponent(arguments[d]);return"Minified React error #"+o+"; visit "+l+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var n=new Set,a={};function s(o,l){i(o,l),i(o+"Capture",l)}function i(o,l){for(a[o]=l,o=0;o<l.length;o++)n.add(l[o])}var c=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),u=Object.prototype.hasOwnProperty,f=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,h={},p={};function m(o){return u.call(p,o)?!0:u.call(h,o)?!1:f.test(o)?p[o]=!0:(h[o]=!0,!1)}function y(o,l,d,g){if(d!==null&&d.type===0)return!1;switch(typeof l){case"function":case"symbol":return!0;case"boolean":return g?!1:d!==null?!d.acceptsBooleans:(o=o.toLowerCase().slice(0,5),o!=="data-"&&o!=="aria-");default:return!1}}function w(o,l,d,g){if(l===null||typeof l>"u"||y(o,l,d,g))return!0;if(g)return!1;if(d!==null)switch(d.type){case 3:return!l;case 4:return l===!1;case 5:return isNaN(l);case 6:return isNaN(l)||1>l}return!1}function x(o,l,d,g,v,S,T){this.acceptsBooleans=l===2||l===3||l===4,this.attributeName=g,this.attributeNamespace=v,this.mustUseProperty=d,this.propertyName=o,this.type=l,this.sanitizeURL=S,this.removeEmptyString=T}var _={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(o){_[o]=new x(o,0,!1,o,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(o){var l=o[0];_[l]=new x(l,1,!1,o[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(o){_[o]=new x(o,2,!1,o.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(o){_[o]=new x(o,2,!1,o,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(o){_[o]=new x(o,3,!1,o.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(o){_[o]=new x(o,3,!0,o,null,!1,!1)}),["capture","download"].forEach(function(o){_[o]=new x(o,4,!1,o,null,!1,!1)}),["cols","rows","size","span"].forEach(function(o){_[o]=new x(o,6,!1,o,null,!1,!1)}),["rowSpan","start"].forEach(function(o){_[o]=new x(o,5,!1,o.toLowerCase(),null,!1,!1)});var E=/[\-:]([a-z])/g;function k(o){return o[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(o){var l=o.replace(E,k);_[l]=new x(l,1,!1,o,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(o){var l=o.replace(E,k);_[l]=new x(l,1,!1,o,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(o){var l=o.replace(E,k);_[l]=new x(l,1,!1,o,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(o){_[o]=new x(o,1,!1,o.toLowerCase(),null,!1,!1)}),_.xlinkHref=new x("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(o){_[o]=new x(o,1,!1,o.toLowerCase(),null,!0,!0)});function b(o,l,d,g){var v=_.hasOwnProperty(l)?_[l]:null;(v!==null?v.type!==0:g||!(2<l.length)||l[0]!=="o"&&l[0]!=="O"||l[1]!=="n"&&l[1]!=="N")&&(w(l,d,v,g)&&(d=null),g||v===null?m(l)&&(d===null?o.removeAttribute(l):o.setAttribute(l,""+d)):v.mustUseProperty?o[v.propertyName]=d===null?v.type===3?!1:"":d:(l=v.attributeName,g=v.attributeNamespace,d===null?o.removeAttribute(l):(v=v.type,d=v===3||v===4&&d===!0?"":""+d,g?o.setAttributeNS(g,l,d):o.setAttribute(l,d))))}var O=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,z=Symbol.for("react.element"),L=Symbol.for("react.portal"),P=Symbol.for("react.fragment"),J=Symbol.for("react.strict_mode"),V=Symbol.for("react.profiler"),le=Symbol.for("react.provider"),ee=Symbol.for("react.context"),X=Symbol.for("react.forward_ref"),he=Symbol.for("react.suspense"),Ie=Symbol.for("react.suspense_list"),Ee=Symbol.for("react.memo"),Te=Symbol.for("react.lazy"),oe=Symbol.for("react.offscreen"),ge=Symbol.iterator;function K(o){return o===null||typeof o!="object"?null:(o=ge&&o[ge]||o["@@iterator"],typeof o=="function"?o:null)}var fe=Object.assign,H;function A(o){if(H===void 0)try{throw Error()}catch(d){var l=d.stack.trim().match(/\n( *(at )?)/);H=l&&l[1]||""}return`
`+H+o}var G=!1;function U(o,l){if(!o||G)return"";G=!0;var d=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(l)if(l=function(){throw Error()},Object.defineProperty(l.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(l,[])}catch(ce){var g=ce}Reflect.construct(o,[],l)}else{try{l.call()}catch(ce){g=ce}o.call(l.prototype)}else{try{throw Error()}catch(ce){g=ce}o()}}catch(ce){if(ce&&g&&typeof ce.stack=="string"){for(var v=ce.stack.split(`
`),S=g.stack.split(`
`),T=v.length-1,B=S.length-1;1<=T&&0<=B&&v[T]!==S[B];)B--;for(;1<=T&&0<=B;T--,B--)if(v[T]!==S[B]){if(T!==1||B!==1)do if(T--,B--,0>B||v[T]!==S[B]){var q=`
`+v[T].replace(" at new "," at ");return o.displayName&&q.includes("<anonymous>")&&(q=q.replace("<anonymous>",o.displayName)),q}while(1<=T&&0<=B);break}}}finally{G=!1,Error.prepareStackTrace=d}return(o=o?o.displayName||o.name:"")?A(o):""}function W(o){switch(o.tag){case 5:return A(o.type);case 16:return A("Lazy");case 13:return A("Suspense");case 19:return A("SuspenseList");case 0:case 2:case 15:return o=U(o.type,!1),o;case 11:return o=U(o.type.render,!1),o;case 1:return o=U(o.type,!0),o;default:return""}}function ne(o){if(o==null)return null;if(typeof o=="function")return o.displayName||o.name||null;if(typeof o=="string")return o;switch(o){case P:return"Fragment";case L:return"Portal";case V:return"Profiler";case J:return"StrictMode";case he:return"Suspense";case Ie:return"SuspenseList"}if(typeof o=="object")switch(o.$$typeof){case ee:return(o.displayName||"Context")+".Consumer";case le:return(o._context.displayName||"Context")+".Provider";case X:var l=o.render;return o=o.displayName,o||(o=l.displayName||l.name||"",o=o!==""?"ForwardRef("+o+")":"ForwardRef"),o;case Ee:return l=o.displayName||null,l!==null?l:ne(o.type)||"Memo";case Te:l=o._payload,o=o._init;try{return ne(o(l))}catch{}}return null}function xe(o){var l=o.type;switch(o.tag){case 24:return"Cache";case 9:return(l.displayName||"Context")+".Consumer";case 10:return(l._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return o=l.render,o=o.displayName||o.name||"",l.displayName||(o!==""?"ForwardRef("+o+")":"ForwardRef");case 7:return"Fragment";case 5:return l;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return ne(l);case 8:return l===J?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof l=="function")return l.displayName||l.name||null;if(typeof l=="string")return l}return null}function ve(o){switch(typeof o){case"boolean":case"number":case"string":case"undefined":return o;case"object":return o;default:return""}}function me(o){var l=o.type;return(o=o.nodeName)&&o.toLowerCase()==="input"&&(l==="checkbox"||l==="radio")}function ye(o){var l=me(o)?"checked":"value",d=Object.getOwnPropertyDescriptor(o.constructor.prototype,l),g=""+o[l];if(!o.hasOwnProperty(l)&&typeof d<"u"&&typeof d.get=="function"&&typeof d.set=="function"){var v=d.get,S=d.set;return Object.defineProperty(o,l,{configurable:!0,get:function(){return v.call(this)},set:function(T){g=""+T,S.call(this,T)}}),Object.defineProperty(o,l,{enumerable:d.enumerable}),{getValue:function(){return g},setValue:function(T){g=""+T},stopTracking:function(){o._valueTracker=null,delete o[l]}}}}function Ze(o){o._valueTracker||(o._valueTracker=ye(o))}function j(o){if(!o)return!1;var l=o._valueTracker;if(!l)return!0;var d=l.getValue(),g="";return o&&(g=me(o)?o.checked?"true":"false":o.value),o=g,o!==d?(l.setValue(o),!0):!1}function yt(o){if(o=o||(typeof document<"u"?document:void 0),typeof o>"u")return null;try{return o.activeElement||o.body}catch{return o.body}}function ot(o,l){var d=l.checked;return fe({},l,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:d??o._wrapperState.initialChecked})}function wt(o,l){var d=l.defaultValue==null?"":l.defaultValue,g=l.checked!=null?l.checked:l.defaultChecked;d=ve(l.value!=null?l.value:d),o._wrapperState={initialChecked:g,initialValue:d,controlled:l.type==="checkbox"||l.type==="radio"?l.checked!=null:l.value!=null}}function at(o,l){l=l.checked,l!=null&&b(o,"checked",l,!1)}function Re(o,l){at(o,l);var d=ve(l.value),g=l.type;if(d!=null)g==="number"?(d===0&&o.value===""||o.value!=d)&&(o.value=""+d):o.value!==""+d&&(o.value=""+d);else if(g==="submit"||g==="reset"){o.removeAttribute("value");return}l.hasOwnProperty("value")?Ir(o,l.type,d):l.hasOwnProperty("defaultValue")&&Ir(o,l.type,ve(l.defaultValue)),l.checked==null&&l.defaultChecked!=null&&(o.defaultChecked=!!l.defaultChecked)}function Nt(o,l,d){if(l.hasOwnProperty("value")||l.hasOwnProperty("defaultValue")){var g=l.type;if(!(g!=="submit"&&g!=="reset"||l.value!==void 0&&l.value!==null))return;l=""+o._wrapperState.initialValue,d||l===o.value||(o.value=l),o.defaultValue=l}d=o.name,d!==""&&(o.name=""),o.defaultChecked=!!o._wrapperState.initialChecked,d!==""&&(o.name=d)}function Ir(o,l,d){(l!=="number"||yt(o.ownerDocument)!==o)&&(d==null?o.defaultValue=""+o._wrapperState.initialValue:o.defaultValue!==""+d&&(o.defaultValue=""+d))}var Or=Array.isArray;function Dr(o,l,d,g){if(o=o.options,l){l={};for(var v=0;v<d.length;v++)l["$"+d[v]]=!0;for(d=0;d<o.length;d++)v=l.hasOwnProperty("$"+o[d].value),o[d].selected!==v&&(o[d].selected=v),v&&g&&(o[d].defaultSelected=!0)}else{for(d=""+ve(d),l=null,v=0;v<o.length;v++){if(o[v].value===d){o[v].selected=!0,g&&(o[v].defaultSelected=!0);return}l!==null||o[v].disabled||(l=o[v])}l!==null&&(l.selected=!0)}}function Sa(o,l){if(l.dangerouslySetInnerHTML!=null)throw Error(r(91));return fe({},l,{value:void 0,defaultValue:void 0,children:""+o._wrapperState.initialValue})}function Vn(o,l){var d=l.value;if(d==null){if(d=l.children,l=l.defaultValue,d!=null){if(l!=null)throw Error(r(92));if(Or(d)){if(1<d.length)throw Error(r(93));d=d[0]}l=d}l==null&&(l=""),d=l}o._wrapperState={initialValue:ve(d)}}function Fr(o,l){var d=ve(l.value),g=ve(l.defaultValue);d!=null&&(d=""+d,d!==o.value&&(o.value=d),l.defaultValue==null&&o.defaultValue!==d&&(o.defaultValue=d)),g!=null&&(o.defaultValue=""+g)}function Cn(o){var l=o.textContent;l===o._wrapperState.initialValue&&l!==""&&l!==null&&(o.value=l)}function Wn(o){switch(o){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Ea(o,l){return o==null||o==="http://www.w3.org/1999/xhtml"?Wn(l):o==="http://www.w3.org/2000/svg"&&l==="foreignObject"?"http://www.w3.org/1999/xhtml":o}var sr,dn=(function(o){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(l,d,g,v){MSApp.execUnsafeLocalFunction(function(){return o(l,d,g,v)})}:o})(function(o,l){if(o.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in o)o.innerHTML=l;else{for(sr=sr||document.createElement("div"),sr.innerHTML="<svg>"+l.valueOf().toString()+"</svg>",l=sr.firstChild;o.firstChild;)o.removeChild(o.firstChild);for(;l.firstChild;)o.appendChild(l.firstChild)}});function tt(o,l){if(l){var d=o.firstChild;if(d&&d===o.lastChild&&d.nodeType===3){d.nodeValue=l;return}}o.textContent=l}var Tt={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},tn=["Webkit","ms","Moz","O"];Object.keys(Tt).forEach(function(o){tn.forEach(function(l){l=l+o.charAt(0).toUpperCase()+o.substring(1),Tt[l]=Tt[o]})});function Ht(o,l,d){return l==null||typeof l=="boolean"||l===""?"":d||typeof l!="number"||l===0||Tt.hasOwnProperty(o)&&Tt[o]?(""+l).trim():l+"px"}function la(o,l){o=o.style;for(var d in l)if(l.hasOwnProperty(d)){var g=d.indexOf("--")===0,v=Ht(d,l[d],g);d==="float"&&(d="cssFloat"),g?o.setProperty(d,v):o[d]=v}}var bc=fe({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Li(o,l){if(l){if(bc[o]&&(l.children!=null||l.dangerouslySetInnerHTML!=null))throw Error(r(137,o));if(l.dangerouslySetInnerHTML!=null){if(l.children!=null)throw Error(r(60));if(typeof l.dangerouslySetInnerHTML!="object"||!("__html"in l.dangerouslySetInnerHTML))throw Error(r(61))}if(l.style!=null&&typeof l.style!="object")throw Error(r(62))}}function Ni(o,l){if(o.indexOf("-")===-1)return typeof l.is=="string";switch(o){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var ko=null;function To(o){return o=o.target||o.srcElement||window,o.correspondingUseElement&&(o=o.correspondingUseElement),o.nodeType===3?o.parentNode:o}var Co=null,qa=null,Ka=null;function Os(o){if(o=al(o)){if(typeof Co!="function")throw Error(r(280));var l=o.stateNode;l&&(l=Kc(l),Co(o.stateNode,o.type,l))}}function kc(o){qa?Ka?Ka.push(o):Ka=[o]:qa=o}function Tc(){if(qa){var o=qa,l=Ka;if(Ka=qa=null,Os(o),l)for(o=0;o<l.length;o++)Os(l[o])}}function Cc(o,l){return o(l)}function Ac(){}var Mi=!1;function Pc(o,l,d){if(Mi)return o(l,d);Mi=!0;try{return Cc(o,l,d)}finally{Mi=!1,(qa!==null||Ka!==null)&&(Ac(),Tc())}}function Ds(o,l){var d=o.stateNode;if(d===null)return null;var g=Kc(d);if(g===null)return null;d=g[l];e:switch(l){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(g=!g.disabled)||(o=o.type,g=!(o==="button"||o==="input"||o==="select"||o==="textarea")),o=!g;break e;default:o=!1}if(o)return null;if(d&&typeof d!="function")throw Error(r(231,l,typeof d));return d}var Bi=!1;if(c)try{var ba={};Object.defineProperty(ba,"passive",{get:function(){Bi=!0}}),window.addEventListener("test",ba,ba),window.removeEventListener("test",ba,ba)}catch{Bi=!1}function Gf(o,l,d,g,v,S,T,B,q){var ce=Array.prototype.slice.call(arguments,3);try{l.apply(d,ce)}catch(Se){this.onError(Se)}}var Fs=!1,Ao=null,C=!1,F=null,I={onError:function(o){Fs=!0,Ao=o}};function D(o,l,d,g,v,S,T,B,q){Fs=!1,Ao=null,Gf.apply(I,arguments)}function N(o,l,d,g,v,S,T,B,q){if(D.apply(this,arguments),Fs){if(Fs){var ce=Ao;Fs=!1,Ao=null}else throw Error(r(198));C||(C=!0,F=ce)}}function M(o){var l=o,d=o;if(o.alternate)for(;l.return;)l=l.return;else{o=l;do l=o,(l.flags&4098)!==0&&(d=l.return),o=l.return;while(o)}return l.tag===3?d:null}function ae(o){if(o.tag===13){var l=o.memoizedState;if(l===null&&(o=o.alternate,o!==null&&(l=o.memoizedState)),l!==null)return l.dehydrated}return null}function pe(o){if(M(o)!==o)throw Error(r(188))}function re(o){var l=o.alternate;if(!l){if(l=M(o),l===null)throw Error(r(188));return l!==o?null:o}for(var d=o,g=l;;){var v=d.return;if(v===null)break;var S=v.alternate;if(S===null){if(g=v.return,g!==null){d=g;continue}break}if(v.child===S.child){for(S=v.child;S;){if(S===d)return pe(v),o;if(S===g)return pe(v),l;S=S.sibling}throw Error(r(188))}if(d.return!==g.return)d=v,g=S;else{for(var T=!1,B=v.child;B;){if(B===d){T=!0,d=v,g=S;break}if(B===g){T=!0,g=v,d=S;break}B=B.sibling}if(!T){for(B=S.child;B;){if(B===d){T=!0,d=S,g=v;break}if(B===g){T=!0,g=S,d=v;break}B=B.sibling}if(!T)throw Error(r(189))}}if(d.alternate!==g)throw Error(r(190))}if(d.tag!==3)throw Error(r(188));return d.stateNode.current===d?o:l}function se(o){return o=re(o),o!==null?ie(o):null}function ie(o){if(o.tag===5||o.tag===6)return o;for(o=o.child;o!==null;){var l=ie(o);if(l!==null)return l;o=o.sibling}return null}var be=t.unstable_scheduleCallback,Fe=t.unstable_cancelCallback,Ne=t.unstable_shouldYield,Ae=t.unstable_requestPaint,Ce=t.unstable_now,et=t.unstable_getCurrentPriorityLevel,Ct=t.unstable_ImmediatePriority,At=t.unstable_UserBlockingPriority,Jt=t.unstable_NormalPriority,Rs=t.unstable_LowPriority,Xa=t.unstable_IdlePriority,ca=null,vr=null;function ji(o){if(vr&&typeof vr.onCommitFiberRoot=="function")try{vr.onCommitFiberRoot(ca,o,void 0,(o.current.flags&128)===128)}catch{}}var Yt=Math.clz32?Math.clz32:g2,d2=Math.log,h2=Math.LN2;function g2(o){return o>>>=0,o===0?32:31-(d2(o)/h2|0)|0}var Ic=64,Oc=4194304;function $i(o){switch(o&-o){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return o&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return o&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return o}}function Dc(o,l){var d=o.pendingLanes;if(d===0)return 0;var g=0,v=o.suspendedLanes,S=o.pingedLanes,T=d&268435455;if(T!==0){var B=T&~v;B!==0?g=$i(B):(S&=T,S!==0&&(g=$i(S)))}else T=d&~v,T!==0?g=$i(T):S!==0&&(g=$i(S));if(g===0)return 0;if(l!==0&&l!==g&&(l&v)===0&&(v=g&-g,S=l&-l,v>=S||v===16&&(S&4194240)!==0))return l;if((g&4)!==0&&(g|=d&16),l=o.entangledLanes,l!==0)for(o=o.entanglements,l&=g;0<l;)d=31-Yt(l),v=1<<d,g|=o[d],l&=~v;return g}function p2(o,l){switch(o){case 1:case 2:case 4:return l+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return l+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function m2(o,l){for(var d=o.suspendedLanes,g=o.pingedLanes,v=o.expirationTimes,S=o.pendingLanes;0<S;){var T=31-Yt(S),B=1<<T,q=v[T];q===-1?((B&d)===0||(B&g)!==0)&&(v[T]=p2(B,l)):q<=l&&(o.expiredLanes|=B),S&=~B}}function qf(o){return o=o.pendingLanes&-1073741825,o!==0?o:o&1073741824?1073741824:0}function ip(){var o=Ic;return Ic<<=1,(Ic&4194240)===0&&(Ic=64),o}function Kf(o){for(var l=[],d=0;31>d;d++)l.push(o);return l}function Ui(o,l,d){o.pendingLanes|=l,l!==536870912&&(o.suspendedLanes=0,o.pingedLanes=0),o=o.eventTimes,l=31-Yt(l),o[l]=d}function v2(o,l){var d=o.pendingLanes&~l;o.pendingLanes=l,o.suspendedLanes=0,o.pingedLanes=0,o.expiredLanes&=l,o.mutableReadLanes&=l,o.entangledLanes&=l,l=o.entanglements;var g=o.eventTimes;for(o=o.expirationTimes;0<d;){var v=31-Yt(d),S=1<<v;l[v]=0,g[v]=-1,o[v]=-1,d&=~S}}function Xf(o,l){var d=o.entangledLanes|=l;for(o=o.entanglements;d;){var g=31-Yt(d),v=1<<g;v&l|o[g]&l&&(o[g]|=l),d&=~v}}var _t=0;function lp(o){return o&=-o,1<o?4<o?(o&268435455)!==0?16:536870912:4:1}var cp,Jf,up,fp,dp,Yf=!1,Fc=[],Ja=null,Ya=null,Qa=null,zi=new Map,Vi=new Map,Za=[],x2="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function hp(o,l){switch(o){case"focusin":case"focusout":Ja=null;break;case"dragenter":case"dragleave":Ya=null;break;case"mouseover":case"mouseout":Qa=null;break;case"pointerover":case"pointerout":zi.delete(l.pointerId);break;case"gotpointercapture":case"lostpointercapture":Vi.delete(l.pointerId)}}function Wi(o,l,d,g,v,S){return o===null||o.nativeEvent!==S?(o={blockedOn:l,domEventName:d,eventSystemFlags:g,nativeEvent:S,targetContainers:[v]},l!==null&&(l=al(l),l!==null&&Jf(l)),o):(o.eventSystemFlags|=g,l=o.targetContainers,v!==null&&l.indexOf(v)===-1&&l.push(v),o)}function y2(o,l,d,g,v){switch(l){case"focusin":return Ja=Wi(Ja,o,l,d,g,v),!0;case"dragenter":return Ya=Wi(Ya,o,l,d,g,v),!0;case"mouseover":return Qa=Wi(Qa,o,l,d,g,v),!0;case"pointerover":var S=v.pointerId;return zi.set(S,Wi(zi.get(S)||null,o,l,d,g,v)),!0;case"gotpointercapture":return S=v.pointerId,Vi.set(S,Wi(Vi.get(S)||null,o,l,d,g,v)),!0}return!1}function gp(o){var l=Ls(o.target);if(l!==null){var d=M(l);if(d!==null){if(l=d.tag,l===13){if(l=ae(d),l!==null){o.blockedOn=l,dp(o.priority,function(){up(d)});return}}else if(l===3&&d.stateNode.current.memoizedState.isDehydrated){o.blockedOn=d.tag===3?d.stateNode.containerInfo:null;return}}}o.blockedOn=null}function Rc(o){if(o.blockedOn!==null)return!1;for(var l=o.targetContainers;0<l.length;){var d=Zf(o.domEventName,o.eventSystemFlags,l[0],o.nativeEvent);if(d===null){d=o.nativeEvent;var g=new d.constructor(d.type,d);ko=g,d.target.dispatchEvent(g),ko=null}else return l=al(d),l!==null&&Jf(l),o.blockedOn=d,!1;l.shift()}return!0}function pp(o,l,d){Rc(o)&&d.delete(l)}function w2(){Yf=!1,Ja!==null&&Rc(Ja)&&(Ja=null),Ya!==null&&Rc(Ya)&&(Ya=null),Qa!==null&&Rc(Qa)&&(Qa=null),zi.forEach(pp),Vi.forEach(pp)}function Hi(o,l){o.blockedOn===l&&(o.blockedOn=null,Yf||(Yf=!0,t.unstable_scheduleCallback(t.unstable_NormalPriority,w2)))}function Gi(o){function l(v){return Hi(v,o)}if(0<Fc.length){Hi(Fc[0],o);for(var d=1;d<Fc.length;d++){var g=Fc[d];g.blockedOn===o&&(g.blockedOn=null)}}for(Ja!==null&&Hi(Ja,o),Ya!==null&&Hi(Ya,o),Qa!==null&&Hi(Qa,o),zi.forEach(l),Vi.forEach(l),d=0;d<Za.length;d++)g=Za[d],g.blockedOn===o&&(g.blockedOn=null);for(;0<Za.length&&(d=Za[0],d.blockedOn===null);)gp(d),d.blockedOn===null&&Za.shift()}var Po=O.ReactCurrentBatchConfig,Lc=!0;function _2(o,l,d,g){var v=_t,S=Po.transition;Po.transition=null;try{_t=1,Qf(o,l,d,g)}finally{_t=v,Po.transition=S}}function S2(o,l,d,g){var v=_t,S=Po.transition;Po.transition=null;try{_t=4,Qf(o,l,d,g)}finally{_t=v,Po.transition=S}}function Qf(o,l,d,g){if(Lc){var v=Zf(o,l,d,g);if(v===null)m0(o,l,g,Nc,d),hp(o,g);else if(y2(v,o,l,d,g))g.stopPropagation();else if(hp(o,g),l&4&&-1<x2.indexOf(o)){for(;v!==null;){var S=al(v);if(S!==null&&cp(S),S=Zf(o,l,d,g),S===null&&m0(o,l,g,Nc,d),S===v)break;v=S}v!==null&&g.stopPropagation()}else m0(o,l,g,null,d)}}var Nc=null;function Zf(o,l,d,g){if(Nc=null,o=To(g),o=Ls(o),o!==null)if(l=M(o),l===null)o=null;else if(d=l.tag,d===13){if(o=ae(l),o!==null)return o;o=null}else if(d===3){if(l.stateNode.current.memoizedState.isDehydrated)return l.tag===3?l.stateNode.containerInfo:null;o=null}else l!==o&&(o=null);return Nc=o,null}function mp(o){switch(o){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(et()){case Ct:return 1;case At:return 4;case Jt:case Rs:return 16;case Xa:return 536870912;default:return 16}default:return 16}}var es=null,e0=null,Mc=null;function vp(){if(Mc)return Mc;var o,l=e0,d=l.length,g,v="value"in es?es.value:es.textContent,S=v.length;for(o=0;o<d&&l[o]===v[o];o++);var T=d-o;for(g=1;g<=T&&l[d-g]===v[S-g];g++);return Mc=v.slice(o,1<g?1-g:void 0)}function Bc(o){var l=o.keyCode;return"charCode"in o?(o=o.charCode,o===0&&l===13&&(o=13)):o=l,o===10&&(o=13),32<=o||o===13?o:0}function jc(){return!0}function xp(){return!1}function hn(o){function l(d,g,v,S,T){this._reactName=d,this._targetInst=v,this.type=g,this.nativeEvent=S,this.target=T,this.currentTarget=null;for(var B in o)o.hasOwnProperty(B)&&(d=o[B],this[B]=d?d(S):S[B]);return this.isDefaultPrevented=(S.defaultPrevented!=null?S.defaultPrevented:S.returnValue===!1)?jc:xp,this.isPropagationStopped=xp,this}return fe(l.prototype,{preventDefault:function(){this.defaultPrevented=!0;var d=this.nativeEvent;d&&(d.preventDefault?d.preventDefault():typeof d.returnValue!="unknown"&&(d.returnValue=!1),this.isDefaultPrevented=jc)},stopPropagation:function(){var d=this.nativeEvent;d&&(d.stopPropagation?d.stopPropagation():typeof d.cancelBubble!="unknown"&&(d.cancelBubble=!0),this.isPropagationStopped=jc)},persist:function(){},isPersistent:jc}),l}var Io={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(o){return o.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},t0=hn(Io),qi=fe({},Io,{view:0,detail:0}),E2=hn(qi),r0,n0,Ki,$c=fe({},qi,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:s0,button:0,buttons:0,relatedTarget:function(o){return o.relatedTarget===void 0?o.fromElement===o.srcElement?o.toElement:o.fromElement:o.relatedTarget},movementX:function(o){return"movementX"in o?o.movementX:(o!==Ki&&(Ki&&o.type==="mousemove"?(r0=o.screenX-Ki.screenX,n0=o.screenY-Ki.screenY):n0=r0=0,Ki=o),r0)},movementY:function(o){return"movementY"in o?o.movementY:n0}}),yp=hn($c),b2=fe({},$c,{dataTransfer:0}),k2=hn(b2),T2=fe({},qi,{relatedTarget:0}),a0=hn(T2),C2=fe({},Io,{animationName:0,elapsedTime:0,pseudoElement:0}),A2=hn(C2),P2=fe({},Io,{clipboardData:function(o){return"clipboardData"in o?o.clipboardData:window.clipboardData}}),I2=hn(P2),O2=fe({},Io,{data:0}),wp=hn(O2),D2={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},F2={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},R2={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function L2(o){var l=this.nativeEvent;return l.getModifierState?l.getModifierState(o):(o=R2[o])?!!l[o]:!1}function s0(){return L2}var N2=fe({},qi,{key:function(o){if(o.key){var l=D2[o.key]||o.key;if(l!=="Unidentified")return l}return o.type==="keypress"?(o=Bc(o),o===13?"Enter":String.fromCharCode(o)):o.type==="keydown"||o.type==="keyup"?F2[o.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:s0,charCode:function(o){return o.type==="keypress"?Bc(o):0},keyCode:function(o){return o.type==="keydown"||o.type==="keyup"?o.keyCode:0},which:function(o){return o.type==="keypress"?Bc(o):o.type==="keydown"||o.type==="keyup"?o.keyCode:0}}),M2=hn(N2),B2=fe({},$c,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),_p=hn(B2),j2=fe({},qi,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:s0}),$2=hn(j2),U2=fe({},Io,{propertyName:0,elapsedTime:0,pseudoElement:0}),z2=hn(U2),V2=fe({},$c,{deltaX:function(o){return"deltaX"in o?o.deltaX:"wheelDeltaX"in o?-o.wheelDeltaX:0},deltaY:function(o){return"deltaY"in o?o.deltaY:"wheelDeltaY"in o?-o.wheelDeltaY:"wheelDelta"in o?-o.wheelDelta:0},deltaZ:0,deltaMode:0}),W2=hn(V2),H2=[9,13,27,32],o0=c&&"CompositionEvent"in window,Xi=null;c&&"documentMode"in document&&(Xi=document.documentMode);var G2=c&&"TextEvent"in window&&!Xi,Sp=c&&(!o0||Xi&&8<Xi&&11>=Xi),Ep=" ",bp=!1;function kp(o,l){switch(o){case"keyup":return H2.indexOf(l.keyCode)!==-1;case"keydown":return l.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Tp(o){return o=o.detail,typeof o=="object"&&"data"in o?o.data:null}var Oo=!1;function q2(o,l){switch(o){case"compositionend":return Tp(l);case"keypress":return l.which!==32?null:(bp=!0,Ep);case"textInput":return o=l.data,o===Ep&&bp?null:o;default:return null}}function K2(o,l){if(Oo)return o==="compositionend"||!o0&&kp(o,l)?(o=vp(),Mc=e0=es=null,Oo=!1,o):null;switch(o){case"paste":return null;case"keypress":if(!(l.ctrlKey||l.altKey||l.metaKey)||l.ctrlKey&&l.altKey){if(l.char&&1<l.char.length)return l.char;if(l.which)return String.fromCharCode(l.which)}return null;case"compositionend":return Sp&&l.locale!=="ko"?null:l.data;default:return null}}var X2={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Cp(o){var l=o&&o.nodeName&&o.nodeName.toLowerCase();return l==="input"?!!X2[o.type]:l==="textarea"}function Ap(o,l,d,g){kc(g),l=Hc(l,"onChange"),0<l.length&&(d=new t0("onChange","change",null,d,g),o.push({event:d,listeners:l}))}var Ji=null,Yi=null;function J2(o){Gp(o,0)}function Uc(o){var l=No(o);if(j(l))return o}function Y2(o,l){if(o==="change")return l}var Pp=!1;if(c){var i0;if(c){var l0="oninput"in document;if(!l0){var Ip=document.createElement("div");Ip.setAttribute("oninput","return;"),l0=typeof Ip.oninput=="function"}i0=l0}else i0=!1;Pp=i0&&(!document.documentMode||9<document.documentMode)}function Op(){Ji&&(Ji.detachEvent("onpropertychange",Dp),Yi=Ji=null)}function Dp(o){if(o.propertyName==="value"&&Uc(Yi)){var l=[];Ap(l,Yi,o,To(o)),Pc(J2,l)}}function Q2(o,l,d){o==="focusin"?(Op(),Ji=l,Yi=d,Ji.attachEvent("onpropertychange",Dp)):o==="focusout"&&Op()}function Z2(o){if(o==="selectionchange"||o==="keyup"||o==="keydown")return Uc(Yi)}function eE(o,l){if(o==="click")return Uc(l)}function tE(o,l){if(o==="input"||o==="change")return Uc(l)}function rE(o,l){return o===l&&(o!==0||1/o===1/l)||o!==o&&l!==l}var Hn=typeof Object.is=="function"?Object.is:rE;function Qi(o,l){if(Hn(o,l))return!0;if(typeof o!="object"||o===null||typeof l!="object"||l===null)return!1;var d=Object.keys(o),g=Object.keys(l);if(d.length!==g.length)return!1;for(g=0;g<d.length;g++){var v=d[g];if(!u.call(l,v)||!Hn(o[v],l[v]))return!1}return!0}function Fp(o){for(;o&&o.firstChild;)o=o.firstChild;return o}function Rp(o,l){var d=Fp(o);o=0;for(var g;d;){if(d.nodeType===3){if(g=o+d.textContent.length,o<=l&&g>=l)return{node:d,offset:l-o};o=g}e:{for(;d;){if(d.nextSibling){d=d.nextSibling;break e}d=d.parentNode}d=void 0}d=Fp(d)}}function Lp(o,l){return o&&l?o===l?!0:o&&o.nodeType===3?!1:l&&l.nodeType===3?Lp(o,l.parentNode):"contains"in o?o.contains(l):o.compareDocumentPosition?!!(o.compareDocumentPosition(l)&16):!1:!1}function Np(){for(var o=window,l=yt();l instanceof o.HTMLIFrameElement;){try{var d=typeof l.contentWindow.location.href=="string"}catch{d=!1}if(d)o=l.contentWindow;else break;l=yt(o.document)}return l}function c0(o){var l=o&&o.nodeName&&o.nodeName.toLowerCase();return l&&(l==="input"&&(o.type==="text"||o.type==="search"||o.type==="tel"||o.type==="url"||o.type==="password")||l==="textarea"||o.contentEditable==="true")}function nE(o){var l=Np(),d=o.focusedElem,g=o.selectionRange;if(l!==d&&d&&d.ownerDocument&&Lp(d.ownerDocument.documentElement,d)){if(g!==null&&c0(d)){if(l=g.start,o=g.end,o===void 0&&(o=l),"selectionStart"in d)d.selectionStart=l,d.selectionEnd=Math.min(o,d.value.length);else if(o=(l=d.ownerDocument||document)&&l.defaultView||window,o.getSelection){o=o.getSelection();var v=d.textContent.length,S=Math.min(g.start,v);g=g.end===void 0?S:Math.min(g.end,v),!o.extend&&S>g&&(v=g,g=S,S=v),v=Rp(d,S);var T=Rp(d,g);v&&T&&(o.rangeCount!==1||o.anchorNode!==v.node||o.anchorOffset!==v.offset||o.focusNode!==T.node||o.focusOffset!==T.offset)&&(l=l.createRange(),l.setStart(v.node,v.offset),o.removeAllRanges(),S>g?(o.addRange(l),o.extend(T.node,T.offset)):(l.setEnd(T.node,T.offset),o.addRange(l)))}}for(l=[],o=d;o=o.parentNode;)o.nodeType===1&&l.push({element:o,left:o.scrollLeft,top:o.scrollTop});for(typeof d.focus=="function"&&d.focus(),d=0;d<l.length;d++)o=l[d],o.element.scrollLeft=o.left,o.element.scrollTop=o.top}}var aE=c&&"documentMode"in document&&11>=document.documentMode,Do=null,u0=null,Zi=null,f0=!1;function Mp(o,l,d){var g=d.window===d?d.document:d.nodeType===9?d:d.ownerDocument;f0||Do==null||Do!==yt(g)||(g=Do,"selectionStart"in g&&c0(g)?g={start:g.selectionStart,end:g.selectionEnd}:(g=(g.ownerDocument&&g.ownerDocument.defaultView||window).getSelection(),g={anchorNode:g.anchorNode,anchorOffset:g.anchorOffset,focusNode:g.focusNode,focusOffset:g.focusOffset}),Zi&&Qi(Zi,g)||(Zi=g,g=Hc(u0,"onSelect"),0<g.length&&(l=new t0("onSelect","select",null,l,d),o.push({event:l,listeners:g}),l.target=Do)))}function zc(o,l){var d={};return d[o.toLowerCase()]=l.toLowerCase(),d["Webkit"+o]="webkit"+l,d["Moz"+o]="moz"+l,d}var Fo={animationend:zc("Animation","AnimationEnd"),animationiteration:zc("Animation","AnimationIteration"),animationstart:zc("Animation","AnimationStart"),transitionend:zc("Transition","TransitionEnd")},d0={},Bp={};c&&(Bp=document.createElement("div").style,"AnimationEvent"in window||(delete Fo.animationend.animation,delete Fo.animationiteration.animation,delete Fo.animationstart.animation),"TransitionEvent"in window||delete Fo.transitionend.transition);function Vc(o){if(d0[o])return d0[o];if(!Fo[o])return o;var l=Fo[o],d;for(d in l)if(l.hasOwnProperty(d)&&d in Bp)return d0[o]=l[d];return o}var jp=Vc("animationend"),$p=Vc("animationiteration"),Up=Vc("animationstart"),zp=Vc("transitionend"),Vp=new Map,Wp="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function ts(o,l){Vp.set(o,l),s(l,[o])}for(var h0=0;h0<Wp.length;h0++){var g0=Wp[h0],sE=g0.toLowerCase(),oE=g0[0].toUpperCase()+g0.slice(1);ts(sE,"on"+oE)}ts(jp,"onAnimationEnd"),ts($p,"onAnimationIteration"),ts(Up,"onAnimationStart"),ts("dblclick","onDoubleClick"),ts("focusin","onFocus"),ts("focusout","onBlur"),ts(zp,"onTransitionEnd"),i("onMouseEnter",["mouseout","mouseover"]),i("onMouseLeave",["mouseout","mouseover"]),i("onPointerEnter",["pointerout","pointerover"]),i("onPointerLeave",["pointerout","pointerover"]),s("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),s("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),s("onBeforeInput",["compositionend","keypress","textInput","paste"]),s("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),s("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),s("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var el="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),iE=new Set("cancel close invalid load scroll toggle".split(" ").concat(el));function Hp(o,l,d){var g=o.type||"unknown-event";o.currentTarget=d,N(g,l,void 0,o),o.currentTarget=null}function Gp(o,l){l=(l&4)!==0;for(var d=0;d<o.length;d++){var g=o[d],v=g.event;g=g.listeners;e:{var S=void 0;if(l)for(var T=g.length-1;0<=T;T--){var B=g[T],q=B.instance,ce=B.currentTarget;if(B=B.listener,q!==S&&v.isPropagationStopped())break e;Hp(v,B,ce),S=q}else for(T=0;T<g.length;T++){if(B=g[T],q=B.instance,ce=B.currentTarget,B=B.listener,q!==S&&v.isPropagationStopped())break e;Hp(v,B,ce),S=q}}}if(C)throw o=F,C=!1,F=null,o}function Ot(o,l){var d=l[S0];d===void 0&&(d=l[S0]=new Set);var g=o+"__bubble";d.has(g)||(qp(l,o,2,!1),d.add(g))}function p0(o,l,d){var g=0;l&&(g|=4),qp(d,o,g,l)}var Wc="_reactListening"+Math.random().toString(36).slice(2);function tl(o){if(!o[Wc]){o[Wc]=!0,n.forEach(function(d){d!=="selectionchange"&&(iE.has(d)||p0(d,!1,o),p0(d,!0,o))});var l=o.nodeType===9?o:o.ownerDocument;l===null||l[Wc]||(l[Wc]=!0,p0("selectionchange",!1,l))}}function qp(o,l,d,g){switch(mp(l)){case 1:var v=_2;break;case 4:v=S2;break;default:v=Qf}d=v.bind(null,l,d,o),v=void 0,!Bi||l!=="touchstart"&&l!=="touchmove"&&l!=="wheel"||(v=!0),g?v!==void 0?o.addEventListener(l,d,{capture:!0,passive:v}):o.addEventListener(l,d,!0):v!==void 0?o.addEventListener(l,d,{passive:v}):o.addEventListener(l,d,!1)}function m0(o,l,d,g,v){var S=g;if((l&1)===0&&(l&2)===0&&g!==null)e:for(;;){if(g===null)return;var T=g.tag;if(T===3||T===4){var B=g.stateNode.containerInfo;if(B===v||B.nodeType===8&&B.parentNode===v)break;if(T===4)for(T=g.return;T!==null;){var q=T.tag;if((q===3||q===4)&&(q=T.stateNode.containerInfo,q===v||q.nodeType===8&&q.parentNode===v))return;T=T.return}for(;B!==null;){if(T=Ls(B),T===null)return;if(q=T.tag,q===5||q===6){g=S=T;continue e}B=B.parentNode}}g=g.return}Pc(function(){var ce=S,Se=To(d),ke=[];e:{var _e=Vp.get(o);if(_e!==void 0){var Le=t0,Be=o;switch(o){case"keypress":if(Bc(d)===0)break e;case"keydown":case"keyup":Le=M2;break;case"focusin":Be="focus",Le=a0;break;case"focusout":Be="blur",Le=a0;break;case"beforeblur":case"afterblur":Le=a0;break;case"click":if(d.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Le=yp;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Le=k2;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Le=$2;break;case jp:case $p:case Up:Le=A2;break;case zp:Le=z2;break;case"scroll":Le=E2;break;case"wheel":Le=W2;break;case"copy":case"cut":case"paste":Le=I2;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Le=_p}var je=(l&4)!==0,Qt=!je&&o==="scroll",Q=je?_e!==null?_e+"Capture":null:_e;je=[];for(var Y=ce,te;Y!==null;){te=Y;var Pe=te.stateNode;if(te.tag===5&&Pe!==null&&(te=Pe,Q!==null&&(Pe=Ds(Y,Q),Pe!=null&&je.push(rl(Y,Pe,te)))),Qt)break;Y=Y.return}0<je.length&&(_e=new Le(_e,Be,null,d,Se),ke.push({event:_e,listeners:je}))}}if((l&7)===0){e:{if(_e=o==="mouseover"||o==="pointerover",Le=o==="mouseout"||o==="pointerout",_e&&d!==ko&&(Be=d.relatedTarget||d.fromElement)&&(Ls(Be)||Be[ka]))break e;if((Le||_e)&&(_e=Se.window===Se?Se:(_e=Se.ownerDocument)?_e.defaultView||_e.parentWindow:window,Le?(Be=d.relatedTarget||d.toElement,Le=ce,Be=Be?Ls(Be):null,Be!==null&&(Qt=M(Be),Be!==Qt||Be.tag!==5&&Be.tag!==6)&&(Be=null)):(Le=null,Be=ce),Le!==Be)){if(je=yp,Pe="onMouseLeave",Q="onMouseEnter",Y="mouse",(o==="pointerout"||o==="pointerover")&&(je=_p,Pe="onPointerLeave",Q="onPointerEnter",Y="pointer"),Qt=Le==null?_e:No(Le),te=Be==null?_e:No(Be),_e=new je(Pe,Y+"leave",Le,d,Se),_e.target=Qt,_e.relatedTarget=te,Pe=null,Ls(Se)===ce&&(je=new je(Q,Y+"enter",Be,d,Se),je.target=te,je.relatedTarget=Qt,Pe=je),Qt=Pe,Le&&Be)t:{for(je=Le,Q=Be,Y=0,te=je;te;te=Ro(te))Y++;for(te=0,Pe=Q;Pe;Pe=Ro(Pe))te++;for(;0<Y-te;)je=Ro(je),Y--;for(;0<te-Y;)Q=Ro(Q),te--;for(;Y--;){if(je===Q||Q!==null&&je===Q.alternate)break t;je=Ro(je),Q=Ro(Q)}je=null}else je=null;Le!==null&&Kp(ke,_e,Le,je,!1),Be!==null&&Qt!==null&&Kp(ke,Qt,Be,je,!0)}}e:{if(_e=ce?No(ce):window,Le=_e.nodeName&&_e.nodeName.toLowerCase(),Le==="select"||Le==="input"&&_e.type==="file")var $e=Y2;else if(Cp(_e))if(Pp)$e=tE;else{$e=Z2;var We=Q2}else(Le=_e.nodeName)&&Le.toLowerCase()==="input"&&(_e.type==="checkbox"||_e.type==="radio")&&($e=eE);if($e&&($e=$e(o,ce))){Ap(ke,$e,d,Se);break e}We&&We(o,_e,ce),o==="focusout"&&(We=_e._wrapperState)&&We.controlled&&_e.type==="number"&&Ir(_e,"number",_e.value)}switch(We=ce?No(ce):window,o){case"focusin":(Cp(We)||We.contentEditable==="true")&&(Do=We,u0=ce,Zi=null);break;case"focusout":Zi=u0=Do=null;break;case"mousedown":f0=!0;break;case"contextmenu":case"mouseup":case"dragend":f0=!1,Mp(ke,d,Se);break;case"selectionchange":if(aE)break;case"keydown":case"keyup":Mp(ke,d,Se)}var He;if(o0)e:{switch(o){case"compositionstart":var Ye="onCompositionStart";break e;case"compositionend":Ye="onCompositionEnd";break e;case"compositionupdate":Ye="onCompositionUpdate";break e}Ye=void 0}else Oo?kp(o,d)&&(Ye="onCompositionEnd"):o==="keydown"&&d.keyCode===229&&(Ye="onCompositionStart");Ye&&(Sp&&d.locale!=="ko"&&(Oo||Ye!=="onCompositionStart"?Ye==="onCompositionEnd"&&Oo&&(He=vp()):(es=Se,e0="value"in es?es.value:es.textContent,Oo=!0)),We=Hc(ce,Ye),0<We.length&&(Ye=new wp(Ye,o,null,d,Se),ke.push({event:Ye,listeners:We}),He?Ye.data=He:(He=Tp(d),He!==null&&(Ye.data=He)))),(He=G2?q2(o,d):K2(o,d))&&(ce=Hc(ce,"onBeforeInput"),0<ce.length&&(Se=new wp("onBeforeInput","beforeinput",null,d,Se),ke.push({event:Se,listeners:ce}),Se.data=He))}Gp(ke,l)})}function rl(o,l,d){return{instance:o,listener:l,currentTarget:d}}function Hc(o,l){for(var d=l+"Capture",g=[];o!==null;){var v=o,S=v.stateNode;v.tag===5&&S!==null&&(v=S,S=Ds(o,d),S!=null&&g.unshift(rl(o,S,v)),S=Ds(o,l),S!=null&&g.push(rl(o,S,v))),o=o.return}return g}function Ro(o){if(o===null)return null;do o=o.return;while(o&&o.tag!==5);return o||null}function Kp(o,l,d,g,v){for(var S=l._reactName,T=[];d!==null&&d!==g;){var B=d,q=B.alternate,ce=B.stateNode;if(q!==null&&q===g)break;B.tag===5&&ce!==null&&(B=ce,v?(q=Ds(d,S),q!=null&&T.unshift(rl(d,q,B))):v||(q=Ds(d,S),q!=null&&T.push(rl(d,q,B)))),d=d.return}T.length!==0&&o.push({event:l,listeners:T})}var lE=/\r\n?/g,cE=/\u0000|\uFFFD/g;function Xp(o){return(typeof o=="string"?o:""+o).replace(lE,`
`).replace(cE,"")}function Gc(o,l,d){if(l=Xp(l),Xp(o)!==l&&d)throw Error(r(425))}function qc(){}var v0=null,x0=null;function y0(o,l){return o==="textarea"||o==="noscript"||typeof l.children=="string"||typeof l.children=="number"||typeof l.dangerouslySetInnerHTML=="object"&&l.dangerouslySetInnerHTML!==null&&l.dangerouslySetInnerHTML.__html!=null}var w0=typeof setTimeout=="function"?setTimeout:void 0,uE=typeof clearTimeout=="function"?clearTimeout:void 0,Jp=typeof Promise=="function"?Promise:void 0,fE=typeof queueMicrotask=="function"?queueMicrotask:typeof Jp<"u"?function(o){return Jp.resolve(null).then(o).catch(dE)}:w0;function dE(o){setTimeout(function(){throw o})}function _0(o,l){var d=l,g=0;do{var v=d.nextSibling;if(o.removeChild(d),v&&v.nodeType===8)if(d=v.data,d==="/$"){if(g===0){o.removeChild(v),Gi(l);return}g--}else d!=="$"&&d!=="$?"&&d!=="$!"||g++;d=v}while(d);Gi(l)}function rs(o){for(;o!=null;o=o.nextSibling){var l=o.nodeType;if(l===1||l===3)break;if(l===8){if(l=o.data,l==="$"||l==="$!"||l==="$?")break;if(l==="/$")return null}}return o}function Yp(o){o=o.previousSibling;for(var l=0;o;){if(o.nodeType===8){var d=o.data;if(d==="$"||d==="$!"||d==="$?"){if(l===0)return o;l--}else d==="/$"&&l++}o=o.previousSibling}return null}var Lo=Math.random().toString(36).slice(2),ua="__reactFiber$"+Lo,nl="__reactProps$"+Lo,ka="__reactContainer$"+Lo,S0="__reactEvents$"+Lo,hE="__reactListeners$"+Lo,gE="__reactHandles$"+Lo;function Ls(o){var l=o[ua];if(l)return l;for(var d=o.parentNode;d;){if(l=d[ka]||d[ua]){if(d=l.alternate,l.child!==null||d!==null&&d.child!==null)for(o=Yp(o);o!==null;){if(d=o[ua])return d;o=Yp(o)}return l}o=d,d=o.parentNode}return null}function al(o){return o=o[ua]||o[ka],!o||o.tag!==5&&o.tag!==6&&o.tag!==13&&o.tag!==3?null:o}function No(o){if(o.tag===5||o.tag===6)return o.stateNode;throw Error(r(33))}function Kc(o){return o[nl]||null}var E0=[],Mo=-1;function ns(o){return{current:o}}function Dt(o){0>Mo||(o.current=E0[Mo],E0[Mo]=null,Mo--)}function Pt(o,l){Mo++,E0[Mo]=o.current,o.current=l}var as={},Rr=ns(as),rn=ns(!1),Ns=as;function Bo(o,l){var d=o.type.contextTypes;if(!d)return as;var g=o.stateNode;if(g&&g.__reactInternalMemoizedUnmaskedChildContext===l)return g.__reactInternalMemoizedMaskedChildContext;var v={},S;for(S in d)v[S]=l[S];return g&&(o=o.stateNode,o.__reactInternalMemoizedUnmaskedChildContext=l,o.__reactInternalMemoizedMaskedChildContext=v),v}function nn(o){return o=o.childContextTypes,o!=null}function Xc(){Dt(rn),Dt(Rr)}function Qp(o,l,d){if(Rr.current!==as)throw Error(r(168));Pt(Rr,l),Pt(rn,d)}function Zp(o,l,d){var g=o.stateNode;if(l=l.childContextTypes,typeof g.getChildContext!="function")return d;g=g.getChildContext();for(var v in g)if(!(v in l))throw Error(r(108,xe(o)||"Unknown",v));return fe({},d,g)}function Jc(o){return o=(o=o.stateNode)&&o.__reactInternalMemoizedMergedChildContext||as,Ns=Rr.current,Pt(Rr,o),Pt(rn,rn.current),!0}function em(o,l,d){var g=o.stateNode;if(!g)throw Error(r(169));d?(o=Zp(o,l,Ns),g.__reactInternalMemoizedMergedChildContext=o,Dt(rn),Dt(Rr),Pt(Rr,o)):Dt(rn),Pt(rn,d)}var Ta=null,Yc=!1,b0=!1;function tm(o){Ta===null?Ta=[o]:Ta.push(o)}function pE(o){Yc=!0,tm(o)}function ss(){if(!b0&&Ta!==null){b0=!0;var o=0,l=_t;try{var d=Ta;for(_t=1;o<d.length;o++){var g=d[o];do g=g(!0);while(g!==null)}Ta=null,Yc=!1}catch(v){throw Ta!==null&&(Ta=Ta.slice(o+1)),be(Ct,ss),v}finally{_t=l,b0=!1}}return null}var jo=[],$o=0,Qc=null,Zc=0,An=[],Pn=0,Ms=null,Ca=1,Aa="";function Bs(o,l){jo[$o++]=Zc,jo[$o++]=Qc,Qc=o,Zc=l}function rm(o,l,d){An[Pn++]=Ca,An[Pn++]=Aa,An[Pn++]=Ms,Ms=o;var g=Ca;o=Aa;var v=32-Yt(g)-1;g&=~(1<<v),d+=1;var S=32-Yt(l)+v;if(30<S){var T=v-v%5;S=(g&(1<<T)-1).toString(32),g>>=T,v-=T,Ca=1<<32-Yt(l)+v|d<<v|g,Aa=S+o}else Ca=1<<S|d<<v|g,Aa=o}function k0(o){o.return!==null&&(Bs(o,1),rm(o,1,0))}function T0(o){for(;o===Qc;)Qc=jo[--$o],jo[$o]=null,Zc=jo[--$o],jo[$o]=null;for(;o===Ms;)Ms=An[--Pn],An[Pn]=null,Aa=An[--Pn],An[Pn]=null,Ca=An[--Pn],An[Pn]=null}var gn=null,pn=null,Mt=!1,Gn=null;function nm(o,l){var d=Fn(5,null,null,0);d.elementType="DELETED",d.stateNode=l,d.return=o,l=o.deletions,l===null?(o.deletions=[d],o.flags|=16):l.push(d)}function am(o,l){switch(o.tag){case 5:var d=o.type;return l=l.nodeType!==1||d.toLowerCase()!==l.nodeName.toLowerCase()?null:l,l!==null?(o.stateNode=l,gn=o,pn=rs(l.firstChild),!0):!1;case 6:return l=o.pendingProps===""||l.nodeType!==3?null:l,l!==null?(o.stateNode=l,gn=o,pn=null,!0):!1;case 13:return l=l.nodeType!==8?null:l,l!==null?(d=Ms!==null?{id:Ca,overflow:Aa}:null,o.memoizedState={dehydrated:l,treeContext:d,retryLane:1073741824},d=Fn(18,null,null,0),d.stateNode=l,d.return=o,o.child=d,gn=o,pn=null,!0):!1;default:return!1}}function C0(o){return(o.mode&1)!==0&&(o.flags&128)===0}function A0(o){if(Mt){var l=pn;if(l){var d=l;if(!am(o,l)){if(C0(o))throw Error(r(418));l=rs(d.nextSibling);var g=gn;l&&am(o,l)?nm(g,d):(o.flags=o.flags&-4097|2,Mt=!1,gn=o)}}else{if(C0(o))throw Error(r(418));o.flags=o.flags&-4097|2,Mt=!1,gn=o}}}function sm(o){for(o=o.return;o!==null&&o.tag!==5&&o.tag!==3&&o.tag!==13;)o=o.return;gn=o}function eu(o){if(o!==gn)return!1;if(!Mt)return sm(o),Mt=!0,!1;var l;if((l=o.tag!==3)&&!(l=o.tag!==5)&&(l=o.type,l=l!=="head"&&l!=="body"&&!y0(o.type,o.memoizedProps)),l&&(l=pn)){if(C0(o))throw om(),Error(r(418));for(;l;)nm(o,l),l=rs(l.nextSibling)}if(sm(o),o.tag===13){if(o=o.memoizedState,o=o!==null?o.dehydrated:null,!o)throw Error(r(317));e:{for(o=o.nextSibling,l=0;o;){if(o.nodeType===8){var d=o.data;if(d==="/$"){if(l===0){pn=rs(o.nextSibling);break e}l--}else d!=="$"&&d!=="$!"&&d!=="$?"||l++}o=o.nextSibling}pn=null}}else pn=gn?rs(o.stateNode.nextSibling):null;return!0}function om(){for(var o=pn;o;)o=rs(o.nextSibling)}function Uo(){pn=gn=null,Mt=!1}function P0(o){Gn===null?Gn=[o]:Gn.push(o)}var mE=O.ReactCurrentBatchConfig;function sl(o,l,d){if(o=d.ref,o!==null&&typeof o!="function"&&typeof o!="object"){if(d._owner){if(d=d._owner,d){if(d.tag!==1)throw Error(r(309));var g=d.stateNode}if(!g)throw Error(r(147,o));var v=g,S=""+o;return l!==null&&l.ref!==null&&typeof l.ref=="function"&&l.ref._stringRef===S?l.ref:(l=function(T){var B=v.refs;T===null?delete B[S]:B[S]=T},l._stringRef=S,l)}if(typeof o!="string")throw Error(r(284));if(!d._owner)throw Error(r(290,o))}return o}function tu(o,l){throw o=Object.prototype.toString.call(l),Error(r(31,o==="[object Object]"?"object with keys {"+Object.keys(l).join(", ")+"}":o))}function im(o){var l=o._init;return l(o._payload)}function lm(o){function l(Q,Y){if(o){var te=Q.deletions;te===null?(Q.deletions=[Y],Q.flags|=16):te.push(Y)}}function d(Q,Y){if(!o)return null;for(;Y!==null;)l(Q,Y),Y=Y.sibling;return null}function g(Q,Y){for(Q=new Map;Y!==null;)Y.key!==null?Q.set(Y.key,Y):Q.set(Y.index,Y),Y=Y.sibling;return Q}function v(Q,Y){return Q=hs(Q,Y),Q.index=0,Q.sibling=null,Q}function S(Q,Y,te){return Q.index=te,o?(te=Q.alternate,te!==null?(te=te.index,te<Y?(Q.flags|=2,Y):te):(Q.flags|=2,Y)):(Q.flags|=1048576,Y)}function T(Q){return o&&Q.alternate===null&&(Q.flags|=2),Q}function B(Q,Y,te,Pe){return Y===null||Y.tag!==6?(Y=wd(te,Q.mode,Pe),Y.return=Q,Y):(Y=v(Y,te),Y.return=Q,Y)}function q(Q,Y,te,Pe){var $e=te.type;return $e===P?Se(Q,Y,te.props.children,Pe,te.key):Y!==null&&(Y.elementType===$e||typeof $e=="object"&&$e!==null&&$e.$$typeof===Te&&im($e)===Y.type)?(Pe=v(Y,te.props),Pe.ref=sl(Q,Y,te),Pe.return=Q,Pe):(Pe=ku(te.type,te.key,te.props,null,Q.mode,Pe),Pe.ref=sl(Q,Y,te),Pe.return=Q,Pe)}function ce(Q,Y,te,Pe){return Y===null||Y.tag!==4||Y.stateNode.containerInfo!==te.containerInfo||Y.stateNode.implementation!==te.implementation?(Y=_d(te,Q.mode,Pe),Y.return=Q,Y):(Y=v(Y,te.children||[]),Y.return=Q,Y)}function Se(Q,Y,te,Pe,$e){return Y===null||Y.tag!==7?(Y=Gs(te,Q.mode,Pe,$e),Y.return=Q,Y):(Y=v(Y,te),Y.return=Q,Y)}function ke(Q,Y,te){if(typeof Y=="string"&&Y!==""||typeof Y=="number")return Y=wd(""+Y,Q.mode,te),Y.return=Q,Y;if(typeof Y=="object"&&Y!==null){switch(Y.$$typeof){case z:return te=ku(Y.type,Y.key,Y.props,null,Q.mode,te),te.ref=sl(Q,null,Y),te.return=Q,te;case L:return Y=_d(Y,Q.mode,te),Y.return=Q,Y;case Te:var Pe=Y._init;return ke(Q,Pe(Y._payload),te)}if(Or(Y)||K(Y))return Y=Gs(Y,Q.mode,te,null),Y.return=Q,Y;tu(Q,Y)}return null}function _e(Q,Y,te,Pe){var $e=Y!==null?Y.key:null;if(typeof te=="string"&&te!==""||typeof te=="number")return $e!==null?null:B(Q,Y,""+te,Pe);if(typeof te=="object"&&te!==null){switch(te.$$typeof){case z:return te.key===$e?q(Q,Y,te,Pe):null;case L:return te.key===$e?ce(Q,Y,te,Pe):null;case Te:return $e=te._init,_e(Q,Y,$e(te._payload),Pe)}if(Or(te)||K(te))return $e!==null?null:Se(Q,Y,te,Pe,null);tu(Q,te)}return null}function Le(Q,Y,te,Pe,$e){if(typeof Pe=="string"&&Pe!==""||typeof Pe=="number")return Q=Q.get(te)||null,B(Y,Q,""+Pe,$e);if(typeof Pe=="object"&&Pe!==null){switch(Pe.$$typeof){case z:return Q=Q.get(Pe.key===null?te:Pe.key)||null,q(Y,Q,Pe,$e);case L:return Q=Q.get(Pe.key===null?te:Pe.key)||null,ce(Y,Q,Pe,$e);case Te:var We=Pe._init;return Le(Q,Y,te,We(Pe._payload),$e)}if(Or(Pe)||K(Pe))return Q=Q.get(te)||null,Se(Y,Q,Pe,$e,null);tu(Y,Pe)}return null}function Be(Q,Y,te,Pe){for(var $e=null,We=null,He=Y,Ye=Y=0,wr=null;He!==null&&Ye<te.length;Ye++){He.index>Ye?(wr=He,He=null):wr=He.sibling;var vt=_e(Q,He,te[Ye],Pe);if(vt===null){He===null&&(He=wr);break}o&&He&&vt.alternate===null&&l(Q,He),Y=S(vt,Y,Ye),We===null?$e=vt:We.sibling=vt,We=vt,He=wr}if(Ye===te.length)return d(Q,He),Mt&&Bs(Q,Ye),$e;if(He===null){for(;Ye<te.length;Ye++)He=ke(Q,te[Ye],Pe),He!==null&&(Y=S(He,Y,Ye),We===null?$e=He:We.sibling=He,We=He);return Mt&&Bs(Q,Ye),$e}for(He=g(Q,He);Ye<te.length;Ye++)wr=Le(He,Q,Ye,te[Ye],Pe),wr!==null&&(o&&wr.alternate!==null&&He.delete(wr.key===null?Ye:wr.key),Y=S(wr,Y,Ye),We===null?$e=wr:We.sibling=wr,We=wr);return o&&He.forEach(function(gs){return l(Q,gs)}),Mt&&Bs(Q,Ye),$e}function je(Q,Y,te,Pe){var $e=K(te);if(typeof $e!="function")throw Error(r(150));if(te=$e.call(te),te==null)throw Error(r(151));for(var We=$e=null,He=Y,Ye=Y=0,wr=null,vt=te.next();He!==null&&!vt.done;Ye++,vt=te.next()){He.index>Ye?(wr=He,He=null):wr=He.sibling;var gs=_e(Q,He,vt.value,Pe);if(gs===null){He===null&&(He=wr);break}o&&He&&gs.alternate===null&&l(Q,He),Y=S(gs,Y,Ye),We===null?$e=gs:We.sibling=gs,We=gs,He=wr}if(vt.done)return d(Q,He),Mt&&Bs(Q,Ye),$e;if(He===null){for(;!vt.done;Ye++,vt=te.next())vt=ke(Q,vt.value,Pe),vt!==null&&(Y=S(vt,Y,Ye),We===null?$e=vt:We.sibling=vt,We=vt);return Mt&&Bs(Q,Ye),$e}for(He=g(Q,He);!vt.done;Ye++,vt=te.next())vt=Le(He,Q,Ye,vt.value,Pe),vt!==null&&(o&&vt.alternate!==null&&He.delete(vt.key===null?Ye:vt.key),Y=S(vt,Y,Ye),We===null?$e=vt:We.sibling=vt,We=vt);return o&&He.forEach(function(XE){return l(Q,XE)}),Mt&&Bs(Q,Ye),$e}function Qt(Q,Y,te,Pe){if(typeof te=="object"&&te!==null&&te.type===P&&te.key===null&&(te=te.props.children),typeof te=="object"&&te!==null){switch(te.$$typeof){case z:e:{for(var $e=te.key,We=Y;We!==null;){if(We.key===$e){if($e=te.type,$e===P){if(We.tag===7){d(Q,We.sibling),Y=v(We,te.props.children),Y.return=Q,Q=Y;break e}}else if(We.elementType===$e||typeof $e=="object"&&$e!==null&&$e.$$typeof===Te&&im($e)===We.type){d(Q,We.sibling),Y=v(We,te.props),Y.ref=sl(Q,We,te),Y.return=Q,Q=Y;break e}d(Q,We);break}else l(Q,We);We=We.sibling}te.type===P?(Y=Gs(te.props.children,Q.mode,Pe,te.key),Y.return=Q,Q=Y):(Pe=ku(te.type,te.key,te.props,null,Q.mode,Pe),Pe.ref=sl(Q,Y,te),Pe.return=Q,Q=Pe)}return T(Q);case L:e:{for(We=te.key;Y!==null;){if(Y.key===We)if(Y.tag===4&&Y.stateNode.containerInfo===te.containerInfo&&Y.stateNode.implementation===te.implementation){d(Q,Y.sibling),Y=v(Y,te.children||[]),Y.return=Q,Q=Y;break e}else{d(Q,Y);break}else l(Q,Y);Y=Y.sibling}Y=_d(te,Q.mode,Pe),Y.return=Q,Q=Y}return T(Q);case Te:return We=te._init,Qt(Q,Y,We(te._payload),Pe)}if(Or(te))return Be(Q,Y,te,Pe);if(K(te))return je(Q,Y,te,Pe);tu(Q,te)}return typeof te=="string"&&te!==""||typeof te=="number"?(te=""+te,Y!==null&&Y.tag===6?(d(Q,Y.sibling),Y=v(Y,te),Y.return=Q,Q=Y):(d(Q,Y),Y=wd(te,Q.mode,Pe),Y.return=Q,Q=Y),T(Q)):d(Q,Y)}return Qt}var zo=lm(!0),cm=lm(!1),ru=ns(null),nu=null,Vo=null,I0=null;function O0(){I0=Vo=nu=null}function D0(o){var l=ru.current;Dt(ru),o._currentValue=l}function F0(o,l,d){for(;o!==null;){var g=o.alternate;if((o.childLanes&l)!==l?(o.childLanes|=l,g!==null&&(g.childLanes|=l)):g!==null&&(g.childLanes&l)!==l&&(g.childLanes|=l),o===d)break;o=o.return}}function Wo(o,l){nu=o,I0=Vo=null,o=o.dependencies,o!==null&&o.firstContext!==null&&((o.lanes&l)!==0&&(an=!0),o.firstContext=null)}function In(o){var l=o._currentValue;if(I0!==o)if(o={context:o,memoizedValue:l,next:null},Vo===null){if(nu===null)throw Error(r(308));Vo=o,nu.dependencies={lanes:0,firstContext:o}}else Vo=Vo.next=o;return l}var js=null;function R0(o){js===null?js=[o]:js.push(o)}function um(o,l,d,g){var v=l.interleaved;return v===null?(d.next=d,R0(l)):(d.next=v.next,v.next=d),l.interleaved=d,Pa(o,g)}function Pa(o,l){o.lanes|=l;var d=o.alternate;for(d!==null&&(d.lanes|=l),d=o,o=o.return;o!==null;)o.childLanes|=l,d=o.alternate,d!==null&&(d.childLanes|=l),d=o,o=o.return;return d.tag===3?d.stateNode:null}var os=!1;function L0(o){o.updateQueue={baseState:o.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function fm(o,l){o=o.updateQueue,l.updateQueue===o&&(l.updateQueue={baseState:o.baseState,firstBaseUpdate:o.firstBaseUpdate,lastBaseUpdate:o.lastBaseUpdate,shared:o.shared,effects:o.effects})}function Ia(o,l){return{eventTime:o,lane:l,tag:0,payload:null,callback:null,next:null}}function is(o,l,d){var g=o.updateQueue;if(g===null)return null;if(g=g.shared,(gt&2)!==0){var v=g.pending;return v===null?l.next=l:(l.next=v.next,v.next=l),g.pending=l,Pa(o,d)}return v=g.interleaved,v===null?(l.next=l,R0(g)):(l.next=v.next,v.next=l),g.interleaved=l,Pa(o,d)}function au(o,l,d){if(l=l.updateQueue,l!==null&&(l=l.shared,(d&4194240)!==0)){var g=l.lanes;g&=o.pendingLanes,d|=g,l.lanes=d,Xf(o,d)}}function dm(o,l){var d=o.updateQueue,g=o.alternate;if(g!==null&&(g=g.updateQueue,d===g)){var v=null,S=null;if(d=d.firstBaseUpdate,d!==null){do{var T={eventTime:d.eventTime,lane:d.lane,tag:d.tag,payload:d.payload,callback:d.callback,next:null};S===null?v=S=T:S=S.next=T,d=d.next}while(d!==null);S===null?v=S=l:S=S.next=l}else v=S=l;d={baseState:g.baseState,firstBaseUpdate:v,lastBaseUpdate:S,shared:g.shared,effects:g.effects},o.updateQueue=d;return}o=d.lastBaseUpdate,o===null?d.firstBaseUpdate=l:o.next=l,d.lastBaseUpdate=l}function su(o,l,d,g){var v=o.updateQueue;os=!1;var S=v.firstBaseUpdate,T=v.lastBaseUpdate,B=v.shared.pending;if(B!==null){v.shared.pending=null;var q=B,ce=q.next;q.next=null,T===null?S=ce:T.next=ce,T=q;var Se=o.alternate;Se!==null&&(Se=Se.updateQueue,B=Se.lastBaseUpdate,B!==T&&(B===null?Se.firstBaseUpdate=ce:B.next=ce,Se.lastBaseUpdate=q))}if(S!==null){var ke=v.baseState;T=0,Se=ce=q=null,B=S;do{var _e=B.lane,Le=B.eventTime;if((g&_e)===_e){Se!==null&&(Se=Se.next={eventTime:Le,lane:0,tag:B.tag,payload:B.payload,callback:B.callback,next:null});e:{var Be=o,je=B;switch(_e=l,Le=d,je.tag){case 1:if(Be=je.payload,typeof Be=="function"){ke=Be.call(Le,ke,_e);break e}ke=Be;break e;case 3:Be.flags=Be.flags&-65537|128;case 0:if(Be=je.payload,_e=typeof Be=="function"?Be.call(Le,ke,_e):Be,_e==null)break e;ke=fe({},ke,_e);break e;case 2:os=!0}}B.callback!==null&&B.lane!==0&&(o.flags|=64,_e=v.effects,_e===null?v.effects=[B]:_e.push(B))}else Le={eventTime:Le,lane:_e,tag:B.tag,payload:B.payload,callback:B.callback,next:null},Se===null?(ce=Se=Le,q=ke):Se=Se.next=Le,T|=_e;if(B=B.next,B===null){if(B=v.shared.pending,B===null)break;_e=B,B=_e.next,_e.next=null,v.lastBaseUpdate=_e,v.shared.pending=null}}while(!0);if(Se===null&&(q=ke),v.baseState=q,v.firstBaseUpdate=ce,v.lastBaseUpdate=Se,l=v.shared.interleaved,l!==null){v=l;do T|=v.lane,v=v.next;while(v!==l)}else S===null&&(v.shared.lanes=0);zs|=T,o.lanes=T,o.memoizedState=ke}}function hm(o,l,d){if(o=l.effects,l.effects=null,o!==null)for(l=0;l<o.length;l++){var g=o[l],v=g.callback;if(v!==null){if(g.callback=null,g=d,typeof v!="function")throw Error(r(191,v));v.call(g)}}}var ol={},fa=ns(ol),il=ns(ol),ll=ns(ol);function $s(o){if(o===ol)throw Error(r(174));return o}function N0(o,l){switch(Pt(ll,l),Pt(il,o),Pt(fa,ol),o=l.nodeType,o){case 9:case 11:l=(l=l.documentElement)?l.namespaceURI:Ea(null,"");break;default:o=o===8?l.parentNode:l,l=o.namespaceURI||null,o=o.tagName,l=Ea(l,o)}Dt(fa),Pt(fa,l)}function Ho(){Dt(fa),Dt(il),Dt(ll)}function gm(o){$s(ll.current);var l=$s(fa.current),d=Ea(l,o.type);l!==d&&(Pt(il,o),Pt(fa,d))}function M0(o){il.current===o&&(Dt(fa),Dt(il))}var Bt=ns(0);function ou(o){for(var l=o;l!==null;){if(l.tag===13){var d=l.memoizedState;if(d!==null&&(d=d.dehydrated,d===null||d.data==="$?"||d.data==="$!"))return l}else if(l.tag===19&&l.memoizedProps.revealOrder!==void 0){if((l.flags&128)!==0)return l}else if(l.child!==null){l.child.return=l,l=l.child;continue}if(l===o)break;for(;l.sibling===null;){if(l.return===null||l.return===o)return null;l=l.return}l.sibling.return=l.return,l=l.sibling}return null}var B0=[];function j0(){for(var o=0;o<B0.length;o++)B0[o]._workInProgressVersionPrimary=null;B0.length=0}var iu=O.ReactCurrentDispatcher,$0=O.ReactCurrentBatchConfig,Us=0,jt=null,fr=null,xr=null,lu=!1,cl=!1,ul=0,vE=0;function Lr(){throw Error(r(321))}function U0(o,l){if(l===null)return!1;for(var d=0;d<l.length&&d<o.length;d++)if(!Hn(o[d],l[d]))return!1;return!0}function z0(o,l,d,g,v,S){if(Us=S,jt=l,l.memoizedState=null,l.updateQueue=null,l.lanes=0,iu.current=o===null||o.memoizedState===null?_E:SE,o=d(g,v),cl){S=0;do{if(cl=!1,ul=0,25<=S)throw Error(r(301));S+=1,xr=fr=null,l.updateQueue=null,iu.current=EE,o=d(g,v)}while(cl)}if(iu.current=fu,l=fr!==null&&fr.next!==null,Us=0,xr=fr=jt=null,lu=!1,l)throw Error(r(300));return o}function V0(){var o=ul!==0;return ul=0,o}function da(){var o={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return xr===null?jt.memoizedState=xr=o:xr=xr.next=o,xr}function On(){if(fr===null){var o=jt.alternate;o=o!==null?o.memoizedState:null}else o=fr.next;var l=xr===null?jt.memoizedState:xr.next;if(l!==null)xr=l,fr=o;else{if(o===null)throw Error(r(310));fr=o,o={memoizedState:fr.memoizedState,baseState:fr.baseState,baseQueue:fr.baseQueue,queue:fr.queue,next:null},xr===null?jt.memoizedState=xr=o:xr=xr.next=o}return xr}function fl(o,l){return typeof l=="function"?l(o):l}function W0(o){var l=On(),d=l.queue;if(d===null)throw Error(r(311));d.lastRenderedReducer=o;var g=fr,v=g.baseQueue,S=d.pending;if(S!==null){if(v!==null){var T=v.next;v.next=S.next,S.next=T}g.baseQueue=v=S,d.pending=null}if(v!==null){S=v.next,g=g.baseState;var B=T=null,q=null,ce=S;do{var Se=ce.lane;if((Us&Se)===Se)q!==null&&(q=q.next={lane:0,action:ce.action,hasEagerState:ce.hasEagerState,eagerState:ce.eagerState,next:null}),g=ce.hasEagerState?ce.eagerState:o(g,ce.action);else{var ke={lane:Se,action:ce.action,hasEagerState:ce.hasEagerState,eagerState:ce.eagerState,next:null};q===null?(B=q=ke,T=g):q=q.next=ke,jt.lanes|=Se,zs|=Se}ce=ce.next}while(ce!==null&&ce!==S);q===null?T=g:q.next=B,Hn(g,l.memoizedState)||(an=!0),l.memoizedState=g,l.baseState=T,l.baseQueue=q,d.lastRenderedState=g}if(o=d.interleaved,o!==null){v=o;do S=v.lane,jt.lanes|=S,zs|=S,v=v.next;while(v!==o)}else v===null&&(d.lanes=0);return[l.memoizedState,d.dispatch]}function H0(o){var l=On(),d=l.queue;if(d===null)throw Error(r(311));d.lastRenderedReducer=o;var g=d.dispatch,v=d.pending,S=l.memoizedState;if(v!==null){d.pending=null;var T=v=v.next;do S=o(S,T.action),T=T.next;while(T!==v);Hn(S,l.memoizedState)||(an=!0),l.memoizedState=S,l.baseQueue===null&&(l.baseState=S),d.lastRenderedState=S}return[S,g]}function pm(){}function mm(o,l){var d=jt,g=On(),v=l(),S=!Hn(g.memoizedState,v);if(S&&(g.memoizedState=v,an=!0),g=g.queue,G0(ym.bind(null,d,g,o),[o]),g.getSnapshot!==l||S||xr!==null&&xr.memoizedState.tag&1){if(d.flags|=2048,dl(9,xm.bind(null,d,g,v,l),void 0,null),yr===null)throw Error(r(349));(Us&30)!==0||vm(d,l,v)}return v}function vm(o,l,d){o.flags|=16384,o={getSnapshot:l,value:d},l=jt.updateQueue,l===null?(l={lastEffect:null,stores:null},jt.updateQueue=l,l.stores=[o]):(d=l.stores,d===null?l.stores=[o]:d.push(o))}function xm(o,l,d,g){l.value=d,l.getSnapshot=g,wm(l)&&_m(o)}function ym(o,l,d){return d(function(){wm(l)&&_m(o)})}function wm(o){var l=o.getSnapshot;o=o.value;try{var d=l();return!Hn(o,d)}catch{return!0}}function _m(o){var l=Pa(o,1);l!==null&&Jn(l,o,1,-1)}function Sm(o){var l=da();return typeof o=="function"&&(o=o()),l.memoizedState=l.baseState=o,o={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:fl,lastRenderedState:o},l.queue=o,o=o.dispatch=wE.bind(null,jt,o),[l.memoizedState,o]}function dl(o,l,d,g){return o={tag:o,create:l,destroy:d,deps:g,next:null},l=jt.updateQueue,l===null?(l={lastEffect:null,stores:null},jt.updateQueue=l,l.lastEffect=o.next=o):(d=l.lastEffect,d===null?l.lastEffect=o.next=o:(g=d.next,d.next=o,o.next=g,l.lastEffect=o)),o}function Em(){return On().memoizedState}function cu(o,l,d,g){var v=da();jt.flags|=o,v.memoizedState=dl(1|l,d,void 0,g===void 0?null:g)}function uu(o,l,d,g){var v=On();g=g===void 0?null:g;var S=void 0;if(fr!==null){var T=fr.memoizedState;if(S=T.destroy,g!==null&&U0(g,T.deps)){v.memoizedState=dl(l,d,S,g);return}}jt.flags|=o,v.memoizedState=dl(1|l,d,S,g)}function bm(o,l){return cu(8390656,8,o,l)}function G0(o,l){return uu(2048,8,o,l)}function km(o,l){return uu(4,2,o,l)}function Tm(o,l){return uu(4,4,o,l)}function Cm(o,l){if(typeof l=="function")return o=o(),l(o),function(){l(null)};if(l!=null)return o=o(),l.current=o,function(){l.current=null}}function Am(o,l,d){return d=d!=null?d.concat([o]):null,uu(4,4,Cm.bind(null,l,o),d)}function q0(){}function Pm(o,l){var d=On();l=l===void 0?null:l;var g=d.memoizedState;return g!==null&&l!==null&&U0(l,g[1])?g[0]:(d.memoizedState=[o,l],o)}function Im(o,l){var d=On();l=l===void 0?null:l;var g=d.memoizedState;return g!==null&&l!==null&&U0(l,g[1])?g[0]:(o=o(),d.memoizedState=[o,l],o)}function Om(o,l,d){return(Us&21)===0?(o.baseState&&(o.baseState=!1,an=!0),o.memoizedState=d):(Hn(d,l)||(d=ip(),jt.lanes|=d,zs|=d,o.baseState=!0),l)}function xE(o,l){var d=_t;_t=d!==0&&4>d?d:4,o(!0);var g=$0.transition;$0.transition={};try{o(!1),l()}finally{_t=d,$0.transition=g}}function Dm(){return On().memoizedState}function yE(o,l,d){var g=fs(o);if(d={lane:g,action:d,hasEagerState:!1,eagerState:null,next:null},Fm(o))Rm(l,d);else if(d=um(o,l,d,g),d!==null){var v=Jr();Jn(d,o,g,v),Lm(d,l,g)}}function wE(o,l,d){var g=fs(o),v={lane:g,action:d,hasEagerState:!1,eagerState:null,next:null};if(Fm(o))Rm(l,v);else{var S=o.alternate;if(o.lanes===0&&(S===null||S.lanes===0)&&(S=l.lastRenderedReducer,S!==null))try{var T=l.lastRenderedState,B=S(T,d);if(v.hasEagerState=!0,v.eagerState=B,Hn(B,T)){var q=l.interleaved;q===null?(v.next=v,R0(l)):(v.next=q.next,q.next=v),l.interleaved=v;return}}catch{}finally{}d=um(o,l,v,g),d!==null&&(v=Jr(),Jn(d,o,g,v),Lm(d,l,g))}}function Fm(o){var l=o.alternate;return o===jt||l!==null&&l===jt}function Rm(o,l){cl=lu=!0;var d=o.pending;d===null?l.next=l:(l.next=d.next,d.next=l),o.pending=l}function Lm(o,l,d){if((d&4194240)!==0){var g=l.lanes;g&=o.pendingLanes,d|=g,l.lanes=d,Xf(o,d)}}var fu={readContext:In,useCallback:Lr,useContext:Lr,useEffect:Lr,useImperativeHandle:Lr,useInsertionEffect:Lr,useLayoutEffect:Lr,useMemo:Lr,useReducer:Lr,useRef:Lr,useState:Lr,useDebugValue:Lr,useDeferredValue:Lr,useTransition:Lr,useMutableSource:Lr,useSyncExternalStore:Lr,useId:Lr,unstable_isNewReconciler:!1},_E={readContext:In,useCallback:function(o,l){return da().memoizedState=[o,l===void 0?null:l],o},useContext:In,useEffect:bm,useImperativeHandle:function(o,l,d){return d=d!=null?d.concat([o]):null,cu(4194308,4,Cm.bind(null,l,o),d)},useLayoutEffect:function(o,l){return cu(4194308,4,o,l)},useInsertionEffect:function(o,l){return cu(4,2,o,l)},useMemo:function(o,l){var d=da();return l=l===void 0?null:l,o=o(),d.memoizedState=[o,l],o},useReducer:function(o,l,d){var g=da();return l=d!==void 0?d(l):l,g.memoizedState=g.baseState=l,o={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:o,lastRenderedState:l},g.queue=o,o=o.dispatch=yE.bind(null,jt,o),[g.memoizedState,o]},useRef:function(o){var l=da();return o={current:o},l.memoizedState=o},useState:Sm,useDebugValue:q0,useDeferredValue:function(o){return da().memoizedState=o},useTransition:function(){var o=Sm(!1),l=o[0];return o=xE.bind(null,o[1]),da().memoizedState=o,[l,o]},useMutableSource:function(){},useSyncExternalStore:function(o,l,d){var g=jt,v=da();if(Mt){if(d===void 0)throw Error(r(407));d=d()}else{if(d=l(),yr===null)throw Error(r(349));(Us&30)!==0||vm(g,l,d)}v.memoizedState=d;var S={value:d,getSnapshot:l};return v.queue=S,bm(ym.bind(null,g,S,o),[o]),g.flags|=2048,dl(9,xm.bind(null,g,S,d,l),void 0,null),d},useId:function(){var o=da(),l=yr.identifierPrefix;if(Mt){var d=Aa,g=Ca;d=(g&~(1<<32-Yt(g)-1)).toString(32)+d,l=":"+l+"R"+d,d=ul++,0<d&&(l+="H"+d.toString(32)),l+=":"}else d=vE++,l=":"+l+"r"+d.toString(32)+":";return o.memoizedState=l},unstable_isNewReconciler:!1},SE={readContext:In,useCallback:Pm,useContext:In,useEffect:G0,useImperativeHandle:Am,useInsertionEffect:km,useLayoutEffect:Tm,useMemo:Im,useReducer:W0,useRef:Em,useState:function(){return W0(fl)},useDebugValue:q0,useDeferredValue:function(o){var l=On();return Om(l,fr.memoizedState,o)},useTransition:function(){var o=W0(fl)[0],l=On().memoizedState;return[o,l]},useMutableSource:pm,useSyncExternalStore:mm,useId:Dm,unstable_isNewReconciler:!1},EE={readContext:In,useCallback:Pm,useContext:In,useEffect:G0,useImperativeHandle:Am,useInsertionEffect:km,useLayoutEffect:Tm,useMemo:Im,useReducer:H0,useRef:Em,useState:function(){return H0(fl)},useDebugValue:q0,useDeferredValue:function(o){var l=On();return fr===null?l.memoizedState=o:Om(l,fr.memoizedState,o)},useTransition:function(){var o=H0(fl)[0],l=On().memoizedState;return[o,l]},useMutableSource:pm,useSyncExternalStore:mm,useId:Dm,unstable_isNewReconciler:!1};function qn(o,l){if(o&&o.defaultProps){l=fe({},l),o=o.defaultProps;for(var d in o)l[d]===void 0&&(l[d]=o[d]);return l}return l}function K0(o,l,d,g){l=o.memoizedState,d=d(g,l),d=d==null?l:fe({},l,d),o.memoizedState=d,o.lanes===0&&(o.updateQueue.baseState=d)}var du={isMounted:function(o){return(o=o._reactInternals)?M(o)===o:!1},enqueueSetState:function(o,l,d){o=o._reactInternals;var g=Jr(),v=fs(o),S=Ia(g,v);S.payload=l,d!=null&&(S.callback=d),l=is(o,S,v),l!==null&&(Jn(l,o,v,g),au(l,o,v))},enqueueReplaceState:function(o,l,d){o=o._reactInternals;var g=Jr(),v=fs(o),S=Ia(g,v);S.tag=1,S.payload=l,d!=null&&(S.callback=d),l=is(o,S,v),l!==null&&(Jn(l,o,v,g),au(l,o,v))},enqueueForceUpdate:function(o,l){o=o._reactInternals;var d=Jr(),g=fs(o),v=Ia(d,g);v.tag=2,l!=null&&(v.callback=l),l=is(o,v,g),l!==null&&(Jn(l,o,g,d),au(l,o,g))}};function Nm(o,l,d,g,v,S,T){return o=o.stateNode,typeof o.shouldComponentUpdate=="function"?o.shouldComponentUpdate(g,S,T):l.prototype&&l.prototype.isPureReactComponent?!Qi(d,g)||!Qi(v,S):!0}function Mm(o,l,d){var g=!1,v=as,S=l.contextType;return typeof S=="object"&&S!==null?S=In(S):(v=nn(l)?Ns:Rr.current,g=l.contextTypes,S=(g=g!=null)?Bo(o,v):as),l=new l(d,S),o.memoizedState=l.state!==null&&l.state!==void 0?l.state:null,l.updater=du,o.stateNode=l,l._reactInternals=o,g&&(o=o.stateNode,o.__reactInternalMemoizedUnmaskedChildContext=v,o.__reactInternalMemoizedMaskedChildContext=S),l}function Bm(o,l,d,g){o=l.state,typeof l.componentWillReceiveProps=="function"&&l.componentWillReceiveProps(d,g),typeof l.UNSAFE_componentWillReceiveProps=="function"&&l.UNSAFE_componentWillReceiveProps(d,g),l.state!==o&&du.enqueueReplaceState(l,l.state,null)}function X0(o,l,d,g){var v=o.stateNode;v.props=d,v.state=o.memoizedState,v.refs={},L0(o);var S=l.contextType;typeof S=="object"&&S!==null?v.context=In(S):(S=nn(l)?Ns:Rr.current,v.context=Bo(o,S)),v.state=o.memoizedState,S=l.getDerivedStateFromProps,typeof S=="function"&&(K0(o,l,S,d),v.state=o.memoizedState),typeof l.getDerivedStateFromProps=="function"||typeof v.getSnapshotBeforeUpdate=="function"||typeof v.UNSAFE_componentWillMount!="function"&&typeof v.componentWillMount!="function"||(l=v.state,typeof v.componentWillMount=="function"&&v.componentWillMount(),typeof v.UNSAFE_componentWillMount=="function"&&v.UNSAFE_componentWillMount(),l!==v.state&&du.enqueueReplaceState(v,v.state,null),su(o,d,v,g),v.state=o.memoizedState),typeof v.componentDidMount=="function"&&(o.flags|=4194308)}function Go(o,l){try{var d="",g=l;do d+=W(g),g=g.return;while(g);var v=d}catch(S){v=`
Error generating stack: `+S.message+`
`+S.stack}return{value:o,source:l,stack:v,digest:null}}function J0(o,l,d){return{value:o,source:null,stack:d??null,digest:l??null}}function Y0(o,l){try{console.error(l.value)}catch(d){setTimeout(function(){throw d})}}var bE=typeof WeakMap=="function"?WeakMap:Map;function jm(o,l,d){d=Ia(-1,d),d.tag=3,d.payload={element:null};var g=l.value;return d.callback=function(){yu||(yu=!0,dd=g),Y0(o,l)},d}function $m(o,l,d){d=Ia(-1,d),d.tag=3;var g=o.type.getDerivedStateFromError;if(typeof g=="function"){var v=l.value;d.payload=function(){return g(v)},d.callback=function(){Y0(o,l)}}var S=o.stateNode;return S!==null&&typeof S.componentDidCatch=="function"&&(d.callback=function(){Y0(o,l),typeof g!="function"&&(cs===null?cs=new Set([this]):cs.add(this));var T=l.stack;this.componentDidCatch(l.value,{componentStack:T!==null?T:""})}),d}function Um(o,l,d){var g=o.pingCache;if(g===null){g=o.pingCache=new bE;var v=new Set;g.set(l,v)}else v=g.get(l),v===void 0&&(v=new Set,g.set(l,v));v.has(d)||(v.add(d),o=BE.bind(null,o,l,d),l.then(o,o))}function zm(o){do{var l;if((l=o.tag===13)&&(l=o.memoizedState,l=l!==null?l.dehydrated!==null:!0),l)return o;o=o.return}while(o!==null);return null}function Vm(o,l,d,g,v){return(o.mode&1)===0?(o===l?o.flags|=65536:(o.flags|=128,d.flags|=131072,d.flags&=-52805,d.tag===1&&(d.alternate===null?d.tag=17:(l=Ia(-1,1),l.tag=2,is(d,l,1))),d.lanes|=1),o):(o.flags|=65536,o.lanes=v,o)}var kE=O.ReactCurrentOwner,an=!1;function Xr(o,l,d,g){l.child=o===null?cm(l,null,d,g):zo(l,o.child,d,g)}function Wm(o,l,d,g,v){d=d.render;var S=l.ref;return Wo(l,v),g=z0(o,l,d,g,S,v),d=V0(),o!==null&&!an?(l.updateQueue=o.updateQueue,l.flags&=-2053,o.lanes&=~v,Oa(o,l,v)):(Mt&&d&&k0(l),l.flags|=1,Xr(o,l,g,v),l.child)}function Hm(o,l,d,g,v){if(o===null){var S=d.type;return typeof S=="function"&&!yd(S)&&S.defaultProps===void 0&&d.compare===null&&d.defaultProps===void 0?(l.tag=15,l.type=S,Gm(o,l,S,g,v)):(o=ku(d.type,null,g,l,l.mode,v),o.ref=l.ref,o.return=l,l.child=o)}if(S=o.child,(o.lanes&v)===0){var T=S.memoizedProps;if(d=d.compare,d=d!==null?d:Qi,d(T,g)&&o.ref===l.ref)return Oa(o,l,v)}return l.flags|=1,o=hs(S,g),o.ref=l.ref,o.return=l,l.child=o}function Gm(o,l,d,g,v){if(o!==null){var S=o.memoizedProps;if(Qi(S,g)&&o.ref===l.ref)if(an=!1,l.pendingProps=g=S,(o.lanes&v)!==0)(o.flags&131072)!==0&&(an=!0);else return l.lanes=o.lanes,Oa(o,l,v)}return Q0(o,l,d,g,v)}function qm(o,l,d){var g=l.pendingProps,v=g.children,S=o!==null?o.memoizedState:null;if(g.mode==="hidden")if((l.mode&1)===0)l.memoizedState={baseLanes:0,cachePool:null,transitions:null},Pt(Ko,mn),mn|=d;else{if((d&1073741824)===0)return o=S!==null?S.baseLanes|d:d,l.lanes=l.childLanes=1073741824,l.memoizedState={baseLanes:o,cachePool:null,transitions:null},l.updateQueue=null,Pt(Ko,mn),mn|=o,null;l.memoizedState={baseLanes:0,cachePool:null,transitions:null},g=S!==null?S.baseLanes:d,Pt(Ko,mn),mn|=g}else S!==null?(g=S.baseLanes|d,l.memoizedState=null):g=d,Pt(Ko,mn),mn|=g;return Xr(o,l,v,d),l.child}function Km(o,l){var d=l.ref;(o===null&&d!==null||o!==null&&o.ref!==d)&&(l.flags|=512,l.flags|=2097152)}function Q0(o,l,d,g,v){var S=nn(d)?Ns:Rr.current;return S=Bo(l,S),Wo(l,v),d=z0(o,l,d,g,S,v),g=V0(),o!==null&&!an?(l.updateQueue=o.updateQueue,l.flags&=-2053,o.lanes&=~v,Oa(o,l,v)):(Mt&&g&&k0(l),l.flags|=1,Xr(o,l,d,v),l.child)}function Xm(o,l,d,g,v){if(nn(d)){var S=!0;Jc(l)}else S=!1;if(Wo(l,v),l.stateNode===null)gu(o,l),Mm(l,d,g),X0(l,d,g,v),g=!0;else if(o===null){var T=l.stateNode,B=l.memoizedProps;T.props=B;var q=T.context,ce=d.contextType;typeof ce=="object"&&ce!==null?ce=In(ce):(ce=nn(d)?Ns:Rr.current,ce=Bo(l,ce));var Se=d.getDerivedStateFromProps,ke=typeof Se=="function"||typeof T.getSnapshotBeforeUpdate=="function";ke||typeof T.UNSAFE_componentWillReceiveProps!="function"&&typeof T.componentWillReceiveProps!="function"||(B!==g||q!==ce)&&Bm(l,T,g,ce),os=!1;var _e=l.memoizedState;T.state=_e,su(l,g,T,v),q=l.memoizedState,B!==g||_e!==q||rn.current||os?(typeof Se=="function"&&(K0(l,d,Se,g),q=l.memoizedState),(B=os||Nm(l,d,B,g,_e,q,ce))?(ke||typeof T.UNSAFE_componentWillMount!="function"&&typeof T.componentWillMount!="function"||(typeof T.componentWillMount=="function"&&T.componentWillMount(),typeof T.UNSAFE_componentWillMount=="function"&&T.UNSAFE_componentWillMount()),typeof T.componentDidMount=="function"&&(l.flags|=4194308)):(typeof T.componentDidMount=="function"&&(l.flags|=4194308),l.memoizedProps=g,l.memoizedState=q),T.props=g,T.state=q,T.context=ce,g=B):(typeof T.componentDidMount=="function"&&(l.flags|=4194308),g=!1)}else{T=l.stateNode,fm(o,l),B=l.memoizedProps,ce=l.type===l.elementType?B:qn(l.type,B),T.props=ce,ke=l.pendingProps,_e=T.context,q=d.contextType,typeof q=="object"&&q!==null?q=In(q):(q=nn(d)?Ns:Rr.current,q=Bo(l,q));var Le=d.getDerivedStateFromProps;(Se=typeof Le=="function"||typeof T.getSnapshotBeforeUpdate=="function")||typeof T.UNSAFE_componentWillReceiveProps!="function"&&typeof T.componentWillReceiveProps!="function"||(B!==ke||_e!==q)&&Bm(l,T,g,q),os=!1,_e=l.memoizedState,T.state=_e,su(l,g,T,v);var Be=l.memoizedState;B!==ke||_e!==Be||rn.current||os?(typeof Le=="function"&&(K0(l,d,Le,g),Be=l.memoizedState),(ce=os||Nm(l,d,ce,g,_e,Be,q)||!1)?(Se||typeof T.UNSAFE_componentWillUpdate!="function"&&typeof T.componentWillUpdate!="function"||(typeof T.componentWillUpdate=="function"&&T.componentWillUpdate(g,Be,q),typeof T.UNSAFE_componentWillUpdate=="function"&&T.UNSAFE_componentWillUpdate(g,Be,q)),typeof T.componentDidUpdate=="function"&&(l.flags|=4),typeof T.getSnapshotBeforeUpdate=="function"&&(l.flags|=1024)):(typeof T.componentDidUpdate!="function"||B===o.memoizedProps&&_e===o.memoizedState||(l.flags|=4),typeof T.getSnapshotBeforeUpdate!="function"||B===o.memoizedProps&&_e===o.memoizedState||(l.flags|=1024),l.memoizedProps=g,l.memoizedState=Be),T.props=g,T.state=Be,T.context=q,g=ce):(typeof T.componentDidUpdate!="function"||B===o.memoizedProps&&_e===o.memoizedState||(l.flags|=4),typeof T.getSnapshotBeforeUpdate!="function"||B===o.memoizedProps&&_e===o.memoizedState||(l.flags|=1024),g=!1)}return Z0(o,l,d,g,S,v)}function Z0(o,l,d,g,v,S){Km(o,l);var T=(l.flags&128)!==0;if(!g&&!T)return v&&em(l,d,!1),Oa(o,l,S);g=l.stateNode,kE.current=l;var B=T&&typeof d.getDerivedStateFromError!="function"?null:g.render();return l.flags|=1,o!==null&&T?(l.child=zo(l,o.child,null,S),l.child=zo(l,null,B,S)):Xr(o,l,B,S),l.memoizedState=g.state,v&&em(l,d,!0),l.child}function Jm(o){var l=o.stateNode;l.pendingContext?Qp(o,l.pendingContext,l.pendingContext!==l.context):l.context&&Qp(o,l.context,!1),N0(o,l.containerInfo)}function Ym(o,l,d,g,v){return Uo(),P0(v),l.flags|=256,Xr(o,l,d,g),l.child}var ed={dehydrated:null,treeContext:null,retryLane:0};function td(o){return{baseLanes:o,cachePool:null,transitions:null}}function Qm(o,l,d){var g=l.pendingProps,v=Bt.current,S=!1,T=(l.flags&128)!==0,B;if((B=T)||(B=o!==null&&o.memoizedState===null?!1:(v&2)!==0),B?(S=!0,l.flags&=-129):(o===null||o.memoizedState!==null)&&(v|=1),Pt(Bt,v&1),o===null)return A0(l),o=l.memoizedState,o!==null&&(o=o.dehydrated,o!==null)?((l.mode&1)===0?l.lanes=1:o.data==="$!"?l.lanes=8:l.lanes=1073741824,null):(T=g.children,o=g.fallback,S?(g=l.mode,S=l.child,T={mode:"hidden",children:T},(g&1)===0&&S!==null?(S.childLanes=0,S.pendingProps=T):S=Tu(T,g,0,null),o=Gs(o,g,d,null),S.return=l,o.return=l,S.sibling=o,l.child=S,l.child.memoizedState=td(d),l.memoizedState=ed,o):rd(l,T));if(v=o.memoizedState,v!==null&&(B=v.dehydrated,B!==null))return TE(o,l,T,g,B,v,d);if(S){S=g.fallback,T=l.mode,v=o.child,B=v.sibling;var q={mode:"hidden",children:g.children};return(T&1)===0&&l.child!==v?(g=l.child,g.childLanes=0,g.pendingProps=q,l.deletions=null):(g=hs(v,q),g.subtreeFlags=v.subtreeFlags&14680064),B!==null?S=hs(B,S):(S=Gs(S,T,d,null),S.flags|=2),S.return=l,g.return=l,g.sibling=S,l.child=g,g=S,S=l.child,T=o.child.memoizedState,T=T===null?td(d):{baseLanes:T.baseLanes|d,cachePool:null,transitions:T.transitions},S.memoizedState=T,S.childLanes=o.childLanes&~d,l.memoizedState=ed,g}return S=o.child,o=S.sibling,g=hs(S,{mode:"visible",children:g.children}),(l.mode&1)===0&&(g.lanes=d),g.return=l,g.sibling=null,o!==null&&(d=l.deletions,d===null?(l.deletions=[o],l.flags|=16):d.push(o)),l.child=g,l.memoizedState=null,g}function rd(o,l){return l=Tu({mode:"visible",children:l},o.mode,0,null),l.return=o,o.child=l}function hu(o,l,d,g){return g!==null&&P0(g),zo(l,o.child,null,d),o=rd(l,l.pendingProps.children),o.flags|=2,l.memoizedState=null,o}function TE(o,l,d,g,v,S,T){if(d)return l.flags&256?(l.flags&=-257,g=J0(Error(r(422))),hu(o,l,T,g)):l.memoizedState!==null?(l.child=o.child,l.flags|=128,null):(S=g.fallback,v=l.mode,g=Tu({mode:"visible",children:g.children},v,0,null),S=Gs(S,v,T,null),S.flags|=2,g.return=l,S.return=l,g.sibling=S,l.child=g,(l.mode&1)!==0&&zo(l,o.child,null,T),l.child.memoizedState=td(T),l.memoizedState=ed,S);if((l.mode&1)===0)return hu(o,l,T,null);if(v.data==="$!"){if(g=v.nextSibling&&v.nextSibling.dataset,g)var B=g.dgst;return g=B,S=Error(r(419)),g=J0(S,g,void 0),hu(o,l,T,g)}if(B=(T&o.childLanes)!==0,an||B){if(g=yr,g!==null){switch(T&-T){case 4:v=2;break;case 16:v=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:v=32;break;case 536870912:v=268435456;break;default:v=0}v=(v&(g.suspendedLanes|T))!==0?0:v,v!==0&&v!==S.retryLane&&(S.retryLane=v,Pa(o,v),Jn(g,o,v,-1))}return xd(),g=J0(Error(r(421))),hu(o,l,T,g)}return v.data==="$?"?(l.flags|=128,l.child=o.child,l=jE.bind(null,o),v._reactRetry=l,null):(o=S.treeContext,pn=rs(v.nextSibling),gn=l,Mt=!0,Gn=null,o!==null&&(An[Pn++]=Ca,An[Pn++]=Aa,An[Pn++]=Ms,Ca=o.id,Aa=o.overflow,Ms=l),l=rd(l,g.children),l.flags|=4096,l)}function Zm(o,l,d){o.lanes|=l;var g=o.alternate;g!==null&&(g.lanes|=l),F0(o.return,l,d)}function nd(o,l,d,g,v){var S=o.memoizedState;S===null?o.memoizedState={isBackwards:l,rendering:null,renderingStartTime:0,last:g,tail:d,tailMode:v}:(S.isBackwards=l,S.rendering=null,S.renderingStartTime=0,S.last=g,S.tail=d,S.tailMode=v)}function e1(o,l,d){var g=l.pendingProps,v=g.revealOrder,S=g.tail;if(Xr(o,l,g.children,d),g=Bt.current,(g&2)!==0)g=g&1|2,l.flags|=128;else{if(o!==null&&(o.flags&128)!==0)e:for(o=l.child;o!==null;){if(o.tag===13)o.memoizedState!==null&&Zm(o,d,l);else if(o.tag===19)Zm(o,d,l);else if(o.child!==null){o.child.return=o,o=o.child;continue}if(o===l)break e;for(;o.sibling===null;){if(o.return===null||o.return===l)break e;o=o.return}o.sibling.return=o.return,o=o.sibling}g&=1}if(Pt(Bt,g),(l.mode&1)===0)l.memoizedState=null;else switch(v){case"forwards":for(d=l.child,v=null;d!==null;)o=d.alternate,o!==null&&ou(o)===null&&(v=d),d=d.sibling;d=v,d===null?(v=l.child,l.child=null):(v=d.sibling,d.sibling=null),nd(l,!1,v,d,S);break;case"backwards":for(d=null,v=l.child,l.child=null;v!==null;){if(o=v.alternate,o!==null&&ou(o)===null){l.child=v;break}o=v.sibling,v.sibling=d,d=v,v=o}nd(l,!0,d,null,S);break;case"together":nd(l,!1,null,null,void 0);break;default:l.memoizedState=null}return l.child}function gu(o,l){(l.mode&1)===0&&o!==null&&(o.alternate=null,l.alternate=null,l.flags|=2)}function Oa(o,l,d){if(o!==null&&(l.dependencies=o.dependencies),zs|=l.lanes,(d&l.childLanes)===0)return null;if(o!==null&&l.child!==o.child)throw Error(r(153));if(l.child!==null){for(o=l.child,d=hs(o,o.pendingProps),l.child=d,d.return=l;o.sibling!==null;)o=o.sibling,d=d.sibling=hs(o,o.pendingProps),d.return=l;d.sibling=null}return l.child}function CE(o,l,d){switch(l.tag){case 3:Jm(l),Uo();break;case 5:gm(l);break;case 1:nn(l.type)&&Jc(l);break;case 4:N0(l,l.stateNode.containerInfo);break;case 10:var g=l.type._context,v=l.memoizedProps.value;Pt(ru,g._currentValue),g._currentValue=v;break;case 13:if(g=l.memoizedState,g!==null)return g.dehydrated!==null?(Pt(Bt,Bt.current&1),l.flags|=128,null):(d&l.child.childLanes)!==0?Qm(o,l,d):(Pt(Bt,Bt.current&1),o=Oa(o,l,d),o!==null?o.sibling:null);Pt(Bt,Bt.current&1);break;case 19:if(g=(d&l.childLanes)!==0,(o.flags&128)!==0){if(g)return e1(o,l,d);l.flags|=128}if(v=l.memoizedState,v!==null&&(v.rendering=null,v.tail=null,v.lastEffect=null),Pt(Bt,Bt.current),g)break;return null;case 22:case 23:return l.lanes=0,qm(o,l,d)}return Oa(o,l,d)}var t1,ad,r1,n1;t1=function(o,l){for(var d=l.child;d!==null;){if(d.tag===5||d.tag===6)o.appendChild(d.stateNode);else if(d.tag!==4&&d.child!==null){d.child.return=d,d=d.child;continue}if(d===l)break;for(;d.sibling===null;){if(d.return===null||d.return===l)return;d=d.return}d.sibling.return=d.return,d=d.sibling}},ad=function(){},r1=function(o,l,d,g){var v=o.memoizedProps;if(v!==g){o=l.stateNode,$s(fa.current);var S=null;switch(d){case"input":v=ot(o,v),g=ot(o,g),S=[];break;case"select":v=fe({},v,{value:void 0}),g=fe({},g,{value:void 0}),S=[];break;case"textarea":v=Sa(o,v),g=Sa(o,g),S=[];break;default:typeof v.onClick!="function"&&typeof g.onClick=="function"&&(o.onclick=qc)}Li(d,g);var T;d=null;for(ce in v)if(!g.hasOwnProperty(ce)&&v.hasOwnProperty(ce)&&v[ce]!=null)if(ce==="style"){var B=v[ce];for(T in B)B.hasOwnProperty(T)&&(d||(d={}),d[T]="")}else ce!=="dangerouslySetInnerHTML"&&ce!=="children"&&ce!=="suppressContentEditableWarning"&&ce!=="suppressHydrationWarning"&&ce!=="autoFocus"&&(a.hasOwnProperty(ce)?S||(S=[]):(S=S||[]).push(ce,null));for(ce in g){var q=g[ce];if(B=v?.[ce],g.hasOwnProperty(ce)&&q!==B&&(q!=null||B!=null))if(ce==="style")if(B){for(T in B)!B.hasOwnProperty(T)||q&&q.hasOwnProperty(T)||(d||(d={}),d[T]="");for(T in q)q.hasOwnProperty(T)&&B[T]!==q[T]&&(d||(d={}),d[T]=q[T])}else d||(S||(S=[]),S.push(ce,d)),d=q;else ce==="dangerouslySetInnerHTML"?(q=q?q.__html:void 0,B=B?B.__html:void 0,q!=null&&B!==q&&(S=S||[]).push(ce,q)):ce==="children"?typeof q!="string"&&typeof q!="number"||(S=S||[]).push(ce,""+q):ce!=="suppressContentEditableWarning"&&ce!=="suppressHydrationWarning"&&(a.hasOwnProperty(ce)?(q!=null&&ce==="onScroll"&&Ot("scroll",o),S||B===q||(S=[])):(S=S||[]).push(ce,q))}d&&(S=S||[]).push("style",d);var ce=S;(l.updateQueue=ce)&&(l.flags|=4)}},n1=function(o,l,d,g){d!==g&&(l.flags|=4)};function hl(o,l){if(!Mt)switch(o.tailMode){case"hidden":l=o.tail;for(var d=null;l!==null;)l.alternate!==null&&(d=l),l=l.sibling;d===null?o.tail=null:d.sibling=null;break;case"collapsed":d=o.tail;for(var g=null;d!==null;)d.alternate!==null&&(g=d),d=d.sibling;g===null?l||o.tail===null?o.tail=null:o.tail.sibling=null:g.sibling=null}}function Nr(o){var l=o.alternate!==null&&o.alternate.child===o.child,d=0,g=0;if(l)for(var v=o.child;v!==null;)d|=v.lanes|v.childLanes,g|=v.subtreeFlags&14680064,g|=v.flags&14680064,v.return=o,v=v.sibling;else for(v=o.child;v!==null;)d|=v.lanes|v.childLanes,g|=v.subtreeFlags,g|=v.flags,v.return=o,v=v.sibling;return o.subtreeFlags|=g,o.childLanes=d,l}function AE(o,l,d){var g=l.pendingProps;switch(T0(l),l.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Nr(l),null;case 1:return nn(l.type)&&Xc(),Nr(l),null;case 3:return g=l.stateNode,Ho(),Dt(rn),Dt(Rr),j0(),g.pendingContext&&(g.context=g.pendingContext,g.pendingContext=null),(o===null||o.child===null)&&(eu(l)?l.flags|=4:o===null||o.memoizedState.isDehydrated&&(l.flags&256)===0||(l.flags|=1024,Gn!==null&&(pd(Gn),Gn=null))),ad(o,l),Nr(l),null;case 5:M0(l);var v=$s(ll.current);if(d=l.type,o!==null&&l.stateNode!=null)r1(o,l,d,g,v),o.ref!==l.ref&&(l.flags|=512,l.flags|=2097152);else{if(!g){if(l.stateNode===null)throw Error(r(166));return Nr(l),null}if(o=$s(fa.current),eu(l)){g=l.stateNode,d=l.type;var S=l.memoizedProps;switch(g[ua]=l,g[nl]=S,o=(l.mode&1)!==0,d){case"dialog":Ot("cancel",g),Ot("close",g);break;case"iframe":case"object":case"embed":Ot("load",g);break;case"video":case"audio":for(v=0;v<el.length;v++)Ot(el[v],g);break;case"source":Ot("error",g);break;case"img":case"image":case"link":Ot("error",g),Ot("load",g);break;case"details":Ot("toggle",g);break;case"input":wt(g,S),Ot("invalid",g);break;case"select":g._wrapperState={wasMultiple:!!S.multiple},Ot("invalid",g);break;case"textarea":Vn(g,S),Ot("invalid",g)}Li(d,S),v=null;for(var T in S)if(S.hasOwnProperty(T)){var B=S[T];T==="children"?typeof B=="string"?g.textContent!==B&&(S.suppressHydrationWarning!==!0&&Gc(g.textContent,B,o),v=["children",B]):typeof B=="number"&&g.textContent!==""+B&&(S.suppressHydrationWarning!==!0&&Gc(g.textContent,B,o),v=["children",""+B]):a.hasOwnProperty(T)&&B!=null&&T==="onScroll"&&Ot("scroll",g)}switch(d){case"input":Ze(g),Nt(g,S,!0);break;case"textarea":Ze(g),Cn(g);break;case"select":case"option":break;default:typeof S.onClick=="function"&&(g.onclick=qc)}g=v,l.updateQueue=g,g!==null&&(l.flags|=4)}else{T=v.nodeType===9?v:v.ownerDocument,o==="http://www.w3.org/1999/xhtml"&&(o=Wn(d)),o==="http://www.w3.org/1999/xhtml"?d==="script"?(o=T.createElement("div"),o.innerHTML="<script><\/script>",o=o.removeChild(o.firstChild)):typeof g.is=="string"?o=T.createElement(d,{is:g.is}):(o=T.createElement(d),d==="select"&&(T=o,g.multiple?T.multiple=!0:g.size&&(T.size=g.size))):o=T.createElementNS(o,d),o[ua]=l,o[nl]=g,t1(o,l,!1,!1),l.stateNode=o;e:{switch(T=Ni(d,g),d){case"dialog":Ot("cancel",o),Ot("close",o),v=g;break;case"iframe":case"object":case"embed":Ot("load",o),v=g;break;case"video":case"audio":for(v=0;v<el.length;v++)Ot(el[v],o);v=g;break;case"source":Ot("error",o),v=g;break;case"img":case"image":case"link":Ot("error",o),Ot("load",o),v=g;break;case"details":Ot("toggle",o),v=g;break;case"input":wt(o,g),v=ot(o,g),Ot("invalid",o);break;case"option":v=g;break;case"select":o._wrapperState={wasMultiple:!!g.multiple},v=fe({},g,{value:void 0}),Ot("invalid",o);break;case"textarea":Vn(o,g),v=Sa(o,g),Ot("invalid",o);break;default:v=g}Li(d,v),B=v;for(S in B)if(B.hasOwnProperty(S)){var q=B[S];S==="style"?la(o,q):S==="dangerouslySetInnerHTML"?(q=q?q.__html:void 0,q!=null&&dn(o,q)):S==="children"?typeof q=="string"?(d!=="textarea"||q!=="")&&tt(o,q):typeof q=="number"&&tt(o,""+q):S!=="suppressContentEditableWarning"&&S!=="suppressHydrationWarning"&&S!=="autoFocus"&&(a.hasOwnProperty(S)?q!=null&&S==="onScroll"&&Ot("scroll",o):q!=null&&b(o,S,q,T))}switch(d){case"input":Ze(o),Nt(o,g,!1);break;case"textarea":Ze(o),Cn(o);break;case"option":g.value!=null&&o.setAttribute("value",""+ve(g.value));break;case"select":o.multiple=!!g.multiple,S=g.value,S!=null?Dr(o,!!g.multiple,S,!1):g.defaultValue!=null&&Dr(o,!!g.multiple,g.defaultValue,!0);break;default:typeof v.onClick=="function"&&(o.onclick=qc)}switch(d){case"button":case"input":case"select":case"textarea":g=!!g.autoFocus;break e;case"img":g=!0;break e;default:g=!1}}g&&(l.flags|=4)}l.ref!==null&&(l.flags|=512,l.flags|=2097152)}return Nr(l),null;case 6:if(o&&l.stateNode!=null)n1(o,l,o.memoizedProps,g);else{if(typeof g!="string"&&l.stateNode===null)throw Error(r(166));if(d=$s(ll.current),$s(fa.current),eu(l)){if(g=l.stateNode,d=l.memoizedProps,g[ua]=l,(S=g.nodeValue!==d)&&(o=gn,o!==null))switch(o.tag){case 3:Gc(g.nodeValue,d,(o.mode&1)!==0);break;case 5:o.memoizedProps.suppressHydrationWarning!==!0&&Gc(g.nodeValue,d,(o.mode&1)!==0)}S&&(l.flags|=4)}else g=(d.nodeType===9?d:d.ownerDocument).createTextNode(g),g[ua]=l,l.stateNode=g}return Nr(l),null;case 13:if(Dt(Bt),g=l.memoizedState,o===null||o.memoizedState!==null&&o.memoizedState.dehydrated!==null){if(Mt&&pn!==null&&(l.mode&1)!==0&&(l.flags&128)===0)om(),Uo(),l.flags|=98560,S=!1;else if(S=eu(l),g!==null&&g.dehydrated!==null){if(o===null){if(!S)throw Error(r(318));if(S=l.memoizedState,S=S!==null?S.dehydrated:null,!S)throw Error(r(317));S[ua]=l}else Uo(),(l.flags&128)===0&&(l.memoizedState=null),l.flags|=4;Nr(l),S=!1}else Gn!==null&&(pd(Gn),Gn=null),S=!0;if(!S)return l.flags&65536?l:null}return(l.flags&128)!==0?(l.lanes=d,l):(g=g!==null,g!==(o!==null&&o.memoizedState!==null)&&g&&(l.child.flags|=8192,(l.mode&1)!==0&&(o===null||(Bt.current&1)!==0?dr===0&&(dr=3):xd())),l.updateQueue!==null&&(l.flags|=4),Nr(l),null);case 4:return Ho(),ad(o,l),o===null&&tl(l.stateNode.containerInfo),Nr(l),null;case 10:return D0(l.type._context),Nr(l),null;case 17:return nn(l.type)&&Xc(),Nr(l),null;case 19:if(Dt(Bt),S=l.memoizedState,S===null)return Nr(l),null;if(g=(l.flags&128)!==0,T=S.rendering,T===null)if(g)hl(S,!1);else{if(dr!==0||o!==null&&(o.flags&128)!==0)for(o=l.child;o!==null;){if(T=ou(o),T!==null){for(l.flags|=128,hl(S,!1),g=T.updateQueue,g!==null&&(l.updateQueue=g,l.flags|=4),l.subtreeFlags=0,g=d,d=l.child;d!==null;)S=d,o=g,S.flags&=14680066,T=S.alternate,T===null?(S.childLanes=0,S.lanes=o,S.child=null,S.subtreeFlags=0,S.memoizedProps=null,S.memoizedState=null,S.updateQueue=null,S.dependencies=null,S.stateNode=null):(S.childLanes=T.childLanes,S.lanes=T.lanes,S.child=T.child,S.subtreeFlags=0,S.deletions=null,S.memoizedProps=T.memoizedProps,S.memoizedState=T.memoizedState,S.updateQueue=T.updateQueue,S.type=T.type,o=T.dependencies,S.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext}),d=d.sibling;return Pt(Bt,Bt.current&1|2),l.child}o=o.sibling}S.tail!==null&&Ce()>Xo&&(l.flags|=128,g=!0,hl(S,!1),l.lanes=4194304)}else{if(!g)if(o=ou(T),o!==null){if(l.flags|=128,g=!0,d=o.updateQueue,d!==null&&(l.updateQueue=d,l.flags|=4),hl(S,!0),S.tail===null&&S.tailMode==="hidden"&&!T.alternate&&!Mt)return Nr(l),null}else 2*Ce()-S.renderingStartTime>Xo&&d!==1073741824&&(l.flags|=128,g=!0,hl(S,!1),l.lanes=4194304);S.isBackwards?(T.sibling=l.child,l.child=T):(d=S.last,d!==null?d.sibling=T:l.child=T,S.last=T)}return S.tail!==null?(l=S.tail,S.rendering=l,S.tail=l.sibling,S.renderingStartTime=Ce(),l.sibling=null,d=Bt.current,Pt(Bt,g?d&1|2:d&1),l):(Nr(l),null);case 22:case 23:return vd(),g=l.memoizedState!==null,o!==null&&o.memoizedState!==null!==g&&(l.flags|=8192),g&&(l.mode&1)!==0?(mn&1073741824)!==0&&(Nr(l),l.subtreeFlags&6&&(l.flags|=8192)):Nr(l),null;case 24:return null;case 25:return null}throw Error(r(156,l.tag))}function PE(o,l){switch(T0(l),l.tag){case 1:return nn(l.type)&&Xc(),o=l.flags,o&65536?(l.flags=o&-65537|128,l):null;case 3:return Ho(),Dt(rn),Dt(Rr),j0(),o=l.flags,(o&65536)!==0&&(o&128)===0?(l.flags=o&-65537|128,l):null;case 5:return M0(l),null;case 13:if(Dt(Bt),o=l.memoizedState,o!==null&&o.dehydrated!==null){if(l.alternate===null)throw Error(r(340));Uo()}return o=l.flags,o&65536?(l.flags=o&-65537|128,l):null;case 19:return Dt(Bt),null;case 4:return Ho(),null;case 10:return D0(l.type._context),null;case 22:case 23:return vd(),null;case 24:return null;default:return null}}var pu=!1,Mr=!1,IE=typeof WeakSet=="function"?WeakSet:Set,Me=null;function qo(o,l){var d=o.ref;if(d!==null)if(typeof d=="function")try{d(null)}catch(g){Gt(o,l,g)}else d.current=null}function sd(o,l,d){try{d()}catch(g){Gt(o,l,g)}}var a1=!1;function OE(o,l){if(v0=Lc,o=Np(),c0(o)){if("selectionStart"in o)var d={start:o.selectionStart,end:o.selectionEnd};else e:{d=(d=o.ownerDocument)&&d.defaultView||window;var g=d.getSelection&&d.getSelection();if(g&&g.rangeCount!==0){d=g.anchorNode;var v=g.anchorOffset,S=g.focusNode;g=g.focusOffset;try{d.nodeType,S.nodeType}catch{d=null;break e}var T=0,B=-1,q=-1,ce=0,Se=0,ke=o,_e=null;t:for(;;){for(var Le;ke!==d||v!==0&&ke.nodeType!==3||(B=T+v),ke!==S||g!==0&&ke.nodeType!==3||(q=T+g),ke.nodeType===3&&(T+=ke.nodeValue.length),(Le=ke.firstChild)!==null;)_e=ke,ke=Le;for(;;){if(ke===o)break t;if(_e===d&&++ce===v&&(B=T),_e===S&&++Se===g&&(q=T),(Le=ke.nextSibling)!==null)break;ke=_e,_e=ke.parentNode}ke=Le}d=B===-1||q===-1?null:{start:B,end:q}}else d=null}d=d||{start:0,end:0}}else d=null;for(x0={focusedElem:o,selectionRange:d},Lc=!1,Me=l;Me!==null;)if(l=Me,o=l.child,(l.subtreeFlags&1028)!==0&&o!==null)o.return=l,Me=o;else for(;Me!==null;){l=Me;try{var Be=l.alternate;if((l.flags&1024)!==0)switch(l.tag){case 0:case 11:case 15:break;case 1:if(Be!==null){var je=Be.memoizedProps,Qt=Be.memoizedState,Q=l.stateNode,Y=Q.getSnapshotBeforeUpdate(l.elementType===l.type?je:qn(l.type,je),Qt);Q.__reactInternalSnapshotBeforeUpdate=Y}break;case 3:var te=l.stateNode.containerInfo;te.nodeType===1?te.textContent="":te.nodeType===9&&te.documentElement&&te.removeChild(te.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(r(163))}}catch(Pe){Gt(l,l.return,Pe)}if(o=l.sibling,o!==null){o.return=l.return,Me=o;break}Me=l.return}return Be=a1,a1=!1,Be}function gl(o,l,d){var g=l.updateQueue;if(g=g!==null?g.lastEffect:null,g!==null){var v=g=g.next;do{if((v.tag&o)===o){var S=v.destroy;v.destroy=void 0,S!==void 0&&sd(l,d,S)}v=v.next}while(v!==g)}}function mu(o,l){if(l=l.updateQueue,l=l!==null?l.lastEffect:null,l!==null){var d=l=l.next;do{if((d.tag&o)===o){var g=d.create;d.destroy=g()}d=d.next}while(d!==l)}}function od(o){var l=o.ref;if(l!==null){var d=o.stateNode;switch(o.tag){case 5:o=d;break;default:o=d}typeof l=="function"?l(o):l.current=o}}function s1(o){var l=o.alternate;l!==null&&(o.alternate=null,s1(l)),o.child=null,o.deletions=null,o.sibling=null,o.tag===5&&(l=o.stateNode,l!==null&&(delete l[ua],delete l[nl],delete l[S0],delete l[hE],delete l[gE])),o.stateNode=null,o.return=null,o.dependencies=null,o.memoizedProps=null,o.memoizedState=null,o.pendingProps=null,o.stateNode=null,o.updateQueue=null}function o1(o){return o.tag===5||o.tag===3||o.tag===4}function i1(o){e:for(;;){for(;o.sibling===null;){if(o.return===null||o1(o.return))return null;o=o.return}for(o.sibling.return=o.return,o=o.sibling;o.tag!==5&&o.tag!==6&&o.tag!==18;){if(o.flags&2||o.child===null||o.tag===4)continue e;o.child.return=o,o=o.child}if(!(o.flags&2))return o.stateNode}}function id(o,l,d){var g=o.tag;if(g===5||g===6)o=o.stateNode,l?d.nodeType===8?d.parentNode.insertBefore(o,l):d.insertBefore(o,l):(d.nodeType===8?(l=d.parentNode,l.insertBefore(o,d)):(l=d,l.appendChild(o)),d=d._reactRootContainer,d!=null||l.onclick!==null||(l.onclick=qc));else if(g!==4&&(o=o.child,o!==null))for(id(o,l,d),o=o.sibling;o!==null;)id(o,l,d),o=o.sibling}function ld(o,l,d){var g=o.tag;if(g===5||g===6)o=o.stateNode,l?d.insertBefore(o,l):d.appendChild(o);else if(g!==4&&(o=o.child,o!==null))for(ld(o,l,d),o=o.sibling;o!==null;)ld(o,l,d),o=o.sibling}var kr=null,Kn=!1;function ls(o,l,d){for(d=d.child;d!==null;)l1(o,l,d),d=d.sibling}function l1(o,l,d){if(vr&&typeof vr.onCommitFiberUnmount=="function")try{vr.onCommitFiberUnmount(ca,d)}catch{}switch(d.tag){case 5:Mr||qo(d,l);case 6:var g=kr,v=Kn;kr=null,ls(o,l,d),kr=g,Kn=v,kr!==null&&(Kn?(o=kr,d=d.stateNode,o.nodeType===8?o.parentNode.removeChild(d):o.removeChild(d)):kr.removeChild(d.stateNode));break;case 18:kr!==null&&(Kn?(o=kr,d=d.stateNode,o.nodeType===8?_0(o.parentNode,d):o.nodeType===1&&_0(o,d),Gi(o)):_0(kr,d.stateNode));break;case 4:g=kr,v=Kn,kr=d.stateNode.containerInfo,Kn=!0,ls(o,l,d),kr=g,Kn=v;break;case 0:case 11:case 14:case 15:if(!Mr&&(g=d.updateQueue,g!==null&&(g=g.lastEffect,g!==null))){v=g=g.next;do{var S=v,T=S.destroy;S=S.tag,T!==void 0&&((S&2)!==0||(S&4)!==0)&&sd(d,l,T),v=v.next}while(v!==g)}ls(o,l,d);break;case 1:if(!Mr&&(qo(d,l),g=d.stateNode,typeof g.componentWillUnmount=="function"))try{g.props=d.memoizedProps,g.state=d.memoizedState,g.componentWillUnmount()}catch(B){Gt(d,l,B)}ls(o,l,d);break;case 21:ls(o,l,d);break;case 22:d.mode&1?(Mr=(g=Mr)||d.memoizedState!==null,ls(o,l,d),Mr=g):ls(o,l,d);break;default:ls(o,l,d)}}function c1(o){var l=o.updateQueue;if(l!==null){o.updateQueue=null;var d=o.stateNode;d===null&&(d=o.stateNode=new IE),l.forEach(function(g){var v=$E.bind(null,o,g);d.has(g)||(d.add(g),g.then(v,v))})}}function Xn(o,l){var d=l.deletions;if(d!==null)for(var g=0;g<d.length;g++){var v=d[g];try{var S=o,T=l,B=T;e:for(;B!==null;){switch(B.tag){case 5:kr=B.stateNode,Kn=!1;break e;case 3:kr=B.stateNode.containerInfo,Kn=!0;break e;case 4:kr=B.stateNode.containerInfo,Kn=!0;break e}B=B.return}if(kr===null)throw Error(r(160));l1(S,T,v),kr=null,Kn=!1;var q=v.alternate;q!==null&&(q.return=null),v.return=null}catch(ce){Gt(v,l,ce)}}if(l.subtreeFlags&12854)for(l=l.child;l!==null;)u1(l,o),l=l.sibling}function u1(o,l){var d=o.alternate,g=o.flags;switch(o.tag){case 0:case 11:case 14:case 15:if(Xn(l,o),ha(o),g&4){try{gl(3,o,o.return),mu(3,o)}catch(je){Gt(o,o.return,je)}try{gl(5,o,o.return)}catch(je){Gt(o,o.return,je)}}break;case 1:Xn(l,o),ha(o),g&512&&d!==null&&qo(d,d.return);break;case 5:if(Xn(l,o),ha(o),g&512&&d!==null&&qo(d,d.return),o.flags&32){var v=o.stateNode;try{tt(v,"")}catch(je){Gt(o,o.return,je)}}if(g&4&&(v=o.stateNode,v!=null)){var S=o.memoizedProps,T=d!==null?d.memoizedProps:S,B=o.type,q=o.updateQueue;if(o.updateQueue=null,q!==null)try{B==="input"&&S.type==="radio"&&S.name!=null&&at(v,S),Ni(B,T);var ce=Ni(B,S);for(T=0;T<q.length;T+=2){var Se=q[T],ke=q[T+1];Se==="style"?la(v,ke):Se==="dangerouslySetInnerHTML"?dn(v,ke):Se==="children"?tt(v,ke):b(v,Se,ke,ce)}switch(B){case"input":Re(v,S);break;case"textarea":Fr(v,S);break;case"select":var _e=v._wrapperState.wasMultiple;v._wrapperState.wasMultiple=!!S.multiple;var Le=S.value;Le!=null?Dr(v,!!S.multiple,Le,!1):_e!==!!S.multiple&&(S.defaultValue!=null?Dr(v,!!S.multiple,S.defaultValue,!0):Dr(v,!!S.multiple,S.multiple?[]:"",!1))}v[nl]=S}catch(je){Gt(o,o.return,je)}}break;case 6:if(Xn(l,o),ha(o),g&4){if(o.stateNode===null)throw Error(r(162));v=o.stateNode,S=o.memoizedProps;try{v.nodeValue=S}catch(je){Gt(o,o.return,je)}}break;case 3:if(Xn(l,o),ha(o),g&4&&d!==null&&d.memoizedState.isDehydrated)try{Gi(l.containerInfo)}catch(je){Gt(o,o.return,je)}break;case 4:Xn(l,o),ha(o);break;case 13:Xn(l,o),ha(o),v=o.child,v.flags&8192&&(S=v.memoizedState!==null,v.stateNode.isHidden=S,!S||v.alternate!==null&&v.alternate.memoizedState!==null||(fd=Ce())),g&4&&c1(o);break;case 22:if(Se=d!==null&&d.memoizedState!==null,o.mode&1?(Mr=(ce=Mr)||Se,Xn(l,o),Mr=ce):Xn(l,o),ha(o),g&8192){if(ce=o.memoizedState!==null,(o.stateNode.isHidden=ce)&&!Se&&(o.mode&1)!==0)for(Me=o,Se=o.child;Se!==null;){for(ke=Me=Se;Me!==null;){switch(_e=Me,Le=_e.child,_e.tag){case 0:case 11:case 14:case 15:gl(4,_e,_e.return);break;case 1:qo(_e,_e.return);var Be=_e.stateNode;if(typeof Be.componentWillUnmount=="function"){g=_e,d=_e.return;try{l=g,Be.props=l.memoizedProps,Be.state=l.memoizedState,Be.componentWillUnmount()}catch(je){Gt(g,d,je)}}break;case 5:qo(_e,_e.return);break;case 22:if(_e.memoizedState!==null){h1(ke);continue}}Le!==null?(Le.return=_e,Me=Le):h1(ke)}Se=Se.sibling}e:for(Se=null,ke=o;;){if(ke.tag===5){if(Se===null){Se=ke;try{v=ke.stateNode,ce?(S=v.style,typeof S.setProperty=="function"?S.setProperty("display","none","important"):S.display="none"):(B=ke.stateNode,q=ke.memoizedProps.style,T=q!=null&&q.hasOwnProperty("display")?q.display:null,B.style.display=Ht("display",T))}catch(je){Gt(o,o.return,je)}}}else if(ke.tag===6){if(Se===null)try{ke.stateNode.nodeValue=ce?"":ke.memoizedProps}catch(je){Gt(o,o.return,je)}}else if((ke.tag!==22&&ke.tag!==23||ke.memoizedState===null||ke===o)&&ke.child!==null){ke.child.return=ke,ke=ke.child;continue}if(ke===o)break e;for(;ke.sibling===null;){if(ke.return===null||ke.return===o)break e;Se===ke&&(Se=null),ke=ke.return}Se===ke&&(Se=null),ke.sibling.return=ke.return,ke=ke.sibling}}break;case 19:Xn(l,o),ha(o),g&4&&c1(o);break;case 21:break;default:Xn(l,o),ha(o)}}function ha(o){var l=o.flags;if(l&2){try{e:{for(var d=o.return;d!==null;){if(o1(d)){var g=d;break e}d=d.return}throw Error(r(160))}switch(g.tag){case 5:var v=g.stateNode;g.flags&32&&(tt(v,""),g.flags&=-33);var S=i1(o);ld(o,S,v);break;case 3:case 4:var T=g.stateNode.containerInfo,B=i1(o);id(o,B,T);break;default:throw Error(r(161))}}catch(q){Gt(o,o.return,q)}o.flags&=-3}l&4096&&(o.flags&=-4097)}function DE(o,l,d){Me=o,f1(o)}function f1(o,l,d){for(var g=(o.mode&1)!==0;Me!==null;){var v=Me,S=v.child;if(v.tag===22&&g){var T=v.memoizedState!==null||pu;if(!T){var B=v.alternate,q=B!==null&&B.memoizedState!==null||Mr;B=pu;var ce=Mr;if(pu=T,(Mr=q)&&!ce)for(Me=v;Me!==null;)T=Me,q=T.child,T.tag===22&&T.memoizedState!==null?g1(v):q!==null?(q.return=T,Me=q):g1(v);for(;S!==null;)Me=S,f1(S),S=S.sibling;Me=v,pu=B,Mr=ce}d1(o)}else(v.subtreeFlags&8772)!==0&&S!==null?(S.return=v,Me=S):d1(o)}}function d1(o){for(;Me!==null;){var l=Me;if((l.flags&8772)!==0){var d=l.alternate;try{if((l.flags&8772)!==0)switch(l.tag){case 0:case 11:case 15:Mr||mu(5,l);break;case 1:var g=l.stateNode;if(l.flags&4&&!Mr)if(d===null)g.componentDidMount();else{var v=l.elementType===l.type?d.memoizedProps:qn(l.type,d.memoizedProps);g.componentDidUpdate(v,d.memoizedState,g.__reactInternalSnapshotBeforeUpdate)}var S=l.updateQueue;S!==null&&hm(l,S,g);break;case 3:var T=l.updateQueue;if(T!==null){if(d=null,l.child!==null)switch(l.child.tag){case 5:d=l.child.stateNode;break;case 1:d=l.child.stateNode}hm(l,T,d)}break;case 5:var B=l.stateNode;if(d===null&&l.flags&4){d=B;var q=l.memoizedProps;switch(l.type){case"button":case"input":case"select":case"textarea":q.autoFocus&&d.focus();break;case"img":q.src&&(d.src=q.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(l.memoizedState===null){var ce=l.alternate;if(ce!==null){var Se=ce.memoizedState;if(Se!==null){var ke=Se.dehydrated;ke!==null&&Gi(ke)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(r(163))}Mr||l.flags&512&&od(l)}catch(_e){Gt(l,l.return,_e)}}if(l===o){Me=null;break}if(d=l.sibling,d!==null){d.return=l.return,Me=d;break}Me=l.return}}function h1(o){for(;Me!==null;){var l=Me;if(l===o){Me=null;break}var d=l.sibling;if(d!==null){d.return=l.return,Me=d;break}Me=l.return}}function g1(o){for(;Me!==null;){var l=Me;try{switch(l.tag){case 0:case 11:case 15:var d=l.return;try{mu(4,l)}catch(q){Gt(l,d,q)}break;case 1:var g=l.stateNode;if(typeof g.componentDidMount=="function"){var v=l.return;try{g.componentDidMount()}catch(q){Gt(l,v,q)}}var S=l.return;try{od(l)}catch(q){Gt(l,S,q)}break;case 5:var T=l.return;try{od(l)}catch(q){Gt(l,T,q)}}}catch(q){Gt(l,l.return,q)}if(l===o){Me=null;break}var B=l.sibling;if(B!==null){B.return=l.return,Me=B;break}Me=l.return}}var FE=Math.ceil,vu=O.ReactCurrentDispatcher,cd=O.ReactCurrentOwner,Dn=O.ReactCurrentBatchConfig,gt=0,yr=null,or=null,Tr=0,mn=0,Ko=ns(0),dr=0,pl=null,zs=0,xu=0,ud=0,ml=null,sn=null,fd=0,Xo=1/0,Da=null,yu=!1,dd=null,cs=null,wu=!1,us=null,_u=0,vl=0,hd=null,Su=-1,Eu=0;function Jr(){return(gt&6)!==0?Ce():Su!==-1?Su:Su=Ce()}function fs(o){return(o.mode&1)===0?1:(gt&2)!==0&&Tr!==0?Tr&-Tr:mE.transition!==null?(Eu===0&&(Eu=ip()),Eu):(o=_t,o!==0||(o=window.event,o=o===void 0?16:mp(o.type)),o)}function Jn(o,l,d,g){if(50<vl)throw vl=0,hd=null,Error(r(185));Ui(o,d,g),((gt&2)===0||o!==yr)&&(o===yr&&((gt&2)===0&&(xu|=d),dr===4&&ds(o,Tr)),on(o,g),d===1&&gt===0&&(l.mode&1)===0&&(Xo=Ce()+500,Yc&&ss()))}function on(o,l){var d=o.callbackNode;m2(o,l);var g=Dc(o,o===yr?Tr:0);if(g===0)d!==null&&Fe(d),o.callbackNode=null,o.callbackPriority=0;else if(l=g&-g,o.callbackPriority!==l){if(d!=null&&Fe(d),l===1)o.tag===0?pE(m1.bind(null,o)):tm(m1.bind(null,o)),fE(function(){(gt&6)===0&&ss()}),d=null;else{switch(lp(g)){case 1:d=Ct;break;case 4:d=At;break;case 16:d=Jt;break;case 536870912:d=Xa;break;default:d=Jt}d=b1(d,p1.bind(null,o))}o.callbackPriority=l,o.callbackNode=d}}function p1(o,l){if(Su=-1,Eu=0,(gt&6)!==0)throw Error(r(327));var d=o.callbackNode;if(Jo()&&o.callbackNode!==d)return null;var g=Dc(o,o===yr?Tr:0);if(g===0)return null;if((g&30)!==0||(g&o.expiredLanes)!==0||l)l=bu(o,g);else{l=g;var v=gt;gt|=2;var S=x1();(yr!==o||Tr!==l)&&(Da=null,Xo=Ce()+500,Ws(o,l));do try{NE();break}catch(B){v1(o,B)}while(!0);O0(),vu.current=S,gt=v,or!==null?l=0:(yr=null,Tr=0,l=dr)}if(l!==0){if(l===2&&(v=qf(o),v!==0&&(g=v,l=gd(o,v))),l===1)throw d=pl,Ws(o,0),ds(o,g),on(o,Ce()),d;if(l===6)ds(o,g);else{if(v=o.current.alternate,(g&30)===0&&!RE(v)&&(l=bu(o,g),l===2&&(S=qf(o),S!==0&&(g=S,l=gd(o,S))),l===1))throw d=pl,Ws(o,0),ds(o,g),on(o,Ce()),d;switch(o.finishedWork=v,o.finishedLanes=g,l){case 0:case 1:throw Error(r(345));case 2:Hs(o,sn,Da);break;case 3:if(ds(o,g),(g&130023424)===g&&(l=fd+500-Ce(),10<l)){if(Dc(o,0)!==0)break;if(v=o.suspendedLanes,(v&g)!==g){Jr(),o.pingedLanes|=o.suspendedLanes&v;break}o.timeoutHandle=w0(Hs.bind(null,o,sn,Da),l);break}Hs(o,sn,Da);break;case 4:if(ds(o,g),(g&4194240)===g)break;for(l=o.eventTimes,v=-1;0<g;){var T=31-Yt(g);S=1<<T,T=l[T],T>v&&(v=T),g&=~S}if(g=v,g=Ce()-g,g=(120>g?120:480>g?480:1080>g?1080:1920>g?1920:3e3>g?3e3:4320>g?4320:1960*FE(g/1960))-g,10<g){o.timeoutHandle=w0(Hs.bind(null,o,sn,Da),g);break}Hs(o,sn,Da);break;case 5:Hs(o,sn,Da);break;default:throw Error(r(329))}}}return on(o,Ce()),o.callbackNode===d?p1.bind(null,o):null}function gd(o,l){var d=ml;return o.current.memoizedState.isDehydrated&&(Ws(o,l).flags|=256),o=bu(o,l),o!==2&&(l=sn,sn=d,l!==null&&pd(l)),o}function pd(o){sn===null?sn=o:sn.push.apply(sn,o)}function RE(o){for(var l=o;;){if(l.flags&16384){var d=l.updateQueue;if(d!==null&&(d=d.stores,d!==null))for(var g=0;g<d.length;g++){var v=d[g],S=v.getSnapshot;v=v.value;try{if(!Hn(S(),v))return!1}catch{return!1}}}if(d=l.child,l.subtreeFlags&16384&&d!==null)d.return=l,l=d;else{if(l===o)break;for(;l.sibling===null;){if(l.return===null||l.return===o)return!0;l=l.return}l.sibling.return=l.return,l=l.sibling}}return!0}function ds(o,l){for(l&=~ud,l&=~xu,o.suspendedLanes|=l,o.pingedLanes&=~l,o=o.expirationTimes;0<l;){var d=31-Yt(l),g=1<<d;o[d]=-1,l&=~g}}function m1(o){if((gt&6)!==0)throw Error(r(327));Jo();var l=Dc(o,0);if((l&1)===0)return on(o,Ce()),null;var d=bu(o,l);if(o.tag!==0&&d===2){var g=qf(o);g!==0&&(l=g,d=gd(o,g))}if(d===1)throw d=pl,Ws(o,0),ds(o,l),on(o,Ce()),d;if(d===6)throw Error(r(345));return o.finishedWork=o.current.alternate,o.finishedLanes=l,Hs(o,sn,Da),on(o,Ce()),null}function md(o,l){var d=gt;gt|=1;try{return o(l)}finally{gt=d,gt===0&&(Xo=Ce()+500,Yc&&ss())}}function Vs(o){us!==null&&us.tag===0&&(gt&6)===0&&Jo();var l=gt;gt|=1;var d=Dn.transition,g=_t;try{if(Dn.transition=null,_t=1,o)return o()}finally{_t=g,Dn.transition=d,gt=l,(gt&6)===0&&ss()}}function vd(){mn=Ko.current,Dt(Ko)}function Ws(o,l){o.finishedWork=null,o.finishedLanes=0;var d=o.timeoutHandle;if(d!==-1&&(o.timeoutHandle=-1,uE(d)),or!==null)for(d=or.return;d!==null;){var g=d;switch(T0(g),g.tag){case 1:g=g.type.childContextTypes,g!=null&&Xc();break;case 3:Ho(),Dt(rn),Dt(Rr),j0();break;case 5:M0(g);break;case 4:Ho();break;case 13:Dt(Bt);break;case 19:Dt(Bt);break;case 10:D0(g.type._context);break;case 22:case 23:vd()}d=d.return}if(yr=o,or=o=hs(o.current,null),Tr=mn=l,dr=0,pl=null,ud=xu=zs=0,sn=ml=null,js!==null){for(l=0;l<js.length;l++)if(d=js[l],g=d.interleaved,g!==null){d.interleaved=null;var v=g.next,S=d.pending;if(S!==null){var T=S.next;S.next=v,g.next=T}d.pending=g}js=null}return o}function v1(o,l){do{var d=or;try{if(O0(),iu.current=fu,lu){for(var g=jt.memoizedState;g!==null;){var v=g.queue;v!==null&&(v.pending=null),g=g.next}lu=!1}if(Us=0,xr=fr=jt=null,cl=!1,ul=0,cd.current=null,d===null||d.return===null){dr=1,pl=l,or=null;break}e:{var S=o,T=d.return,B=d,q=l;if(l=Tr,B.flags|=32768,q!==null&&typeof q=="object"&&typeof q.then=="function"){var ce=q,Se=B,ke=Se.tag;if((Se.mode&1)===0&&(ke===0||ke===11||ke===15)){var _e=Se.alternate;_e?(Se.updateQueue=_e.updateQueue,Se.memoizedState=_e.memoizedState,Se.lanes=_e.lanes):(Se.updateQueue=null,Se.memoizedState=null)}var Le=zm(T);if(Le!==null){Le.flags&=-257,Vm(Le,T,B,S,l),Le.mode&1&&Um(S,ce,l),l=Le,q=ce;var Be=l.updateQueue;if(Be===null){var je=new Set;je.add(q),l.updateQueue=je}else Be.add(q);break e}else{if((l&1)===0){Um(S,ce,l),xd();break e}q=Error(r(426))}}else if(Mt&&B.mode&1){var Qt=zm(T);if(Qt!==null){(Qt.flags&65536)===0&&(Qt.flags|=256),Vm(Qt,T,B,S,l),P0(Go(q,B));break e}}S=q=Go(q,B),dr!==4&&(dr=2),ml===null?ml=[S]:ml.push(S),S=T;do{switch(S.tag){case 3:S.flags|=65536,l&=-l,S.lanes|=l;var Q=jm(S,q,l);dm(S,Q);break e;case 1:B=q;var Y=S.type,te=S.stateNode;if((S.flags&128)===0&&(typeof Y.getDerivedStateFromError=="function"||te!==null&&typeof te.componentDidCatch=="function"&&(cs===null||!cs.has(te)))){S.flags|=65536,l&=-l,S.lanes|=l;var Pe=$m(S,B,l);dm(S,Pe);break e}}S=S.return}while(S!==null)}w1(d)}catch($e){l=$e,or===d&&d!==null&&(or=d=d.return);continue}break}while(!0)}function x1(){var o=vu.current;return vu.current=fu,o===null?fu:o}function xd(){(dr===0||dr===3||dr===2)&&(dr=4),yr===null||(zs&268435455)===0&&(xu&268435455)===0||ds(yr,Tr)}function bu(o,l){var d=gt;gt|=2;var g=x1();(yr!==o||Tr!==l)&&(Da=null,Ws(o,l));do try{LE();break}catch(v){v1(o,v)}while(!0);if(O0(),gt=d,vu.current=g,or!==null)throw Error(r(261));return yr=null,Tr=0,dr}function LE(){for(;or!==null;)y1(or)}function NE(){for(;or!==null&&!Ne();)y1(or)}function y1(o){var l=E1(o.alternate,o,mn);o.memoizedProps=o.pendingProps,l===null?w1(o):or=l,cd.current=null}function w1(o){var l=o;do{var d=l.alternate;if(o=l.return,(l.flags&32768)===0){if(d=AE(d,l,mn),d!==null){or=d;return}}else{if(d=PE(d,l),d!==null){d.flags&=32767,or=d;return}if(o!==null)o.flags|=32768,o.subtreeFlags=0,o.deletions=null;else{dr=6,or=null;return}}if(l=l.sibling,l!==null){or=l;return}or=l=o}while(l!==null);dr===0&&(dr=5)}function Hs(o,l,d){var g=_t,v=Dn.transition;try{Dn.transition=null,_t=1,ME(o,l,d,g)}finally{Dn.transition=v,_t=g}return null}function ME(o,l,d,g){do Jo();while(us!==null);if((gt&6)!==0)throw Error(r(327));d=o.finishedWork;var v=o.finishedLanes;if(d===null)return null;if(o.finishedWork=null,o.finishedLanes=0,d===o.current)throw Error(r(177));o.callbackNode=null,o.callbackPriority=0;var S=d.lanes|d.childLanes;if(v2(o,S),o===yr&&(or=yr=null,Tr=0),(d.subtreeFlags&2064)===0&&(d.flags&2064)===0||wu||(wu=!0,b1(Jt,function(){return Jo(),null})),S=(d.flags&15990)!==0,(d.subtreeFlags&15990)!==0||S){S=Dn.transition,Dn.transition=null;var T=_t;_t=1;var B=gt;gt|=4,cd.current=null,OE(o,d),u1(d,o),nE(x0),Lc=!!v0,x0=v0=null,o.current=d,DE(d),Ae(),gt=B,_t=T,Dn.transition=S}else o.current=d;if(wu&&(wu=!1,us=o,_u=v),S=o.pendingLanes,S===0&&(cs=null),ji(d.stateNode),on(o,Ce()),l!==null)for(g=o.onRecoverableError,d=0;d<l.length;d++)v=l[d],g(v.value,{componentStack:v.stack,digest:v.digest});if(yu)throw yu=!1,o=dd,dd=null,o;return(_u&1)!==0&&o.tag!==0&&Jo(),S=o.pendingLanes,(S&1)!==0?o===hd?vl++:(vl=0,hd=o):vl=0,ss(),null}function Jo(){if(us!==null){var o=lp(_u),l=Dn.transition,d=_t;try{if(Dn.transition=null,_t=16>o?16:o,us===null)var g=!1;else{if(o=us,us=null,_u=0,(gt&6)!==0)throw Error(r(331));var v=gt;for(gt|=4,Me=o.current;Me!==null;){var S=Me,T=S.child;if((Me.flags&16)!==0){var B=S.deletions;if(B!==null){for(var q=0;q<B.length;q++){var ce=B[q];for(Me=ce;Me!==null;){var Se=Me;switch(Se.tag){case 0:case 11:case 15:gl(8,Se,S)}var ke=Se.child;if(ke!==null)ke.return=Se,Me=ke;else for(;Me!==null;){Se=Me;var _e=Se.sibling,Le=Se.return;if(s1(Se),Se===ce){Me=null;break}if(_e!==null){_e.return=Le,Me=_e;break}Me=Le}}}var Be=S.alternate;if(Be!==null){var je=Be.child;if(je!==null){Be.child=null;do{var Qt=je.sibling;je.sibling=null,je=Qt}while(je!==null)}}Me=S}}if((S.subtreeFlags&2064)!==0&&T!==null)T.return=S,Me=T;else e:for(;Me!==null;){if(S=Me,(S.flags&2048)!==0)switch(S.tag){case 0:case 11:case 15:gl(9,S,S.return)}var Q=S.sibling;if(Q!==null){Q.return=S.return,Me=Q;break e}Me=S.return}}var Y=o.current;for(Me=Y;Me!==null;){T=Me;var te=T.child;if((T.subtreeFlags&2064)!==0&&te!==null)te.return=T,Me=te;else e:for(T=Y;Me!==null;){if(B=Me,(B.flags&2048)!==0)try{switch(B.tag){case 0:case 11:case 15:mu(9,B)}}catch($e){Gt(B,B.return,$e)}if(B===T){Me=null;break e}var Pe=B.sibling;if(Pe!==null){Pe.return=B.return,Me=Pe;break e}Me=B.return}}if(gt=v,ss(),vr&&typeof vr.onPostCommitFiberRoot=="function")try{vr.onPostCommitFiberRoot(ca,o)}catch{}g=!0}return g}finally{_t=d,Dn.transition=l}}return!1}function _1(o,l,d){l=Go(d,l),l=jm(o,l,1),o=is(o,l,1),l=Jr(),o!==null&&(Ui(o,1,l),on(o,l))}function Gt(o,l,d){if(o.tag===3)_1(o,o,d);else for(;l!==null;){if(l.tag===3){_1(l,o,d);break}else if(l.tag===1){var g=l.stateNode;if(typeof l.type.getDerivedStateFromError=="function"||typeof g.componentDidCatch=="function"&&(cs===null||!cs.has(g))){o=Go(d,o),o=$m(l,o,1),l=is(l,o,1),o=Jr(),l!==null&&(Ui(l,1,o),on(l,o));break}}l=l.return}}function BE(o,l,d){var g=o.pingCache;g!==null&&g.delete(l),l=Jr(),o.pingedLanes|=o.suspendedLanes&d,yr===o&&(Tr&d)===d&&(dr===4||dr===3&&(Tr&130023424)===Tr&&500>Ce()-fd?Ws(o,0):ud|=d),on(o,l)}function S1(o,l){l===0&&((o.mode&1)===0?l=1:(l=Oc,Oc<<=1,(Oc&130023424)===0&&(Oc=4194304)));var d=Jr();o=Pa(o,l),o!==null&&(Ui(o,l,d),on(o,d))}function jE(o){var l=o.memoizedState,d=0;l!==null&&(d=l.retryLane),S1(o,d)}function $E(o,l){var d=0;switch(o.tag){case 13:var g=o.stateNode,v=o.memoizedState;v!==null&&(d=v.retryLane);break;case 19:g=o.stateNode;break;default:throw Error(r(314))}g!==null&&g.delete(l),S1(o,d)}var E1;E1=function(o,l,d){if(o!==null)if(o.memoizedProps!==l.pendingProps||rn.current)an=!0;else{if((o.lanes&d)===0&&(l.flags&128)===0)return an=!1,CE(o,l,d);an=(o.flags&131072)!==0}else an=!1,Mt&&(l.flags&1048576)!==0&&rm(l,Zc,l.index);switch(l.lanes=0,l.tag){case 2:var g=l.type;gu(o,l),o=l.pendingProps;var v=Bo(l,Rr.current);Wo(l,d),v=z0(null,l,g,o,v,d);var S=V0();return l.flags|=1,typeof v=="object"&&v!==null&&typeof v.render=="function"&&v.$$typeof===void 0?(l.tag=1,l.memoizedState=null,l.updateQueue=null,nn(g)?(S=!0,Jc(l)):S=!1,l.memoizedState=v.state!==null&&v.state!==void 0?v.state:null,L0(l),v.updater=du,l.stateNode=v,v._reactInternals=l,X0(l,g,o,d),l=Z0(null,l,g,!0,S,d)):(l.tag=0,Mt&&S&&k0(l),Xr(null,l,v,d),l=l.child),l;case 16:g=l.elementType;e:{switch(gu(o,l),o=l.pendingProps,v=g._init,g=v(g._payload),l.type=g,v=l.tag=zE(g),o=qn(g,o),v){case 0:l=Q0(null,l,g,o,d);break e;case 1:l=Xm(null,l,g,o,d);break e;case 11:l=Wm(null,l,g,o,d);break e;case 14:l=Hm(null,l,g,qn(g.type,o),d);break e}throw Error(r(306,g,""))}return l;case 0:return g=l.type,v=l.pendingProps,v=l.elementType===g?v:qn(g,v),Q0(o,l,g,v,d);case 1:return g=l.type,v=l.pendingProps,v=l.elementType===g?v:qn(g,v),Xm(o,l,g,v,d);case 3:e:{if(Jm(l),o===null)throw Error(r(387));g=l.pendingProps,S=l.memoizedState,v=S.element,fm(o,l),su(l,g,null,d);var T=l.memoizedState;if(g=T.element,S.isDehydrated)if(S={element:g,isDehydrated:!1,cache:T.cache,pendingSuspenseBoundaries:T.pendingSuspenseBoundaries,transitions:T.transitions},l.updateQueue.baseState=S,l.memoizedState=S,l.flags&256){v=Go(Error(r(423)),l),l=Ym(o,l,g,d,v);break e}else if(g!==v){v=Go(Error(r(424)),l),l=Ym(o,l,g,d,v);break e}else for(pn=rs(l.stateNode.containerInfo.firstChild),gn=l,Mt=!0,Gn=null,d=cm(l,null,g,d),l.child=d;d;)d.flags=d.flags&-3|4096,d=d.sibling;else{if(Uo(),g===v){l=Oa(o,l,d);break e}Xr(o,l,g,d)}l=l.child}return l;case 5:return gm(l),o===null&&A0(l),g=l.type,v=l.pendingProps,S=o!==null?o.memoizedProps:null,T=v.children,y0(g,v)?T=null:S!==null&&y0(g,S)&&(l.flags|=32),Km(o,l),Xr(o,l,T,d),l.child;case 6:return o===null&&A0(l),null;case 13:return Qm(o,l,d);case 4:return N0(l,l.stateNode.containerInfo),g=l.pendingProps,o===null?l.child=zo(l,null,g,d):Xr(o,l,g,d),l.child;case 11:return g=l.type,v=l.pendingProps,v=l.elementType===g?v:qn(g,v),Wm(o,l,g,v,d);case 7:return Xr(o,l,l.pendingProps,d),l.child;case 8:return Xr(o,l,l.pendingProps.children,d),l.child;case 12:return Xr(o,l,l.pendingProps.children,d),l.child;case 10:e:{if(g=l.type._context,v=l.pendingProps,S=l.memoizedProps,T=v.value,Pt(ru,g._currentValue),g._currentValue=T,S!==null)if(Hn(S.value,T)){if(S.children===v.children&&!rn.current){l=Oa(o,l,d);break e}}else for(S=l.child,S!==null&&(S.return=l);S!==null;){var B=S.dependencies;if(B!==null){T=S.child;for(var q=B.firstContext;q!==null;){if(q.context===g){if(S.tag===1){q=Ia(-1,d&-d),q.tag=2;var ce=S.updateQueue;if(ce!==null){ce=ce.shared;var Se=ce.pending;Se===null?q.next=q:(q.next=Se.next,Se.next=q),ce.pending=q}}S.lanes|=d,q=S.alternate,q!==null&&(q.lanes|=d),F0(S.return,d,l),B.lanes|=d;break}q=q.next}}else if(S.tag===10)T=S.type===l.type?null:S.child;else if(S.tag===18){if(T=S.return,T===null)throw Error(r(341));T.lanes|=d,B=T.alternate,B!==null&&(B.lanes|=d),F0(T,d,l),T=S.sibling}else T=S.child;if(T!==null)T.return=S;else for(T=S;T!==null;){if(T===l){T=null;break}if(S=T.sibling,S!==null){S.return=T.return,T=S;break}T=T.return}S=T}Xr(o,l,v.children,d),l=l.child}return l;case 9:return v=l.type,g=l.pendingProps.children,Wo(l,d),v=In(v),g=g(v),l.flags|=1,Xr(o,l,g,d),l.child;case 14:return g=l.type,v=qn(g,l.pendingProps),v=qn(g.type,v),Hm(o,l,g,v,d);case 15:return Gm(o,l,l.type,l.pendingProps,d);case 17:return g=l.type,v=l.pendingProps,v=l.elementType===g?v:qn(g,v),gu(o,l),l.tag=1,nn(g)?(o=!0,Jc(l)):o=!1,Wo(l,d),Mm(l,g,v),X0(l,g,v,d),Z0(null,l,g,!0,o,d);case 19:return e1(o,l,d);case 22:return qm(o,l,d)}throw Error(r(156,l.tag))};function b1(o,l){return be(o,l)}function UE(o,l,d,g){this.tag=o,this.key=d,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=l,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=g,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Fn(o,l,d,g){return new UE(o,l,d,g)}function yd(o){return o=o.prototype,!(!o||!o.isReactComponent)}function zE(o){if(typeof o=="function")return yd(o)?1:0;if(o!=null){if(o=o.$$typeof,o===X)return 11;if(o===Ee)return 14}return 2}function hs(o,l){var d=o.alternate;return d===null?(d=Fn(o.tag,l,o.key,o.mode),d.elementType=o.elementType,d.type=o.type,d.stateNode=o.stateNode,d.alternate=o,o.alternate=d):(d.pendingProps=l,d.type=o.type,d.flags=0,d.subtreeFlags=0,d.deletions=null),d.flags=o.flags&14680064,d.childLanes=o.childLanes,d.lanes=o.lanes,d.child=o.child,d.memoizedProps=o.memoizedProps,d.memoizedState=o.memoizedState,d.updateQueue=o.updateQueue,l=o.dependencies,d.dependencies=l===null?null:{lanes:l.lanes,firstContext:l.firstContext},d.sibling=o.sibling,d.index=o.index,d.ref=o.ref,d}function ku(o,l,d,g,v,S){var T=2;if(g=o,typeof o=="function")yd(o)&&(T=1);else if(typeof o=="string")T=5;else e:switch(o){case P:return Gs(d.children,v,S,l);case J:T=8,v|=8;break;case V:return o=Fn(12,d,l,v|2),o.elementType=V,o.lanes=S,o;case he:return o=Fn(13,d,l,v),o.elementType=he,o.lanes=S,o;case Ie:return o=Fn(19,d,l,v),o.elementType=Ie,o.lanes=S,o;case oe:return Tu(d,v,S,l);default:if(typeof o=="object"&&o!==null)switch(o.$$typeof){case le:T=10;break e;case ee:T=9;break e;case X:T=11;break e;case Ee:T=14;break e;case Te:T=16,g=null;break e}throw Error(r(130,o==null?o:typeof o,""))}return l=Fn(T,d,l,v),l.elementType=o,l.type=g,l.lanes=S,l}function Gs(o,l,d,g){return o=Fn(7,o,g,l),o.lanes=d,o}function Tu(o,l,d,g){return o=Fn(22,o,g,l),o.elementType=oe,o.lanes=d,o.stateNode={isHidden:!1},o}function wd(o,l,d){return o=Fn(6,o,null,l),o.lanes=d,o}function _d(o,l,d){return l=Fn(4,o.children!==null?o.children:[],o.key,l),l.lanes=d,l.stateNode={containerInfo:o.containerInfo,pendingChildren:null,implementation:o.implementation},l}function VE(o,l,d,g,v){this.tag=l,this.containerInfo=o,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Kf(0),this.expirationTimes=Kf(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Kf(0),this.identifierPrefix=g,this.onRecoverableError=v,this.mutableSourceEagerHydrationData=null}function Sd(o,l,d,g,v,S,T,B,q){return o=new VE(o,l,d,B,q),l===1?(l=1,S===!0&&(l|=8)):l=0,S=Fn(3,null,null,l),o.current=S,S.stateNode=o,S.memoizedState={element:g,isDehydrated:d,cache:null,transitions:null,pendingSuspenseBoundaries:null},L0(S),o}function WE(o,l,d){var g=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:L,key:g==null?null:""+g,children:o,containerInfo:l,implementation:d}}function k1(o){if(!o)return as;o=o._reactInternals;e:{if(M(o)!==o||o.tag!==1)throw Error(r(170));var l=o;do{switch(l.tag){case 3:l=l.stateNode.context;break e;case 1:if(nn(l.type)){l=l.stateNode.__reactInternalMemoizedMergedChildContext;break e}}l=l.return}while(l!==null);throw Error(r(171))}if(o.tag===1){var d=o.type;if(nn(d))return Zp(o,d,l)}return l}function T1(o,l,d,g,v,S,T,B,q){return o=Sd(d,g,!0,o,v,S,T,B,q),o.context=k1(null),d=o.current,g=Jr(),v=fs(d),S=Ia(g,v),S.callback=l??null,is(d,S,v),o.current.lanes=v,Ui(o,v,g),on(o,g),o}function Cu(o,l,d,g){var v=l.current,S=Jr(),T=fs(v);return d=k1(d),l.context===null?l.context=d:l.pendingContext=d,l=Ia(S,T),l.payload={element:o},g=g===void 0?null:g,g!==null&&(l.callback=g),o=is(v,l,T),o!==null&&(Jn(o,v,T,S),au(o,v,T)),T}function Au(o){if(o=o.current,!o.child)return null;switch(o.child.tag){case 5:return o.child.stateNode;default:return o.child.stateNode}}function C1(o,l){if(o=o.memoizedState,o!==null&&o.dehydrated!==null){var d=o.retryLane;o.retryLane=d!==0&&d<l?d:l}}function Ed(o,l){C1(o,l),(o=o.alternate)&&C1(o,l)}function HE(){return null}var A1=typeof reportError=="function"?reportError:function(o){console.error(o)};function bd(o){this._internalRoot=o}Pu.prototype.render=bd.prototype.render=function(o){var l=this._internalRoot;if(l===null)throw Error(r(409));Cu(o,l,null,null)},Pu.prototype.unmount=bd.prototype.unmount=function(){var o=this._internalRoot;if(o!==null){this._internalRoot=null;var l=o.containerInfo;Vs(function(){Cu(null,o,null,null)}),l[ka]=null}};function Pu(o){this._internalRoot=o}Pu.prototype.unstable_scheduleHydration=function(o){if(o){var l=fp();o={blockedOn:null,target:o,priority:l};for(var d=0;d<Za.length&&l!==0&&l<Za[d].priority;d++);Za.splice(d,0,o),d===0&&gp(o)}};function kd(o){return!(!o||o.nodeType!==1&&o.nodeType!==9&&o.nodeType!==11)}function Iu(o){return!(!o||o.nodeType!==1&&o.nodeType!==9&&o.nodeType!==11&&(o.nodeType!==8||o.nodeValue!==" react-mount-point-unstable "))}function P1(){}function GE(o,l,d,g,v){if(v){if(typeof g=="function"){var S=g;g=function(){var ce=Au(T);S.call(ce)}}var T=T1(l,g,o,0,null,!1,!1,"",P1);return o._reactRootContainer=T,o[ka]=T.current,tl(o.nodeType===8?o.parentNode:o),Vs(),T}for(;v=o.lastChild;)o.removeChild(v);if(typeof g=="function"){var B=g;g=function(){var ce=Au(q);B.call(ce)}}var q=Sd(o,0,!1,null,null,!1,!1,"",P1);return o._reactRootContainer=q,o[ka]=q.current,tl(o.nodeType===8?o.parentNode:o),Vs(function(){Cu(l,q,d,g)}),q}function Ou(o,l,d,g,v){var S=d._reactRootContainer;if(S){var T=S;if(typeof v=="function"){var B=v;v=function(){var q=Au(T);B.call(q)}}Cu(l,T,o,v)}else T=GE(d,l,o,v,g);return Au(T)}cp=function(o){switch(o.tag){case 3:var l=o.stateNode;if(l.current.memoizedState.isDehydrated){var d=$i(l.pendingLanes);d!==0&&(Xf(l,d|1),on(l,Ce()),(gt&6)===0&&(Xo=Ce()+500,ss()))}break;case 13:Vs(function(){var g=Pa(o,1);if(g!==null){var v=Jr();Jn(g,o,1,v)}}),Ed(o,1)}},Jf=function(o){if(o.tag===13){var l=Pa(o,134217728);if(l!==null){var d=Jr();Jn(l,o,134217728,d)}Ed(o,134217728)}},up=function(o){if(o.tag===13){var l=fs(o),d=Pa(o,l);if(d!==null){var g=Jr();Jn(d,o,l,g)}Ed(o,l)}},fp=function(){return _t},dp=function(o,l){var d=_t;try{return _t=o,l()}finally{_t=d}},Co=function(o,l,d){switch(l){case"input":if(Re(o,d),l=d.name,d.type==="radio"&&l!=null){for(d=o;d.parentNode;)d=d.parentNode;for(d=d.querySelectorAll("input[name="+JSON.stringify(""+l)+'][type="radio"]'),l=0;l<d.length;l++){var g=d[l];if(g!==o&&g.form===o.form){var v=Kc(g);if(!v)throw Error(r(90));j(g),Re(g,v)}}}break;case"textarea":Fr(o,d);break;case"select":l=d.value,l!=null&&Dr(o,!!d.multiple,l,!1)}},Cc=md,Ac=Vs;var qE={usingClientEntryPoint:!1,Events:[al,No,Kc,kc,Tc,md]},xl={findFiberByHostInstance:Ls,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},KE={bundleType:xl.bundleType,version:xl.version,rendererPackageName:xl.rendererPackageName,rendererConfig:xl.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:O.ReactCurrentDispatcher,findHostInstanceByFiber:function(o){return o=se(o),o===null?null:o.stateNode},findFiberByHostInstance:xl.findFiberByHostInstance||HE,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Du=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Du.isDisabled&&Du.supportsFiber)try{ca=Du.inject(KE),vr=Du}catch{}}return ln.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=qE,ln.createPortal=function(o,l){var d=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!kd(l))throw Error(r(200));return WE(o,l,null,d)},ln.createRoot=function(o,l){if(!kd(o))throw Error(r(299));var d=!1,g="",v=A1;return l!=null&&(l.unstable_strictMode===!0&&(d=!0),l.identifierPrefix!==void 0&&(g=l.identifierPrefix),l.onRecoverableError!==void 0&&(v=l.onRecoverableError)),l=Sd(o,1,!1,null,null,d,!1,g,v),o[ka]=l.current,tl(o.nodeType===8?o.parentNode:o),new bd(l)},ln.findDOMNode=function(o){if(o==null)return null;if(o.nodeType===1)return o;var l=o._reactInternals;if(l===void 0)throw typeof o.render=="function"?Error(r(188)):(o=Object.keys(o).join(","),Error(r(268,o)));return o=se(l),o=o===null?null:o.stateNode,o},ln.flushSync=function(o){return Vs(o)},ln.hydrate=function(o,l,d){if(!Iu(l))throw Error(r(200));return Ou(null,o,l,!0,d)},ln.hydrateRoot=function(o,l,d){if(!kd(o))throw Error(r(405));var g=d!=null&&d.hydratedSources||null,v=!1,S="",T=A1;if(d!=null&&(d.unstable_strictMode===!0&&(v=!0),d.identifierPrefix!==void 0&&(S=d.identifierPrefix),d.onRecoverableError!==void 0&&(T=d.onRecoverableError)),l=T1(l,null,o,1,d??null,v,!1,S,T),o[ka]=l.current,tl(o),g)for(o=0;o<g.length;o++)d=g[o],v=d._getVersion,v=v(d._source),l.mutableSourceEagerHydrationData==null?l.mutableSourceEagerHydrationData=[d,v]:l.mutableSourceEagerHydrationData.push(d,v);return new Pu(l)},ln.render=function(o,l,d){if(!Iu(l))throw Error(r(200));return Ou(null,o,l,!1,d)},ln.unmountComponentAtNode=function(o){if(!Iu(o))throw Error(r(40));return o._reactRootContainer?(Vs(function(){Ou(null,null,o,!1,function(){o._reactRootContainer=null,o[ka]=null})}),!0):!1},ln.unstable_batchedUpdates=md,ln.unstable_renderSubtreeIntoContainer=function(o,l,d,g){if(!Iu(d))throw Error(r(200));if(o==null||o._reactInternals===void 0)throw Error(r(38));return Ou(o,l,d,!1,g)},ln.version="18.3.1-next-f1338f8080-20240426",ln}var B1;function Jx(){if(B1)return Ad.exports;B1=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}return e(),Ad.exports=ab(),Ad.exports}var j1;function sb(){if(j1)return Fu;j1=1;var e=Jx();return Fu.createRoot=e.createRoot,Fu.hydrateRoot=e.hydrateRoot,Fu}var ob=sb();Jx();/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function $l(){return $l=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},$l.apply(this,arguments)}var xs;(function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"})(xs||(xs={}));const $1="popstate";function ib(e){e===void 0&&(e={});function t(n,a){let{pathname:s,search:i,hash:c}=n.location;return uh("",{pathname:s,search:i,hash:c},a.state&&a.state.usr||null,a.state&&a.state.key||"default")}function r(n,a){return typeof a=="string"?a:sf(a)}return cb(t,r,null,e)}function Wt(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function Yx(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function lb(){return Math.random().toString(36).substr(2,8)}function U1(e,t){return{usr:e.state,key:e.key,idx:t}}function uh(e,t,r,n){return r===void 0&&(r=null),$l({pathname:typeof e=="string"?e:e.pathname,search:"",hash:""},typeof t=="string"?bi(t):t,{state:r,key:t&&t.key||n||lb()})}function sf(e){let{pathname:t="/",search:r="",hash:n=""}=e;return r&&r!=="?"&&(t+=r.charAt(0)==="?"?r:"?"+r),n&&n!=="#"&&(t+=n.charAt(0)==="#"?n:"#"+n),t}function bi(e){let t={};if(e){let r=e.indexOf("#");r>=0&&(t.hash=e.substr(r),e=e.substr(0,r));let n=e.indexOf("?");n>=0&&(t.search=e.substr(n),e=e.substr(0,n)),e&&(t.pathname=e)}return t}function cb(e,t,r,n){n===void 0&&(n={});let{window:a=document.defaultView,v5Compat:s=!1}=n,i=a.history,c=xs.Pop,u=null,f=h();f==null&&(f=0,i.replaceState($l({},i.state,{idx:f}),""));function h(){return(i.state||{idx:null}).idx}function p(){c=xs.Pop;let _=h(),E=_==null?null:_-f;f=_,u&&u({action:c,location:x.location,delta:E})}function m(_,E){c=xs.Push;let k=uh(x.location,_,E);f=h()+1;let b=U1(k,f),O=x.createHref(k);try{i.pushState(b,"",O)}catch(z){if(z instanceof DOMException&&z.name==="DataCloneError")throw z;a.location.assign(O)}s&&u&&u({action:c,location:x.location,delta:1})}function y(_,E){c=xs.Replace;let k=uh(x.location,_,E);f=h();let b=U1(k,f),O=x.createHref(k);i.replaceState(b,"",O),s&&u&&u({action:c,location:x.location,delta:0})}function w(_){let E=a.location.origin!=="null"?a.location.origin:a.location.href,k=typeof _=="string"?_:sf(_);return k=k.replace(/ $/,"%20"),Wt(E,"No window.location.(origin|href) available to create URL for href: "+k),new URL(k,E)}let x={get action(){return c},get location(){return e(a,i)},listen(_){if(u)throw new Error("A history only accepts one active listener");return a.addEventListener($1,p),u=_,()=>{a.removeEventListener($1,p),u=null}},createHref(_){return t(a,_)},createURL:w,encodeLocation(_){let E=w(_);return{pathname:E.pathname,search:E.search,hash:E.hash}},push:m,replace:y,go(_){return i.go(_)}};return x}var z1;(function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"})(z1||(z1={}));function ub(e,t,r){return r===void 0&&(r="/"),fb(e,t,r)}function fb(e,t,r,n){let a=typeof t=="string"?bi(t):t,s=vi(a.pathname||"/",r);if(s==null)return null;let i=Qx(e);db(i);let c=null;for(let u=0;c==null&&u<i.length;++u){let f=Eb(s);c=_b(i[u],f)}return c}function Qx(e,t,r,n){t===void 0&&(t=[]),r===void 0&&(r=[]),n===void 0&&(n="");let a=(s,i,c)=>{let u={relativePath:c===void 0?s.path||"":c,caseSensitive:s.caseSensitive===!0,childrenIndex:i,route:s};u.relativePath.startsWith("/")&&(Wt(u.relativePath.startsWith(n),'Absolute route path "'+u.relativePath+'" nested under path '+('"'+n+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),u.relativePath=u.relativePath.slice(n.length));let f=_s([n,u.relativePath]),h=r.concat(u);s.children&&s.children.length>0&&(Wt(s.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+f+'".')),Qx(s.children,t,h,f)),!(s.path==null&&!s.index)&&t.push({path:f,score:yb(f,s.index),routesMeta:h})};return e.forEach((s,i)=>{var c;if(s.path===""||!((c=s.path)!=null&&c.includes("?")))a(s,i);else for(let u of Zx(s.path))a(s,i,u)}),t}function Zx(e){let t=e.split("/");if(t.length===0)return[];let[r,...n]=t,a=r.endsWith("?"),s=r.replace(/\?$/,"");if(n.length===0)return a?[s,""]:[s];let i=Zx(n.join("/")),c=[];return c.push(...i.map(u=>u===""?s:[s,u].join("/"))),a&&c.push(...i),c.map(u=>e.startsWith("/")&&u===""?"/":u)}function db(e){e.sort((t,r)=>t.score!==r.score?r.score-t.score:wb(t.routesMeta.map(n=>n.childrenIndex),r.routesMeta.map(n=>n.childrenIndex)))}const hb=/^:[\w-]+$/,gb=3,pb=2,mb=1,vb=10,xb=-2,V1=e=>e==="*";function yb(e,t){let r=e.split("/"),n=r.length;return r.some(V1)&&(n+=xb),t&&(n+=pb),r.filter(a=>!V1(a)).reduce((a,s)=>a+(hb.test(s)?gb:s===""?mb:vb),n)}function wb(e,t){return e.length===t.length&&e.slice(0,-1).every((n,a)=>n===t[a])?e[e.length-1]-t[t.length-1]:0}function _b(e,t,r){let{routesMeta:n}=e,a={},s="/",i=[];for(let c=0;c<n.length;++c){let u=n[c],f=c===n.length-1,h=s==="/"?t:t.slice(s.length)||"/",p=fh({path:u.relativePath,caseSensitive:u.caseSensitive,end:f},h),m=u.route;if(!p)return null;Object.assign(a,p.params),i.push({params:a,pathname:_s([s,p.pathname]),pathnameBase:Cb(_s([s,p.pathnameBase])),route:m}),p.pathnameBase!=="/"&&(s=_s([s,p.pathnameBase]))}return i}function fh(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[r,n]=Sb(e.path,e.caseSensitive,e.end),a=t.match(r);if(!a)return null;let s=a[0],i=s.replace(/(.)\/+$/,"$1"),c=a.slice(1);return{params:n.reduce((f,h,p)=>{let{paramName:m,isOptional:y}=h;if(m==="*"){let x=c[p]||"";i=s.slice(0,s.length-x.length).replace(/(.)\/+$/,"$1")}const w=c[p];return y&&!w?f[m]=void 0:f[m]=(w||"").replace(/%2F/g,"/"),f},{}),pathname:s,pathnameBase:i,pattern:e}}function Sb(e,t,r){t===void 0&&(t=!1),r===void 0&&(r=!0),Yx(e==="*"||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were '+('"'+e.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+e.replace(/\*$/,"/*")+'".'));let n=[],a="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(i,c,u)=>(n.push({paramName:c,isOptional:u!=null}),u?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(n.push({paramName:"*"}),a+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?a+="\\/*$":e!==""&&e!=="/"&&(a+="(?:(?=\\/|$))"),[new RegExp(a,t?void 0:"i"),n]}function Eb(e){try{return e.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return Yx(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+t+").")),e}}function vi(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let r=t.endsWith("/")?t.length-1:t.length,n=e.charAt(r);return n&&n!=="/"?null:e.slice(r)||"/"}function bb(e,t){t===void 0&&(t="/");let{pathname:r,search:n="",hash:a=""}=typeof e=="string"?bi(e):e;return{pathname:r?r.startsWith("/")?r:kb(r,t):t,search:Ab(n),hash:Pb(a)}}function kb(e,t){let r=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(a=>{a===".."?r.length>1&&r.pop():a!=="."&&r.push(a)}),r.length>1?r.join("/"):"/"}function Od(e,t,r,n){return"Cannot include a '"+e+"' character in a manually specified "+("`to."+t+"` field ["+JSON.stringify(n)+"].  Please separate it out to the ")+("`to."+r+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function Tb(e){return e.filter((t,r)=>r===0||t.route.path&&t.route.path.length>0)}function Zh(e,t){let r=Tb(e);return t?r.map((n,a)=>a===r.length-1?n.pathname:n.pathnameBase):r.map(n=>n.pathnameBase)}function eg(e,t,r,n){n===void 0&&(n=!1);let a;typeof e=="string"?a=bi(e):(a=$l({},e),Wt(!a.pathname||!a.pathname.includes("?"),Od("?","pathname","search",a)),Wt(!a.pathname||!a.pathname.includes("#"),Od("#","pathname","hash",a)),Wt(!a.search||!a.search.includes("#"),Od("#","search","hash",a)));let s=e===""||a.pathname==="",i=s?"/":a.pathname,c;if(i==null)c=r;else{let p=t.length-1;if(!n&&i.startsWith("..")){let m=i.split("/");for(;m[0]==="..";)m.shift(),p-=1;a.pathname=m.join("/")}c=p>=0?t[p]:"/"}let u=bb(a,c),f=i&&i!=="/"&&i.endsWith("/"),h=(s||i===".")&&r.endsWith("/");return!u.pathname.endsWith("/")&&(f||h)&&(u.pathname+="/"),u}const _s=e=>e.join("/").replace(/\/\/+/g,"/"),Cb=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),Ab=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,Pb=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function Ib(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}const ey=["post","put","patch","delete"];new Set(ey);const Ob=["get",...ey];new Set(Ob);/**
 * React Router v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Ul(){return Ul=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Ul.apply(this,arguments)}const Cf=ue.createContext(null),ty=ue.createContext(null),Ua=ue.createContext(null),Af=ue.createContext(null),ya=ue.createContext({outlet:null,matches:[],isDataRoute:!1}),ry=ue.createContext(null);function Db(e,t){let{relative:r}=t===void 0?{}:t;ki()||Wt(!1);let{basename:n,navigator:a}=ue.useContext(Ua),{hash:s,pathname:i,search:c}=Pf(e,{relative:r}),u=i;return n!=="/"&&(u=i==="/"?n:_s([n,i])),a.createHref({pathname:u,search:c,hash:s})}function ki(){return ue.useContext(Af)!=null}function Ts(){return ki()||Wt(!1),ue.useContext(Af).location}function ny(e){ue.useContext(Ua).static||ue.useLayoutEffect(e)}function uc(){let{isDataRoute:e}=ue.useContext(ya);return e?qb():Fb()}function Fb(){ki()||Wt(!1);let e=ue.useContext(Cf),{basename:t,future:r,navigator:n}=ue.useContext(Ua),{matches:a}=ue.useContext(ya),{pathname:s}=Ts(),i=JSON.stringify(Zh(a,r.v7_relativeSplatPath)),c=ue.useRef(!1);return ny(()=>{c.current=!0}),ue.useCallback(function(f,h){if(h===void 0&&(h={}),!c.current)return;if(typeof f=="number"){n.go(f);return}let p=eg(f,JSON.parse(i),s,h.relative==="path");e==null&&t!=="/"&&(p.pathname=p.pathname==="/"?t:_s([t,p.pathname])),(h.replace?n.replace:n.push)(p,h.state,h)},[t,n,i,s,e])}const Rb=ue.createContext(null);function Lb(e){let t=ue.useContext(ya).outlet;return t&&ue.createElement(Rb.Provider,{value:e},t)}function qM(){let{matches:e}=ue.useContext(ya),t=e[e.length-1];return t?t.params:{}}function Pf(e,t){let{relative:r}=t===void 0?{}:t,{future:n}=ue.useContext(Ua),{matches:a}=ue.useContext(ya),{pathname:s}=Ts(),i=JSON.stringify(Zh(a,n.v7_relativeSplatPath));return ue.useMemo(()=>eg(e,JSON.parse(i),s,r==="path"),[e,i,s,r])}function Nb(e,t){return Mb(e,t)}function Mb(e,t,r,n){ki()||Wt(!1);let{navigator:a}=ue.useContext(Ua),{matches:s}=ue.useContext(ya),i=s[s.length-1],c=i?i.params:{};i&&i.pathname;let u=i?i.pathnameBase:"/";i&&i.route;let f=Ts(),h;if(t){var p;let _=typeof t=="string"?bi(t):t;u==="/"||(p=_.pathname)!=null&&p.startsWith(u)||Wt(!1),h=_}else h=f;let m=h.pathname||"/",y=m;if(u!=="/"){let _=u.replace(/^\//,"").split("/");y="/"+m.replace(/^\//,"").split("/").slice(_.length).join("/")}let w=ub(e,{pathname:y}),x=zb(w&&w.map(_=>Object.assign({},_,{params:Object.assign({},c,_.params),pathname:_s([u,a.encodeLocation?a.encodeLocation(_.pathname).pathname:_.pathname]),pathnameBase:_.pathnameBase==="/"?u:_s([u,a.encodeLocation?a.encodeLocation(_.pathnameBase).pathname:_.pathnameBase])})),s,r,n);return t&&x?ue.createElement(Af.Provider,{value:{location:Ul({pathname:"/",search:"",hash:"",state:null,key:"default"},h),navigationType:xs.Pop}},x):x}function Bb(){let e=Gb(),t=Ib(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),r=e instanceof Error?e.stack:null,a={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return ue.createElement(ue.Fragment,null,ue.createElement("h2",null,"Unexpected Application Error!"),ue.createElement("h3",{style:{fontStyle:"italic"}},t),r?ue.createElement("pre",{style:a},r):null,null)}const jb=ue.createElement(Bb,null);class $b extends ue.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,r){return r.location!==t.location||r.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:r.error,location:r.location,revalidation:t.revalidation||r.revalidation}}componentDidCatch(t,r){console.error("React Router caught the following error during render",t,r)}render(){return this.state.error!==void 0?ue.createElement(ya.Provider,{value:this.props.routeContext},ue.createElement(ry.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function Ub(e){let{routeContext:t,match:r,children:n}=e,a=ue.useContext(Cf);return a&&a.static&&a.staticContext&&(r.route.errorElement||r.route.ErrorBoundary)&&(a.staticContext._deepestRenderedBoundaryId=r.route.id),ue.createElement(ya.Provider,{value:t},n)}function zb(e,t,r,n){var a;if(t===void 0&&(t=[]),r===void 0&&(r=null),n===void 0&&(n=null),e==null){var s;if(!r)return null;if(r.errors)e=r.matches;else if((s=n)!=null&&s.v7_partialHydration&&t.length===0&&!r.initialized&&r.matches.length>0)e=r.matches;else return null}let i=e,c=(a=r)==null?void 0:a.errors;if(c!=null){let h=i.findIndex(p=>p.route.id&&c?.[p.route.id]!==void 0);h>=0||Wt(!1),i=i.slice(0,Math.min(i.length,h+1))}let u=!1,f=-1;if(r&&n&&n.v7_partialHydration)for(let h=0;h<i.length;h++){let p=i[h];if((p.route.HydrateFallback||p.route.hydrateFallbackElement)&&(f=h),p.route.id){let{loaderData:m,errors:y}=r,w=p.route.loader&&m[p.route.id]===void 0&&(!y||y[p.route.id]===void 0);if(p.route.lazy||w){u=!0,f>=0?i=i.slice(0,f+1):i=[i[0]];break}}}return i.reduceRight((h,p,m)=>{let y,w=!1,x=null,_=null;r&&(y=c&&p.route.id?c[p.route.id]:void 0,x=p.route.errorElement||jb,u&&(f<0&&m===0?(Kb("route-fallback"),w=!0,_=null):f===m&&(w=!0,_=p.route.hydrateFallbackElement||null)));let E=t.concat(i.slice(0,m+1)),k=()=>{let b;return y?b=x:w?b=_:p.route.Component?b=ue.createElement(p.route.Component,null):p.route.element?b=p.route.element:b=h,ue.createElement(Ub,{match:p,routeContext:{outlet:h,matches:E,isDataRoute:r!=null},children:b})};return r&&(p.route.ErrorBoundary||p.route.errorElement||m===0)?ue.createElement($b,{location:r.location,revalidation:r.revalidation,component:x,error:y,children:k(),routeContext:{outlet:null,matches:E,isDataRoute:!0}}):k()},null)}var ay=(function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e})(ay||{}),sy=(function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e})(sy||{});function Vb(e){let t=ue.useContext(Cf);return t||Wt(!1),t}function Wb(e){let t=ue.useContext(ty);return t||Wt(!1),t}function Hb(e){let t=ue.useContext(ya);return t||Wt(!1),t}function oy(e){let t=Hb(),r=t.matches[t.matches.length-1];return r.route.id||Wt(!1),r.route.id}function Gb(){var e;let t=ue.useContext(ry),r=Wb(),n=oy();return t!==void 0?t:(e=r.errors)==null?void 0:e[n]}function qb(){let{router:e}=Vb(ay.UseNavigateStable),t=oy(sy.UseNavigateStable),r=ue.useRef(!1);return ny(()=>{r.current=!0}),ue.useCallback(function(a,s){s===void 0&&(s={}),r.current&&(typeof a=="number"?e.navigate(a):e.navigate(a,Ul({fromRouteId:t},s)))},[e,t])}const W1={};function Kb(e,t,r){W1[e]||(W1[e]=!0)}function Xb(e,t){e?.v7_startTransition,e?.v7_relativeSplatPath}function KM(e){let{to:t,replace:r,state:n,relative:a}=e;ki()||Wt(!1);let{future:s,static:i}=ue.useContext(Ua),{matches:c}=ue.useContext(ya),{pathname:u}=Ts(),f=uc(),h=eg(t,Zh(c,s.v7_relativeSplatPath),u,a==="path"),p=JSON.stringify(h);return ue.useEffect(()=>f(JSON.parse(p),{replace:r,state:n,relative:a}),[f,p,a,r,n]),null}function Jb(e){return Lb(e.context)}function Qe(e){Wt(!1)}function Yb(e){let{basename:t="/",children:r=null,location:n,navigationType:a=xs.Pop,navigator:s,static:i=!1,future:c}=e;ki()&&Wt(!1);let u=t.replace(/^\/*/,"/"),f=ue.useMemo(()=>({basename:u,navigator:s,static:i,future:Ul({v7_relativeSplatPath:!1},c)}),[u,c,s,i]);typeof n=="string"&&(n=bi(n));let{pathname:h="/",search:p="",hash:m="",state:y=null,key:w="default"}=n,x=ue.useMemo(()=>{let _=vi(h,u);return _==null?null:{location:{pathname:_,search:p,hash:m,state:y,key:w},navigationType:a}},[u,h,p,m,y,w,a]);return x==null?null:ue.createElement(Ua.Provider,{value:f},ue.createElement(Af.Provider,{children:r,value:x}))}function Qb(e){let{children:t,location:r}=e;return Nb(dh(t),r)}new Promise(()=>{});function dh(e,t){t===void 0&&(t=[]);let r=[];return ue.Children.forEach(e,(n,a)=>{if(!ue.isValidElement(n))return;let s=[...t,a];if(n.type===ue.Fragment){r.push.apply(r,dh(n.props.children,s));return}n.type!==Qe&&Wt(!1),!n.props.index||!n.props.children||Wt(!1);let i={id:n.props.id||s.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,loader:n.props.loader,action:n.props.action,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(i.children=dh(n.props.children,s)),r.push(i)}),r}/**
 * React Router DOM v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function of(){return of=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},of.apply(this,arguments)}function iy(e,t){if(e==null)return{};var r={},n=Object.keys(e),a,s;for(s=0;s<n.length;s++)a=n[s],!(t.indexOf(a)>=0)&&(r[a]=e[a]);return r}function Zb(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function ek(e,t){return e.button===0&&(!t||t==="_self")&&!Zb(e)}function hh(e){return e===void 0&&(e=""),new URLSearchParams(typeof e=="string"||Array.isArray(e)||e instanceof URLSearchParams?e:Object.keys(e).reduce((t,r)=>{let n=e[r];return t.concat(Array.isArray(n)?n.map(a=>[r,a]):[[r,n]])},[]))}function tk(e,t){let r=hh(e);return t&&t.forEach((n,a)=>{r.has(a)||t.getAll(a).forEach(s=>{r.append(a,s)})}),r}const rk=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],nk=["aria-current","caseSensitive","className","end","style","to","viewTransition","children"],ak="6";try{window.__reactRouterVersion=ak}catch{}const sk=ue.createContext({isTransitioning:!1}),ok="startTransition",H1=tb[ok];function ik(e){let{basename:t,children:r,future:n,window:a}=e,s=ue.useRef();s.current==null&&(s.current=ib({window:a,v5Compat:!0}));let i=s.current,[c,u]=ue.useState({action:i.action,location:i.location}),{v7_startTransition:f}=n||{},h=ue.useCallback(p=>{f&&H1?H1(()=>u(p)):u(p)},[u,f]);return ue.useLayoutEffect(()=>i.listen(h),[i,h]),ue.useEffect(()=>Xb(n),[n]),ue.createElement(Yb,{basename:t,children:r,location:c.location,navigationType:c.action,navigator:i,future:n})}const lk=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",ck=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,ut=ue.forwardRef(function(t,r){let{onClick:n,relative:a,reloadDocument:s,replace:i,state:c,target:u,to:f,preventScrollReset:h,viewTransition:p}=t,m=iy(t,rk),{basename:y}=ue.useContext(Ua),w,x=!1;if(typeof f=="string"&&ck.test(f)&&(w=f,lk))try{let b=new URL(window.location.href),O=f.startsWith("//")?new URL(b.protocol+f):new URL(f),z=vi(O.pathname,y);O.origin===b.origin&&z!=null?f=z+O.search+O.hash:x=!0}catch{}let _=Db(f,{relative:a}),E=fk(f,{replace:i,state:c,target:u,preventScrollReset:h,relative:a,viewTransition:p});function k(b){n&&n(b),b.defaultPrevented||E(b)}return ue.createElement("a",of({},m,{href:w||_,onClick:x||s?n:k,ref:r,target:u}))}),XM=ue.forwardRef(function(t,r){let{"aria-current":n="page",caseSensitive:a=!1,className:s="",end:i=!1,style:c,to:u,viewTransition:f,children:h}=t,p=iy(t,nk),m=Pf(u,{relative:p.relative}),y=Ts(),w=ue.useContext(ty),{navigator:x,basename:_}=ue.useContext(Ua),E=w!=null&&dk(m)&&f===!0,k=x.encodeLocation?x.encodeLocation(m).pathname:m.pathname,b=y.pathname,O=w&&w.navigation&&w.navigation.location?w.navigation.location.pathname:null;a||(b=b.toLowerCase(),O=O?O.toLowerCase():null,k=k.toLowerCase()),O&&_&&(O=vi(O,_)||O);const z=k!=="/"&&k.endsWith("/")?k.length-1:k.length;let L=b===k||!i&&b.startsWith(k)&&b.charAt(z)==="/",P=O!=null&&(O===k||!i&&O.startsWith(k)&&O.charAt(k.length)==="/"),J={isActive:L,isPending:P,isTransitioning:E},V=L?n:void 0,le;typeof s=="function"?le=s(J):le=[s,L?"active":null,P?"pending":null,E?"transitioning":null].filter(Boolean).join(" ");let ee=typeof c=="function"?c(J):c;return ue.createElement(ut,of({},p,{"aria-current":V,className:le,ref:r,style:ee,to:u,viewTransition:f}),typeof h=="function"?h(J):h)});var gh;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})(gh||(gh={}));var G1;(function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"})(G1||(G1={}));function uk(e){let t=ue.useContext(Cf);return t||Wt(!1),t}function fk(e,t){let{target:r,replace:n,state:a,preventScrollReset:s,relative:i,viewTransition:c}=t===void 0?{}:t,u=uc(),f=Ts(),h=Pf(e,{relative:i});return ue.useCallback(p=>{if(ek(p,r)){p.preventDefault();let m=n!==void 0?n:sf(f)===sf(h);u(e,{replace:m,state:a,preventScrollReset:s,relative:i,viewTransition:c})}},[f,u,h,n,a,r,e,s,i,c])}function JM(e){let t=ue.useRef(hh(e)),r=ue.useRef(!1),n=Ts(),a=ue.useMemo(()=>tk(n.search,r.current?null:t.current),[n.search]),s=uc(),i=ue.useCallback((c,u)=>{const f=hh(typeof c=="function"?c(a):c);r.current=!0,s("?"+f,u)},[s,a]);return[a,i]}function dk(e,t){t===void 0&&(t={});let r=ue.useContext(sk);r==null&&Wt(!1);let{basename:n}=uk(gh.useViewTransitionState),a=Pf(e,{relative:t.relative});if(!r.isTransitioning)return!1;let s=vi(r.currentLocation.pathname,n)||r.currentLocation.pathname,i=vi(r.nextLocation.pathname,n)||r.nextLocation.pathname;return fh(a.pathname,i)!=null||fh(a.pathname,s)!=null}var hk={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const gk=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),qr=(e,t)=>{const r=ue.forwardRef(({color:n="currentColor",size:a=24,strokeWidth:s=2,absoluteStrokeWidth:i,children:c,...u},f)=>ue.createElement("svg",{ref:f,...hk,width:a,height:a,stroke:n,strokeWidth:i?Number(s)*24/Number(a):s,className:`lucide lucide-${gk(e)}`,...u},[...t.map(([h,p])=>ue.createElement(h,p)),...(Array.isArray(c)?c:[c])||[]]));return r.displayName=`${e}`,r},pk=qr("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]),mk=qr("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]),vk=qr("ChevronDown",[["polyline",{points:"6 9 12 15 18 9",key:"1do0m2"}]]),xk=qr("Facebook",[["path",{d:"M18 2h-3a5 5 0 0 0-5 5v3H7v4h3v8h4v-8h3l1-4h-4V7a1 1 0 0 1 1-1h3z",key:"1jg4f8"}]]),yk=qr("Github",[["path",{d:"M15 22v-4a4.8 4.8 0 0 0-1-3.5c3 0 6-2 6-5.5.08-1.25-.27-2.48-1-3.5.28-1.15.28-2.35 0-3.5 0 0-1 0-3 1.5-2.64-.5-5.36-.5-8 0C6 2 5 2 5 2c-.3 1.15-.3 2.35 0 3.5A5.403 5.403 0 0 0 4 9c0 3.5 3 5.5 6 5.5-.39.49-.68 1.05-.85 1.65-.17.6-.22 1.23-.15 1.85v4",key:"tonef"}],["path",{d:"M9 18c-4.51 2-5-2-7-2",key:"9comsn"}]]),wk=qr("HelpCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]]),_k=qr("Instagram",[["rect",{width:"20",height:"20",x:"2",y:"2",rx:"5",ry:"5",key:"2e1cvw"}],["path",{d:"M16 11.37A4 4 0 1 1 12.63 8 4 4 0 0 1 16 11.37z",key:"9exkf1"}],["line",{x1:"17.5",x2:"17.51",y1:"6.5",y2:"6.5",key:"r4j83e"}]]),Sk=qr("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]),Ek=qr("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]),bk=qr("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]),kk=qr("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),Tk=qr("Shield",[["path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z",key:"3xmgem"}]]),Ck=qr("Trophy",[["path",{d:"M6 9H4.5a2.5 2.5 0 0 1 0-5H6",key:"17hqa7"}],["path",{d:"M18 9h1.5a2.5 2.5 0 0 0 0-5H18",key:"lmptdp"}],["path",{d:"M4 22h16",key:"57wxv0"}],["path",{d:"M10 14.66V17c0 .55-.47.98-.97 1.21C7.85 18.75 7 20.24 7 22",key:"1nw9bq"}],["path",{d:"M14 14.66V17c0 .55.47.98.97 1.21C16.15 18.75 17 20.24 17 22",key:"1np0yb"}],["path",{d:"M18 2H6v7a6 6 0 0 0 12 0V2Z",key:"u46fv3"}]]),Ak=qr("Twitter",[["path",{d:"M22 4s-.7 2.1-2 3.4c1.6 10-9.4 17.3-18 11.6 2.2.1 4.4-.6 6-2C3 15.5.5 9.6 3 5c2.2 2.6 5.6 4.1 9 4-.9-4.2 4-6.6 7-3.8 1.1 0 3-1.2 3-1.2z",key:"pff0z6"}]]),Pk=qr("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]),ly=qr("X",[["line",{x1:"18",x2:"6",y1:"6",y2:"18",key:"15jfxm"}],["line",{x1:"6",x2:"18",y1:"6",y2:"18",key:"d1lma3"}]]),Ik={},q1=e=>{let t;const r=new Set,n=(h,p)=>{const m=typeof h=="function"?h(t):h;if(!Object.is(m,t)){const y=t;t=p??(typeof m!="object"||m===null)?m:Object.assign({},t,m),r.forEach(w=>w(t,y))}},a=()=>t,u={setState:n,getState:a,getInitialState:()=>f,subscribe:h=>(r.add(h),()=>r.delete(h)),destroy:()=>{(Ik?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),r.clear()}},f=t=e(n,a,u);return u},Ok=e=>e?q1(e):q1;var Dd={exports:{}},Fd={},Rd={exports:{}},Ld={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var K1;function Dk(){if(K1)return Ld;K1=1;var e=cc();function t(p,m){return p===m&&(p!==0||1/p===1/m)||p!==p&&m!==m}var r=typeof Object.is=="function"?Object.is:t,n=e.useState,a=e.useEffect,s=e.useLayoutEffect,i=e.useDebugValue;function c(p,m){var y=m(),w=n({inst:{value:y,getSnapshot:m}}),x=w[0].inst,_=w[1];return s(function(){x.value=y,x.getSnapshot=m,u(x)&&_({inst:x})},[p,y,m]),a(function(){return u(x)&&_({inst:x}),p(function(){u(x)&&_({inst:x})})},[p]),i(y),y}function u(p){var m=p.getSnapshot;p=p.value;try{var y=m();return!r(p,y)}catch{return!0}}function f(p,m){return m()}var h=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?f:c;return Ld.useSyncExternalStore=e.useSyncExternalStore!==void 0?e.useSyncExternalStore:h,Ld}var X1;function Fk(){return X1||(X1=1,Rd.exports=Dk()),Rd.exports}/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var J1;function Rk(){if(J1)return Fd;J1=1;var e=cc(),t=Fk();function r(f,h){return f===h&&(f!==0||1/f===1/h)||f!==f&&h!==h}var n=typeof Object.is=="function"?Object.is:r,a=t.useSyncExternalStore,s=e.useRef,i=e.useEffect,c=e.useMemo,u=e.useDebugValue;return Fd.useSyncExternalStoreWithSelector=function(f,h,p,m,y){var w=s(null);if(w.current===null){var x={hasValue:!1,value:null};w.current=x}else x=w.current;w=c(function(){function E(L){if(!k){if(k=!0,b=L,L=m(L),y!==void 0&&x.hasValue){var P=x.value;if(y(P,L))return O=P}return O=L}if(P=O,n(b,L))return P;var J=m(L);return y!==void 0&&y(P,J)?(b=L,P):(b=L,O=J)}var k=!1,b,O,z=p===void 0?null:p;return[function(){return E(h())},z===null?void 0:function(){return E(z())}]},[h,p,m,y]);var _=a(f,w[0],w[1]);return i(function(){x.hasValue=!0,x.value=_},[_]),u(_),_},Fd}var Y1;function Lk(){return Y1||(Y1=1,Dd.exports=Rk()),Dd.exports}var Nk=Lk();const Mk=Qh(Nk),cy={},{useDebugValue:Bk}=Xx,{useSyncExternalStoreWithSelector:jk}=Mk;let Q1=!1;const $k=e=>e;function Uk(e,t=$k,r){(cy?"production":void 0)!=="production"&&r&&!Q1&&(console.warn("[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937"),Q1=!0);const n=jk(e.subscribe,e.getState,e.getServerState||e.getInitialState,t,r);return Bk(n),n}const Z1=e=>{(cy?"production":void 0)!=="production"&&typeof e!="function"&&console.warn("[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.");const t=typeof e=="function"?Ok(e):e,r=(n,a)=>Uk(t,n,a);return Object.assign(r,t),r},uy=e=>e?Z1(e):Z1;function zk(e,t,r,n){function a(s){return s instanceof r?s:new r(function(i){i(s)})}return new(r||(r=Promise))(function(s,i){function c(h){try{f(n.next(h))}catch(p){i(p)}}function u(h){try{f(n.throw(h))}catch(p){i(p)}}function f(h){h.done?s(h.value):a(h.value).then(c,u)}f((n=n.apply(e,t||[])).next())})}const Vk=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...r)=>Z(async()=>{const{default:n}=await Promise.resolve().then(()=>mo);return{default:n}},void 0).then(({default:n})=>n(...r)):t=fetch,(...r)=>t(...r)};class tg extends Error{constructor(t,r="FunctionsError",n){super(t),this.name=r,this.context=n}}class ev extends tg{constructor(t){super("Failed to send a request to the Edge Function","FunctionsFetchError",t)}}class tv extends tg{constructor(t){super("Relay Error invoking the Edge Function","FunctionsRelayError",t)}}class rv extends tg{constructor(t){super("Edge Function returned a non-2xx status code","FunctionsHttpError",t)}}var ph;(function(e){e.Any="any",e.ApNortheast1="ap-northeast-1",e.ApNortheast2="ap-northeast-2",e.ApSouth1="ap-south-1",e.ApSoutheast1="ap-southeast-1",e.ApSoutheast2="ap-southeast-2",e.CaCentral1="ca-central-1",e.EuCentral1="eu-central-1",e.EuWest1="eu-west-1",e.EuWest2="eu-west-2",e.EuWest3="eu-west-3",e.SaEast1="sa-east-1",e.UsEast1="us-east-1",e.UsWest1="us-west-1",e.UsWest2="us-west-2"})(ph||(ph={}));class Wk{constructor(t,{headers:r={},customFetch:n,region:a=ph.Any}={}){this.url=t,this.headers=r,this.region=a,this.fetch=Vk(n)}setAuth(t){this.headers.Authorization=`Bearer ${t}`}invoke(t){return zk(this,arguments,void 0,function*(r,n={}){var a;try{const{headers:s,method:i,body:c,signal:u}=n;let f={},{region:h}=n;h||(h=this.region);const p=new URL(`${this.url}/${r}`);h&&h!=="any"&&(f["x-region"]=h,p.searchParams.set("forceFunctionRegion",h));let m;c&&(s&&!Object.prototype.hasOwnProperty.call(s,"Content-Type")||!s)?typeof Blob<"u"&&c instanceof Blob||c instanceof ArrayBuffer?(f["Content-Type"]="application/octet-stream",m=c):typeof c=="string"?(f["Content-Type"]="text/plain",m=c):typeof FormData<"u"&&c instanceof FormData?m=c:(f["Content-Type"]="application/json",m=JSON.stringify(c)):m=c;const y=yield this.fetch(p.toString(),{method:i||"POST",headers:Object.assign(Object.assign(Object.assign({},f),this.headers),s),body:m,signal:u}).catch(E=>{throw E.name==="AbortError"?E:new ev(E)}),w=y.headers.get("x-relay-error");if(w&&w==="true")throw new tv(y);if(!y.ok)throw new rv(y);let x=((a=y.headers.get("Content-Type"))!==null&&a!==void 0?a:"text/plain").split(";")[0].trim(),_;return x==="application/json"?_=yield y.json():x==="application/octet-stream"||x==="application/pdf"?_=yield y.blob():x==="text/event-stream"?_=y:x==="multipart/form-data"?_=yield y.formData():_=yield y.text(),{data:_,error:null,response:y}}catch(s){return s instanceof Error&&s.name==="AbortError"?{data:null,error:new ev(s)}:{data:null,error:s,response:s instanceof rv||s instanceof tv?s.context:void 0}}})}}var Br={},mh=function(e,t){return mh=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(r[a]=n[a])},mh(e,t)};function fy(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");mh(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}var lf=function(){return lf=Object.assign||function(t){for(var r,n=1,a=arguments.length;n<a;n++){r=arguments[n];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(t[s]=r[s])}return t},lf.apply(this,arguments)};function dy(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(r[n[a]]=e[n[a]]);return r}function hy(e,t,r,n){var a=arguments.length,s=a<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,r):n,i;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(e,t,r,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(s=(a<3?i(s):a>3?i(t,r,s):i(t,r))||s);return a>3&&s&&Object.defineProperty(t,r,s),s}function gy(e,t){return function(r,n){t(r,n,e)}}function py(e,t,r,n,a,s){function i(E){if(E!==void 0&&typeof E!="function")throw new TypeError("Function expected");return E}for(var c=n.kind,u=c==="getter"?"get":c==="setter"?"set":"value",f=!t&&e?n.static?e:e.prototype:null,h=t||(f?Object.getOwnPropertyDescriptor(f,n.name):{}),p,m=!1,y=r.length-1;y>=0;y--){var w={};for(var x in n)w[x]=x==="access"?{}:n[x];for(var x in n.access)w.access[x]=n.access[x];w.addInitializer=function(E){if(m)throw new TypeError("Cannot add initializers after decoration has completed");s.push(i(E||null))};var _=(0,r[y])(c==="accessor"?{get:h.get,set:h.set}:h[u],w);if(c==="accessor"){if(_===void 0)continue;if(_===null||typeof _!="object")throw new TypeError("Object expected");(p=i(_.get))&&(h.get=p),(p=i(_.set))&&(h.set=p),(p=i(_.init))&&a.unshift(p)}else(p=i(_))&&(c==="field"?a.unshift(p):h[u]=p)}f&&Object.defineProperty(f,n.name,h),m=!0}function my(e,t,r){for(var n=arguments.length>2,a=0;a<t.length;a++)r=n?t[a].call(e,r):t[a].call(e);return n?r:void 0}function vy(e){return typeof e=="symbol"?e:"".concat(e)}function xy(e,t,r){return typeof t=="symbol"&&(t=t.description?"[".concat(t.description,"]"):""),Object.defineProperty(e,"name",{configurable:!0,value:r?"".concat(r," ",t):t})}function yy(e,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(e,t)}function wy(e,t,r,n){function a(s){return s instanceof r?s:new r(function(i){i(s)})}return new(r||(r=Promise))(function(s,i){function c(h){try{f(n.next(h))}catch(p){i(p)}}function u(h){try{f(n.throw(h))}catch(p){i(p)}}function f(h){h.done?s(h.value):a(h.value).then(c,u)}f((n=n.apply(e,t||[])).next())})}function _y(e,t){var r={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},n,a,s,i=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return i.next=c(0),i.throw=c(1),i.return=c(2),typeof Symbol=="function"&&(i[Symbol.iterator]=function(){return this}),i;function c(f){return function(h){return u([f,h])}}function u(f){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,f[0]&&(r=0)),r;)try{if(n=1,a&&(s=f[0]&2?a.return:f[0]?a.throw||((s=a.return)&&s.call(a),0):a.next)&&!(s=s.call(a,f[1])).done)return s;switch(a=0,s&&(f=[f[0]&2,s.value]),f[0]){case 0:case 1:s=f;break;case 4:return r.label++,{value:f[1],done:!1};case 5:r.label++,a=f[1],f=[0];continue;case 7:f=r.ops.pop(),r.trys.pop();continue;default:if(s=r.trys,!(s=s.length>0&&s[s.length-1])&&(f[0]===6||f[0]===2)){r=0;continue}if(f[0]===3&&(!s||f[1]>s[0]&&f[1]<s[3])){r.label=f[1];break}if(f[0]===6&&r.label<s[1]){r.label=s[1],s=f;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(f);break}s[2]&&r.ops.pop(),r.trys.pop();continue}f=t.call(e,r)}catch(h){f=[6,h],a=0}finally{n=s=0}if(f[0]&5)throw f[1];return{value:f[0]?f[1]:void 0,done:!0}}}var If=Object.create?(function(e,t,r,n){n===void 0&&(n=r);var a=Object.getOwnPropertyDescriptor(t,r);(!a||("get"in a?!t.__esModule:a.writable||a.configurable))&&(a={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,a)}):(function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]});function Sy(e,t){for(var r in e)r!=="default"&&!Object.prototype.hasOwnProperty.call(t,r)&&If(t,e,r)}function cf(e){var t=typeof Symbol=="function"&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function rg(e,t){var r=typeof Symbol=="function"&&e[Symbol.iterator];if(!r)return e;var n=r.call(e),a,s=[],i;try{for(;(t===void 0||t-- >0)&&!(a=n.next()).done;)s.push(a.value)}catch(c){i={error:c}}finally{try{a&&!a.done&&(r=n.return)&&r.call(n)}finally{if(i)throw i.error}}return s}function Ey(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(rg(arguments[t]));return e}function by(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;for(var n=Array(e),a=0,t=0;t<r;t++)for(var s=arguments[t],i=0,c=s.length;i<c;i++,a++)n[a]=s[i];return n}function ky(e,t,r){if(r||arguments.length===2)for(var n=0,a=t.length,s;n<a;n++)(s||!(n in t))&&(s||(s=Array.prototype.slice.call(t,0,n)),s[n]=t[n]);return e.concat(s||Array.prototype.slice.call(t))}function xi(e){return this instanceof xi?(this.v=e,this):new xi(e)}function Ty(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=r.apply(e,t||[]),a,s=[];return a=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),c("next"),c("throw"),c("return",i),a[Symbol.asyncIterator]=function(){return this},a;function i(y){return function(w){return Promise.resolve(w).then(y,p)}}function c(y,w){n[y]&&(a[y]=function(x){return new Promise(function(_,E){s.push([y,x,_,E])>1||u(y,x)})},w&&(a[y]=w(a[y])))}function u(y,w){try{f(n[y](w))}catch(x){m(s[0][3],x)}}function f(y){y.value instanceof xi?Promise.resolve(y.value.v).then(h,p):m(s[0][2],y)}function h(y){u("next",y)}function p(y){u("throw",y)}function m(y,w){y(w),s.shift(),s.length&&u(s[0][0],s[0][1])}}function Cy(e){var t,r;return t={},n("next"),n("throw",function(a){throw a}),n("return"),t[Symbol.iterator]=function(){return this},t;function n(a,s){t[a]=e[a]?function(i){return(r=!r)?{value:xi(e[a](i)),done:!1}:s?s(i):i}:s}}function Ay(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=e[Symbol.asyncIterator],r;return t?t.call(e):(e=typeof cf=="function"?cf(e):e[Symbol.iterator](),r={},n("next"),n("throw"),n("return"),r[Symbol.asyncIterator]=function(){return this},r);function n(s){r[s]=e[s]&&function(i){return new Promise(function(c,u){i=e[s](i),a(c,u,i.done,i.value)})}}function a(s,i,c,u){Promise.resolve(u).then(function(f){s({value:f,done:c})},i)}}function Py(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}var Hk=Object.create?(function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}):function(e,t){e.default=t},vh=function(e){return vh=Object.getOwnPropertyNames||function(t){var r=[];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(r[r.length]=n);return r},vh(e)};function Iy(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r=vh(e),n=0;n<r.length;n++)r[n]!=="default"&&If(t,e,r[n]);return Hk(t,e),t}function Oy(e){return e&&e.__esModule?e:{default:e}}function Dy(e,t,r,n){if(r==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof t=="function"?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?n:r==="a"?n.call(e):n?n.value:t.get(e)}function Fy(e,t,r,n,a){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!a)throw new TypeError("Private accessor was defined without a setter");if(typeof t=="function"?e!==t||!a:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?a.call(e,r):a?a.value=r:t.set(e,r),r}function Ry(e,t){if(t===null||typeof t!="object"&&typeof t!="function")throw new TypeError("Cannot use 'in' operator on non-object");return typeof e=="function"?t===e:e.has(t)}function Ly(e,t,r){if(t!=null){if(typeof t!="object"&&typeof t!="function")throw new TypeError("Object expected.");var n,a;if(r){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");n=t[Symbol.asyncDispose]}if(n===void 0){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");n=t[Symbol.dispose],r&&(a=n)}if(typeof n!="function")throw new TypeError("Object not disposable.");a&&(n=function(){try{a.call(this)}catch(s){return Promise.reject(s)}}),e.stack.push({value:t,dispose:n,async:r})}else r&&e.stack.push({async:!0});return t}var Gk=typeof SuppressedError=="function"?SuppressedError:function(e,t,r){var n=new Error(r);return n.name="SuppressedError",n.error=e,n.suppressed=t,n};function Ny(e){function t(s){e.error=e.hasError?new Gk(s,e.error,"An error was suppressed during disposal."):s,e.hasError=!0}var r,n=0;function a(){for(;r=e.stack.pop();)try{if(!r.async&&n===1)return n=0,e.stack.push(r),Promise.resolve().then(a);if(r.dispose){var s=r.dispose.call(r.value);if(r.async)return n|=2,Promise.resolve(s).then(a,function(i){return t(i),a()})}else n|=1}catch(i){t(i)}if(n===1)return e.hasError?Promise.reject(e.error):Promise.resolve();if(e.hasError)throw e.error}return a()}function My(e,t){return typeof e=="string"&&/^\.\.?\//.test(e)?e.replace(/\.(tsx)$|((?:\.d)?)((?:\.[^./]+?)?)\.([cm]?)ts$/i,function(r,n,a,s,i){return n?t?".jsx":".js":a&&(!s||!i)?r:a+s+"."+i.toLowerCase()+"js"}):e}const qk={__extends:fy,__assign:lf,__rest:dy,__decorate:hy,__param:gy,__esDecorate:py,__runInitializers:my,__propKey:vy,__setFunctionName:xy,__metadata:yy,__awaiter:wy,__generator:_y,__createBinding:If,__exportStar:Sy,__values:cf,__read:rg,__spread:Ey,__spreadArrays:by,__spreadArray:ky,__await:xi,__asyncGenerator:Ty,__asyncDelegator:Cy,__asyncValues:Ay,__makeTemplateObject:Py,__importStar:Iy,__importDefault:Oy,__classPrivateFieldGet:Dy,__classPrivateFieldSet:Fy,__classPrivateFieldIn:Ry,__addDisposableResource:Ly,__disposeResources:Ny,__rewriteRelativeImportExtension:My},Kk=Object.freeze(Object.defineProperty({__proto__:null,__addDisposableResource:Ly,get __assign(){return lf},__asyncDelegator:Cy,__asyncGenerator:Ty,__asyncValues:Ay,__await:xi,__awaiter:wy,__classPrivateFieldGet:Dy,__classPrivateFieldIn:Ry,__classPrivateFieldSet:Fy,__createBinding:If,__decorate:hy,__disposeResources:Ny,__esDecorate:py,__exportStar:Sy,__extends:fy,__generator:_y,__importDefault:Oy,__importStar:Iy,__makeTemplateObject:Py,__metadata:yy,__param:gy,__propKey:vy,__read:rg,__rest:dy,__rewriteRelativeImportExtension:My,__runInitializers:my,__setFunctionName:xy,__spread:Ey,__spreadArray:ky,__spreadArrays:by,__values:cf,default:qk},Symbol.toStringTag,{value:"Module"})),Ti=Kx(Kk);var Ru={},Lu={},Nu={},Mu={},Bu={},Xk=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},yi=Xk();const Jk=yi.fetch,By=yi.fetch.bind(yi),jy=yi.Headers,Yk=yi.Request,Qk=yi.Response,mo=Object.freeze(Object.defineProperty({__proto__:null,Headers:jy,Request:Yk,Response:Qk,default:By,fetch:Jk},Symbol.toStringTag,{value:"Module"})),Zk=Kx(mo);var ju={},nv;function $y(){if(nv)return ju;nv=1,Object.defineProperty(ju,"__esModule",{value:!0});class e extends Error{constructor(r){super(r.message),this.name="PostgrestError",this.details=r.details,this.hint=r.hint,this.code=r.code}}return ju.default=e,ju}var av;function Uy(){if(av)return Bu;av=1,Object.defineProperty(Bu,"__esModule",{value:!0});const e=Ti,t=e.__importDefault(Zk),r=e.__importDefault($y());class n{constructor(s){var i,c;this.shouldThrowOnError=!1,this.method=s.method,this.url=s.url,this.headers=new Headers(s.headers),this.schema=s.schema,this.body=s.body,this.shouldThrowOnError=(i=s.shouldThrowOnError)!==null&&i!==void 0?i:!1,this.signal=s.signal,this.isMaybeSingle=(c=s.isMaybeSingle)!==null&&c!==void 0?c:!1,s.fetch?this.fetch=s.fetch:typeof fetch>"u"?this.fetch=t.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(s,i){return this.headers=new Headers(this.headers),this.headers.set(s,i),this}then(s,i){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const c=this.fetch;let u=c(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async f=>{var h,p,m,y;let w=null,x=null,_=null,E=f.status,k=f.statusText;if(f.ok){if(this.method!=="HEAD"){const L=await f.text();L===""||(this.headers.get("Accept")==="text/csv"||this.headers.get("Accept")&&(!((h=this.headers.get("Accept"))===null||h===void 0)&&h.includes("application/vnd.pgrst.plan+text"))?x=L:x=JSON.parse(L))}const O=(p=this.headers.get("Prefer"))===null||p===void 0?void 0:p.match(/count=(exact|planned|estimated)/),z=(m=f.headers.get("content-range"))===null||m===void 0?void 0:m.split("/");O&&z&&z.length>1&&(_=parseInt(z[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(x)&&(x.length>1?(w={code:"PGRST116",details:`Results contain ${x.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},x=null,_=null,E=406,k="Not Acceptable"):x.length===1?x=x[0]:x=null)}else{const O=await f.text();try{w=JSON.parse(O),Array.isArray(w)&&f.status===404&&(x=[],w=null,E=200,k="OK")}catch{f.status===404&&O===""?(E=204,k="No Content"):w={message:O}}if(w&&this.isMaybeSingle&&(!((y=w?.details)===null||y===void 0)&&y.includes("0 rows"))&&(w=null,E=200,k="OK"),w&&this.shouldThrowOnError)throw new r.default(w)}return{error:w,data:x,count:_,status:E,statusText:k}});return this.shouldThrowOnError||(u=u.catch(f=>{var h,p,m;return{error:{message:`${(h=f?.name)!==null&&h!==void 0?h:"FetchError"}: ${f?.message}`,details:`${(p=f?.stack)!==null&&p!==void 0?p:""}`,hint:"",code:`${(m=f?.code)!==null&&m!==void 0?m:""}`},data:null,count:null,status:0,statusText:""}})),u.then(s,i)}returns(){return this}overrideTypes(){return this}}return Bu.default=n,Bu}var sv;function zy(){if(sv)return Mu;sv=1,Object.defineProperty(Mu,"__esModule",{value:!0});const t=Ti.__importDefault(Uy());class r extends t.default{select(a){let s=!1;const i=(a??"*").split("").map(c=>/\s/.test(c)&&!s?"":(c==='"'&&(s=!s),c)).join("");return this.url.searchParams.set("select",i),this.headers.append("Prefer","return=representation"),this}order(a,{ascending:s=!0,nullsFirst:i,foreignTable:c,referencedTable:u=c}={}){const f=u?`${u}.order`:"order",h=this.url.searchParams.get(f);return this.url.searchParams.set(f,`${h?`${h},`:""}${a}.${s?"asc":"desc"}${i===void 0?"":i?".nullsfirst":".nullslast"}`),this}limit(a,{foreignTable:s,referencedTable:i=s}={}){const c=typeof i>"u"?"limit":`${i}.limit`;return this.url.searchParams.set(c,`${a}`),this}range(a,s,{foreignTable:i,referencedTable:c=i}={}){const u=typeof c>"u"?"offset":`${c}.offset`,f=typeof c>"u"?"limit":`${c}.limit`;return this.url.searchParams.set(u,`${a}`),this.url.searchParams.set(f,`${s-a+1}`),this}abortSignal(a){return this.signal=a,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:a=!1,verbose:s=!1,settings:i=!1,buffers:c=!1,wal:u=!1,format:f="text"}={}){var h;const p=[a?"analyze":null,s?"verbose":null,i?"settings":null,c?"buffers":null,u?"wal":null].filter(Boolean).join("|"),m=(h=this.headers.get("Accept"))!==null&&h!==void 0?h:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${f}; for="${m}"; options=${p};`),f==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(a){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${a}`),this}}return Mu.default=r,Mu}var ov;function ng(){if(ov)return Nu;ov=1,Object.defineProperty(Nu,"__esModule",{value:!0});const t=Ti.__importDefault(zy()),r=new RegExp("[,()]");class n extends t.default{eq(s,i){return this.url.searchParams.append(s,`eq.${i}`),this}neq(s,i){return this.url.searchParams.append(s,`neq.${i}`),this}gt(s,i){return this.url.searchParams.append(s,`gt.${i}`),this}gte(s,i){return this.url.searchParams.append(s,`gte.${i}`),this}lt(s,i){return this.url.searchParams.append(s,`lt.${i}`),this}lte(s,i){return this.url.searchParams.append(s,`lte.${i}`),this}like(s,i){return this.url.searchParams.append(s,`like.${i}`),this}likeAllOf(s,i){return this.url.searchParams.append(s,`like(all).{${i.join(",")}}`),this}likeAnyOf(s,i){return this.url.searchParams.append(s,`like(any).{${i.join(",")}}`),this}ilike(s,i){return this.url.searchParams.append(s,`ilike.${i}`),this}ilikeAllOf(s,i){return this.url.searchParams.append(s,`ilike(all).{${i.join(",")}}`),this}ilikeAnyOf(s,i){return this.url.searchParams.append(s,`ilike(any).{${i.join(",")}}`),this}is(s,i){return this.url.searchParams.append(s,`is.${i}`),this}in(s,i){const c=Array.from(new Set(i)).map(u=>typeof u=="string"&&r.test(u)?`"${u}"`:`${u}`).join(",");return this.url.searchParams.append(s,`in.(${c})`),this}contains(s,i){return typeof i=="string"?this.url.searchParams.append(s,`cs.${i}`):Array.isArray(i)?this.url.searchParams.append(s,`cs.{${i.join(",")}}`):this.url.searchParams.append(s,`cs.${JSON.stringify(i)}`),this}containedBy(s,i){return typeof i=="string"?this.url.searchParams.append(s,`cd.${i}`):Array.isArray(i)?this.url.searchParams.append(s,`cd.{${i.join(",")}}`):this.url.searchParams.append(s,`cd.${JSON.stringify(i)}`),this}rangeGt(s,i){return this.url.searchParams.append(s,`sr.${i}`),this}rangeGte(s,i){return this.url.searchParams.append(s,`nxl.${i}`),this}rangeLt(s,i){return this.url.searchParams.append(s,`sl.${i}`),this}rangeLte(s,i){return this.url.searchParams.append(s,`nxr.${i}`),this}rangeAdjacent(s,i){return this.url.searchParams.append(s,`adj.${i}`),this}overlaps(s,i){return typeof i=="string"?this.url.searchParams.append(s,`ov.${i}`):this.url.searchParams.append(s,`ov.{${i.join(",")}}`),this}textSearch(s,i,{config:c,type:u}={}){let f="";u==="plain"?f="pl":u==="phrase"?f="ph":u==="websearch"&&(f="w");const h=c===void 0?"":`(${c})`;return this.url.searchParams.append(s,`${f}fts${h}.${i}`),this}match(s){return Object.entries(s).forEach(([i,c])=>{this.url.searchParams.append(i,`eq.${c}`)}),this}not(s,i,c){return this.url.searchParams.append(s,`not.${i}.${c}`),this}or(s,{foreignTable:i,referencedTable:c=i}={}){const u=c?`${c}.or`:"or";return this.url.searchParams.append(u,`(${s})`),this}filter(s,i,c){return this.url.searchParams.append(s,`${i}.${c}`),this}}return Nu.default=n,Nu}var iv;function Vy(){if(iv)return Lu;iv=1,Object.defineProperty(Lu,"__esModule",{value:!0});const t=Ti.__importDefault(ng());class r{constructor(a,{headers:s={},schema:i,fetch:c}){this.url=a,this.headers=new Headers(s),this.schema=i,this.fetch=c}select(a,s){const{head:i=!1,count:c}=s??{},u=i?"HEAD":"GET";let f=!1;const h=(a??"*").split("").map(p=>/\s/.test(p)&&!f?"":(p==='"'&&(f=!f),p)).join("");return this.url.searchParams.set("select",h),c&&this.headers.append("Prefer",`count=${c}`),new t.default({method:u,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(a,{count:s,defaultToNull:i=!0}={}){var c;const u="POST";if(s&&this.headers.append("Prefer",`count=${s}`),i||this.headers.append("Prefer","missing=default"),Array.isArray(a)){const f=a.reduce((h,p)=>h.concat(Object.keys(p)),[]);if(f.length>0){const h=[...new Set(f)].map(p=>`"${p}"`);this.url.searchParams.set("columns",h.join(","))}}return new t.default({method:u,url:this.url,headers:this.headers,schema:this.schema,body:a,fetch:(c=this.fetch)!==null&&c!==void 0?c:fetch})}upsert(a,{onConflict:s,ignoreDuplicates:i=!1,count:c,defaultToNull:u=!0}={}){var f;const h="POST";if(this.headers.append("Prefer",`resolution=${i?"ignore":"merge"}-duplicates`),s!==void 0&&this.url.searchParams.set("on_conflict",s),c&&this.headers.append("Prefer",`count=${c}`),u||this.headers.append("Prefer","missing=default"),Array.isArray(a)){const p=a.reduce((m,y)=>m.concat(Object.keys(y)),[]);if(p.length>0){const m=[...new Set(p)].map(y=>`"${y}"`);this.url.searchParams.set("columns",m.join(","))}}return new t.default({method:h,url:this.url,headers:this.headers,schema:this.schema,body:a,fetch:(f=this.fetch)!==null&&f!==void 0?f:fetch})}update(a,{count:s}={}){var i;const c="PATCH";return s&&this.headers.append("Prefer",`count=${s}`),new t.default({method:c,url:this.url,headers:this.headers,schema:this.schema,body:a,fetch:(i=this.fetch)!==null&&i!==void 0?i:fetch})}delete({count:a}={}){var s;const i="DELETE";return a&&this.headers.append("Prefer",`count=${a}`),new t.default({method:i,url:this.url,headers:this.headers,schema:this.schema,fetch:(s=this.fetch)!==null&&s!==void 0?s:fetch})}}return Lu.default=r,Lu}var lv;function eT(){if(lv)return Ru;lv=1,Object.defineProperty(Ru,"__esModule",{value:!0});const e=Ti,t=e.__importDefault(Vy()),r=e.__importDefault(ng());class n{constructor(s,{headers:i={},schema:c,fetch:u}={}){this.url=s,this.headers=new Headers(i),this.schemaName=c,this.fetch=u}from(s){const i=new URL(`${this.url}/${s}`);return new t.default(i,{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(s){return new n(this.url,{headers:this.headers,schema:s,fetch:this.fetch})}rpc(s,i={},{head:c=!1,get:u=!1,count:f}={}){var h;let p;const m=new URL(`${this.url}/rpc/${s}`);let y;c||u?(p=c?"HEAD":"GET",Object.entries(i).filter(([x,_])=>_!==void 0).map(([x,_])=>[x,Array.isArray(_)?`{${_.join(",")}}`:`${_}`]).forEach(([x,_])=>{m.searchParams.append(x,_)})):(p="POST",y=i);const w=new Headers(this.headers);return f&&w.set("Prefer",`count=${f}`),new r.default({method:p,url:m,headers:w,schema:this.schemaName,body:y,fetch:(h=this.fetch)!==null&&h!==void 0?h:fetch})}}return Ru.default=n,Ru}var cv;function tT(){if(cv)return Br;cv=1,Object.defineProperty(Br,"__esModule",{value:!0}),Br.PostgrestError=Br.PostgrestBuilder=Br.PostgrestTransformBuilder=Br.PostgrestFilterBuilder=Br.PostgrestQueryBuilder=Br.PostgrestClient=void 0;const e=Ti,t=e.__importDefault(eT());Br.PostgrestClient=t.default;const r=e.__importDefault(Vy());Br.PostgrestQueryBuilder=r.default;const n=e.__importDefault(ng());Br.PostgrestFilterBuilder=n.default;const a=e.__importDefault(zy());Br.PostgrestTransformBuilder=a.default;const s=e.__importDefault(Uy());Br.PostgrestBuilder=s.default;const i=e.__importDefault($y());return Br.PostgrestError=i.default,Br.default={PostgrestClient:t.default,PostgrestQueryBuilder:r.default,PostgrestFilterBuilder:n.default,PostgrestTransformBuilder:a.default,PostgrestBuilder:s.default,PostgrestError:i.default},Br}var Wy=tT();const Hy=Qh(Wy),rT=qx({__proto__:null,default:Hy},[Wy]),{PostgrestClient:nT,PostgrestQueryBuilder:YM,PostgrestFilterBuilder:QM,PostgrestTransformBuilder:ZM,PostgrestBuilder:eB,PostgrestError:tB}=Hy||rT;class aT{static detectEnvironment(){var t;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((t=navigator.userAgent)===null||t===void 0)&&t.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if(typeof process<"u"){const r=process.versions;if(r&&r.node){const n=r.node,a=parseInt(n.replace(/^v/,"").split(".")[0]);return a>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${a} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${a} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const t=this.detectEnvironment();if(t.constructor)return t.constructor;let r=t.error||"WebSocket not supported in this environment.";throw t.workaround&&(r+=`

Suggested solution: ${t.workaround}`),new Error(r)}static createWebSocket(t,r){const n=this.getWebSocketConstructor();return new n(t,r)}static isWebSocketSupported(){try{const t=this.detectEnvironment();return t.type==="native"||t.type==="ws"}catch{return!1}}}const sT="2.78.0",oT=`realtime-js/${sT}`,iT="1.0.0",xh=1e4,lT=1e3,cT=100;var Pl;(function(e){e[e.connecting=0]="connecting",e[e.open=1]="open",e[e.closing=2]="closing",e[e.closed=3]="closed"})(Pl||(Pl={}));var hr;(function(e){e.closed="closed",e.errored="errored",e.joined="joined",e.joining="joining",e.leaving="leaving"})(hr||(hr={}));var ta;(function(e){e.close="phx_close",e.error="phx_error",e.join="phx_join",e.reply="phx_reply",e.leave="phx_leave",e.access_token="access_token"})(ta||(ta={}));var yh;(function(e){e.websocket="websocket"})(yh||(yh={}));var Ys;(function(e){e.Connecting="connecting",e.Open="open",e.Closing="closing",e.Closed="closed"})(Ys||(Ys={}));class uT{constructor(){this.HEADER_LENGTH=1}decode(t,r){return t.constructor===ArrayBuffer?r(this._binaryDecode(t)):r(typeof t=="string"?JSON.parse(t):{})}_binaryDecode(t){const r=new DataView(t),n=new TextDecoder;return this._decodeBroadcast(t,r,n)}_decodeBroadcast(t,r,n){const a=r.getUint8(1),s=r.getUint8(2);let i=this.HEADER_LENGTH+2;const c=n.decode(t.slice(i,i+a));i=i+a;const u=n.decode(t.slice(i,i+s));i=i+s;const f=JSON.parse(n.decode(t.slice(i,t.byteLength)));return{ref:null,topic:c,event:u,payload:f}}}class Gy{constructor(t,r){this.callback=t,this.timerCalc=r,this.timer=void 0,this.tries=0,this.callback=t,this.timerCalc=r}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var It;(function(e){e.abstime="abstime",e.bool="bool",e.date="date",e.daterange="daterange",e.float4="float4",e.float8="float8",e.int2="int2",e.int4="int4",e.int4range="int4range",e.int8="int8",e.int8range="int8range",e.json="json",e.jsonb="jsonb",e.money="money",e.numeric="numeric",e.oid="oid",e.reltime="reltime",e.text="text",e.time="time",e.timestamp="timestamp",e.timestamptz="timestamptz",e.timetz="timetz",e.tsrange="tsrange",e.tstzrange="tstzrange"})(It||(It={}));const uv=(e,t,r={})=>{var n;const a=(n=r.skipTypes)!==null&&n!==void 0?n:[];return t?Object.keys(t).reduce((s,i)=>(s[i]=fT(i,e,t,a),s),{}):{}},fT=(e,t,r,n)=>{const a=t.find(c=>c.name===e),s=a?.type,i=r[e];return s&&!n.includes(s)?qy(s,i):wh(i)},qy=(e,t)=>{if(e.charAt(0)==="_"){const r=e.slice(1,e.length);return pT(t,r)}switch(e){case It.bool:return dT(t);case It.float4:case It.float8:case It.int2:case It.int4:case It.int8:case It.numeric:case It.oid:return hT(t);case It.json:case It.jsonb:return gT(t);case It.timestamp:return mT(t);case It.abstime:case It.date:case It.daterange:case It.int4range:case It.int8range:case It.money:case It.reltime:case It.text:case It.time:case It.timestamptz:case It.timetz:case It.tsrange:case It.tstzrange:return wh(t);default:return wh(t)}},wh=e=>e,dT=e=>{switch(e){case"t":return!0;case"f":return!1;default:return e}},hT=e=>{if(typeof e=="string"){const t=parseFloat(e);if(!Number.isNaN(t))return t}return e},gT=e=>{if(typeof e=="string")try{return JSON.parse(e)}catch(t){return console.log(`JSON parse error: ${t}`),e}return e},pT=(e,t)=>{if(typeof e!="string")return e;const r=e.length-1,n=e[r];if(e[0]==="{"&&n==="}"){let s;const i=e.slice(1,r);try{s=JSON.parse("["+i+"]")}catch{s=i?i.split(","):[]}return s.map(c=>qy(t,c))}return e},mT=e=>typeof e=="string"?e.replace(" ","T"):e,Ky=e=>{const t=new URL(e);return t.protocol=t.protocol.replace(/^ws/i,"http"),t.pathname=t.pathname.replace(/\/+$/,"").replace(/\/socket\/websocket$/i,"").replace(/\/socket$/i,"").replace(/\/websocket$/i,""),t.pathname===""||t.pathname==="/"?t.pathname="/api/broadcast":t.pathname=t.pathname+"/api/broadcast",t.href};class Nd{constructor(t,r,n={},a=xh){this.channel=t,this.event=r,this.payload=n,this.timeout=a,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(t){this.timeout=t,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(t){this.payload=Object.assign(Object.assign({},this.payload),t)}receive(t,r){var n;return this._hasReceived(t)&&r((n=this.receivedResp)===null||n===void 0?void 0:n.response),this.recHooks.push({status:t,callback:r}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const t=r=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=r,this._matchReceive(r)};this.channel._on(this.refEvent,{},t),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(t,r){this.refEvent&&this.channel._trigger(this.refEvent,{status:t,response:r})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:t,response:r}){this.recHooks.filter(n=>n.status===t).forEach(n=>n.callback(r))}_hasReceived(t){return this.receivedResp&&this.receivedResp.status===t}}var fv;(function(e){e.SYNC="sync",e.JOIN="join",e.LEAVE="leave"})(fv||(fv={}));class Il{constructor(t,r){this.channel=t,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const n=r?.events||{state:"presence_state",diff:"presence_diff"};this.channel._on(n.state,{},a=>{const{onJoin:s,onLeave:i,onSync:c}=this.caller;this.joinRef=this.channel._joinRef(),this.state=Il.syncState(this.state,a,s,i),this.pendingDiffs.forEach(u=>{this.state=Il.syncDiff(this.state,u,s,i)}),this.pendingDiffs=[],c()}),this.channel._on(n.diff,{},a=>{const{onJoin:s,onLeave:i,onSync:c}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(a):(this.state=Il.syncDiff(this.state,a,s,i),c())}),this.onJoin((a,s,i)=>{this.channel._trigger("presence",{event:"join",key:a,currentPresences:s,newPresences:i})}),this.onLeave((a,s,i)=>{this.channel._trigger("presence",{event:"leave",key:a,currentPresences:s,leftPresences:i})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(t,r,n,a){const s=this.cloneDeep(t),i=this.transformState(r),c={},u={};return this.map(s,(f,h)=>{i[f]||(u[f]=h)}),this.map(i,(f,h)=>{const p=s[f];if(p){const m=h.map(_=>_.presence_ref),y=p.map(_=>_.presence_ref),w=h.filter(_=>y.indexOf(_.presence_ref)<0),x=p.filter(_=>m.indexOf(_.presence_ref)<0);w.length>0&&(c[f]=w),x.length>0&&(u[f]=x)}else c[f]=h}),this.syncDiff(s,{joins:c,leaves:u},n,a)}static syncDiff(t,r,n,a){const{joins:s,leaves:i}={joins:this.transformState(r.joins),leaves:this.transformState(r.leaves)};return n||(n=()=>{}),a||(a=()=>{}),this.map(s,(c,u)=>{var f;const h=(f=t[c])!==null&&f!==void 0?f:[];if(t[c]=this.cloneDeep(u),h.length>0){const p=t[c].map(y=>y.presence_ref),m=h.filter(y=>p.indexOf(y.presence_ref)<0);t[c].unshift(...m)}n(c,h,u)}),this.map(i,(c,u)=>{let f=t[c];if(!f)return;const h=u.map(p=>p.presence_ref);f=f.filter(p=>h.indexOf(p.presence_ref)<0),t[c]=f,a(c,f,u),f.length===0&&delete t[c]}),t}static map(t,r){return Object.getOwnPropertyNames(t).map(n=>r(n,t[n]))}static transformState(t){return t=this.cloneDeep(t),Object.getOwnPropertyNames(t).reduce((r,n)=>{const a=t[n];return"metas"in a?r[n]=a.metas.map(s=>(s.presence_ref=s.phx_ref,delete s.phx_ref,delete s.phx_ref_prev,s)):r[n]=a,r},{})}static cloneDeep(t){return JSON.parse(JSON.stringify(t))}onJoin(t){this.caller.onJoin=t}onLeave(t){this.caller.onLeave=t}onSync(t){this.caller.onSync=t}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var dv;(function(e){e.ALL="*",e.INSERT="INSERT",e.UPDATE="UPDATE",e.DELETE="DELETE"})(dv||(dv={}));var Ol;(function(e){e.BROADCAST="broadcast",e.PRESENCE="presence",e.POSTGRES_CHANGES="postgres_changes",e.SYSTEM="system"})(Ol||(Ol={}));var Ra;(function(e){e.SUBSCRIBED="SUBSCRIBED",e.TIMED_OUT="TIMED_OUT",e.CLOSED="CLOSED",e.CHANNEL_ERROR="CHANNEL_ERROR"})(Ra||(Ra={}));class ag{constructor(t,r={config:{}},n){var a,s;if(this.topic=t,this.params=r,this.socket=n,this.bindings={},this.state=hr.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=t.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},r.config),this.timeout=this.socket.timeout,this.joinPush=new Nd(this,ta.join,this.params,this.timeout),this.rejoinTimer=new Gy(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=hr.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(i=>i.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=hr.closed,this.socket._remove(this)}),this._onError(i=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,i),this.state=hr.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=hr.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",i=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,i),this.state=hr.errored,this.rejoinTimer.scheduleTimeout())}),this._on(ta.reply,{},(i,c)=>{this._trigger(this._replyEventName(c),i)}),this.presence=new Il(this),this.broadcastEndpointURL=Ky(this.socket.endPoint),this.private=this.params.config.private||!1,!this.private&&(!((s=(a=this.params.config)===null||a===void 0?void 0:a.broadcast)===null||s===void 0)&&s.replay))throw`tried to use replay on public channel '${this.topic}'. It must be a private channel.`}subscribe(t,r=this.timeout){var n,a,s;if(this.socket.isConnected()||this.socket.connect(),this.state==hr.closed){const{config:{broadcast:i,presence:c,private:u}}=this.params,f=(a=(n=this.bindings.postgres_changes)===null||n===void 0?void 0:n.map(y=>y.filter))!==null&&a!==void 0?a:[],h=!!this.bindings[Ol.PRESENCE]&&this.bindings[Ol.PRESENCE].length>0||((s=this.params.config.presence)===null||s===void 0?void 0:s.enabled)===!0,p={},m={broadcast:i,presence:Object.assign(Object.assign({},c),{enabled:h}),postgres_changes:f,private:u};this.socket.accessTokenValue&&(p.access_token=this.socket.accessTokenValue),this._onError(y=>t?.(Ra.CHANNEL_ERROR,y)),this._onClose(()=>t?.(Ra.CLOSED)),this.updateJoinPayload(Object.assign({config:m},p)),this.joinedOnce=!0,this._rejoin(r),this.joinPush.receive("ok",async({postgres_changes:y})=>{var w;if(this.socket.setAuth(),y===void 0){t?.(Ra.SUBSCRIBED);return}else{const x=this.bindings.postgres_changes,_=(w=x?.length)!==null&&w!==void 0?w:0,E=[];for(let k=0;k<_;k++){const b=x[k],{filter:{event:O,schema:z,table:L,filter:P}}=b,J=y&&y[k];if(J&&J.event===O&&J.schema===z&&J.table===L&&J.filter===P)E.push(Object.assign(Object.assign({},b),{id:J.id}));else{this.unsubscribe(),this.state=hr.errored,t?.(Ra.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=E,t&&t(Ra.SUBSCRIBED);return}}).receive("error",y=>{this.state=hr.errored,t?.(Ra.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(y).join(", ")||"error")))}).receive("timeout",()=>{t?.(Ra.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(t,r={}){return await this.send({type:"presence",event:"track",payload:t},r.timeout||this.timeout)}async untrack(t={}){return await this.send({type:"presence",event:"untrack"},t)}on(t,r,n){return this.state===hr.joined&&t===Ol.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(()=>this.subscribe())),this._on(t,r,n)}async httpSend(t,r,n={}){var a;const s=this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"";if(r==null)return Promise.reject("Payload is required for httpSend()");const i={method:"POST",headers:{Authorization:s,apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:t,payload:r,private:this.private}]})},c=await this._fetchWithTimeout(this.broadcastEndpointURL,i,(a=n.timeout)!==null&&a!==void 0?a:this.timeout);if(c.status===202)return{success:!0};let u=c.statusText;try{const f=await c.json();u=f.error||f.message||u}catch{}return Promise.reject(new Error(u))}async send(t,r={}){var n,a;if(!this._canPush()&&t.type==="broadcast"){console.warn("Realtime send() is automatically falling back to REST API. This behavior will be deprecated in the future. Please use httpSend() explicitly for REST delivery.");const{event:s,payload:i}=t,u={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:s,payload:i,private:this.private}]})};try{const f=await this._fetchWithTimeout(this.broadcastEndpointURL,u,(n=r.timeout)!==null&&n!==void 0?n:this.timeout);return await((a=f.body)===null||a===void 0?void 0:a.cancel()),f.ok?"ok":"error"}catch(f){return f.name==="AbortError"?"timed out":"error"}}else return new Promise(s=>{var i,c,u;const f=this._push(t.type,t,r.timeout||this.timeout);t.type==="broadcast"&&!(!((u=(c=(i=this.params)===null||i===void 0?void 0:i.config)===null||c===void 0?void 0:c.broadcast)===null||u===void 0)&&u.ack)&&s("ok"),f.receive("ok",()=>s("ok")),f.receive("error",()=>s("error")),f.receive("timeout",()=>s("timed out"))})}updateJoinPayload(t){this.joinPush.updatePayload(t)}unsubscribe(t=this.timeout){this.state=hr.leaving;const r=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(ta.close,"leave",this._joinRef())};this.joinPush.destroy();let n=null;return new Promise(a=>{n=new Nd(this,ta.leave,{},t),n.receive("ok",()=>{r(),a("ok")}).receive("timeout",()=>{r(),a("timed out")}).receive("error",()=>{a("error")}),n.send(),this._canPush()||n.trigger("ok",{})}).finally(()=>{n?.destroy()})}teardown(){this.pushBuffer.forEach(t=>t.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=hr.closed,this.bindings={}}async _fetchWithTimeout(t,r,n){const a=new AbortController,s=setTimeout(()=>a.abort(),n),i=await this.socket.fetch(t,Object.assign(Object.assign({},r),{signal:a.signal}));return clearTimeout(s),i}_push(t,r,n=this.timeout){if(!this.joinedOnce)throw`tried to push '${t}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let a=new Nd(this,t,r,n);return this._canPush()?a.send():this._addToPushBuffer(a),a}_addToPushBuffer(t){if(t.startTimeout(),this.pushBuffer.push(t),this.pushBuffer.length>cT){const r=this.pushBuffer.shift();r&&(r.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${r.event}`,r.payload))}}_onMessage(t,r,n){return r}_isMember(t){return this.topic===t}_joinRef(){return this.joinPush.ref}_trigger(t,r,n){var a,s;const i=t.toLocaleLowerCase(),{close:c,error:u,leave:f,join:h}=ta;if(n&&[c,u,f,h].indexOf(i)>=0&&n!==this._joinRef())return;let m=this._onMessage(i,r,n);if(r&&!m)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(i)?(a=this.bindings.postgres_changes)===null||a===void 0||a.filter(y=>{var w,x,_;return((w=y.filter)===null||w===void 0?void 0:w.event)==="*"||((_=(x=y.filter)===null||x===void 0?void 0:x.event)===null||_===void 0?void 0:_.toLocaleLowerCase())===i}).map(y=>y.callback(m,n)):(s=this.bindings[i])===null||s===void 0||s.filter(y=>{var w,x,_,E,k,b;if(["broadcast","presence","postgres_changes"].includes(i))if("id"in y){const O=y.id,z=(w=y.filter)===null||w===void 0?void 0:w.event;return O&&((x=r.ids)===null||x===void 0?void 0:x.includes(O))&&(z==="*"||z?.toLocaleLowerCase()===((_=r.data)===null||_===void 0?void 0:_.type.toLocaleLowerCase()))}else{const O=(k=(E=y?.filter)===null||E===void 0?void 0:E.event)===null||k===void 0?void 0:k.toLocaleLowerCase();return O==="*"||O===((b=r?.event)===null||b===void 0?void 0:b.toLocaleLowerCase())}else return y.type.toLocaleLowerCase()===i}).map(y=>{if(typeof m=="object"&&"ids"in m){const w=m.data,{schema:x,table:_,commit_timestamp:E,type:k,errors:b}=w;m=Object.assign(Object.assign({},{schema:x,table:_,commit_timestamp:E,eventType:k,new:{},old:{},errors:b}),this._getPayloadRecords(w))}y.callback(m,n)})}_isClosed(){return this.state===hr.closed}_isJoined(){return this.state===hr.joined}_isJoining(){return this.state===hr.joining}_isLeaving(){return this.state===hr.leaving}_replyEventName(t){return`chan_reply_${t}`}_on(t,r,n){const a=t.toLocaleLowerCase(),s={type:a,filter:r,callback:n};return this.bindings[a]?this.bindings[a].push(s):this.bindings[a]=[s],this}_off(t,r){const n=t.toLocaleLowerCase();return this.bindings[n]&&(this.bindings[n]=this.bindings[n].filter(a=>{var s;return!(((s=a.type)===null||s===void 0?void 0:s.toLocaleLowerCase())===n&&ag.isEqual(a.filter,r))})),this}static isEqual(t,r){if(Object.keys(t).length!==Object.keys(r).length)return!1;for(const n in t)if(t[n]!==r[n])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(t){this._on(ta.close,{},t)}_onError(t){this._on(ta.error,{},r=>t(r))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(t=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=hr.joining,this.joinPush.resend(t))}_getPayloadRecords(t){const r={new:{},old:{}};return(t.type==="INSERT"||t.type==="UPDATE")&&(r.new=uv(t.columns,t.record)),(t.type==="UPDATE"||t.type==="DELETE")&&(r.old=uv(t.columns,t.old_record)),r}}const Md=()=>{},$u={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},vT=[1e3,2e3,5e3,1e4],xT=1e4,yT=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class wT{constructor(t,r){var n;if(this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=xh,this.transport=null,this.heartbeatIntervalMs=$u.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=Md,this.ref=0,this.reconnectTimer=null,this.logger=Md,this.conn=null,this.sendBuffer=[],this.serializer=new uT,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=a=>{let s;return a?s=a:typeof fetch>"u"?s=(...i)=>Z(async()=>{const{default:c}=await Promise.resolve().then(()=>mo);return{default:c}},void 0).then(({default:c})=>c(...i)).catch(c=>{throw new Error(`Failed to load @supabase/node-fetch: ${c.message}. This is required for HTTP requests in Node.js environments without native fetch.`)}):s=fetch,(...i)=>s(...i)},!(!((n=r?.params)===null||n===void 0)&&n.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=r.params.apikey,this.endPoint=`${t}/${yh.websocket}`,this.httpEndpoint=Ky(t),this._initializeOptions(r),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(r?.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=aT.createWebSocket(this.endpointURL())}catch(t){this._setConnectionState("disconnected");const r=t.message;throw r.includes("Node.js")?new Error(`${r}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${r}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:iT}))}disconnect(t,r){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const n=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(n),this._setConnectionState("disconnected")},t?this.conn.close(t,r??""):this.conn.close(),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(t){const r=await t.unsubscribe();return this.channels.length===0&&this.disconnect(),r}async removeAllChannels(){const t=await Promise.all(this.channels.map(r=>r.unsubscribe()));return this.channels=[],this.disconnect(),t}log(t,r,n){this.logger(t,r,n)}connectionState(){switch(this.conn&&this.conn.readyState){case Pl.connecting:return Ys.Connecting;case Pl.open:return Ys.Open;case Pl.closing:return Ys.Closing;default:return Ys.Closed}}isConnected(){return this.connectionState()===Ys.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(t,r={config:{}}){const n=`realtime:${t}`,a=this.getChannels().find(s=>s.topic===n);if(a)return a;{const s=new ag(`realtime:${t}`,r,this);return this.channels.push(s),s}}push(t){const{topic:r,event:n,payload:a,ref:s}=t,i=()=>{this.encode(t,c=>{var u;(u=this.conn)===null||u===void 0||u.send(c)})};this.log("push",`${r} ${n} (${s})`,a),this.isConnected()?i():this.sendBuffer.push(i)}async setAuth(t=null){this._authPromise=this._performAuth(t);try{await this._authPromise}finally{this._authPromise=null}}async sendHeartbeat(){var t;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(r){this.log("error","error in heartbeat callback",r)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(r){this.log("error","error in heartbeat callback",r)}this._wasManualDisconnect=!1,(t=this.conn)===null||t===void 0||t.close(lT,"heartbeat timeout"),setTimeout(()=>{var r;this.isConnected()||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout()},$u.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(r){this.log("error","error in heartbeat callback",r)}this._setAuthSafely("heartbeat")}onHeartbeat(t){this.heartbeatCallback=t}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(t=>t()),this.sendBuffer=[])}_makeRef(){let t=this.ref+1;return t===this.ref?this.ref=0:this.ref=t,this.ref.toString()}_leaveOpenTopic(t){let r=this.channels.find(n=>n.topic===t&&(n._isJoined()||n._isJoining()));r&&(this.log("transport",`leaving duplicate topic "${t}"`),r.unsubscribe())}_remove(t){this.channels=this.channels.filter(r=>r.topic!==t.topic)}_onConnMessage(t){this.decode(t.data,r=>{if(r.topic==="phoenix"&&r.event==="phx_reply")try{this.heartbeatCallback(r.payload.status==="ok"?"ok":"error")}catch(f){this.log("error","error in heartbeat callback",f)}r.ref&&r.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:n,event:a,payload:s,ref:i}=r,c=i?`(${i})`:"",u=s.status||"";this.log("receive",`${u} ${n} ${a} ${c}`.trim(),s),this.channels.filter(f=>f._isMember(n)).forEach(f=>f._trigger(a,s,i)),this._triggerStateCallbacks("message",r)})}_clearTimer(t){var r;t==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):t==="reconnect"&&((r=this.reconnectTimer)===null||r===void 0||r.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=t=>this._onConnError(t),this.conn.onmessage=t=>this._onConnMessage(t),this.conn.onclose=t=>this._onConnClose(t))}_teardownConnection(){this.conn&&(this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null),this._clearAllTimers(),this.channels.forEach(t=>t.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const t=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(t),this.workerRef.onerror=r=>{this.log("worker","worker error",r.message),this.workerRef.terminate()},this.workerRef.onmessage=r=>{r.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(t){var r;this._setConnectionState("disconnected"),this.log("transport","close",t),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout(),this._triggerStateCallbacks("close",t)}_onConnError(t){this._setConnectionState("disconnected"),this.log("transport",`${t}`),this._triggerChanError(),this._triggerStateCallbacks("error",t)}_triggerChanError(){this.channels.forEach(t=>t._trigger(ta.error))}_appendParams(t,r){if(Object.keys(r).length===0)return t;const n=t.match(/\?/)?"&":"?",a=new URLSearchParams(r);return`${t}${n}${a}`}_workerObjectUrl(t){let r;if(t)r=t;else{const n=new Blob([yT],{type:"application/javascript"});r=URL.createObjectURL(n)}return r}_setConnectionState(t,r=!1){this._connectionState=t,t==="connecting"?this._wasManualDisconnect=!1:t==="disconnecting"&&(this._wasManualDisconnect=r)}async _performAuth(t=null){let r;t?r=t:this.accessToken?r=await this.accessToken():r=this.accessTokenValue,this.accessTokenValue!=r&&(this.accessTokenValue=r,this.channels.forEach(n=>{const a={access_token:r,version:oT};r&&n.updateJoinPayload(a),n.joinedOnce&&n._isJoined()&&n._push(ta.access_token,{access_token:r})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(t="general"){this.setAuth().catch(r=>{this.log("error",`error setting auth in ${t}`,r)})}_triggerStateCallbacks(t,r){try{this.stateChangeCallbacks[t].forEach(n=>{try{n(r)}catch(a){this.log("error",`error in ${t} callback`,a)}})}catch(n){this.log("error",`error triggering ${t} callbacks`,n)}}_setupReconnectionTimer(){this.reconnectTimer=new Gy(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},$u.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(t){var r,n,a,s,i,c,u,f,h;if(this.transport=(r=t?.transport)!==null&&r!==void 0?r:null,this.timeout=(n=t?.timeout)!==null&&n!==void 0?n:xh,this.heartbeatIntervalMs=(a=t?.heartbeatIntervalMs)!==null&&a!==void 0?a:$u.HEARTBEAT_INTERVAL,this.worker=(s=t?.worker)!==null&&s!==void 0?s:!1,this.accessToken=(i=t?.accessToken)!==null&&i!==void 0?i:null,this.heartbeatCallback=(c=t?.heartbeatCallback)!==null&&c!==void 0?c:Md,t?.params&&(this.params=t.params),t?.logger&&(this.logger=t.logger),(t?.logLevel||t?.log_level)&&(this.logLevel=t.logLevel||t.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(u=t?.reconnectAfterMs)!==null&&u!==void 0?u:(p=>vT[p-1]||xT),this.encode=(f=t?.encode)!==null&&f!==void 0?f:((p,m)=>m(JSON.stringify(p))),this.decode=(h=t?.decode)!==null&&h!==void 0?h:this.serializer.decode.bind(this.serializer),this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=t?.workerUrl}}}function Ue(e,t,r,n){function a(s){return s instanceof r?s:new r(function(i){i(s)})}return new(r||(r=Promise))(function(s,i){function c(h){try{f(n.next(h))}catch(p){i(p)}}function u(h){try{f(n.throw(h))}catch(p){i(p)}}function f(h){h.done?s(h.value):a(h.value).then(c,u)}f((n=n.apply(e,t||[])).next())})}class sg extends Error{constructor(t){super(t),this.__isStorageError=!0,this.name="StorageError"}}function Ut(e){return typeof e=="object"&&e!==null&&"__isStorageError"in e}class _T extends sg{constructor(t,r,n){super(t),this.name="StorageApiError",this.status=r,this.statusCode=n}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class _h extends sg{constructor(t,r){super(t),this.name="StorageUnknownError",this.originalError=r}}const og=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...r)=>Z(async()=>{const{default:n}=await Promise.resolve().then(()=>mo);return{default:n}},void 0).then(({default:n})=>n(...r)):t=fetch,(...r)=>t(...r)},ST=()=>Ue(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield Z(()=>Promise.resolve().then(()=>mo),void 0)).Response:Response}),Sh=e=>{if(Array.isArray(e))return e.map(r=>Sh(r));if(typeof e=="function"||e!==Object(e))return e;const t={};return Object.entries(e).forEach(([r,n])=>{const a=r.replace(/([-_][a-z])/gi,s=>s.toUpperCase().replace(/[-_]/g,""));t[a]=Sh(n)}),t},ET=e=>{if(typeof e!="object"||e===null)return!1;const t=Object.getPrototypeOf(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)},Bd=e=>{var t;return e.msg||e.message||e.error_description||(typeof e.error=="string"?e.error:(t=e.error)===null||t===void 0?void 0:t.message)||JSON.stringify(e)},bT=(e,t,r)=>Ue(void 0,void 0,void 0,function*(){const n=yield ST();e instanceof n&&!r?.noResolveJson?e.json().then(a=>{const s=e.status||500,i=a?.statusCode||s+"";t(new _T(Bd(a),s,i))}).catch(a=>{t(new _h(Bd(a),a))}):t(new _h(Bd(e),e))}),kT=(e,t,r,n)=>{const a={method:e,headers:t?.headers||{}};return e==="GET"||!n?a:(ET(n)?(a.headers=Object.assign({"Content-Type":"application/json"},t?.headers),a.body=JSON.stringify(n)):a.body=n,t?.duplex&&(a.duplex=t.duplex),Object.assign(Object.assign({},a),r))};function fc(e,t,r,n,a,s){return Ue(this,void 0,void 0,function*(){return new Promise((i,c)=>{e(r,kT(t,n,a,s)).then(u=>{if(!u.ok)throw u;return n?.noResolveJson?u:u.json()}).then(u=>i(u)).catch(u=>bT(u,c,n))})})}function zl(e,t,r,n){return Ue(this,void 0,void 0,function*(){return fc(e,"GET",t,r,n)})}function ea(e,t,r,n,a){return Ue(this,void 0,void 0,function*(){return fc(e,"POST",t,n,a,r)})}function Eh(e,t,r,n,a){return Ue(this,void 0,void 0,function*(){return fc(e,"PUT",t,n,a,r)})}function TT(e,t,r,n){return Ue(this,void 0,void 0,function*(){return fc(e,"HEAD",t,Object.assign(Object.assign({},r),{noResolveJson:!0}),n)})}function ig(e,t,r,n,a){return Ue(this,void 0,void 0,function*(){return fc(e,"DELETE",t,n,a,r)})}class CT{constructor(t,r){this.downloadFn=t,this.shouldThrowOnError=r}then(t,r){return this.execute().then(t,r)}execute(){return Ue(this,void 0,void 0,function*(){try{return{data:(yield this.downloadFn()).body,error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(Ut(t))return{data:null,error:t};throw t}})}}var Xy;class AT{constructor(t,r){this.downloadFn=t,this.shouldThrowOnError=r,this[Xy]="BlobDownloadBuilder",this.promise=null}asStream(){return new CT(this.downloadFn,this.shouldThrowOnError)}then(t,r){return this.getPromise().then(t,r)}catch(t){return this.getPromise().catch(t)}finally(t){return this.getPromise().finally(t)}getPromise(){return this.promise||(this.promise=this.execute()),this.promise}execute(){return Ue(this,void 0,void 0,function*(){try{return{data:yield(yield this.downloadFn()).blob(),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(Ut(t))return{data:null,error:t};throw t}})}}Xy=Symbol.toStringTag;const PT={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},hv={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class IT{constructor(t,r={},n,a){this.shouldThrowOnError=!1,this.url=t,this.headers=r,this.bucketId=n,this.fetch=og(a)}throwOnError(){return this.shouldThrowOnError=!0,this}uploadOrUpdate(t,r,n,a){return Ue(this,void 0,void 0,function*(){try{let s;const i=Object.assign(Object.assign({},hv),a);let c=Object.assign(Object.assign({},this.headers),t==="POST"&&{"x-upsert":String(i.upsert)});const u=i.metadata;typeof Blob<"u"&&n instanceof Blob?(s=new FormData,s.append("cacheControl",i.cacheControl),u&&s.append("metadata",this.encodeMetadata(u)),s.append("",n)):typeof FormData<"u"&&n instanceof FormData?(s=n,s.append("cacheControl",i.cacheControl),u&&s.append("metadata",this.encodeMetadata(u))):(s=n,c["cache-control"]=`max-age=${i.cacheControl}`,c["content-type"]=i.contentType,u&&(c["x-metadata"]=this.toBase64(this.encodeMetadata(u)))),a?.headers&&(c=Object.assign(Object.assign({},c),a.headers));const f=this._removeEmptyFolders(r),h=this._getFinalPath(f),p=yield(t=="PUT"?Eh:ea)(this.fetch,`${this.url}/object/${h}`,s,Object.assign({headers:c},i?.duplex?{duplex:i.duplex}:{}));return{data:{path:f,id:p.Id,fullPath:p.Key},error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(Ut(s))return{data:null,error:s};throw s}})}upload(t,r,n){return Ue(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",t,r,n)})}uploadToSignedUrl(t,r,n,a){return Ue(this,void 0,void 0,function*(){const s=this._removeEmptyFolders(t),i=this._getFinalPath(s),c=new URL(this.url+`/object/upload/sign/${i}`);c.searchParams.set("token",r);try{let u;const f=Object.assign({upsert:hv.upsert},a),h=Object.assign(Object.assign({},this.headers),{"x-upsert":String(f.upsert)});typeof Blob<"u"&&n instanceof Blob?(u=new FormData,u.append("cacheControl",f.cacheControl),u.append("",n)):typeof FormData<"u"&&n instanceof FormData?(u=n,u.append("cacheControl",f.cacheControl)):(u=n,h["cache-control"]=`max-age=${f.cacheControl}`,h["content-type"]=f.contentType);const p=yield Eh(this.fetch,c.toString(),u,{headers:h});return{data:{path:s,fullPath:p.Key},error:null}}catch(u){if(this.shouldThrowOnError)throw u;if(Ut(u))return{data:null,error:u};throw u}})}createSignedUploadUrl(t,r){return Ue(this,void 0,void 0,function*(){try{let n=this._getFinalPath(t);const a=Object.assign({},this.headers);r?.upsert&&(a["x-upsert"]="true");const s=yield ea(this.fetch,`${this.url}/object/upload/sign/${n}`,{},{headers:a}),i=new URL(this.url+s.url),c=i.searchParams.get("token");if(!c)throw new sg("No token returned by API");return{data:{signedUrl:i.toString(),path:t,token:c},error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Ut(n))return{data:null,error:n};throw n}})}update(t,r,n){return Ue(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",t,r,n)})}move(t,r,n){return Ue(this,void 0,void 0,function*(){try{return{data:yield ea(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:t,destinationKey:r,destinationBucket:n?.destinationBucket},{headers:this.headers}),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(Ut(a))return{data:null,error:a};throw a}})}copy(t,r,n){return Ue(this,void 0,void 0,function*(){try{return{data:{path:(yield ea(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:t,destinationKey:r,destinationBucket:n?.destinationBucket},{headers:this.headers})).Key},error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(Ut(a))return{data:null,error:a};throw a}})}createSignedUrl(t,r,n){return Ue(this,void 0,void 0,function*(){try{let a=this._getFinalPath(t),s=yield ea(this.fetch,`${this.url}/object/sign/${a}`,Object.assign({expiresIn:r},n?.transform?{transform:n.transform}:{}),{headers:this.headers});const i=n?.download?`&download=${n.download===!0?"":n.download}`:"";return s={signedUrl:encodeURI(`${this.url}${s.signedURL}${i}`)},{data:s,error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(Ut(a))return{data:null,error:a};throw a}})}createSignedUrls(t,r,n){return Ue(this,void 0,void 0,function*(){try{const a=yield ea(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:r,paths:t},{headers:this.headers}),s=n?.download?`&download=${n.download===!0?"":n.download}`:"";return{data:a.map(i=>Object.assign(Object.assign({},i),{signedUrl:i.signedURL?encodeURI(`${this.url}${i.signedURL}${s}`):null})),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(Ut(a))return{data:null,error:a};throw a}})}download(t,r){const a=typeof r?.transform<"u"?"render/image/authenticated":"object",s=this.transformOptsToQueryString(r?.transform||{}),i=s?`?${s}`:"",c=this._getFinalPath(t),u=()=>zl(this.fetch,`${this.url}/${a}/${c}${i}`,{headers:this.headers,noResolveJson:!0});return new AT(u,this.shouldThrowOnError)}info(t){return Ue(this,void 0,void 0,function*(){const r=this._getFinalPath(t);try{const n=yield zl(this.fetch,`${this.url}/object/info/${r}`,{headers:this.headers});return{data:Sh(n),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Ut(n))return{data:null,error:n};throw n}})}exists(t){return Ue(this,void 0,void 0,function*(){const r=this._getFinalPath(t);try{return yield TT(this.fetch,`${this.url}/object/${r}`,{headers:this.headers}),{data:!0,error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Ut(n)&&n instanceof _h){const a=n.originalError;if([400,404].includes(a?.status))return{data:!1,error:n}}throw n}})}getPublicUrl(t,r){const n=this._getFinalPath(t),a=[],s=r?.download?`download=${r.download===!0?"":r.download}`:"";s!==""&&a.push(s);const c=typeof r?.transform<"u"?"render/image":"object",u=this.transformOptsToQueryString(r?.transform||{});u!==""&&a.push(u);let f=a.join("&");return f!==""&&(f=`?${f}`),{data:{publicUrl:encodeURI(`${this.url}/${c}/public/${n}${f}`)}}}remove(t){return Ue(this,void 0,void 0,function*(){try{return{data:yield ig(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:t},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Ut(r))return{data:null,error:r};throw r}})}list(t,r,n){return Ue(this,void 0,void 0,function*(){try{const a=Object.assign(Object.assign(Object.assign({},PT),r),{prefix:t||""});return{data:yield ea(this.fetch,`${this.url}/object/list/${this.bucketId}`,a,{headers:this.headers},n),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(Ut(a))return{data:null,error:a};throw a}})}listV2(t,r){return Ue(this,void 0,void 0,function*(){try{const n=Object.assign({},t);return{data:yield ea(this.fetch,`${this.url}/object/list-v2/${this.bucketId}`,n,{headers:this.headers},r),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Ut(n))return{data:null,error:n};throw n}})}encodeMetadata(t){return JSON.stringify(t)}toBase64(t){return typeof Buffer<"u"?Buffer.from(t).toString("base64"):btoa(t)}_getFinalPath(t){return`${this.bucketId}/${t.replace(/^\/+/,"")}`}_removeEmptyFolders(t){return t.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(t){const r=[];return t.width&&r.push(`width=${t.width}`),t.height&&r.push(`height=${t.height}`),t.resize&&r.push(`resize=${t.resize}`),t.format&&r.push(`format=${t.format}`),t.quality&&r.push(`quality=${t.quality}`),r.join("&")}}const Jy="2.78.0",Yy={"X-Client-Info":`storage-js/${Jy}`};class OT{constructor(t,r={},n,a){this.shouldThrowOnError=!1;const s=new URL(t);a?.useNewHostname&&/supabase\.(co|in|red)$/.test(s.hostname)&&!s.hostname.includes("storage.supabase.")&&(s.hostname=s.hostname.replace("supabase.","storage.supabase.")),this.url=s.href.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},Yy),r),this.fetch=og(n)}throwOnError(){return this.shouldThrowOnError=!0,this}listBuckets(t){return Ue(this,void 0,void 0,function*(){try{const r=this.listBucketOptionsToQueryString(t);return{data:yield zl(this.fetch,`${this.url}/bucket${r}`,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Ut(r))return{data:null,error:r};throw r}})}getBucket(t){return Ue(this,void 0,void 0,function*(){try{return{data:yield zl(this.fetch,`${this.url}/bucket/${t}`,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Ut(r))return{data:null,error:r};throw r}})}createBucket(t){return Ue(this,arguments,void 0,function*(r,n={public:!1}){try{return{data:yield ea(this.fetch,`${this.url}/bucket`,{id:r,name:r,type:n.type,public:n.public,file_size_limit:n.fileSizeLimit,allowed_mime_types:n.allowedMimeTypes},{headers:this.headers}),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(Ut(a))return{data:null,error:a};throw a}})}updateBucket(t,r){return Ue(this,void 0,void 0,function*(){try{return{data:yield Eh(this.fetch,`${this.url}/bucket/${t}`,{id:t,name:t,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Ut(n))return{data:null,error:n};throw n}})}emptyBucket(t){return Ue(this,void 0,void 0,function*(){try{return{data:yield ea(this.fetch,`${this.url}/bucket/${t}/empty`,{},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Ut(r))return{data:null,error:r};throw r}})}deleteBucket(t){return Ue(this,void 0,void 0,function*(){try{return{data:yield ig(this.fetch,`${this.url}/bucket/${t}`,{},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Ut(r))return{data:null,error:r};throw r}})}listBucketOptionsToQueryString(t){const r={};return t&&("limit"in t&&(r.limit=String(t.limit)),"offset"in t&&(r.offset=String(t.offset)),t.search&&(r.search=t.search),t.sortColumn&&(r.sortColumn=t.sortColumn),t.sortOrder&&(r.sortOrder=t.sortOrder)),Object.keys(r).length>0?"?"+new URLSearchParams(r).toString():""}}class DT{constructor(t,r={},n){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},Yy),r),this.fetch=og(n)}throwOnError(){return this.shouldThrowOnError=!0,this}createBucket(t){return Ue(this,void 0,void 0,function*(){try{return{data:yield ea(this.fetch,`${this.url}/bucket`,{name:t},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Ut(r))return{data:null,error:r};throw r}})}listBuckets(t){return Ue(this,void 0,void 0,function*(){try{const r=new URLSearchParams;t?.limit!==void 0&&r.set("limit",t.limit.toString()),t?.offset!==void 0&&r.set("offset",t.offset.toString()),t?.sortColumn&&r.set("sortColumn",t.sortColumn),t?.sortOrder&&r.set("sortOrder",t.sortOrder),t?.search&&r.set("search",t.search);const n=r.toString(),a=n?`${this.url}/bucket?${n}`:`${this.url}/bucket`;return{data:yield zl(this.fetch,a,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Ut(r))return{data:null,error:r};throw r}})}deleteBucket(t){return Ue(this,void 0,void 0,function*(){try{return{data:yield ig(this.fetch,`${this.url}/bucket/${t}`,{},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Ut(r))return{data:null,error:r};throw r}})}}const lg={"X-Client-Info":`storage-js/${Jy}`,"Content-Type":"application/json"};class Qy extends Error{constructor(t){super(t),this.__isStorageVectorsError=!0,this.name="StorageVectorsError"}}function _n(e){return typeof e=="object"&&e!==null&&"__isStorageVectorsError"in e}class jd extends Qy{constructor(t,r,n){super(t),this.name="StorageVectorsApiError",this.status=r,this.statusCode=n}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class FT extends Qy{constructor(t,r){super(t),this.name="StorageVectorsUnknownError",this.originalError=r}}var gv;(function(e){e.InternalError="InternalError",e.S3VectorConflictException="S3VectorConflictException",e.S3VectorNotFoundException="S3VectorNotFoundException",e.S3VectorBucketNotEmpty="S3VectorBucketNotEmpty",e.S3VectorMaxBucketsExceeded="S3VectorMaxBucketsExceeded",e.S3VectorMaxIndexesExceeded="S3VectorMaxIndexesExceeded"})(gv||(gv={}));const cg=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...r)=>Z(async()=>{const{default:n}=await Promise.resolve().then(()=>mo);return{default:n}},void 0).then(({default:n})=>n(...r)):t=fetch,(...r)=>t(...r)},RT=e=>{if(typeof e!="object"||e===null)return!1;const t=Object.getPrototypeOf(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)},pv=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),LT=(e,t,r)=>Ue(void 0,void 0,void 0,function*(){if(e&&typeof e=="object"&&"status"in e&&"ok"in e&&typeof e.status=="number"&&!r?.noResolveJson){const a=e.status||500,s=e;if(typeof s.json=="function")s.json().then(i=>{const c=i?.statusCode||i?.code||a+"";t(new jd(pv(i),a,c))}).catch(()=>{const i=a+"",c=s.statusText||`HTTP ${a} error`;t(new jd(c,a,i))});else{const i=a+"",c=s.statusText||`HTTP ${a} error`;t(new jd(c,a,i))}}else t(new FT(pv(e),e))}),NT=(e,t,r,n)=>{const a={method:e,headers:t?.headers||{}};return n?(RT(n)?(a.headers=Object.assign({"Content-Type":"application/json"},t?.headers),a.body=JSON.stringify(n)):a.body=n,Object.assign(Object.assign({},a),r)):a};function MT(e,t,r,n,a,s){return Ue(this,void 0,void 0,function*(){return new Promise((i,c)=>{e(r,NT(t,n,a,s)).then(u=>{if(!u.ok)throw u;if(n?.noResolveJson)return u;const f=u.headers.get("content-type");return!f||!f.includes("application/json")?{}:u.json()}).then(u=>i(u)).catch(u=>LT(u,c,n))})})}function Sn(e,t,r,n,a){return Ue(this,void 0,void 0,function*(){return MT(e,"POST",t,n,a,r)})}class BT{constructor(t,r={},n){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},lg),r),this.fetch=cg(n)}throwOnError(){return this.shouldThrowOnError=!0,this}createIndex(t){return Ue(this,void 0,void 0,function*(){try{return{data:(yield Sn(this.fetch,`${this.url}/CreateIndex`,t,{headers:this.headers}))||{},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(_n(r))return{data:null,error:r};throw r}})}getIndex(t,r){return Ue(this,void 0,void 0,function*(){try{return{data:yield Sn(this.fetch,`${this.url}/GetIndex`,{vectorBucketName:t,indexName:r},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(_n(n))return{data:null,error:n};throw n}})}listIndexes(t){return Ue(this,void 0,void 0,function*(){try{return{data:yield Sn(this.fetch,`${this.url}/ListIndexes`,t,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(_n(r))return{data:null,error:r};throw r}})}deleteIndex(t,r){return Ue(this,void 0,void 0,function*(){try{return{data:(yield Sn(this.fetch,`${this.url}/DeleteIndex`,{vectorBucketName:t,indexName:r},{headers:this.headers}))||{},error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(_n(n))return{data:null,error:n};throw n}})}}class jT{constructor(t,r={},n){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},lg),r),this.fetch=cg(n)}throwOnError(){return this.shouldThrowOnError=!0,this}putVectors(t){return Ue(this,void 0,void 0,function*(){try{if(t.vectors.length<1||t.vectors.length>500)throw new Error("Vector batch size must be between 1 and 500 items");return{data:(yield Sn(this.fetch,`${this.url}/PutVectors`,t,{headers:this.headers}))||{},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(_n(r))return{data:null,error:r};throw r}})}getVectors(t){return Ue(this,void 0,void 0,function*(){try{return{data:yield Sn(this.fetch,`${this.url}/GetVectors`,t,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(_n(r))return{data:null,error:r};throw r}})}listVectors(t){return Ue(this,void 0,void 0,function*(){try{if(t.segmentCount!==void 0){if(t.segmentCount<1||t.segmentCount>16)throw new Error("segmentCount must be between 1 and 16");if(t.segmentIndex!==void 0&&(t.segmentIndex<0||t.segmentIndex>=t.segmentCount))throw new Error(`segmentIndex must be between 0 and ${t.segmentCount-1}`)}return{data:yield Sn(this.fetch,`${this.url}/ListVectors`,t,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(_n(r))return{data:null,error:r};throw r}})}queryVectors(t){return Ue(this,void 0,void 0,function*(){try{return{data:yield Sn(this.fetch,`${this.url}/QueryVectors`,t,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(_n(r))return{data:null,error:r};throw r}})}deleteVectors(t){return Ue(this,void 0,void 0,function*(){try{if(t.keys.length<1||t.keys.length>500)throw new Error("Keys batch size must be between 1 and 500 items");return{data:(yield Sn(this.fetch,`${this.url}/DeleteVectors`,t,{headers:this.headers}))||{},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(_n(r))return{data:null,error:r};throw r}})}}class $T{constructor(t,r={},n){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},lg),r),this.fetch=cg(n)}throwOnError(){return this.shouldThrowOnError=!0,this}createBucket(t){return Ue(this,void 0,void 0,function*(){try{return{data:(yield Sn(this.fetch,`${this.url}/CreateVectorBucket`,{vectorBucketName:t},{headers:this.headers}))||{},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(_n(r))return{data:null,error:r};throw r}})}getBucket(t){return Ue(this,void 0,void 0,function*(){try{return{data:yield Sn(this.fetch,`${this.url}/GetVectorBucket`,{vectorBucketName:t},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(_n(r))return{data:null,error:r};throw r}})}listBuckets(){return Ue(this,arguments,void 0,function*(t={}){try{return{data:yield Sn(this.fetch,`${this.url}/ListVectorBuckets`,t,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(_n(r))return{data:null,error:r};throw r}})}deleteBucket(t){return Ue(this,void 0,void 0,function*(){try{return{data:(yield Sn(this.fetch,`${this.url}/DeleteVectorBucket`,{vectorBucketName:t},{headers:this.headers}))||{},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(_n(r))return{data:null,error:r};throw r}})}}class UT extends $T{constructor(t,r={}){super(t,r.headers||{},r.fetch)}from(t){return new zT(this.url,this.headers,t,this.fetch)}}class zT extends BT{constructor(t,r,n,a){super(t,r,a),this.vectorBucketName=n}createIndex(t){const r=Object.create(null,{createIndex:{get:()=>super.createIndex}});return Ue(this,void 0,void 0,function*(){return r.createIndex.call(this,Object.assign(Object.assign({},t),{vectorBucketName:this.vectorBucketName}))})}listIndexes(){const t=Object.create(null,{listIndexes:{get:()=>super.listIndexes}});return Ue(this,arguments,void 0,function*(r={}){return t.listIndexes.call(this,Object.assign(Object.assign({},r),{vectorBucketName:this.vectorBucketName}))})}getIndex(t){const r=Object.create(null,{getIndex:{get:()=>super.getIndex}});return Ue(this,void 0,void 0,function*(){return r.getIndex.call(this,this.vectorBucketName,t)})}deleteIndex(t){const r=Object.create(null,{deleteIndex:{get:()=>super.deleteIndex}});return Ue(this,void 0,void 0,function*(){return r.deleteIndex.call(this,this.vectorBucketName,t)})}index(t){return new VT(this.url,this.headers,this.vectorBucketName,t,this.fetch)}}class VT extends jT{constructor(t,r,n,a,s){super(t,r,s),this.vectorBucketName=n,this.indexName=a}putVectors(t){const r=Object.create(null,{putVectors:{get:()=>super.putVectors}});return Ue(this,void 0,void 0,function*(){return r.putVectors.call(this,Object.assign(Object.assign({},t),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}getVectors(t){const r=Object.create(null,{getVectors:{get:()=>super.getVectors}});return Ue(this,void 0,void 0,function*(){return r.getVectors.call(this,Object.assign(Object.assign({},t),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}listVectors(){const t=Object.create(null,{listVectors:{get:()=>super.listVectors}});return Ue(this,arguments,void 0,function*(r={}){return t.listVectors.call(this,Object.assign(Object.assign({},r),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}queryVectors(t){const r=Object.create(null,{queryVectors:{get:()=>super.queryVectors}});return Ue(this,void 0,void 0,function*(){return r.queryVectors.call(this,Object.assign(Object.assign({},t),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}deleteVectors(t){const r=Object.create(null,{deleteVectors:{get:()=>super.deleteVectors}});return Ue(this,void 0,void 0,function*(){return r.deleteVectors.call(this,Object.assign(Object.assign({},t),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}}class WT extends OT{constructor(t,r={},n,a){super(t,r,n,a)}from(t){return new IT(this.url,this.headers,t,this.fetch)}get vectors(){return new UT(this.url+"/vector",{headers:this.headers,fetch:this.fetch})}get analytics(){return new DT(this.url+"/iceberg",this.headers,this.fetch)}}const HT="2.78.0";let bl="";typeof Deno<"u"?bl="deno":typeof document<"u"?bl="web":typeof navigator<"u"&&navigator.product==="ReactNative"?bl="react-native":bl="node";const GT={"X-Client-Info":`supabase-js-${bl}/${HT}`},qT={headers:GT},KT={schema:"public"},XT={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},JT={},YT=e=>{let t;return e?t=e:typeof fetch>"u"?t=By:t=fetch,(...r)=>t(...r)},QT=()=>typeof Headers>"u"?jy:Headers,ZT=(e,t,r)=>{const n=YT(r),a=QT();return async(s,i)=>{var c;const u=(c=await t())!==null&&c!==void 0?c:e;let f=new a(i?.headers);return f.has("apikey")||f.set("apikey",e),f.has("Authorization")||f.set("Authorization",`Bearer ${u}`),n(s,Object.assign(Object.assign({},i),{headers:f}))}};function eC(e){return e.endsWith("/")?e:e+"/"}function tC(e,t){var r,n;const{db:a,auth:s,realtime:i,global:c}=e,{db:u,auth:f,realtime:h,global:p}=t,m={db:Object.assign(Object.assign({},u),a),auth:Object.assign(Object.assign({},f),s),realtime:Object.assign(Object.assign({},h),i),storage:{},global:Object.assign(Object.assign(Object.assign({},p),c),{headers:Object.assign(Object.assign({},(r=p?.headers)!==null&&r!==void 0?r:{}),(n=c?.headers)!==null&&n!==void 0?n:{})}),accessToken:async()=>""};return e.accessToken?m.accessToken=e.accessToken:delete m.accessToken,m}function rC(e){const t=e?.trim();if(!t)throw new Error("supabaseUrl is required.");if(!t.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(eC(t))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}function Of(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(r[n[a]]=e[n[a]]);return r}const Zy="2.78.0",oi=30*1e3,bh=3,$d=bh*oi,nC="http://localhost:9999",aC="supabase.auth.token",sC={"X-Client-Info":`gotrue-js/${Zy}`},kh="X-Supabase-Api-Version",ew={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},oC=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,iC=600*1e3;class Vl extends Error{constructor(t,r,n){super(t),this.__isAuthError=!0,this.name="AuthError",this.status=r,this.code=n}}function ze(e){return typeof e=="object"&&e!==null&&"__isAuthError"in e}class lC extends Vl{constructor(t,r,n){super(t,r,n),this.name="AuthApiError",this.status=r,this.code=n}}function cC(e){return ze(e)&&e.name==="AuthApiError"}class Qs extends Vl{constructor(t,r){super(t),this.name="AuthUnknownError",this.originalError=r}}class Cs extends Vl{constructor(t,r,n,a){super(t,n,a),this.name=r,this.status=n}}class Qn extends Cs{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function uC(e){return ze(e)&&e.name==="AuthSessionMissingError"}class Yo extends Cs{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class Uu extends Cs{constructor(t){super(t,"AuthInvalidCredentialsError",400,void 0)}}class zu extends Cs{constructor(t,r=null){super(t,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function fC(e){return ze(e)&&e.name==="AuthImplicitGrantRedirectError"}class mv extends Cs{constructor(t,r=null){super(t,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class Th extends Cs{constructor(t,r){super(t,"AuthRetryableFetchError",r,void 0)}}function Ud(e){return ze(e)&&e.name==="AuthRetryableFetchError"}class vv extends Cs{constructor(t,r,n){super(t,"AuthWeakPasswordError",r,"weak_password"),this.reasons=n}}class Ch extends Cs{constructor(t){super(t,"AuthInvalidJwtError",400,"invalid_jwt")}}const uf="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),xv=` 	
\r=`.split(""),dC=(()=>{const e=new Array(128);for(let t=0;t<e.length;t+=1)e[t]=-1;for(let t=0;t<xv.length;t+=1)e[xv[t].charCodeAt(0)]=-2;for(let t=0;t<uf.length;t+=1)e[uf[t].charCodeAt(0)]=t;return e})();function yv(e,t,r){if(e!==null)for(t.queue=t.queue<<8|e,t.queuedBits+=8;t.queuedBits>=6;){const n=t.queue>>t.queuedBits-6&63;r(uf[n]),t.queuedBits-=6}else if(t.queuedBits>0)for(t.queue=t.queue<<6-t.queuedBits,t.queuedBits=6;t.queuedBits>=6;){const n=t.queue>>t.queuedBits-6&63;r(uf[n]),t.queuedBits-=6}}function tw(e,t,r){const n=dC[e];if(n>-1)for(t.queue=t.queue<<6|n,t.queuedBits+=6;t.queuedBits>=8;)r(t.queue>>t.queuedBits-8&255),t.queuedBits-=8;else{if(n===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(e)}"`)}}function wv(e){const t=[],r=i=>{t.push(String.fromCodePoint(i))},n={utf8seq:0,codepoint:0},a={queue:0,queuedBits:0},s=i=>{pC(i,n,r)};for(let i=0;i<e.length;i+=1)tw(e.charCodeAt(i),a,s);return t.join("")}function hC(e,t){if(e<=127){t(e);return}else if(e<=2047){t(192|e>>6),t(128|e&63);return}else if(e<=65535){t(224|e>>12),t(128|e>>6&63),t(128|e&63);return}else if(e<=1114111){t(240|e>>18),t(128|e>>12&63),t(128|e>>6&63),t(128|e&63);return}throw new Error(`Unrecognized Unicode codepoint: ${e.toString(16)}`)}function gC(e,t){for(let r=0;r<e.length;r+=1){let n=e.charCodeAt(r);if(n>55295&&n<=56319){const a=(n-55296)*1024&65535;n=(e.charCodeAt(r+1)-56320&65535|a)+65536,r+=1}hC(n,t)}}function pC(e,t,r){if(t.utf8seq===0){if(e<=127){r(e);return}for(let n=1;n<6;n+=1)if((e>>7-n&1)===0){t.utf8seq=n;break}if(t.utf8seq===2)t.codepoint=e&31;else if(t.utf8seq===3)t.codepoint=e&15;else if(t.utf8seq===4)t.codepoint=e&7;else throw new Error("Invalid UTF-8 sequence");t.utf8seq-=1}else if(t.utf8seq>0){if(e<=127)throw new Error("Invalid UTF-8 sequence");t.codepoint=t.codepoint<<6|e&63,t.utf8seq-=1,t.utf8seq===0&&r(t.codepoint)}}function ui(e){const t=[],r={queue:0,queuedBits:0},n=a=>{t.push(a)};for(let a=0;a<e.length;a+=1)tw(e.charCodeAt(a),r,n);return new Uint8Array(t)}function mC(e){const t=[];return gC(e,r=>t.push(r)),new Uint8Array(t)}function eo(e){const t=[],r={queue:0,queuedBits:0},n=a=>{t.push(a)};return e.forEach(a=>yv(a,r,n)),yv(null,r,n),t.join("")}function vC(e){return Math.round(Date.now()/1e3)+e}function xC(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){const t=Math.random()*16|0;return(e=="x"?t:t&3|8).toString(16)})}const Yr=()=>typeof window<"u"&&typeof document<"u",qs={tested:!1,writable:!1},rw=()=>{if(!Yr())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(qs.tested)return qs.writable;const e=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(e,e),globalThis.localStorage.removeItem(e),qs.tested=!0,qs.writable=!0}catch{qs.tested=!0,qs.writable=!1}return qs.writable};function yC(e){const t={},r=new URL(e);if(r.hash&&r.hash[0]==="#")try{new URLSearchParams(r.hash.substring(1)).forEach((a,s)=>{t[s]=a})}catch{}return r.searchParams.forEach((n,a)=>{t[a]=n}),t}const nw=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...r)=>Z(async()=>{const{default:n}=await Promise.resolve().then(()=>mo);return{default:n}},void 0).then(({default:n})=>n(...r)):t=fetch,(...r)=>t(...r)},wC=e=>typeof e=="object"&&e!==null&&"status"in e&&"ok"in e&&"json"in e&&typeof e.json=="function",ii=async(e,t,r)=>{await e.setItem(t,JSON.stringify(r))},Ks=async(e,t)=>{const r=await e.getItem(t);if(!r)return null;try{return JSON.parse(r)}catch{return r}},ps=async(e,t)=>{await e.removeItem(t)};class Df{constructor(){this.promise=new Df.promiseConstructor((t,r)=>{this.resolve=t,this.reject=r})}}Df.promiseConstructor=Promise;function zd(e){const t=e.split(".");if(t.length!==3)throw new Ch("Invalid JWT structure");for(let n=0;n<t.length;n++)if(!oC.test(t[n]))throw new Ch("JWT not in base64url format");return{header:JSON.parse(wv(t[0])),payload:JSON.parse(wv(t[1])),signature:ui(t[2]),raw:{header:t[0],payload:t[1]}}}async function _C(e){return await new Promise(t=>{setTimeout(()=>t(null),e)})}function SC(e,t){return new Promise((n,a)=>{(async()=>{for(let s=0;s<1/0;s++)try{const i=await e(s);if(!t(s,null,i)){n(i);return}}catch(i){if(!t(s,i)){a(i);return}}})()})}function EC(e){return("0"+e.toString(16)).substr(-2)}function bC(){const t=new Uint32Array(56);if(typeof crypto>"u"){const r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",n=r.length;let a="";for(let s=0;s<56;s++)a+=r.charAt(Math.floor(Math.random()*n));return a}return crypto.getRandomValues(t),Array.from(t,EC).join("")}async function kC(e){const r=new TextEncoder().encode(e),n=await crypto.subtle.digest("SHA-256",r),a=new Uint8Array(n);return Array.from(a).map(s=>String.fromCharCode(s)).join("")}async function TC(e){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),e;const r=await kC(e);return btoa(r).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function Qo(e,t,r=!1){const n=bC();let a=n;r&&(a+="/PASSWORD_RECOVERY"),await ii(e,`${t}-code-verifier`,a);const s=await TC(n);return[s,n===s?"plain":"s256"]}const CC=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function AC(e){const t=e.headers.get(kh);if(!t||!t.match(CC))return null;try{return new Date(`${t}T00:00:00.0Z`)}catch{return null}}function PC(e){if(!e)throw new Error("Missing exp claim");const t=Math.floor(Date.now()/1e3);if(e<=t)throw new Error("JWT has expired")}function IC(e){switch(e){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const OC=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function Zo(e){if(!OC.test(e))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function Vd(){const e={};return new Proxy(e,{get:(t,r)=>{if(r==="__isUserNotAvailableProxy")return!0;if(typeof r=="symbol"){const n=r.toString();if(n==="Symbol(Symbol.toPrimitive)"||n==="Symbol(Symbol.toStringTag)"||n==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${r}" property of the session object is not supported. Please use getUser() instead.`)},set:(t,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(t,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function DC(e,t){return new Proxy(e,{get:(r,n,a)=>{if(n==="__isInsecureUserWarningProxy")return!0;if(typeof n=="symbol"){const s=n.toString();if(s==="Symbol(Symbol.toPrimitive)"||s==="Symbol(Symbol.toStringTag)"||s==="Symbol(util.inspect.custom)"||s==="Symbol(nodejs.util.inspect.custom)")return Reflect.get(r,n,a)}return!t.value&&typeof n=="string"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),t.value=!0),Reflect.get(r,n,a)}})}function _v(e){return JSON.parse(JSON.stringify(e))}const Js=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),FC=[502,503,504];async function Sv(e){var t;if(!wC(e))throw new Th(Js(e),0);if(FC.includes(e.status))throw new Th(Js(e),e.status);let r;try{r=await e.json()}catch(s){throw new Qs(Js(s),s)}let n;const a=AC(e);if(a&&a.getTime()>=ew["2024-01-01"].timestamp&&typeof r=="object"&&r&&typeof r.code=="string"?n=r.code:typeof r=="object"&&r&&typeof r.error_code=="string"&&(n=r.error_code),n){if(n==="weak_password")throw new vv(Js(r),e.status,((t=r.weak_password)===null||t===void 0?void 0:t.reasons)||[]);if(n==="session_not_found")throw new Qn}else if(typeof r=="object"&&r&&typeof r.weak_password=="object"&&r.weak_password&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.reasons.reduce((s,i)=>s&&typeof i=="string",!0))throw new vv(Js(r),e.status,r.weak_password.reasons);throw new lC(Js(r),e.status||500,n)}const RC=(e,t,r,n)=>{const a={method:e,headers:t?.headers||{}};return e==="GET"?a:(a.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},t?.headers),a.body=JSON.stringify(n),Object.assign(Object.assign({},a),r))};async function Xe(e,t,r,n){var a;const s=Object.assign({},n?.headers);s[kh]||(s[kh]=ew["2024-01-01"].name),n?.jwt&&(s.Authorization=`Bearer ${n.jwt}`);const i=(a=n?.query)!==null&&a!==void 0?a:{};n?.redirectTo&&(i.redirect_to=n.redirectTo);const c=Object.keys(i).length?"?"+new URLSearchParams(i).toString():"",u=await LC(e,t,r+c,{headers:s,noResolveJson:n?.noResolveJson},{},n?.body);return n?.xform?n?.xform(u):{data:Object.assign({},u),error:null}}async function LC(e,t,r,n,a,s){const i=RC(t,n,a,s);let c;try{c=await e(r,Object.assign({},i))}catch(u){throw console.error(u),new Th(Js(u),0)}if(c.ok||await Sv(c),n?.noResolveJson)return c;try{return await c.json()}catch(u){await Sv(u)}}function Zn(e){var t;let r=null;BC(e)&&(r=Object.assign({},e),e.expires_at||(r.expires_at=vC(e.expires_in)));const n=(t=e.user)!==null&&t!==void 0?t:e;return{data:{session:r,user:n},error:null}}function Ev(e){const t=Zn(e);return!t.error&&e.weak_password&&typeof e.weak_password=="object"&&Array.isArray(e.weak_password.reasons)&&e.weak_password.reasons.length&&e.weak_password.message&&typeof e.weak_password.message=="string"&&e.weak_password.reasons.reduce((r,n)=>r&&typeof n=="string",!0)&&(t.data.weak_password=e.weak_password),t}function vs(e){var t;return{data:{user:(t=e.user)!==null&&t!==void 0?t:e},error:null}}function NC(e){return{data:e,error:null}}function MC(e){const{action_link:t,email_otp:r,hashed_token:n,redirect_to:a,verification_type:s}=e,i=Of(e,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),c={action_link:t,email_otp:r,hashed_token:n,redirect_to:a,verification_type:s},u=Object.assign({},i);return{data:{properties:c,user:u},error:null}}function bv(e){return e}function BC(e){return e.access_token&&e.refresh_token&&e.expires_in}const Wd=["global","local","others"];class jC{constructor({url:t="",headers:r={},fetch:n}){this.url=t,this.headers=r,this.fetch=nw(n),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)},this.oauth={listClients:this._listOAuthClients.bind(this),createClient:this._createOAuthClient.bind(this),getClient:this._getOAuthClient.bind(this),updateClient:this._updateOAuthClient.bind(this),deleteClient:this._deleteOAuthClient.bind(this),regenerateClientSecret:this._regenerateOAuthClientSecret.bind(this)}}async signOut(t,r=Wd[0]){if(Wd.indexOf(r)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${Wd.join(", ")}`);try{return await Xe(this.fetch,"POST",`${this.url}/logout?scope=${r}`,{headers:this.headers,jwt:t,noResolveJson:!0}),{data:null,error:null}}catch(n){if(ze(n))return{data:null,error:n};throw n}}async inviteUserByEmail(t,r={}){try{return await Xe(this.fetch,"POST",`${this.url}/invite`,{body:{email:t,data:r.data},headers:this.headers,redirectTo:r.redirectTo,xform:vs})}catch(n){if(ze(n))return{data:{user:null},error:n};throw n}}async generateLink(t){try{const{options:r}=t,n=Of(t,["options"]),a=Object.assign(Object.assign({},n),r);return"newEmail"in n&&(a.new_email=n?.newEmail,delete a.newEmail),await Xe(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:a,headers:this.headers,xform:MC,redirectTo:r?.redirectTo})}catch(r){if(ze(r))return{data:{properties:null,user:null},error:r};throw r}}async createUser(t){try{return await Xe(this.fetch,"POST",`${this.url}/admin/users`,{body:t,headers:this.headers,xform:vs})}catch(r){if(ze(r))return{data:{user:null},error:r};throw r}}async listUsers(t){var r,n,a,s,i,c,u;try{const f={nextPage:null,lastPage:0,total:0},h=await Xe(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(r=t?.page)===null||r===void 0?void 0:r.toString())!==null&&n!==void 0?n:"",per_page:(s=(a=t?.perPage)===null||a===void 0?void 0:a.toString())!==null&&s!==void 0?s:""},xform:bv});if(h.error)throw h.error;const p=await h.json(),m=(i=h.headers.get("x-total-count"))!==null&&i!==void 0?i:0,y=(u=(c=h.headers.get("link"))===null||c===void 0?void 0:c.split(","))!==null&&u!==void 0?u:[];return y.length>0&&(y.forEach(w=>{const x=parseInt(w.split(";")[0].split("=")[1].substring(0,1)),_=JSON.parse(w.split(";")[1].split("=")[1]);f[`${_}Page`]=x}),f.total=parseInt(m)),{data:Object.assign(Object.assign({},p),f),error:null}}catch(f){if(ze(f))return{data:{users:[]},error:f};throw f}}async getUserById(t){Zo(t);try{return await Xe(this.fetch,"GET",`${this.url}/admin/users/${t}`,{headers:this.headers,xform:vs})}catch(r){if(ze(r))return{data:{user:null},error:r};throw r}}async updateUserById(t,r){Zo(t);try{return await Xe(this.fetch,"PUT",`${this.url}/admin/users/${t}`,{body:r,headers:this.headers,xform:vs})}catch(n){if(ze(n))return{data:{user:null},error:n};throw n}}async deleteUser(t,r=!1){Zo(t);try{return await Xe(this.fetch,"DELETE",`${this.url}/admin/users/${t}`,{headers:this.headers,body:{should_soft_delete:r},xform:vs})}catch(n){if(ze(n))return{data:{user:null},error:n};throw n}}async _listFactors(t){Zo(t.userId);try{const{data:r,error:n}=await Xe(this.fetch,"GET",`${this.url}/admin/users/${t.userId}/factors`,{headers:this.headers,xform:a=>({data:{factors:a},error:null})});return{data:r,error:n}}catch(r){if(ze(r))return{data:null,error:r};throw r}}async _deleteFactor(t){Zo(t.userId),Zo(t.id);try{return{data:await Xe(this.fetch,"DELETE",`${this.url}/admin/users/${t.userId}/factors/${t.id}`,{headers:this.headers}),error:null}}catch(r){if(ze(r))return{data:null,error:r};throw r}}async _listOAuthClients(t){var r,n,a,s,i,c,u;try{const f={nextPage:null,lastPage:0,total:0},h=await Xe(this.fetch,"GET",`${this.url}/admin/oauth/clients`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(r=t?.page)===null||r===void 0?void 0:r.toString())!==null&&n!==void 0?n:"",per_page:(s=(a=t?.perPage)===null||a===void 0?void 0:a.toString())!==null&&s!==void 0?s:""},xform:bv});if(h.error)throw h.error;const p=await h.json(),m=(i=h.headers.get("x-total-count"))!==null&&i!==void 0?i:0,y=(u=(c=h.headers.get("link"))===null||c===void 0?void 0:c.split(","))!==null&&u!==void 0?u:[];return y.length>0&&(y.forEach(w=>{const x=parseInt(w.split(";")[0].split("=")[1].substring(0,1)),_=JSON.parse(w.split(";")[1].split("=")[1]);f[`${_}Page`]=x}),f.total=parseInt(m)),{data:Object.assign(Object.assign({},p),f),error:null}}catch(f){if(ze(f))return{data:{clients:[]},error:f};throw f}}async _createOAuthClient(t){try{return await Xe(this.fetch,"POST",`${this.url}/admin/oauth/clients`,{body:t,headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(ze(r))return{data:null,error:r};throw r}}async _getOAuthClient(t){try{return await Xe(this.fetch,"GET",`${this.url}/admin/oauth/clients/${t}`,{headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(ze(r))return{data:null,error:r};throw r}}async _updateOAuthClient(t,r){try{return await Xe(this.fetch,"PUT",`${this.url}/admin/oauth/clients/${t}`,{body:r,headers:this.headers,xform:n=>({data:n,error:null})})}catch(n){if(ze(n))return{data:null,error:n};throw n}}async _deleteOAuthClient(t){try{return await Xe(this.fetch,"DELETE",`${this.url}/admin/oauth/clients/${t}`,{headers:this.headers,noResolveJson:!0}),{data:null,error:null}}catch(r){if(ze(r))return{data:null,error:r};throw r}}async _regenerateOAuthClientSecret(t){try{return await Xe(this.fetch,"POST",`${this.url}/admin/oauth/clients/${t}/regenerate_secret`,{headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(ze(r))return{data:null,error:r};throw r}}}function kv(e={}){return{getItem:t=>e[t]||null,setItem:(t,r)=>{e[t]=r},removeItem:t=>{delete e[t]}}}const ei={debug:!!(globalThis&&rw()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class aw extends Error{constructor(t){super(t),this.isAcquireTimeout=!0}}class $C extends aw{}async function UC(e,t,r){ei.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",e,t);const n=new globalThis.AbortController;return t>0&&setTimeout(()=>{n.abort(),ei.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",e)},t),await Promise.resolve().then(()=>globalThis.navigator.locks.request(e,t===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:n.signal},async a=>{if(a){ei.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",e,a.name);try{return await r()}finally{ei.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",e,a.name)}}else{if(t===0)throw ei.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",e),new $C(`Acquiring an exclusive Navigator LockManager lock "${e}" immediately failed`);if(ei.debug)try{const s=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(s,null,"  "))}catch(s){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",s)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await r()}}))}function zC(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}function sw(e){if(!/^0x[a-fA-F0-9]{40}$/.test(e))throw new Error(`@supabase/auth-js: Address "${e}" is invalid.`);return e.toLowerCase()}function VC(e){return parseInt(e,16)}function WC(e){const t=new TextEncoder().encode(e);return"0x"+Array.from(t,n=>n.toString(16).padStart(2,"0")).join("")}function HC(e){var t;const{chainId:r,domain:n,expirationTime:a,issuedAt:s=new Date,nonce:i,notBefore:c,requestId:u,resources:f,scheme:h,uri:p,version:m}=e;{if(!Number.isInteger(r))throw new Error(`@supabase/auth-js: Invalid SIWE message field "chainId". Chain ID must be a EIP-155 chain ID. Provided value: ${r}`);if(!n)throw new Error('@supabase/auth-js: Invalid SIWE message field "domain". Domain must be provided.');if(i&&i.length<8)throw new Error(`@supabase/auth-js: Invalid SIWE message field "nonce". Nonce must be at least 8 characters. Provided value: ${i}`);if(!p)throw new Error('@supabase/auth-js: Invalid SIWE message field "uri". URI must be provided.');if(m!=="1")throw new Error(`@supabase/auth-js: Invalid SIWE message field "version". Version must be '1'. Provided value: ${m}`);if(!((t=e.statement)===null||t===void 0)&&t.includes(`
`))throw new Error(`@supabase/auth-js: Invalid SIWE message field "statement". Statement must not include '\\n'. Provided value: ${e.statement}`)}const y=sw(e.address),w=h?`${h}://${n}`:n,x=e.statement?`${e.statement}
`:"",_=`${w} wants you to sign in with your Ethereum account:
${y}

${x}`;let E=`URI: ${p}
Version: ${m}
Chain ID: ${r}${i?`
Nonce: ${i}`:""}
Issued At: ${s.toISOString()}`;if(a&&(E+=`
Expiration Time: ${a.toISOString()}`),c&&(E+=`
Not Before: ${c.toISOString()}`),u&&(E+=`
Request ID: ${u}`),f){let k=`
Resources:`;for(const b of f){if(!b||typeof b!="string")throw new Error(`@supabase/auth-js: Invalid SIWE message field "resources". Every resource must be a valid string. Provided value: ${b}`);k+=`
- ${b}`}E+=k}return`${_}
${E}`}class ur extends Error{constructor({message:t,code:r,cause:n,name:a}){var s;super(t,{cause:n}),this.__isWebAuthnError=!0,this.name=(s=a??(n instanceof Error?n.name:void 0))!==null&&s!==void 0?s:"Unknown Error",this.code=r}}class ff extends ur{constructor(t,r){super({code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:r,message:t}),this.name="WebAuthnUnknownError",this.originalError=r}}function GC({error:e,options:t}){var r,n,a;const{publicKey:s}=t;if(!s)throw Error("options was missing required publicKey property");if(e.name==="AbortError"){if(t.signal instanceof AbortSignal)return new ur({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:e})}else if(e.name==="ConstraintError"){if(((r=s.authenticatorSelection)===null||r===void 0?void 0:r.requireResidentKey)===!0)return new ur({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:e});if(t.mediation==="conditional"&&((n=s.authenticatorSelection)===null||n===void 0?void 0:n.userVerification)==="required")return new ur({message:"User verification was required during automatic registration but it could not be performed",code:"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE",cause:e});if(((a=s.authenticatorSelection)===null||a===void 0?void 0:a.userVerification)==="required")return new ur({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:e})}else{if(e.name==="InvalidStateError")return new ur({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:e});if(e.name==="NotAllowedError")return new ur({message:e.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e});if(e.name==="NotSupportedError")return s.pubKeyCredParams.filter(c=>c.type==="public-key").length===0?new ur({message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:e}):new ur({message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:e});if(e.name==="SecurityError"){const i=window.location.hostname;if(ow(i)){if(s.rp.id!==i)return new ur({message:`The RP ID "${s.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:e})}else return new ur({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:e})}else if(e.name==="TypeError"){if(s.user.id.byteLength<1||s.user.id.byteLength>64)return new ur({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:e})}else if(e.name==="UnknownError")return new ur({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:e})}return new ur({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e})}function qC({error:e,options:t}){const{publicKey:r}=t;if(!r)throw Error("options was missing required publicKey property");if(e.name==="AbortError"){if(t.signal instanceof AbortSignal)return new ur({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:e})}else{if(e.name==="NotAllowedError")return new ur({message:e.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e});if(e.name==="SecurityError"){const n=window.location.hostname;if(ow(n)){if(r.rpId!==n)return new ur({message:`The RP ID "${r.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:e})}else return new ur({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:e})}else if(e.name==="UnknownError")return new ur({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:e})}return new ur({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e})}class KC{createNewAbortSignal(){if(this.controller){const r=new Error("Cancelling existing WebAuthn API call for new one");r.name="AbortError",this.controller.abort(r)}const t=new AbortController;return this.controller=t,t.signal}cancelCeremony(){if(this.controller){const t=new Error("Manually cancelling existing WebAuthn API call");t.name="AbortError",this.controller.abort(t),this.controller=void 0}}}const XC=new KC;function JC(e){if(!e)throw new Error("Credential creation options are required");if(typeof PublicKeyCredential<"u"&&"parseCreationOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseCreationOptionsFromJSON=="function")return PublicKeyCredential.parseCreationOptionsFromJSON(e);const{challenge:t,user:r,excludeCredentials:n}=e,a=Of(e,["challenge","user","excludeCredentials"]),s=ui(t).buffer,i=Object.assign(Object.assign({},r),{id:ui(r.id).buffer}),c=Object.assign(Object.assign({},a),{challenge:s,user:i});if(n&&n.length>0){c.excludeCredentials=new Array(n.length);for(let u=0;u<n.length;u++){const f=n[u];c.excludeCredentials[u]=Object.assign(Object.assign({},f),{id:ui(f.id).buffer,type:f.type||"public-key",transports:f.transports})}}return c}function YC(e){if(!e)throw new Error("Credential request options are required");if(typeof PublicKeyCredential<"u"&&"parseRequestOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseRequestOptionsFromJSON=="function")return PublicKeyCredential.parseRequestOptionsFromJSON(e);const{challenge:t,allowCredentials:r}=e,n=Of(e,["challenge","allowCredentials"]),a=ui(t).buffer,s=Object.assign(Object.assign({},n),{challenge:a});if(r&&r.length>0){s.allowCredentials=new Array(r.length);for(let i=0;i<r.length;i++){const c=r[i];s.allowCredentials[i]=Object.assign(Object.assign({},c),{id:ui(c.id).buffer,type:c.type||"public-key",transports:c.transports})}}return s}function QC(e){var t;if("toJSON"in e&&typeof e.toJSON=="function")return e.toJSON();const r=e;return{id:e.id,rawId:e.id,response:{attestationObject:eo(new Uint8Array(e.response.attestationObject)),clientDataJSON:eo(new Uint8Array(e.response.clientDataJSON))},type:"public-key",clientExtensionResults:e.getClientExtensionResults(),authenticatorAttachment:(t=r.authenticatorAttachment)!==null&&t!==void 0?t:void 0}}function ZC(e){var t;if("toJSON"in e&&typeof e.toJSON=="function")return e.toJSON();const r=e,n=e.getClientExtensionResults(),a=e.response;return{id:e.id,rawId:e.id,response:{authenticatorData:eo(new Uint8Array(a.authenticatorData)),clientDataJSON:eo(new Uint8Array(a.clientDataJSON)),signature:eo(new Uint8Array(a.signature)),userHandle:a.userHandle?eo(new Uint8Array(a.userHandle)):void 0},type:"public-key",clientExtensionResults:n,authenticatorAttachment:(t=r.authenticatorAttachment)!==null&&t!==void 0?t:void 0}}function ow(e){return e==="localhost"||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(e)}function Tv(){var e,t;return!!(Yr()&&"PublicKeyCredential"in window&&window.PublicKeyCredential&&"credentials"in navigator&&typeof((e=navigator?.credentials)===null||e===void 0?void 0:e.create)=="function"&&typeof((t=navigator?.credentials)===null||t===void 0?void 0:t.get)=="function")}async function eA(e){try{const t=await navigator.credentials.create(e);return t?t instanceof PublicKeyCredential?{data:t,error:null}:{data:null,error:new ff("Browser returned unexpected credential type",t)}:{data:null,error:new ff("Empty credential response",t)}}catch(t){return{data:null,error:GC({error:t,options:e})}}}async function tA(e){try{const t=await navigator.credentials.get(e);return t?t instanceof PublicKeyCredential?{data:t,error:null}:{data:null,error:new ff("Browser returned unexpected credential type",t)}:{data:null,error:new ff("Empty credential response",t)}}catch(t){return{data:null,error:qC({error:t,options:e})}}}const rA={hints:["security-key"],authenticatorSelection:{authenticatorAttachment:"cross-platform",requireResidentKey:!1,userVerification:"preferred",residentKey:"discouraged"},attestation:"none"},nA={userVerification:"preferred",hints:["security-key"]};function df(...e){const t=a=>a!==null&&typeof a=="object"&&!Array.isArray(a),r=a=>a instanceof ArrayBuffer||ArrayBuffer.isView(a),n={};for(const a of e)if(a)for(const s in a){const i=a[s];if(i!==void 0)if(Array.isArray(i))n[s]=i;else if(r(i))n[s]=i;else if(t(i)){const c=n[s];t(c)?n[s]=df(c,i):n[s]=df(i)}else n[s]=i}return n}function aA(e,t){return df(rA,e,t||{})}function sA(e,t){return df(nA,e,t||{})}class oA{constructor(t){this.client=t,this.enroll=this._enroll.bind(this),this.challenge=this._challenge.bind(this),this.verify=this._verify.bind(this),this.authenticate=this._authenticate.bind(this),this.register=this._register.bind(this)}async _enroll(t){return this.client.mfa.enroll(Object.assign(Object.assign({},t),{factorType:"webauthn"}))}async _challenge({factorId:t,webauthn:r,friendlyName:n,signal:a},s){try{const{data:i,error:c}=await this.client.mfa.challenge({factorId:t,webauthn:r});if(!i)return{data:null,error:c};const u=a??XC.createNewAbortSignal();if(i.webauthn.type==="create"){const{user:f}=i.webauthn.credential_options.publicKey;f.name||(f.name=`${f.id}:${n}`),f.displayName||(f.displayName=f.name)}switch(i.webauthn.type){case"create":{const f=aA(i.webauthn.credential_options.publicKey,s?.create),{data:h,error:p}=await eA({publicKey:f,signal:u});return h?{data:{factorId:t,challengeId:i.id,webauthn:{type:i.webauthn.type,credential_response:h}},error:null}:{data:null,error:p}}case"request":{const f=sA(i.webauthn.credential_options.publicKey,s?.request),{data:h,error:p}=await tA(Object.assign(Object.assign({},i.webauthn.credential_options),{publicKey:f,signal:u}));return h?{data:{factorId:t,challengeId:i.id,webauthn:{type:i.webauthn.type,credential_response:h}},error:null}:{data:null,error:p}}}}catch(i){return ze(i)?{data:null,error:i}:{data:null,error:new Qs("Unexpected error in challenge",i)}}}async _verify({challengeId:t,factorId:r,webauthn:n}){return this.client.mfa.verify({factorId:r,challengeId:t,webauthn:n})}async _authenticate({factorId:t,webauthn:{rpId:r=typeof window<"u"?window.location.hostname:void 0,rpOrigins:n=typeof window<"u"?[window.location.origin]:void 0,signal:a}},s){if(!r)return{data:null,error:new Vl("rpId is required for WebAuthn authentication")};try{if(!Tv())return{data:null,error:new Qs("Browser does not support WebAuthn",null)};const{data:i,error:c}=await this.challenge({factorId:t,webauthn:{rpId:r,rpOrigins:n},signal:a},{request:s});if(!i)return{data:null,error:c};const{webauthn:u}=i;return this._verify({factorId:t,challengeId:i.challengeId,webauthn:{type:u.type,rpId:r,rpOrigins:n,credential_response:u.credential_response}})}catch(i){return ze(i)?{data:null,error:i}:{data:null,error:new Qs("Unexpected error in authenticate",i)}}}async _register({friendlyName:t,rpId:r=typeof window<"u"?window.location.hostname:void 0,rpOrigins:n=typeof window<"u"?[window.location.origin]:void 0,signal:a},s){if(!r)return{data:null,error:new Vl("rpId is required for WebAuthn registration")};try{if(!Tv())return{data:null,error:new Qs("Browser does not support WebAuthn",null)};const{data:i,error:c}=await this._enroll({friendlyName:t});if(!i)return await this.client.mfa.listFactors().then(h=>{var p;return(p=h.data)===null||p===void 0?void 0:p.all.find(m=>m.factor_type==="webauthn"&&m.friendly_name===t&&m.status!=="unverified")}).then(h=>h?this.client.mfa.unenroll({factorId:h?.id}):void 0),{data:null,error:c};const{data:u,error:f}=await this._challenge({factorId:i.id,friendlyName:i.friendly_name,webauthn:{rpId:r,rpOrigins:n},signal:a},{create:s});return u?this._verify({factorId:i.id,challengeId:u.challengeId,webauthn:{rpId:r,rpOrigins:n,type:u.webauthn.type,credential_response:u.webauthn.credential_response}}):{data:null,error:f}}catch(i){return ze(i)?{data:null,error:i}:{data:null,error:new Qs("Unexpected error in register",i)}}}}zC();const iA={url:nC,storageKey:aC,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:sC,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function Cv(e,t,r){return await r()}const ti={};class Wl{get jwks(){var t,r;return(r=(t=ti[this.storageKey])===null||t===void 0?void 0:t.jwks)!==null&&r!==void 0?r:{keys:[]}}set jwks(t){ti[this.storageKey]=Object.assign(Object.assign({},ti[this.storageKey]),{jwks:t})}get jwks_cached_at(){var t,r;return(r=(t=ti[this.storageKey])===null||t===void 0?void 0:t.cachedAt)!==null&&r!==void 0?r:Number.MIN_SAFE_INTEGER}set jwks_cached_at(t){ti[this.storageKey]=Object.assign(Object.assign({},ti[this.storageKey]),{cachedAt:t})}constructor(t){var r,n;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=Wl.nextInstanceID,Wl.nextInstanceID+=1,this.instanceID>0&&Yr()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const a=Object.assign(Object.assign({},iA),t);if(this.logDebugMessages=!!a.debug,typeof a.debug=="function"&&(this.logger=a.debug),this.persistSession=a.persistSession,this.storageKey=a.storageKey,this.autoRefreshToken=a.autoRefreshToken,this.admin=new jC({url:a.url,headers:a.headers,fetch:a.fetch}),this.url=a.url,this.headers=a.headers,this.fetch=nw(a.fetch),this.lock=a.lock||Cv,this.detectSessionInUrl=a.detectSessionInUrl,this.flowType=a.flowType,this.hasCustomAuthorizationHeader=a.hasCustomAuthorizationHeader,a.lock?this.lock=a.lock:Yr()&&(!((r=globalThis?.navigator)===null||r===void 0)&&r.locks)?this.lock=UC:this.lock=Cv,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this),webauthn:new oA(this)},this.oauth={getAuthorizationDetails:this._getAuthorizationDetails.bind(this),approveAuthorization:this._approveAuthorization.bind(this),denyAuthorization:this._denyAuthorization.bind(this)},this.persistSession?(a.storage?this.storage=a.storage:rw()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=kv(this.memoryStorage)),a.userStorage&&(this.userStorage=a.userStorage)):(this.memoryStorage={},this.storage=kv(this.memoryStorage)),Yr()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(s){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",s)}(n=this.broadcastChannel)===null||n===void 0||n.addEventListener("message",async s=>{this._debug("received broadcast notification from other tab or client",s),await this._notifyAllSubscribers(s.data.event,s.data.session,!1)})}this.initialize()}_debug(...t){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${Zy}) ${new Date().toISOString()}`,...t),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var t;try{const r=yC(window.location.href);let n="none";if(this._isImplicitGrantCallback(r)?n="implicit":await this._isPKCECallback(r)&&(n="pkce"),Yr()&&this.detectSessionInUrl&&n!=="none"){const{data:a,error:s}=await this._getSessionFromURL(r,n);if(s){if(this._debug("#_initialize()","error detecting session from URL",s),fC(s)){const u=(t=s.details)===null||t===void 0?void 0:t.code;if(u==="identity_already_exists"||u==="identity_not_found"||u==="single_identity_not_deletable")return{error:s}}return await this._removeSession(),{error:s}}const{session:i,redirectType:c}=a;return this._debug("#_initialize()","detected session in URL",i,"redirect type",c),await this._saveSession(i),setTimeout(async()=>{c==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",i):await this._notifyAllSubscribers("SIGNED_IN",i)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(r){return ze(r)?{error:r}:{error:new Qs("Unexpected error during initialization",r)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(t){var r,n,a;try{const s=await Xe(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(n=(r=t?.options)===null||r===void 0?void 0:r.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:(a=t?.options)===null||a===void 0?void 0:a.captchaToken}},xform:Zn}),{data:i,error:c}=s;if(c||!i)return{data:{user:null,session:null},error:c};const u=i.session,f=i.user;return i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",u)),{data:{user:f,session:u},error:null}}catch(s){if(ze(s))return{data:{user:null,session:null},error:s};throw s}}async signUp(t){var r,n,a;try{let s;if("email"in t){const{email:h,password:p,options:m}=t;let y=null,w=null;this.flowType==="pkce"&&([y,w]=await Qo(this.storage,this.storageKey)),s=await Xe(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:m?.emailRedirectTo,body:{email:h,password:p,data:(r=m?.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:m?.captchaToken},code_challenge:y,code_challenge_method:w},xform:Zn})}else if("phone"in t){const{phone:h,password:p,options:m}=t;s=await Xe(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:h,password:p,data:(n=m?.data)!==null&&n!==void 0?n:{},channel:(a=m?.channel)!==null&&a!==void 0?a:"sms",gotrue_meta_security:{captcha_token:m?.captchaToken}},xform:Zn})}else throw new Uu("You must provide either an email or phone number and a password");const{data:i,error:c}=s;if(c||!i)return{data:{user:null,session:null},error:c};const u=i.session,f=i.user;return i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",u)),{data:{user:f,session:u},error:null}}catch(s){if(ze(s))return{data:{user:null,session:null},error:s};throw s}}async signInWithPassword(t){try{let r;if("email"in t){const{email:s,password:i,options:c}=t;r=await Xe(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:s,password:i,gotrue_meta_security:{captcha_token:c?.captchaToken}},xform:Ev})}else if("phone"in t){const{phone:s,password:i,options:c}=t;r=await Xe(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:s,password:i,gotrue_meta_security:{captcha_token:c?.captchaToken}},xform:Ev})}else throw new Uu("You must provide either an email or phone number and a password");const{data:n,error:a}=r;return a?{data:{user:null,session:null},error:a}:!n||!n.session||!n.user?{data:{user:null,session:null},error:new Yo}:(n.session&&(await this._saveSession(n.session),await this._notifyAllSubscribers("SIGNED_IN",n.session)),{data:Object.assign({user:n.user,session:n.session},n.weak_password?{weakPassword:n.weak_password}:null),error:a})}catch(r){if(ze(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithOAuth(t){var r,n,a,s;return await this._handleProviderSignIn(t.provider,{redirectTo:(r=t.options)===null||r===void 0?void 0:r.redirectTo,scopes:(n=t.options)===null||n===void 0?void 0:n.scopes,queryParams:(a=t.options)===null||a===void 0?void 0:a.queryParams,skipBrowserRedirect:(s=t.options)===null||s===void 0?void 0:s.skipBrowserRedirect})}async exchangeCodeForSession(t){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(t))}async signInWithWeb3(t){const{chain:r}=t;switch(r){case"ethereum":return await this.signInWithEthereum(t);case"solana":return await this.signInWithSolana(t);default:throw new Error(`@supabase/auth-js: Unsupported chain "${r}"`)}}async signInWithEthereum(t){var r,n,a,s,i,c,u,f,h,p,m;let y,w;if("message"in t)y=t.message,w=t.signature;else{const{chain:x,wallet:_,statement:E,options:k}=t;let b;if(Yr())if(typeof _=="object")b=_;else{const V=window;if("ethereum"in V&&typeof V.ethereum=="object"&&"request"in V.ethereum&&typeof V.ethereum.request=="function")b=V.ethereum;else throw new Error("@supabase/auth-js: No compatible Ethereum wallet interface on the window object (window.ethereum) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'ethereum', wallet: resolvedUserWallet }) instead.")}else{if(typeof _!="object"||!k?.url)throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");b=_}const O=new URL((r=k?.url)!==null&&r!==void 0?r:window.location.href),z=await b.request({method:"eth_requestAccounts"}).then(V=>V).catch(()=>{throw new Error("@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid")});if(!z||z.length===0)throw new Error("@supabase/auth-js: No accounts available. Please ensure the wallet is connected.");const L=sw(z[0]);let P=(n=k?.signInWithEthereum)===null||n===void 0?void 0:n.chainId;if(!P){const V=await b.request({method:"eth_chainId"});P=VC(V)}const J={domain:O.host,address:L,statement:E,uri:O.href,version:"1",chainId:P,nonce:(a=k?.signInWithEthereum)===null||a===void 0?void 0:a.nonce,issuedAt:(i=(s=k?.signInWithEthereum)===null||s===void 0?void 0:s.issuedAt)!==null&&i!==void 0?i:new Date,expirationTime:(c=k?.signInWithEthereum)===null||c===void 0?void 0:c.expirationTime,notBefore:(u=k?.signInWithEthereum)===null||u===void 0?void 0:u.notBefore,requestId:(f=k?.signInWithEthereum)===null||f===void 0?void 0:f.requestId,resources:(h=k?.signInWithEthereum)===null||h===void 0?void 0:h.resources};y=HC(J),w=await b.request({method:"personal_sign",params:[WC(y),L]})}try{const{data:x,error:_}=await Xe(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"ethereum",message:y,signature:w},!((p=t.options)===null||p===void 0)&&p.captchaToken?{gotrue_meta_security:{captcha_token:(m=t.options)===null||m===void 0?void 0:m.captchaToken}}:null),xform:Zn});if(_)throw _;return!x||!x.session||!x.user?{data:{user:null,session:null},error:new Yo}:(x.session&&(await this._saveSession(x.session),await this._notifyAllSubscribers("SIGNED_IN",x.session)),{data:Object.assign({},x),error:_})}catch(x){if(ze(x))return{data:{user:null,session:null},error:x};throw x}}async signInWithSolana(t){var r,n,a,s,i,c,u,f,h,p,m,y;let w,x;if("message"in t)w=t.message,x=t.signature;else{const{chain:_,wallet:E,statement:k,options:b}=t;let O;if(Yr())if(typeof E=="object")O=E;else{const L=window;if("solana"in L&&typeof L.solana=="object"&&("signIn"in L.solana&&typeof L.solana.signIn=="function"||"signMessage"in L.solana&&typeof L.solana.signMessage=="function"))O=L.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof E!="object"||!b?.url)throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");O=E}const z=new URL((r=b?.url)!==null&&r!==void 0?r:window.location.href);if("signIn"in O&&O.signIn){const L=await O.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},b?.signInWithSolana),{version:"1",domain:z.host,uri:z.href}),k?{statement:k}:null));let P;if(Array.isArray(L)&&L[0]&&typeof L[0]=="object")P=L[0];else if(L&&typeof L=="object"&&"signedMessage"in L&&"signature"in L)P=L;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in P&&"signature"in P&&(typeof P.signedMessage=="string"||P.signedMessage instanceof Uint8Array)&&P.signature instanceof Uint8Array)w=typeof P.signedMessage=="string"?P.signedMessage:new TextDecoder().decode(P.signedMessage),x=P.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in O)||typeof O.signMessage!="function"||!("publicKey"in O)||typeof O!="object"||!O.publicKey||!("toBase58"in O.publicKey)||typeof O.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");w=[`${z.host} wants you to sign in with your Solana account:`,O.publicKey.toBase58(),...k?["",k,""]:[""],"Version: 1",`URI: ${z.href}`,`Issued At: ${(a=(n=b?.signInWithSolana)===null||n===void 0?void 0:n.issuedAt)!==null&&a!==void 0?a:new Date().toISOString()}`,...!((s=b?.signInWithSolana)===null||s===void 0)&&s.notBefore?[`Not Before: ${b.signInWithSolana.notBefore}`]:[],...!((i=b?.signInWithSolana)===null||i===void 0)&&i.expirationTime?[`Expiration Time: ${b.signInWithSolana.expirationTime}`]:[],...!((c=b?.signInWithSolana)===null||c===void 0)&&c.chainId?[`Chain ID: ${b.signInWithSolana.chainId}`]:[],...!((u=b?.signInWithSolana)===null||u===void 0)&&u.nonce?[`Nonce: ${b.signInWithSolana.nonce}`]:[],...!((f=b?.signInWithSolana)===null||f===void 0)&&f.requestId?[`Request ID: ${b.signInWithSolana.requestId}`]:[],...!((p=(h=b?.signInWithSolana)===null||h===void 0?void 0:h.resources)===null||p===void 0)&&p.length?["Resources",...b.signInWithSolana.resources.map(P=>`- ${P}`)]:[]].join(`
`);const L=await O.signMessage(new TextEncoder().encode(w),"utf8");if(!L||!(L instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");x=L}}try{const{data:_,error:E}=await Xe(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:w,signature:eo(x)},!((m=t.options)===null||m===void 0)&&m.captchaToken?{gotrue_meta_security:{captcha_token:(y=t.options)===null||y===void 0?void 0:y.captchaToken}}:null),xform:Zn});if(E)throw E;return!_||!_.session||!_.user?{data:{user:null,session:null},error:new Yo}:(_.session&&(await this._saveSession(_.session),await this._notifyAllSubscribers("SIGNED_IN",_.session)),{data:Object.assign({},_),error:E})}catch(_){if(ze(_))return{data:{user:null,session:null},error:_};throw _}}async _exchangeCodeForSession(t){const r=await Ks(this.storage,`${this.storageKey}-code-verifier`),[n,a]=(r??"").split("/");try{const{data:s,error:i}=await Xe(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:t,code_verifier:n},xform:Zn});if(await ps(this.storage,`${this.storageKey}-code-verifier`),i)throw i;return!s||!s.session||!s.user?{data:{user:null,session:null,redirectType:null},error:new Yo}:(s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",s.session)),{data:Object.assign(Object.assign({},s),{redirectType:a??null}),error:i})}catch(s){if(ze(s))return{data:{user:null,session:null,redirectType:null},error:s};throw s}}async signInWithIdToken(t){try{const{options:r,provider:n,token:a,access_token:s,nonce:i}=t,c=await Xe(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:n,id_token:a,access_token:s,nonce:i,gotrue_meta_security:{captcha_token:r?.captchaToken}},xform:Zn}),{data:u,error:f}=c;return f?{data:{user:null,session:null},error:f}:!u||!u.session||!u.user?{data:{user:null,session:null},error:new Yo}:(u.session&&(await this._saveSession(u.session),await this._notifyAllSubscribers("SIGNED_IN",u.session)),{data:u,error:f})}catch(r){if(ze(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithOtp(t){var r,n,a,s,i;try{if("email"in t){const{email:c,options:u}=t;let f=null,h=null;this.flowType==="pkce"&&([f,h]=await Qo(this.storage,this.storageKey));const{error:p}=await Xe(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:c,data:(r=u?.data)!==null&&r!==void 0?r:{},create_user:(n=u?.shouldCreateUser)!==null&&n!==void 0?n:!0,gotrue_meta_security:{captcha_token:u?.captchaToken},code_challenge:f,code_challenge_method:h},redirectTo:u?.emailRedirectTo});return{data:{user:null,session:null},error:p}}if("phone"in t){const{phone:c,options:u}=t,{data:f,error:h}=await Xe(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:c,data:(a=u?.data)!==null&&a!==void 0?a:{},create_user:(s=u?.shouldCreateUser)!==null&&s!==void 0?s:!0,gotrue_meta_security:{captcha_token:u?.captchaToken},channel:(i=u?.channel)!==null&&i!==void 0?i:"sms"}});return{data:{user:null,session:null,messageId:f?.message_id},error:h}}throw new Uu("You must provide either an email or phone number.")}catch(c){if(ze(c))return{data:{user:null,session:null},error:c};throw c}}async verifyOtp(t){var r,n;try{let a,s;"options"in t&&(a=(r=t.options)===null||r===void 0?void 0:r.redirectTo,s=(n=t.options)===null||n===void 0?void 0:n.captchaToken);const{data:i,error:c}=await Xe(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},t),{gotrue_meta_security:{captcha_token:s}}),redirectTo:a,xform:Zn});if(c)throw c;if(!i)throw new Error("An error occurred on token verification.");const u=i.session,f=i.user;return u?.access_token&&(await this._saveSession(u),await this._notifyAllSubscribers(t.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",u)),{data:{user:f,session:u},error:null}}catch(a){if(ze(a))return{data:{user:null,session:null},error:a};throw a}}async signInWithSSO(t){var r,n,a;try{let s=null,i=null;return this.flowType==="pkce"&&([s,i]=await Qo(this.storage,this.storageKey)),await Xe(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in t?{provider_id:t.providerId}:null),"domain"in t?{domain:t.domain}:null),{redirect_to:(n=(r=t.options)===null||r===void 0?void 0:r.redirectTo)!==null&&n!==void 0?n:void 0}),!((a=t?.options)===null||a===void 0)&&a.captchaToken?{gotrue_meta_security:{captcha_token:t.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:s,code_challenge_method:i}),headers:this.headers,xform:NC})}catch(s){if(ze(s))return{data:null,error:s};throw s}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async t=>{const{data:{session:r},error:n}=t;if(n)throw n;if(!r)throw new Qn;const{error:a}=await Xe(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:r.access_token});return{data:{user:null,session:null},error:a}})}catch(t){if(ze(t))return{data:{user:null,session:null},error:t};throw t}}async resend(t){try{const r=`${this.url}/resend`;if("email"in t){const{email:n,type:a,options:s}=t,{error:i}=await Xe(this.fetch,"POST",r,{headers:this.headers,body:{email:n,type:a,gotrue_meta_security:{captcha_token:s?.captchaToken}},redirectTo:s?.emailRedirectTo});return{data:{user:null,session:null},error:i}}else if("phone"in t){const{phone:n,type:a,options:s}=t,{data:i,error:c}=await Xe(this.fetch,"POST",r,{headers:this.headers,body:{phone:n,type:a,gotrue_meta_security:{captcha_token:s?.captchaToken}}});return{data:{user:null,session:null,messageId:i?.message_id},error:c}}throw new Uu("You must provide either an email or phone number and a type")}catch(r){if(ze(r))return{data:{user:null,session:null},error:r};throw r}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async r=>r))}async _acquireLock(t,r){this._debug("#_acquireLock","begin",t);try{if(this.lockAcquired){const n=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),a=(async()=>(await n,await r()))();return this.pendingInLock.push((async()=>{try{await a}catch{}})()),a}return await this.lock(`lock:${this.storageKey}`,t,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const n=r();for(this.pendingInLock.push((async()=>{try{await n}catch{}})()),await n;this.pendingInLock.length;){const a=[...this.pendingInLock];await Promise.all(a),this.pendingInLock.splice(0,a.length)}return await n}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(t){this._debug("#_useSession","begin");try{const r=await this.__loadSession();return await t(r)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let t=null;const r=await Ks(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",r),r!==null&&(this._isValidSession(r)?t=r:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!t)return{data:{session:null},error:null};const n=t.expires_at?t.expires_at*1e3-Date.now()<$d:!1;if(this._debug("#__loadSession()",`session has${n?"":" not"} expired`,"expires_at",t.expires_at),!n){if(this.userStorage){const i=await Ks(this.userStorage,this.storageKey+"-user");i?.user?t.user=i.user:t.user=Vd()}if(this.storage.isServer&&t.user&&!t.user.__isUserNotAvailableProxy){const i={value:this.suppressGetSessionWarning};t.user=DC(t.user,i),i.value&&(this.suppressGetSessionWarning=!0)}return{data:{session:t},error:null}}const{data:a,error:s}=await this._callRefreshToken(t.refresh_token);return s?{data:{session:null},error:s}:{data:{session:a},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(t){return t?await this._getUser(t):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(t){try{return t?await Xe(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:t,xform:vs}):await this._useSession(async r=>{var n,a,s;const{data:i,error:c}=r;if(c)throw c;return!(!((n=i.session)===null||n===void 0)&&n.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new Qn}:await Xe(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(s=(a=i.session)===null||a===void 0?void 0:a.access_token)!==null&&s!==void 0?s:void 0,xform:vs})})}catch(r){if(ze(r))return uC(r)&&(await this._removeSession(),await ps(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:r};throw r}}async updateUser(t,r={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(t,r))}async _updateUser(t,r={}){try{return await this._useSession(async n=>{const{data:a,error:s}=n;if(s)throw s;if(!a.session)throw new Qn;const i=a.session;let c=null,u=null;this.flowType==="pkce"&&t.email!=null&&([c,u]=await Qo(this.storage,this.storageKey));const{data:f,error:h}=await Xe(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:r?.emailRedirectTo,body:Object.assign(Object.assign({},t),{code_challenge:c,code_challenge_method:u}),jwt:i.access_token,xform:vs});if(h)throw h;return i.user=f.user,await this._saveSession(i),await this._notifyAllSubscribers("USER_UPDATED",i),{data:{user:i.user},error:null}})}catch(n){if(ze(n))return{data:{user:null},error:n};throw n}}async setSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(t))}async _setSession(t){try{if(!t.access_token||!t.refresh_token)throw new Qn;const r=Date.now()/1e3;let n=r,a=!0,s=null;const{payload:i}=zd(t.access_token);if(i.exp&&(n=i.exp,a=n<=r),a){const{data:c,error:u}=await this._callRefreshToken(t.refresh_token);if(u)return{data:{user:null,session:null},error:u};if(!c)return{data:{user:null,session:null},error:null};s=c}else{const{data:c,error:u}=await this._getUser(t.access_token);if(u)throw u;s={access_token:t.access_token,refresh_token:t.refresh_token,user:c.user,token_type:"bearer",expires_in:n-r,expires_at:n},await this._saveSession(s),await this._notifyAllSubscribers("SIGNED_IN",s)}return{data:{user:s.user,session:s},error:null}}catch(r){if(ze(r))return{data:{session:null,user:null},error:r};throw r}}async refreshSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(t))}async _refreshSession(t){try{return await this._useSession(async r=>{var n;if(!t){const{data:i,error:c}=r;if(c)throw c;t=(n=i.session)!==null&&n!==void 0?n:void 0}if(!t?.refresh_token)throw new Qn;const{data:a,error:s}=await this._callRefreshToken(t.refresh_token);return s?{data:{user:null,session:null},error:s}:a?{data:{user:a.user,session:a},error:null}:{data:{user:null,session:null},error:null}})}catch(r){if(ze(r))return{data:{user:null,session:null},error:r};throw r}}async _getSessionFromURL(t,r){try{if(!Yr())throw new zu("No browser detected.");if(t.error||t.error_description||t.error_code)throw new zu(t.error_description||"Error in URL with unspecified error_description",{error:t.error||"unspecified_error",code:t.error_code||"unspecified_code"});switch(r){case"implicit":if(this.flowType==="pkce")throw new mv("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new zu("Not a valid implicit grant flow url.");break;default:}if(r==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!t.code)throw new mv("No code detected.");const{data:k,error:b}=await this._exchangeCodeForSession(t.code);if(b)throw b;const O=new URL(window.location.href);return O.searchParams.delete("code"),window.history.replaceState(window.history.state,"",O.toString()),{data:{session:k.session,redirectType:null},error:null}}const{provider_token:n,provider_refresh_token:a,access_token:s,refresh_token:i,expires_in:c,expires_at:u,token_type:f}=t;if(!s||!c||!i||!f)throw new zu("No session defined in URL");const h=Math.round(Date.now()/1e3),p=parseInt(c);let m=h+p;u&&(m=parseInt(u));const y=m-h;y*1e3<=oi&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${y}s, should have been closer to ${p}s`);const w=m-p;h-w>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",w,m,h):h-w<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",w,m,h);const{data:x,error:_}=await this._getUser(s);if(_)throw _;const E={provider_token:n,provider_refresh_token:a,access_token:s,expires_in:p,expires_at:m,refresh_token:i,token_type:f,user:x.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:E,redirectType:t.type},error:null}}catch(n){if(ze(n))return{data:{session:null,redirectType:null},error:n};throw n}}_isImplicitGrantCallback(t){return!!(t.access_token||t.error_description)}async _isPKCECallback(t){const r=await Ks(this.storage,`${this.storageKey}-code-verifier`);return!!(t.code&&r)}async signOut(t={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(t))}async _signOut({scope:t}={scope:"global"}){return await this._useSession(async r=>{var n;const{data:a,error:s}=r;if(s)return{error:s};const i=(n=a.session)===null||n===void 0?void 0:n.access_token;if(i){const{error:c}=await this.admin.signOut(i,t);if(c&&!(cC(c)&&(c.status===404||c.status===401||c.status===403)))return{error:c}}return t!=="others"&&(await this._removeSession(),await ps(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(t){const r=xC(),n={id:r,callback:t,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",r),this.stateChangeEmitters.delete(r)}};return this._debug("#onAuthStateChange()","registered callback with id",r),this.stateChangeEmitters.set(r,n),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(r)})))(),{data:{subscription:n}}}async _emitInitialSession(t){return await this._useSession(async r=>{var n,a;try{const{data:{session:s},error:i}=r;if(i)throw i;await((n=this.stateChangeEmitters.get(t))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",s)),this._debug("INITIAL_SESSION","callback id",t,"session",s)}catch(s){await((a=this.stateChangeEmitters.get(t))===null||a===void 0?void 0:a.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",t,"error",s),console.error(s)}})}async resetPasswordForEmail(t,r={}){let n=null,a=null;this.flowType==="pkce"&&([n,a]=await Qo(this.storage,this.storageKey,!0));try{return await Xe(this.fetch,"POST",`${this.url}/recover`,{body:{email:t,code_challenge:n,code_challenge_method:a,gotrue_meta_security:{captcha_token:r.captchaToken}},headers:this.headers,redirectTo:r.redirectTo})}catch(s){if(ze(s))return{data:null,error:s};throw s}}async getUserIdentities(){var t;try{const{data:r,error:n}=await this.getUser();if(n)throw n;return{data:{identities:(t=r.user.identities)!==null&&t!==void 0?t:[]},error:null}}catch(r){if(ze(r))return{data:null,error:r};throw r}}async linkIdentity(t){return"token"in t?this.linkIdentityIdToken(t):this.linkIdentityOAuth(t)}async linkIdentityOAuth(t){var r;try{const{data:n,error:a}=await this._useSession(async s=>{var i,c,u,f,h;const{data:p,error:m}=s;if(m)throw m;const y=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,t.provider,{redirectTo:(i=t.options)===null||i===void 0?void 0:i.redirectTo,scopes:(c=t.options)===null||c===void 0?void 0:c.scopes,queryParams:(u=t.options)===null||u===void 0?void 0:u.queryParams,skipBrowserRedirect:!0});return await Xe(this.fetch,"GET",y,{headers:this.headers,jwt:(h=(f=p.session)===null||f===void 0?void 0:f.access_token)!==null&&h!==void 0?h:void 0})});if(a)throw a;return Yr()&&!(!((r=t.options)===null||r===void 0)&&r.skipBrowserRedirect)&&window.location.assign(n?.url),{data:{provider:t.provider,url:n?.url},error:null}}catch(n){if(ze(n))return{data:{provider:t.provider,url:null},error:n};throw n}}async linkIdentityIdToken(t){return await this._useSession(async r=>{var n;try{const{error:a,data:{session:s}}=r;if(a)throw a;const{options:i,provider:c,token:u,access_token:f,nonce:h}=t,p=await Xe(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,jwt:(n=s?.access_token)!==null&&n!==void 0?n:void 0,body:{provider:c,id_token:u,access_token:f,nonce:h,link_identity:!0,gotrue_meta_security:{captcha_token:i?.captchaToken}},xform:Zn}),{data:m,error:y}=p;return y?{data:{user:null,session:null},error:y}:!m||!m.session||!m.user?{data:{user:null,session:null},error:new Yo}:(m.session&&(await this._saveSession(m.session),await this._notifyAllSubscribers("USER_UPDATED",m.session)),{data:m,error:y})}catch(a){if(ze(a))return{data:{user:null,session:null},error:a};throw a}})}async unlinkIdentity(t){try{return await this._useSession(async r=>{var n,a;const{data:s,error:i}=r;if(i)throw i;return await Xe(this.fetch,"DELETE",`${this.url}/user/identities/${t.identity_id}`,{headers:this.headers,jwt:(a=(n=s.session)===null||n===void 0?void 0:n.access_token)!==null&&a!==void 0?a:void 0})})}catch(r){if(ze(r))return{data:null,error:r};throw r}}async _refreshAccessToken(t){const r=`#_refreshAccessToken(${t.substring(0,5)}...)`;this._debug(r,"begin");try{const n=Date.now();return await SC(async a=>(a>0&&await _C(200*Math.pow(2,a-1)),this._debug(r,"refreshing attempt",a),await Xe(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:t},headers:this.headers,xform:Zn})),(a,s)=>{const i=200*Math.pow(2,a);return s&&Ud(s)&&Date.now()+i-n<oi})}catch(n){if(this._debug(r,"error",n),ze(n))return{data:{session:null,user:null},error:n};throw n}finally{this._debug(r,"end")}}_isValidSession(t){return typeof t=="object"&&t!==null&&"access_token"in t&&"refresh_token"in t&&"expires_at"in t}async _handleProviderSignIn(t,r){const n=await this._getUrlForProvider(`${this.url}/authorize`,t,{redirectTo:r.redirectTo,scopes:r.scopes,queryParams:r.queryParams});return this._debug("#_handleProviderSignIn()","provider",t,"options",r,"url",n),Yr()&&!r.skipBrowserRedirect&&window.location.assign(n),{data:{provider:t,url:n},error:null}}async _recoverAndRefresh(){var t,r;const n="#_recoverAndRefresh()";this._debug(n,"begin");try{const a=await Ks(this.storage,this.storageKey);if(a&&this.userStorage){let i=await Ks(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!i&&(i={user:a.user},await ii(this.userStorage,this.storageKey+"-user",i)),a.user=(t=i?.user)!==null&&t!==void 0?t:Vd()}else if(a&&!a.user&&!a.user){const i=await Ks(this.storage,this.storageKey+"-user");i&&i?.user?(a.user=i.user,await ps(this.storage,this.storageKey+"-user"),await ii(this.storage,this.storageKey,a)):a.user=Vd()}if(this._debug(n,"session from storage",a),!this._isValidSession(a)){this._debug(n,"session is not valid"),a!==null&&await this._removeSession();return}const s=((r=a.expires_at)!==null&&r!==void 0?r:1/0)*1e3-Date.now()<$d;if(this._debug(n,`session has${s?"":" not"} expired with margin of ${$d}s`),s){if(this.autoRefreshToken&&a.refresh_token){const{error:i}=await this._callRefreshToken(a.refresh_token);i&&(console.error(i),Ud(i)||(this._debug(n,"refresh failed with a non-retryable error, removing the session",i),await this._removeSession()))}}else if(a.user&&a.user.__isUserNotAvailableProxy===!0)try{const{data:i,error:c}=await this._getUser(a.access_token);!c&&i?.user?(a.user=i.user,await this._saveSession(a),await this._notifyAllSubscribers("SIGNED_IN",a)):this._debug(n,"could not get user data, skipping SIGNED_IN notification")}catch(i){console.error("Error getting user data:",i),this._debug(n,"error getting user data, skipping SIGNED_IN notification",i)}else await this._notifyAllSubscribers("SIGNED_IN",a)}catch(a){this._debug(n,"error",a),console.error(a);return}finally{this._debug(n,"end")}}async _callRefreshToken(t){var r,n;if(!t)throw new Qn;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const a=`#_callRefreshToken(${t.substring(0,5)}...)`;this._debug(a,"begin");try{this.refreshingDeferred=new Df;const{data:s,error:i}=await this._refreshAccessToken(t);if(i)throw i;if(!s.session)throw new Qn;await this._saveSession(s.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",s.session);const c={data:s.session,error:null};return this.refreshingDeferred.resolve(c),c}catch(s){if(this._debug(a,"error",s),ze(s)){const i={data:null,error:s};return Ud(s)||await this._removeSession(),(r=this.refreshingDeferred)===null||r===void 0||r.resolve(i),i}throw(n=this.refreshingDeferred)===null||n===void 0||n.reject(s),s}finally{this.refreshingDeferred=null,this._debug(a,"end")}}async _notifyAllSubscribers(t,r,n=!0){const a=`#_notifyAllSubscribers(${t})`;this._debug(a,"begin",r,`broadcast = ${n}`);try{this.broadcastChannel&&n&&this.broadcastChannel.postMessage({event:t,session:r});const s=[],i=Array.from(this.stateChangeEmitters.values()).map(async c=>{try{await c.callback(t,r)}catch(u){s.push(u)}});if(await Promise.all(i),s.length>0){for(let c=0;c<s.length;c+=1)console.error(s[c]);throw s[0]}}finally{this._debug(a,"end")}}async _saveSession(t){this._debug("#_saveSession()",t),this.suppressGetSessionWarning=!0;const r=Object.assign({},t),n=r.user&&r.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!n&&r.user&&await ii(this.userStorage,this.storageKey+"-user",{user:r.user});const a=Object.assign({},r);delete a.user;const s=_v(a);await ii(this.storage,this.storageKey,s)}else{const a=_v(r);await ii(this.storage,this.storageKey,a)}}async _removeSession(){this._debug("#_removeSession()"),await ps(this.storage,this.storageKey),await ps(this.storage,this.storageKey+"-code-verifier"),await ps(this.storage,this.storageKey+"-user"),this.userStorage&&await ps(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const t=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{t&&Yr()&&window?.removeEventListener&&window.removeEventListener("visibilitychange",t)}catch(r){console.error("removing visibilitychange callback failed",r)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const t=setInterval(()=>this._autoRefreshTokenTick(),oi);this.autoRefreshTicker=t,t&&typeof t=="object"&&typeof t.unref=="function"?t.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(t),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const t=this.autoRefreshTicker;this.autoRefreshTicker=null,t&&clearInterval(t)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const t=Date.now();try{return await this._useSession(async r=>{const{data:{session:n}}=r;if(!n||!n.refresh_token||!n.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const a=Math.floor((n.expires_at*1e3-t)/oi);this._debug("#_autoRefreshTokenTick()",`access token expires in ${a} ticks, a tick lasts ${oi}ms, refresh threshold is ${bh} ticks`),a<=bh&&await this._callRefreshToken(n.refresh_token)})}catch(r){console.error("Auto refresh tick failed with error. This is likely a transient error.",r)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(t){if(t.isAcquireTimeout||t instanceof aw)this._debug("auto refresh token tick lock not available");else throw t}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!Yr()||!window?.addEventListener)return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window?.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(t){console.error("_handleVisibilityChange",t)}}async _onVisibilityChanged(t){const r=`#_onVisibilityChanged(${t})`;this._debug(r,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),t||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(r,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(t,r,n){const a=[`provider=${encodeURIComponent(r)}`];if(n?.redirectTo&&a.push(`redirect_to=${encodeURIComponent(n.redirectTo)}`),n?.scopes&&a.push(`scopes=${encodeURIComponent(n.scopes)}`),this.flowType==="pkce"){const[s,i]=await Qo(this.storage,this.storageKey),c=new URLSearchParams({code_challenge:`${encodeURIComponent(s)}`,code_challenge_method:`${encodeURIComponent(i)}`});a.push(c.toString())}if(n?.queryParams){const s=new URLSearchParams(n.queryParams);a.push(s.toString())}return n?.skipBrowserRedirect&&a.push(`skip_http_redirect=${n.skipBrowserRedirect}`),`${t}?${a.join("&")}`}async _unenroll(t){try{return await this._useSession(async r=>{var n;const{data:a,error:s}=r;return s?{data:null,error:s}:await Xe(this.fetch,"DELETE",`${this.url}/factors/${t.factorId}`,{headers:this.headers,jwt:(n=a?.session)===null||n===void 0?void 0:n.access_token})})}catch(r){if(ze(r))return{data:null,error:r};throw r}}async _enroll(t){try{return await this._useSession(async r=>{var n,a;const{data:s,error:i}=r;if(i)return{data:null,error:i};const c=Object.assign({friendly_name:t.friendlyName,factor_type:t.factorType},t.factorType==="phone"?{phone:t.phone}:t.factorType==="totp"?{issuer:t.issuer}:{}),{data:u,error:f}=await Xe(this.fetch,"POST",`${this.url}/factors`,{body:c,headers:this.headers,jwt:(n=s?.session)===null||n===void 0?void 0:n.access_token});return f?{data:null,error:f}:(t.factorType==="totp"&&u.type==="totp"&&(!((a=u?.totp)===null||a===void 0)&&a.qr_code)&&(u.totp.qr_code=`data:image/svg+xml;utf-8,${u.totp.qr_code}`),{data:u,error:null})})}catch(r){if(ze(r))return{data:null,error:r};throw r}}async _verify(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var n;const{data:a,error:s}=r;if(s)return{data:null,error:s};const i=Object.assign({challenge_id:t.challengeId},"webauthn"in t?{webauthn:Object.assign(Object.assign({},t.webauthn),{credential_response:t.webauthn.type==="create"?QC(t.webauthn.credential_response):ZC(t.webauthn.credential_response)})}:{code:t.code}),{data:c,error:u}=await Xe(this.fetch,"POST",`${this.url}/factors/${t.factorId}/verify`,{body:i,headers:this.headers,jwt:(n=a?.session)===null||n===void 0?void 0:n.access_token});return u?{data:null,error:u}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+c.expires_in},c)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",c),{data:c,error:u})})}catch(r){if(ze(r))return{data:null,error:r};throw r}})}async _challenge(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var n;const{data:a,error:s}=r;if(s)return{data:null,error:s};const i=await Xe(this.fetch,"POST",`${this.url}/factors/${t.factorId}/challenge`,{body:t,headers:this.headers,jwt:(n=a?.session)===null||n===void 0?void 0:n.access_token});if(i.error)return i;const{data:c}=i;if(c.type!=="webauthn")return{data:c,error:null};switch(c.webauthn.type){case"create":return{data:Object.assign(Object.assign({},c),{webauthn:Object.assign(Object.assign({},c.webauthn),{credential_options:Object.assign(Object.assign({},c.webauthn.credential_options),{publicKey:JC(c.webauthn.credential_options.publicKey)})})}),error:null};case"request":return{data:Object.assign(Object.assign({},c),{webauthn:Object.assign(Object.assign({},c.webauthn),{credential_options:Object.assign(Object.assign({},c.webauthn.credential_options),{publicKey:YC(c.webauthn.credential_options.publicKey)})})}),error:null}}})}catch(r){if(ze(r))return{data:null,error:r};throw r}})}async _challengeAndVerify(t){const{data:r,error:n}=await this._challenge({factorId:t.factorId});return n?{data:null,error:n}:await this._verify({factorId:t.factorId,challengeId:r.id,code:t.code})}async _listFactors(){var t;const{data:{user:r},error:n}=await this.getUser();if(n)return{data:null,error:n};const a={all:[],phone:[],totp:[],webauthn:[]};for(const s of(t=r?.factors)!==null&&t!==void 0?t:[])a.all.push(s),s.status==="verified"&&a[s.factor_type].push(s);return{data:a,error:null}}async _getAuthenticatorAssuranceLevel(){var t,r;const{data:{session:n},error:a}=await this.getSession();if(a)return{data:null,error:a};if(!n)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:s}=zd(n.access_token);let i=null;s.aal&&(i=s.aal);let c=i;((r=(t=n.user.factors)===null||t===void 0?void 0:t.filter(h=>h.status==="verified"))!==null&&r!==void 0?r:[]).length>0&&(c="aal2");const f=s.amr||[];return{data:{currentLevel:i,nextLevel:c,currentAuthenticationMethods:f},error:null}}async _getAuthorizationDetails(t){try{return await this._useSession(async r=>{const{data:{session:n},error:a}=r;return a?{data:null,error:a}:n?await Xe(this.fetch,"GET",`${this.url}/oauth/authorizations/${t}`,{headers:this.headers,jwt:n.access_token,xform:s=>({data:s,error:null})}):{data:null,error:new Qn}})}catch(r){if(ze(r))return{data:null,error:r};throw r}}async _approveAuthorization(t,r){try{return await this._useSession(async n=>{const{data:{session:a},error:s}=n;if(s)return{data:null,error:s};if(!a)return{data:null,error:new Qn};const i=await Xe(this.fetch,"POST",`${this.url}/oauth/authorizations/${t}/consent`,{headers:this.headers,jwt:a.access_token,body:{action:"approve"},xform:c=>({data:c,error:null})});return i.data&&i.data.redirect_url&&Yr()&&!r?.skipBrowserRedirect&&window.location.assign(i.data.redirect_url),i})}catch(n){if(ze(n))return{data:null,error:n};throw n}}async _denyAuthorization(t,r){try{return await this._useSession(async n=>{const{data:{session:a},error:s}=n;if(s)return{data:null,error:s};if(!a)return{data:null,error:new Qn};const i=await Xe(this.fetch,"POST",`${this.url}/oauth/authorizations/${t}/consent`,{headers:this.headers,jwt:a.access_token,body:{action:"deny"},xform:c=>({data:c,error:null})});return i.data&&i.data.redirect_url&&Yr()&&!r?.skipBrowserRedirect&&window.location.assign(i.data.redirect_url),i})}catch(n){if(ze(n))return{data:null,error:n};throw n}}async fetchJwk(t,r={keys:[]}){let n=r.keys.find(c=>c.kid===t);if(n)return n;const a=Date.now();if(n=this.jwks.keys.find(c=>c.kid===t),n&&this.jwks_cached_at+iC>a)return n;const{data:s,error:i}=await Xe(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(i)throw i;return!s.keys||s.keys.length===0||(this.jwks=s,this.jwks_cached_at=a,n=s.keys.find(c=>c.kid===t),!n)?null:n}async getClaims(t,r={}){try{let n=t;if(!n){const{data:y,error:w}=await this.getSession();if(w||!y.session)return{data:null,error:w};n=y.session.access_token}const{header:a,payload:s,signature:i,raw:{header:c,payload:u}}=zd(n);r?.allowExpired||PC(s.exp);const f=!a.alg||a.alg.startsWith("HS")||!a.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(a.kid,r?.keys?{keys:r.keys}:r?.jwks);if(!f){const{error:y}=await this.getUser(n);if(y)throw y;return{data:{claims:s,header:a,signature:i},error:null}}const h=IC(a.alg),p=await crypto.subtle.importKey("jwk",f,h,!0,["verify"]);if(!await crypto.subtle.verify(h,p,i,mC(`${c}.${u}`)))throw new Ch("Invalid JWT signature");return{data:{claims:s,header:a,signature:i},error:null}}catch(n){if(ze(n))return{data:null,error:n};throw n}}}Wl.nextInstanceID=0;const lA=Wl;class cA extends lA{constructor(t){super(t)}}class uA{constructor(t,r,n){var a,s,i;this.supabaseUrl=t,this.supabaseKey=r;const c=rC(t);if(!r)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",c),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",c),this.storageUrl=new URL("storage/v1",c),this.functionsUrl=new URL("functions/v1",c);const u=`sb-${c.hostname.split(".")[0]}-auth-token`,f={db:KT,realtime:JT,auth:Object.assign(Object.assign({},XT),{storageKey:u}),global:qT},h=tC(n??{},f);this.storageKey=(a=h.auth.storageKey)!==null&&a!==void 0?a:"",this.headers=(s=h.global.headers)!==null&&s!==void 0?s:{},h.accessToken?(this.accessToken=h.accessToken,this.auth=new Proxy({},{get:(p,m)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(m)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((i=h.auth)!==null&&i!==void 0?i:{},this.headers,h.global.fetch),this.fetch=ZT(r,this._getAccessToken.bind(this),h.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},h.realtime)),this.rest=new nT(new URL("rest/v1",c).href,{headers:this.headers,schema:h.db.schema,fetch:this.fetch}),this.storage=new WT(this.storageUrl.href,this.headers,this.fetch,n?.storage),h.accessToken||this._listenForAuthEvents()}get functions(){return new Wk(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(t){return this.rest.from(t)}schema(t){return this.rest.schema(t)}rpc(t,r={},n={head:!1,get:!1,count:void 0}){return this.rest.rpc(t,r,n)}channel(t,r={config:{}}){return this.realtime.channel(t,r)}getChannels(){return this.realtime.getChannels()}removeChannel(t){return this.realtime.removeChannel(t)}removeAllChannels(){return this.realtime.removeAllChannels()}async _getAccessToken(){var t,r;if(this.accessToken)return await this.accessToken();const{data:n}=await this.auth.getSession();return(r=(t=n.session)===null||t===void 0?void 0:t.access_token)!==null&&r!==void 0?r:this.supabaseKey}_initSupabaseAuthClient({autoRefreshToken:t,persistSession:r,detectSessionInUrl:n,storage:a,userStorage:s,storageKey:i,flowType:c,lock:u,debug:f},h,p){const m={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new cA({url:this.authUrl.href,headers:Object.assign(Object.assign({},m),h),storageKey:i,autoRefreshToken:t,persistSession:r,detectSessionInUrl:n,storage:a,userStorage:s,flowType:c,lock:u,debug:f,fetch:p,hasCustomAuthorizationHeader:Object.keys(this.headers).some(y=>y.toLowerCase()==="authorization")})}_initRealtimeClient(t){return new wT(this.realtimeUrl.href,Object.assign(Object.assign({},t),{params:Object.assign({apikey:this.supabaseKey},t?.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((r,n)=>{this._handleTokenChanged(r,"CLIENT",n?.access_token)})}_handleTokenChanged(t,r,n){(t==="TOKEN_REFRESHED"||t==="SIGNED_IN")&&this.changedAccessToken!==n?(this.changedAccessToken=n,this.realtime.setAuth(n)):t==="SIGNED_OUT"&&(this.realtime.setAuth(),r=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const iw=(e,t,r)=>new uA(e,t,r);function fA(){if(typeof window<"u"||typeof process>"u")return!1;const e=process.version;if(e==null)return!1;const t=e.match(/^v(\d+)\./);return t?parseInt(t[1],10)<=18:!1}fA()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const Ke={useSupabase:!0,supabase:{url:"https://atnwdqdagrkmspjkfrhg.supabase.co",anonKey:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImF0bndkcWRhZ3JrbXNwamtmcmhnIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjIxMDAwOTksImV4cCI6MjA3NzY3NjA5OX0.Jt5xv_xX5gvS6JPzbO82X631z3UmNCEmbTBxVyKwzPs",serviceRoleKey:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImF0bndkcWRhZ3JrbXNwamtmcmhnIiwicm9sZSI6InNlcnZpY2Vfcm9sZSIsImlhdCI6MTc2MjEwMDA5OSwiZXhwIjoyMDc3Njc2MDk5fQ.Rs9oNWpS_sYdyZGqvGr6n32p6GN3TWj-zQYZlZ4HP-g"},indexedDB:{name:"VirtualZoneDB",version:2},sync:{intervalMinutes:5,maxRetries:3,timeoutSeconds:30},development:{enableDetailedLogs:!1,forceOffline:!1}},lw=()=>Ke.useSupabase&&(!Ke.supabase.url||!Ke.supabase.anonKey)?(console.warn(" Supabase est habilitado pero faltan variables de entorno"),console.warn("VITE_SUPABASE_URL y VITE_SUPABASE_ANON_KEY son requeridos"),!1):!0,Av=localStorage.getItem("virtual_zone_use_supabase");Av!==null&&(Ke.useSupabase=Av==="true");typeof window<"u"&&lw();const ft=Object.freeze(Object.defineProperty({__proto__:null,config:Ke,validateConfig:lw},Symbol.toStringTag,{value:"Module"}));let Hd=null;const nr=()=>{if(!Ke.useSupabase)throw new Error("Supabase is not enabled. Check config.useSupabase");if(!Ke.supabase.url||!Ke.supabase.anonKey)throw new Error("Missing Supabase environment variables. Make sure VITE_SUPABASE_URL and VITE_SUPABASE_ANON_KEY are set.");return Hd||(Hd=iw(Ke.supabase.url,Ke.supabase.anonKey)),Hd};let Gd=null;const lo=()=>{if(!Ke.supabase.url||!Ke.supabase.serviceRoleKey)throw new Error("Supabase service role key is required to perform admin operations.");return Gd||(Gd=iw(Ke.supabase.url,Ke.supabase.serviceRoleKey)),Gd},cw=null,dt=Object.freeze(Object.defineProperty({__proto__:null,getSupabaseAdminClient:lo,getSupabaseClient:nr,supabase:cw},Symbol.toStringTag,{value:"Module"})),Ah="virtual_zone_users",ja="virtual_zone_current_user",Ph=["user","dt","admin"],dc=e=>{if(Array.isArray(e)){const t=e.map(r=>typeof r=="string"?r.toLowerCase():"").filter(r=>Ph.includes(r)).filter((r,n,a)=>a.indexOf(r)===n);return t.length?t:void 0}if(typeof e=="string"){const t=e.toLowerCase();if(Ph.includes(t))return[t]}},dA=(e,t="user")=>e?.includes("admin")?"admin":e?.includes("dt")?"dt":e?.includes("user")?"user":t,hA=e=>{if(!e)return null;const t=new Date(e);return Number.isNaN(t.getTime())?null:t.toLocaleDateString("es-ES",{day:"2-digit",month:"2-digit",year:"numeric"})},Ff=e=>{if(!e)return null;const t=e.status;if(!t||t==="active")return null;if(t==="suspended"){const r=hA(e.suspendedUntil),n="Esta cuenta est suspendida",a=r?`${n} hasta el ${r}`:n;return{message:e.suspendedReason?`${a}. Motivo: ${e.suspendedReason}`:a,status:"suspended"}}if(t==="banned"){const r="Esta cuenta ha sido baneada";return{message:e.banReason?`${r}. Motivo: ${e.banReason}`:r,status:"banned"}}return{message:"Esta cuenta no est activa",status:"inactive"}},uw=e=>{const t=new Error(e.message);return t.code="ACCOUNT_STATUS_BLOCK",t.status=e.status,t},sa=e=>{if(!e)throw new Error("Perfil invlido");const t=e.email==="admin@lavirtualzone.com",r=typeof e.role=="string"?e.role.toLowerCase():void 0,n=dc(e.roles);let a;t?a=["admin","dt"]:n&&n.length?a=n:r&&Ph.includes(r)?a=[r]:a=["user"],a=Array.from(new Set(a));const s=t?"admin":dA(a,"user"),i=["active","suspended","banned","deleted"],c=e.status,u=i.includes(c)?c:"active",f=typeof e.username=="string"&&e.username.trim().length>0?e.username:typeof e.email=="string"&&e.email.includes("@")?e.email.split("@")[0]:"usuario",h=typeof e.avatar=="string"&&e.avatar.trim().length>0?e.avatar:`https://ui-avatars.com/api/?name=${encodeURIComponent(f)}&background=111827&color=fff&size=128&bold=true`,p=(E,k=0)=>{if(typeof E=="number"&&Number.isFinite(E))return E;const b=Number(E);return Number.isFinite(b)?b:k},m=(E,k="")=>typeof E=="string"?E:k,y=typeof e.notifications=="boolean"?e.notifications:e.notifications===null||e.notifications===void 0?!0:!!e.notifications,w=a&&a.length?a:["user"],x=(E,k,b)=>typeof E=="string"?E:typeof k=="string"?k:b;return{id:e.id,username:f,email:m(e.email),role:s,roles:w,avatar:h,clubId:x(e.clubId,e.club_id)||void 0,club:x(e.club,e.club_name)||void 0,joinDate:x(e.joinDate,e.join_date,e.created_at)||new Date().toISOString(),status:u,bio:x(e.bio,e.about)||void 0,location:x(e.location)||void 0,website:x(e.website)||void 0,favoriteTeam:x(e.favoriteTeam,e.favorite_team)||void 0,favoritePosition:x(e.favoritePosition,e.favorite_position)||void 0,suspendedUntil:x(e.suspendedUntil,e.suspended_until)||void 0,suspendedReason:x(e.suspendedReason,e.suspended_reason)||void 0,banReason:x(e.banReason,e.ban_reason)||void 0,deletedAt:x(e.deletedAt,e.deleted_at)||void 0,deletedReason:x(e.deletedReason,e.deleted_reason)||void 0,notifications:y,lastLogin:x(e.lastLogin,e.last_login)||"",followers:p(e.followers),following:p(e.following)}},gA=e=>e instanceof Error?e.message:typeof e=="string"?e:e&&typeof e=="object"&&"message"in e&&typeof e.message=="string"?e.message:"Error desconocido",pA=e=>{const t=e.toLowerCase();return t.includes("invalid login credentials")?"Credenciales incorrectas. Revisa tu correo y contrasea.":t.includes("email not confirmed")?"Debes confirmar tu correo electrnico antes de iniciar sesin.":t.includes("network")||t.includes("fetch")?"No pudimos conectar con el servidor de autenticacin. Intntalo nuevamente.":t.includes("too many requests")||t.includes("rate limit")?"Demasiados intentos. Espera un momento antes de volver a intentarlo.":e},fw=async(e,t)=>{try{console.log(" Attempting Supabase login for:",e);const{data:r,error:n}=await nr().auth.signInWithPassword({email:e,password:t});if(n)throw console.error(" Supabase login error:",n.message),new Error(n.message);if(!r.user)throw new Error("No user data returned");console.log(" Supabase login successful, fetching profile...");const{data:a,error:s}=await nr().from("profiles").select("*").eq("id",r.user.id).single();if(s)throw console.error(" Error fetching profile:",s.message),new Error("Failed to load user profile");console.log(" Profile loaded successfully:",a.username);const i=dc(r.session?.user.user_metadata?.roles),c=i?{...a,roles:i}:a,u=sa(c),f=Ff(u);if(f)throw uw(f);return localStorage.setItem(ja,JSON.stringify(u)),u}catch(r){console.error(" Supabase login failed:",r);const n=gA(r),a=pA(n);throw a===n&&r instanceof Error?r:new Error(a)}},dw=async(e,t,r)=>{try{console.log(" Attempting Supabase registration for:",e,t);const{data:n,error:a}=await nr().auth.signUp({email:e,password:r,options:{data:{username:t}}});if(a)throw console.error(" Supabase registration error:",a.message),new Error(a.message);if(!n.user)throw new Error("Registration failed - no user data returned");console.log(" Supabase registration successful, profile should be created by trigger"),await new Promise(u=>setTimeout(u,1e3));const{data:s,error:i}=await nr().from("profiles").select("*").eq("id",n.user.id).single();if(i)throw console.error(" Error fetching created profile:",i.message),new Error("Profile creation failed");console.log(" Profile created and loaded successfully:",s.username);const c=sa(s);return localStorage.setItem(ja,JSON.stringify(c)),c}catch(n){throw console.error(" Supabase registration failed:",n),n}},hw=async()=>{try{console.log(" Attempting Supabase logout");const{error:e}=await nr().auth.signOut();if(e)throw console.error(" Supabase logout error:",e.message),new Error(e.message);localStorage.removeItem(ja),console.log(" Supabase logout successful")}catch(e){throw console.error(" Supabase logout failed:",e),e}},Ih=async()=>{try{const t=nr().auth.getSession(),r=new Promise((m,y)=>setTimeout(()=>y(new Error("Session query timeout")),8e3)),{data:{session:n},error:a}=await Promise.race([t,r]).catch(m=>(console.warn(" getSupabaseCurrentUser: Session timeout, using fallback"),{data:{session:null},error:{message:m.message}}));if(a&&a.message!=="Session query timeout")return console.error(" getSupabaseCurrentUser: Error getting session:",a.message),null;if(!n?.user)return null;const s=nr().from("profiles").select("*").eq("id",n.user.id).single(),i=new Promise((m,y)=>setTimeout(()=>y(new Error("Profile query timeout")),6e3)),{data:c,error:u}=await Promise.race([s,i]).catch(m=>(console.warn(" getSupabaseCurrentUser: Profile query timeout, using fallback"),{data:null,error:{message:m.message}}));if(u&&u.message!=="Profile query timeout")return console.error(" getSupabaseCurrentUser: Error fetching profile:",u.message),null;if(!c)return null;const f=dc(n.user.user_metadata?.roles),h=f?{...c,roles:f}:c,p=sa(h);return localStorage.setItem(ja,JSON.stringify(p)),p}catch(e){return console.error(" getSupabaseCurrentUser: Unexpected error:",e),null}},gw=async e=>{try{console.log(" Attempting password reset for:",e);const{error:t}=await nr().auth.resetPasswordForEmail(e,{redirectTo:`${window.location.origin}/reset-password`});if(t)throw console.error(" Supabase password reset error:",t.message),new Error(t.message);console.log(" Supabase password reset email sent successfully")}catch(t){throw console.error(" Supabase password reset failed:",t),t}},pw=async(e,t)=>{try{console.log(" Updating Supabase user profile:",e),console.log(" Using admin client:",!!Ke.supabase.serviceRoleKey);const r=["username","email","role","roles","avatar","clubId","club_id","club","status","bio","location","website","favoriteTeam","favoritePosition","suspendedUntil","suspendedReason","banReason","deletedAt","deletedReason","notifications","lastLogin","followers"],n={};for(const[f,h]of Object.entries(t))if(h!==void 0)if(r.includes(f)){if(h===null){const m=f.replace(/[A-Z]/g,y=>`_${y.toLowerCase()}`);n[m]=null;continue}if(typeof h=="object"&&h!==null&&!Array.isArray(h)){console.log(` Skipping complex object field: ${f}`);continue}if(Array.isArray(h))if(f==="roles"&&Array.isArray(h)){const m=h.includes("admin")?"admin":h.includes("dt")?"dt":"user";console.log(` Converting roles array to primary role: ${h}  ${m}`),n.role=m;continue}else{console.log(` Skipping array field: ${f}`);continue}const p=f.replace(/[A-Z]/g,m=>`_${m.toLowerCase()}`);console.log(` Converting field: ${f}  ${p} = ${h}`),n[p]=h}else console.log(` Skipping not allowed field: ${f}`);Object.keys(n).length>0&&(n.updated_at=new Date().toISOString()),console.log(" Filtered updates for Supabase:",n);const a=Hl();console.log(" Current user before update:",a);const s=Ke.supabase.serviceRoleKey?lo():nr();if(Ke.supabase.serviceRoleKey){const f=lo(),h={};typeof t.email=="string"&&t.email.trim().length>0&&(h.email=t.email.trim());const p={};typeof t.username=="string"&&t.username.trim().length>0&&(p.username=t.username.trim()),Array.isArray(t.roles)&&t.roles.length>0&&(p.roles=t.roles);const m=dc(p.roles);if(m?p.roles=m:delete p.roles,Object.keys(p).length>0&&(h.user_metadata=p),Object.keys(h).length>0){const{error:y}=await f.auth.admin.updateUserById(e,h);if(y)throw console.error(" Error updating auth metadata:",y.message),new Error(y.message)}}if(Object.keys(n).length>0){const{error:f}=await s.from("profiles").update(n).eq("id",e);if(f)throw console.error(" Error updating profile:",f.message),new Error(f.message)}else console.log(" No hay campos para actualizar en profiles, solo se sincroniz auth metadata.");const{data:i,error:c}=await s.from("profiles").select("*").eq("id",e).maybeSingle();if(c)throw console.error(" Error fetching profile after update:",c.message),new Error(c.message);if(!i)throw new Error("No se encontr el perfil actualizado despus de la actualizacin");console.log(" Profile updated successfully");const u=sa(i);return console.log(" Normalized profile:",u),console.log(" Normalized roles:",u.roles),console.log(" Normalized role:",u.role),localStorage.setItem(ja,JSON.stringify(u)),u}catch(r){throw console.error(" Failed to update Supabase user:",r),r}},mw=async(e,t)=>Ke.useSupabase?(console.log(" Using Supabase authentication"),await fw(e,t)):(console.log(" Using legacy localStorage authentication"),mA(e,t)),vw=async(e,t,r)=>Ke.useSupabase?(console.log(" Using Supabase registration"),await dw(e,t,r)):(console.log(" Using legacy localStorage registration"),registerLegacy(e,t,r)),xw=async()=>{Ke.useSupabase?(console.log(" Using Supabase logout"),await hw()):(console.log(" Using legacy localStorage logout"),vA())},Hl=()=>{if(Ke.useSupabase){const e=localStorage.getItem(ja);if(!e)return null;try{const t=JSON.parse(e);return sa(t)}catch(t){console.warn(" Error normalizando usuario almacenado, usando datos crudos:",t);try{return JSON.parse(e)}catch{return null}}}else return Ai()},yw=async e=>{if(Ke.useSupabase)return console.log(" Using Supabase password reset"),await gw(e);throw console.log(" Password reset not available in legacy mode"),new Error("La recuperacin de contrasea no est disponible en el modo legacy")},Oh=async e=>{const t=Hl();if(!t)throw new Error("No user logged in");let r;Ke.useSupabase?r=await pw(t.id,e):r=xA(e);try{const{useAuthStore:n}=await Z(async()=>{const{useAuthStore:s}=await Promise.resolve().then(()=>vn);return{useAuthStore:s}},void 0),a=n.getState();if(a.user&&a.user.id===t.id){console.log(" Actualizando authStore con el perfil actualizado del usuario");const s={...r,clubId:r.club_id||r.clubId},i={...a.user,...s,roles:s.roles||a.user.roles||(s.role==="admin"?["admin","dt"]:s.role==="dt"?["dt"]:a.user.role==="admin"?["admin","dt"]:a.user.role==="dt"?["dt"]:["user"])};console.log(" Final user data for authStore:",i),console.log(" Final roles:",i.roles),n.setState({user:i}),localStorage.setItem("virtual_zone_current_user",JSON.stringify(i)),console.log(" Perfil guardado en localStorage como backup")}}catch(n){console.warn(" No se pudo actualizar authStore:",n)}return r},Gl=[{id:"1",username:"admin",email:"admin@virtualzone.com",password:"admin123",role:"admin",roles:["admin","dt"],avatar:"https://ui-avatars.com/api/?name=Admin&background=9f65fd&color=fff&size=128&bold=true",createdAt:new Date().toISOString(),status:"active",achievements:["founder"],following:{users:[],clubs:[],players:[]}},{id:"2",username:"usuario",email:"usuario@test.com",password:"usuario123",role:"user",roles:["user"],createdAt:new Date().toISOString(),status:"active",achievements:[],following:{users:[],clubs:[],players:[]}},{id:"2",username:"usuario_dt",email:"user2@test.com",password:"dt123",role:"dt",roles:["dt"],avatar:"https://ui-avatars.com/api/?name=User2&background=3b82f6&color=fff&size=128&bold=true",createdAt:new Date().toISOString(),status:"active",achievements:[],following:{users:[],clubs:[],players:[]}},{id:"3",username:"entrenador",email:"dt@test.com",password:"dt456",role:"dt",roles:["dt"],avatar:"https://ui-avatars.com/api/?name=Coach&background=00b3ff&color=fff&size=128&bold=true",createdAt:new Date().toISOString(),status:"active",achievements:["first_win","first_transfer"],following:{users:[],clubs:["Rayo Digital FC"],players:[]}}],za=()=>{const e=localStorage.getItem(Ah);if(!e)return localStorage.setItem(Ah,JSON.stringify(Gl)),Gl;const t=JSON.parse(e);let r=!1;const n=t.findIndex(s=>s.username&&s.username.toLowerCase()==="admin");if(n>=0){const s=t[n];s.role!=="admin"&&(s.role="admin",r=!0),Array.isArray(s.roles)?s.roles.includes("admin")||(s.roles=[...s.roles,"admin"],r=!0):(s.roles=["admin"],r=!0),s.status&&s.status!=="active"&&(s.status="active",r=!0),t[n]=s}if(!t.some(s=>s.role==="admin"||Array.isArray(s.roles)&&s.roles.includes("admin"))){const s=new Date().toISOString(),i={id:`admin-${Date.now()}`,username:"admin",email:"admin@virtualzone.com",role:"admin",avatar:"https://ui-avatars.com/api/?name=Admin&background=9f65fd&color=fff&size=128&bold=true",joinDate:s,status:"active",notifications:!0,lastLogin:"",followers:0,following:0};t.push(i),r=!0}if(r){Ci(t);try{const s=Ai();s&&s.username&&s.username.toLowerCase()==="admin"&&n>=0&&Pi(t[n])}catch{}}return t},Ci=e=>{localStorage.setItem(Ah,JSON.stringify(e))},Ai=()=>{const e=localStorage.getItem(ja);return e?JSON.parse(e):null},Pi=e=>{e?localStorage.setItem(ja,JSON.stringify(e)):localStorage.removeItem(ja)},mA=(e,t)=>{const r=za(),n=r.find(s=>s.username.toLowerCase()===e.toLowerCase());if(!n)throw new Error("Usuario no encontrado");if(n.password&&t!==n.password)throw new Error("Contrasea incorrecta");const a=Ff(n);if(a)throw uw(a);return n.lastLogin=new Date().toISOString(),Ci(r.map(s=>s.id===n.id?n:s)),Pi(n),n},vA=()=>{Pi(null)},xA=e=>{const r=za().map(a=>a.id===e.id?e:a);Ci(r);const n=Ai();return n&&n.id===e.id&&Pi(e),e},Dh=()=>za(),yA=e=>{const t=za(),r=Date.now().toString(),n=e.username.trim(),a=e.email.trim(),s=`https://ui-avatars.com/api/?name=${encodeURIComponent(n)}&background=111827&color=fff&size=128&bold=true`,i={id:r,username:n,email:a,role:e.role,roles:e.roles&&e.roles.length?e.roles:void 0,avatar:s,clubId:e.clubId,joinDate:new Date().toISOString(),status:e.status||"active",notifications:!0,lastLogin:"",followers:0,following:0};return t.push(i),Ci(t),i},ww=async e=>{if(!e.password)throw new Error("Se requiere una contrasea para crear usuarios en Supabase");const t=lo(),{data:r,error:n}=await t.auth.admin.createUser({email:e.email,password:e.password,email_confirm:!0,user_metadata:{username:e.username,roles:e.roles}});if(n)throw console.error(" Error creating Supabase user:",n),n;if(!r)throw new Error("No se pudo crear el usuario en Supabase");const a={id:r.id,username:e.username,email:e.email,role:e.role,status:e.status||"active",avatar:`https://ui-avatars.com/api/?name=${encodeURIComponent(e.username)}&background=111827&color=fff&size=128&bold=true`,notifications:!0,last_login:new Date().toISOString(),followers:0,following:0};e.clubId&&(a.club_id=e.clubId);const{error:s}=await t.from("profiles").upsert(a,{onConflict:"id"});if(s)throw console.error(" Error upserting Supabase profile:",s),s;const{data:i,error:c}=await t.from("profiles").select("*").eq("id",r.id).single();if(c)throw console.error(" Error fetching Supabase profile after creation:",c),c;return sa(i)},wA=async e=>Ke.useSupabase?ww(e):yA(e),_A=e=>{const r=za().filter(a=>a.id!==e);Ci(r);const n=Ai();n&&n.id===e&&Pi(null)},_w=async e=>{const t=lo(),{error:r}=await t.from("profiles").delete().eq("id",e);if(r)throw console.error(" Error deleting Supabase profile:",r),r;const{error:n}=await t.auth.admin.deleteUser(e);if(n)throw console.error(" Error deleting Supabase auth user:",n),n},SA=async e=>{if(Ke.useSupabase){await _w(e);return}_A(e)},EA=async()=>{const e=Ke.supabase.serviceRoleKey?lo():nr(),{data:t,error:r}=await e.from("profiles").select("*");if(r)throw console.error(" Error fetching profiles:",r.message),new Error(r.message);let n={};if(Ke.supabase.serviceRoleKey){const a=lo(),s=1e3;let i=1,c=!0;for(;c;){const{data:u,error:f}=await a.auth.admin.listUsers({page:i,perPage:s});if(f)throw console.error(" Error fetching auth users:",f.message),new Error(f.message);const h=u?.users||[];h.forEach(p=>{const m=dc(p.user_metadata?.roles);m&&(n[p.id]=m)}),c=h.length===s,i++}}return(t||[]).map(a=>{const s={...a};return n[a.id]&&(s.roles=n[a.id]),sa(s)})},bA=async()=>Ke.useSupabase?await EA():Promise.resolve(za()),kA=e=>za().find(r=>r.id===e)||null,Sw=e=>{try{const r=za().find(u=>u.id===e.id);if(!r)throw new Error("Usuario no encontrado");const n={user:r,exportDate:new Date().toISOString(),exportReason:"Descarga de datos personales desde La Virtual Zone",version:"1.0.0"},a=JSON.stringify(n,null,2),s=new Blob([a],{type:"application/json"}),i=URL.createObjectURL(s),c=document.createElement("a");c.href=i,c.download=`virtual-zone-data-${e.username}-${new Date().toISOString().split("T")[0]}.json`,document.body.appendChild(c),c.click(),document.body.removeChild(c),URL.revokeObjectURL(i)}catch(t){throw console.error("Error downloading user data:",t),new Error("Error al descargar los datos")}},TA=(e,t,r)=>{try{const n=za(),a=Ai(),s=n.findIndex(f=>f.id===e);if(s===-1)throw new Error("Usuario no encontrado");const i=n[s];if(!t||t.trim()==="")throw new Error("Debes ingresar tu contrasea actual");if(!r||r.length<6)throw new Error("La nueva contrasea debe tener al menos 6 caracteres");if(t===r)throw new Error("La nueva contrasea debe ser diferente a la actual");const c={...i,updatedAt:new Date().toISOString()},u=[...n];u[s]=c,Ci(u),a&&a.id===e&&Pi(c)}catch(n){throw console.error("Error changing password:",n),n}},Ew=async(e,t)=>{if(Ke.useSupabase){const n=nr(),{data:{session:a},error:s}=await n.auth.getSession();if(s)throw console.error("Error fetching session for password change:",s),new Error("No se pudo verificar la sesin actual");const i=a?.user?.email;if(!i)throw new Error("No se pudo obtener el correo del usuario actual");const{error:c}=await n.auth.signInWithPassword({email:i,password:e});if(c)throw console.error("Supabase password verification failed:",c),new Error("La contrasea actual es incorrecta");const{error:u}=await n.auth.updateUser({password:t});if(u)throw console.error("Supabase password update failed:",u),new Error(u.message||"No se pudo actualizar la contrasea");return}const r=Ai();if(!r)throw new Error("No hay usuario autenticado");TA(r.id,e,t)},wl=Object.freeze(Object.defineProperty({__proto__:null,TEST_USERS:Gl,changePassword:Ew,createSupabaseUser:ww,createUser:wA,deleteSupabaseUser:_w,deleteUser:SA,downloadUserData:Sw,fetchUsers:bA,getAccountStatusError:Ff,getCurrentUser:Hl,getSupabaseCurrentUser:Ih,getUserById:kA,listUsers:Dh,login:mw,logout:xw,normalizeSupabaseProfile:sa,register:vw,resetPassword:yw,supabaseLogin:fw,supabaseLogout:hw,supabaseRegister:dw,supabaseResetPassword:gw,updateSupabaseUser:pw,updateUser:Oh},Symbol.toStringTag,{value:"Module"})),CA=(e,t="Error al procesar la autenticacion")=>{if(e instanceof Error&&e.message)return e.message;if(typeof e=="string"&&e.trim())return e;if(e&&typeof e=="object"&&"message"in e){const r=e.message;if(typeof r=="string"&&r.trim())return r}return t},AA=e=>e?{status:e.status,message:e.message}:null,wi=uy((e,t)=>({user:null,isAuthenticated:!1,isLoading:!0,isProcessingAuth:!1,authError:null,accountBlock:null,clearAuthError:()=>e({authError:null}),clearAccountBlock:()=>e({accountBlock:null}),hasRole:r=>{try{const n=t();if(!n.user)return!1;const a=n.user.role===r,s=Array.isArray(n.user.roles)&&n.user.roles.includes(r);return a||s}catch{return!1}},login:async(r,n)=>{try{console.log(" AuthStore: Attempting login"),e({isLoading:!0,authError:null,accountBlock:null});const a=await mw(r,n);return e({user:a,isAuthenticated:!0,isLoading:!1,authError:null,accountBlock:null}),console.log(" AuthStore: Login successful for:",a.username),a}catch(a){console.error(" AuthStore: Login failed:",a);const s=typeof a=="object"&&a!==null&&"code"in a&&a.code==="ACCOUNT_STATUS_BLOCK",i=CA(a,"Error al iniciar sesion");throw e({isLoading:!1,authError:i,accountBlock:s?{status:a.status||"inactive",message:i}:null}),a instanceof Error?a:new Error(i)}},register:async(r,n,a)=>{try{console.log(" AuthStore: Attempting registration"),e({isLoading:!0});const s=await vw(r,n,a);return e({user:s,isAuthenticated:!0,isLoading:!1}),console.log(" AuthStore: Registration successful for:",s.username),s}catch(s){throw console.error(" AuthStore: Registration failed:",s),e({isLoading:!1}),s}},resetPassword:async r=>{try{console.log(" AuthStore: Attempting password reset"),e({isLoading:!0}),await yw(r),console.log(" AuthStore: Password reset email sent successfully"),e({isLoading:!1})}catch(n){throw console.error(" AuthStore: Password reset failed:",n),e({isLoading:!1}),n}},logout:async()=>{try{console.log(" AuthStore: Attempting logout"),e({isLoading:!0}),await xw(),e({user:null,isAuthenticated:!1,isLoading:!1}),console.log(" AuthStore: Logout successful")}catch(r){throw console.error(" AuthStore: Logout failed:",r),e({isLoading:!1}),r}},updateUser:async r=>{let n=t().user;if(!n)try{const a=localStorage.getItem("virtual_zone_current_user");if(a){const s=JSON.parse(a);n=s,e({user:s,isAuthenticated:!0})}}catch{console.warn(" AuthStore: No stored session available while updating user")}if(!n)throw new Error("No user logged in");try{console.log(" AuthStore: Updating user profile"),e({isLoading:!0});const a=await Oh(r);return e({user:a,isLoading:!1}),console.log(" AuthStore: User profile updated"),a}catch(a){throw console.error(" AuthStore: Failed to update user:",a),e({isLoading:!1}),a}},downloadUserData:()=>{const r=t();r.user&&Sw(r.user)},deleteAccount:async()=>{if(t().user)try{await Oh({status:"deleted",deleted_at:new Date().toISOString()}),e({user:null,isAuthenticated:!1,isLoading:!1})}catch(n){throw console.error("Error deleting account:",n),n}},changePassword:async(r,n)=>{if(!t().user)throw new Error("No hay usuario autenticado");try{e({isLoading:!0}),await Ew(r,n),e({isLoading:!1})}catch(s){throw console.error("Error changing password:",s),e({isLoading:!1}),s}},initializeAuth:async()=>{try{console.log(" AuthStore: Initializing authentication");const r=async(n,a={})=>{const s=Ff(n);if(!s)return!1;if(a.signOut)try{await cw.auth.signOut()}catch(i){console.warn(" AuthStore: Failed to sign out after blocked status",i)}return localStorage.removeItem("virtual_zone_current_user"),e({user:null,isAuthenticated:!1,isLoading:!1,authError:s.message,accountBlock:AA(s)}),!0};if(Ke.useSupabase)try{const n=nr(),{data:{subscription:a}}=n.auth.onAuthStateChange(async(i,c)=>{if(console.log(" AuthStore: Auth state changed:",i,!!c),t().isProcessingAuth){console.log(" AuthStore: Auth processing already in progress, skipping...");return}e({isProcessingAuth:!0});try{if(c?.user){console.log(" AuthStore: User authenticated, getting profile...");try{const f=Ih(),h=new Promise((m,y)=>setTimeout(()=>y(new Error("Profile fetch timeout")),8e3));let p=await Promise.race([f,h]).catch(m=>(console.warn(" AuthStore: Profile fetch timeout, checking localStorage"),null));if(console.log(" AuthStore: Profile result:",p?"found":"not found"),!p){const m=localStorage.getItem("virtual_zone_current_user");if(m)try{const y=JSON.parse(m),w=sa(y);console.log(" AuthStore: Using localStorage fallback for auth change:",w.username),p=w}catch{console.warn(" AuthStore: Could not parse localStorage user for auth change")}}if(p){if(await r(p,{signOut:!0}))return;e({user:p,isAuthenticated:!0,isLoading:!1,accountBlock:null}),console.log(" AuthStore: User session restored:",p.username,"Role:",p.role,"Club:",p.clubId)}else{const m=t();if(m.user&&m.user.id===c.user.id)console.log(" AuthStore: Keeping existing user during auth state change:",m.user.username),e({isAuthenticated:!0,isLoading:!1});else{console.warn(" AuthStore: Using basic user (all fallbacks failed)");const y=c.user.email==="admin@lavirtualzone.com",w={id:c.user.id,username:c.user.email?.split("@")[0]||"user",email:c.user.email||"",role:y?"admin":"user",roles:y?["admin","dt"]:["user"],status:"active"};e({user:w,isAuthenticated:!0,isLoading:!1}),console.log(` AuthStore: Basic ${y?"admin":"user"} created:`,w.username)}}}catch(f){console.error(" AuthStore: Error restoring session:",f);const h=c.user.email==="admin@lavirtualzone.com",p={id:c.user.id,username:c.user.email?.split("@")[0]||"user",email:c.user.email||"",role:h?"admin":"user",roles:h?["admin","dt"]:["user"],status:"active"};e({user:p,isAuthenticated:!0,isLoading:!1}),console.log(` AuthStore: Fallback ${h?"admin":"user"} created:`,p.username)}}else e({user:null,isAuthenticated:!1,isLoading:!1}),console.log(" AuthStore: User logged out")}finally{e({isProcessingAuth:!1})}}),{data:{session:s}}=await n.auth.getSession();if(s?.user){console.log(" AuthStore: Initial session found, loading profile...");try{const i=Ih(),c=new Promise((f,h)=>setTimeout(()=>h(new Error("Initial profile fetch timeout")),8e3));let u=await Promise.race([i,c]).catch(f=>(console.warn(" AuthStore: Initial profile fetch timeout, trying localStorage fallback"),null));if(console.log(" AuthStore: Initial profile result:",u?"found":"not found"),!u){const f=localStorage.getItem("virtual_zone_current_user");if(f)try{const h=JSON.parse(f),p=sa(h);console.log(" AuthStore: Using localStorage fallback for user:",p.username),u=p}catch{console.warn(" AuthStore: Could not parse localStorage user")}}if(!u){const f=localStorage.getItem("virtual_zone_current_user");if(f)try{const h=JSON.parse(f),p=sa(h);console.log(" AuthStore: Emergency localStorage load for user:",p.username),u=p}catch{console.warn(" AuthStore: Emergency localStorage load failed")}}if(u){if(await r(u,{signOut:!0}))return;e({user:u,isAuthenticated:!0,isLoading:!1,accountBlock:null}),console.log(" AuthStore: Initial user loaded:",u.username,"Role:",u.role,"Club:",u.clubId)}else{const f=s.user.email==="admin@lavirtualzone.com",h={id:s.user.id,username:s.user.email?.split("@")[0]||"user",email:s.user.email||"",role:f?"admin":"user",roles:f?["admin","dt"]:["user"],status:"active"};e({user:h,isAuthenticated:!0,isLoading:!1}),console.log(` AuthStore: Initial basic ${f?"admin":"user"} created:`,h.username)}}catch(i){console.error(" AuthStore: Error loading initial profile:",i);const c=s.user.email==="admin@lavirtualzone.com",u={id:s.user.id,username:s.user.email?.split("@")[0]||"user",email:s.user.email||"",role:c?"admin":"user",roles:c?["admin","dt"]:["user"],status:"active"};e({user:u,isAuthenticated:!0,isLoading:!1}),console.log(` AuthStore: Initial fallback ${c?"admin":"user"} created:`,u.username)}}else console.log(" AuthStore: No initial session found"),e({isLoading:!1})}catch(n){console.error(" AuthStore: Failed to initialize Supabase auth:",n),console.log(" AuthStore: Falling back to legacy authentication");const a=Hl();if(await r(a,{signOut:!0}))return;e({user:a,isAuthenticated:!!a,isLoading:!1,accountBlock:null})}else{console.log(" AuthStore: Using legacy localStorage auth");const n=Hl();if(await r(n))return;e({user:n,isAuthenticated:!!n,isLoading:!1,accountBlock:null})}}catch(r){console.error(" AuthStore: Error initializing auth:",r),e({user:null,isAuthenticated:!1,isLoading:!1})}}})),vn=Object.freeze(Object.defineProperty({__proto__:null,useAuthStore:wi},Symbol.toStringTag,{value:"Module"})),PA=e=>{const t=!e.clubId||e.clubId==="libre"||e.clubId==="free";return{id:e.id,name:e.name,age:e.age||25,position:e.position,nationality:e.nationality||"Argentina",club_id:t?null:e.clubId,overall:e.overall||50,potential:e.potential||e.overall||50,transfer_listed:e.transferListed||!1,transfer_value:e.transferValue||0,image:e.image||"",attributes:e.attributes,skills:e.skills||[],playing_styles:e.playingStyles||[],contract:e.contract||{expires:new Date().toISOString(),salary:0},form:e.form||3,goals:e.goals||0,assists:e.assists||0,appearances:e.appearances||0,matches:e.matches||0,dorsal:e.dorsal||1,injury_resistance:e.injuryResistance||50,height:e.height,weight:e.weight,updated_at:new Date().toISOString()}},bw=async e=>{if(e.length)try{const{config:t}=await Z(async()=>{const{config:s}=await Promise.resolve().then(()=>ft);return{config:s}},void 0);if(!t.useSupabase){console.log("MarketRules: Supabase sync disabled, skipping batch sync...");return}const{getSupabaseClient:r}=await Z(async()=>{const{getSupabaseClient:s}=await Promise.resolve().then(()=>dt);return{getSupabaseClient:s}},void 0),n=r();console.log(`MarketRules: Syncing ${e.length} jugadores con Supabase en lotes...`);const a=100;for(let s=0;s<e.length;s+=a){const i=e.slice(s,s+a).map(PA),{error:c}=await n.from("players").upsert(i,{onConflict:"id"});if(c)throw c;console.log(`MarketRules: Lote ${Math.min(s+a,e.length)} / ${e.length} sincronizado`)}console.log("MarketRules: Sincronizacin en lotes completada")}catch(t){console.error("MarketRules: Failed to sync players batch to Supabase:",t)}};function kw(e){const t=Math.max(0,e.transferValue||0);let r=2e5,n=5e5;e.overall>=75&&e.overall<=79?(r=5e5,n=15e5):e.overall>=80&&e.overall<=84?(r=15e5,n=3e6):e.overall>=85&&e.overall<=89?(r=3e6,n=6e6):e.overall>=90&&(r=6e6,n=12e6);const a=e.overall>=90?2:e.overall>=85?1.6:e.overall>=80?1.4:1.2;return{marketValue:t,minTransferFee:Math.round(t*.8),salaryRange:{min:Math.round(r),max:Math.round(n)},releaseClause:Math.round(t*a)}}function Tw(e){return!e.clubId||e.clubId==="free"||e.clubId==="libre"||e.transferValue===0}function IA(e){const{player:t,buyer:r,amount:n}=e,a=Tw(t),{minTransferFee:s}=kw(t);return r.budget<n?{ok:!1,reason:"Presupuesto insuficiente para la oferta"}:!a&&n<s?{ok:!1,reason:`La oferta mnima es ${s.toLocaleString("es-ES")} (80% del valor)`}:{ok:!0}}function Cw(){const e=new Date,t=new Date;return t.setDate(e.getDate()-7),{fromISO:t.toISOString(),toISO:e.toISOString()}}function OA(e){const t=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate()));t.setUTCDate(t.getUTCDate()+4-(t.getUTCDay()||7));const r=new Date(Date.UTC(t.getUTCFullYear(),0,1)),n=Math.ceil(((t.getTime()-r.getTime())/864e5+1)/7);return`${t.getUTCFullYear()}-W${String(n).padStart(2,"0")}`}function DA(){const e="virtual_zone_last_victory_bonus_week",t=localStorage.getItem(e)||"",r=OA(new Date);if(t===r)return{applied:0};const{tournaments:n,clubs:a,updateClubs:s}=mr.getState(),{fromISO:i}=Cw(),c=new Date(i).getTime();let u=0;const f={};if((n||[]).forEach(h=>{(h.matches||[]).forEach(p=>{if(p.status==="finished"&&typeof p.homeScore=="number"&&typeof p.awayScore=="number"&&(p.date?new Date(p.date).getTime():0)>=c){const y=p.homeScore>p.awayScore?p.homeTeam:p.awayScore>p.homeScore?p.awayTeam:null;y&&(f[y]=(f[y]||0)+15e6)}})}),Object.keys(f).length>0){const h=(a||[]).map(p=>{const m=f[p.name]||0;return m>0&&u++,m>0?{...p,budget:p.budget+m}:p});s(h)}return localStorage.setItem(e,r),{applied:u}}function ug(e){const t={72:2e7,73:2e7,74:2e7,75:2e7,76:32e6,77:36e6,78:5e7,79:5e7,80:59e6,81:83e6,82:92e6,83:116e6,84:14e7,85:164e6,86:21e7,87:27e7,88:3e8,89:35e7,90:5e8,91:6e8,92:8e8,93:1e9,94:12e8,95:1356e6,96:16e8,97:1818e6,98:2018e6,99:2648e6,100:3248e6,101:4136e6};if(e<72)return Math.max(1e6,t[72]*(e/72));if(e>101){const r=t[101],n=t[101]-t[100];return r+n*(e-101)}return t[e]||t[72]}function Rf(e){const t={72:1e6,73:1e6,74:2e6,75:2e6,76:4e6,77:4e6,78:4e6,79:4e6,80:5e6,81:1e7,82:16e6,83:2e7,84:24e6,85:26e6,86:3e7,87:35e6,88:4e7,89:42e6,90:45e6,91:46e6,92:46e6,93:48e6,94:5e7,95:67e6,96:74e6,97:81e6,98:84e6,99:132e6,100:165e6,101:206e6};if(e<72)return Math.max(2e5,t[72]*(e/72));if(e>101){const r=t[101],n=t[101]-t[100];return r+n*(e-101)}return t[e]||t[72]}async function Aw(){const{players:e,updatePlayers:t}=mr.getState();let r=0,n=0,a=!1;const s=e.map(i=>{i.contract||(i.contract={salary:0,expires:new Date(Date.now()+3*365*24*60*60*1e3).toISOString()});const c=i.contract.salary||0,u=Rf(i.overall);return Math.abs(c-u)>1e3?(a=!0,r++,n+=u,{...i,contract:{...i.contract,salary:u}}):i});if(a)try{await t(s),console.log(` Salarios ajustados: ${r} jugadores actualizados segn tablas de mercado`),console.log(` Costo total anual: $${(n/1e6).toFixed(1)}M`),console.log(" Sincronizando cambios de salarios con Supabase en lotes...");const i=s.filter(c=>{const u=e.find(f=>f.id===c.id);return u&&Math.abs((u.contract?.salary||0)-(c.contract?.salary||0))>1e3});await bw(i),console.log(` Sincronizacin con Supabase completada para ${i.length} jugadores`)}catch(i){console.error(" Error al guardar salarios ajustados:",i)}else console.log(" Todos los salarios ya estn actualizados segn las tablas de mercado");return{updated:r,totalCost:n}}async function Pw(){const{players:e,updatePlayers:t}=mr.getState();let r=0,n=0,a=!1;const s=e.map(i=>{const c=i.transferValue||0,u=ug(i.overall);return Math.abs(c-u)>1e5?(a=!0,r++,n+=u,{...i,transferValue:u}):i});if(a)try{await t(s),console.log(` Valores de mercado ajustados: ${r} jugadores actualizados segn tablas de mercado`),console.log(` Valor total de mercado: $${(n/1e6).toFixed(1)}M`),console.log(" Sincronizando cambios de valores de mercado con Supabase en lotes...");const i=s.filter(c=>{const u=e.find(f=>f.id===c.id);return u&&Math.abs((u.transferValue||0)-(c.transferValue||0))>1e5});await bw(i),console.log(` Sincronizacin con Supabase completada para ${i.length} jugadores`)}catch(i){console.error(" Error al guardar valores de mercado ajustados:",i)}else console.log(" Todos los valores de mercado ya estn actualizados segn las tablas de mercado");return{updated:r,totalValue:n}}function Iw(){console.log(" Inicializando ajuste de salarios segn tablas de mercado...");const e=Aw();if(e.updated>0){console.log(" AJUSTE COMPLETADO:"),console.log(`    ${e.updated} jugadores con salarios actualizados`),console.log(`    Costo total anual: $${(e.totalCost/1e6).toFixed(1)}M`),console.log("    Salarios guardados en IndexedDB y estado global");const{players:t}=mr.getState(),r=t.slice(0,3).filter(n=>n.contract?.salary);r.length>0&&(console.log(" EJEMPLOS DE CAMBIOS:"),r.forEach(n=>{console.log(`    ${n.name} (${n.overall} OVR): $${(n.contract.salary/1e6).toFixed(1)}M`)}))}else console.log(" Los salarios ya estn actualizados segn las tablas de mercado")}function Ow(){console.log(" Inicializando ajuste de valores de mercado segn tablas de mercado...");const e=Pw();if(e.updated>0){console.log(" AJUSTE DE VALORES COMPLETADO:"),console.log(`    ${e.updated} jugadores con valores de mercado actualizados`),console.log(`    Valor total de mercado: $${(e.totalValue/1e6).toFixed(1)}M`),console.log("    Valores guardados en IndexedDB y estado global");const{players:t}=mr.getState(),r=t.slice(0,3).filter(n=>n.transferValue);r.length>0&&(console.log(" EJEMPLOS DE CAMBIOS:"),r.forEach(n=>{console.log(`    ${n.name} (${n.overall} OVR): $${(n.transferValue/1e6).toFixed(1)}M`)}))}else console.log(" Los valores de mercado ya estn actualizados segn las tablas de mercado")}function va(){console.log(" Inicializando datos de mercado completos...");const e="virtual_zone_salaries_updated",t=localStorage.getItem(e),r="virtual_zone_market_values_updated",n=localStorage.getItem(r);t||(Iw(),localStorage.setItem(e,"true")),n||(Ow(),localStorage.setItem(r,"true")),t&&n&&console.log(" Todos los datos de mercado ya estn actualizados")}function Dw(){console.log(" Forzando actualizacin completa de datos de mercado..."),localStorage.removeItem("virtual_zone_salaries_updated"),localStorage.removeItem("virtual_zone_market_values_updated"),va(),console.log(" Actualizacin completa forzada")}function Fw(){const{players:e}=mr.getState();console.log(" ESTADO ACTUAL DE SALARIOS:"),console.log(`Total de jugadores: ${e.length}`);let t=0,r={};e.forEach(a=>{if(a.contract?.salary){const s=a.overall.toString(),i=a.contract.salary;t+=i,r[s]||(r[s]={count:0,totalSalary:0,avgSalary:0}),r[s].count++,r[s].totalSalary+=i}}),Object.keys(r).forEach(a=>{r[a].avgSalary=r[a].totalSalary/r[a].count}),console.log(` Costo total anual: $${(t/1e6).toFixed(1)}M`),console.log(` Promedio por jugador: $${(t/e.length/1e6).toFixed(1)}M`),console.log(`
 SALARIOS POR VALORACIN:`),Object.entries(r).sort(([a],[s])=>parseInt(s)-parseInt(a)).forEach(([a,s])=>{console.log(`   OVR ${a}: ${s.count} jugadores | Promedio: $${(s.avgSalary/1e6).toFixed(1)}M`)}),console.log(`
 VERIFICACIN CON TABLA DE MERCADO:`);let n=0;e.slice(0,10).forEach(a=>{if(a.contract?.salary){const s=Rf(a.overall),i=a.contract.salary;Math.abs(i-s)>1e3&&(console.log(`    ${a.name} (${a.overall} OVR): Actual: $${(i/1e6).toFixed(1)}M | Esperado: $${(s/1e6).toFixed(1)}M`),n++)}}),console.log(n===0?"    Todos los salarios verificados estn correctos segn la tabla de mercado":`    Encontradas ${n} discrepancias en salarios`)}function Rw(){const{players:e}=mr.getState();console.log(" ESTADO ACTUAL DE VALORES DE MERCADO:"),console.log(`Total de jugadores: ${e.length}`);let t=0,r={};e.forEach(a=>{if(a.transferValue){const s=a.overall.toString(),i=a.transferValue;t+=i,r[s]||(r[s]={count:0,totalValue:0,avgValue:0}),r[s].count++,r[s].totalValue+=i}}),Object.keys(r).forEach(a=>{r[a].avgValue=r[a].totalValue/r[a].count}),console.log(` Valor total de mercado: $${(t/1e6).toFixed(1)}M`),console.log(` Promedio por jugador: $${(t/e.length/1e6).toFixed(1)}M`),console.log(`
 VALORES POR VALORACIN:`),Object.entries(r).sort(([a],[s])=>parseInt(s)-parseInt(a)).forEach(([a,s])=>{console.log(`   OVR ${a}: ${s.count} jugadores | Promedio: $${(s.avgValue/1e6).toFixed(1)}M`)}),console.log(`
 VERIFICACIN CON TABLA DE MERCADO:`);let n=0;e.slice(0,10).forEach(a=>{if(a.transferValue){const s=ug(a.overall),i=a.transferValue;Math.abs(i-s)>1e5&&(console.log(`    ${a.name} (${a.overall} OVR): Actual: $${(i/1e6).toFixed(1)}M | Esperado: $${(s/1e6).toFixed(1)}M`),n++)}}),console.log(n===0?"    Todos los valores de mercado verificados estn correctos segn la tabla de mercado":`    Encontradas ${n} discrepancias en valores de mercado`)}function Lw(){console.log(" VERIFICACIN COMPLETA DE DATOS DE MERCADO"),console.log("".repeat(50)),Fw(),console.log(`
`+"".repeat(50)),Rw()}const Pv=Object.freeze(Object.defineProperty({__proto__:null,adjustAllPlayerMarketValues:Pw,adjustAllPlayerSalaries:Aw,applyWeeklyVictoryBonusesIfNeeded:DA,calculateMarketValueByRating:ug,calculateSalaryByRating:Rf,checkCompleteMarketStatus:Lw,checkMarketValueStatus:Rw,checkSalaryStatus:Fw,computeValuation:kw,computeWeeklyWindow:Cw,forceCompleteMarketUpdate:Dw,initializePlayerMarketData:va,initializePlayerMarketValues:Ow,initializePlayerSalaries:Iw,isFreeAgent:Tw,validateOfferBasics:IA},Symbol.toStringTag,{value:"Module"})),lt=[{id:"club1",name:"Alianza Atletico Sullana",logo:"/Logos_Clubes/Liga B/alianzasullana.png",foundedYear:2023,stadium:"Estadio Cyber Arena",budget:25e6,manager:"coach",playStyle:"Posesin",primaryColor:"#ef4444",secondaryColor:"#000000",description:"Club fundador de la Liga Master, conocido por su juego de posesin y formacin de talento joven.",titles:[{id:"title1",name:"Liga Master",year:2023,type:"league"},{id:"title2",name:"Copa PES",year:2024,type:"cup"}],reputation:85,fanBase:1e4},{id:"club2",name:"Alianza Lima",logo:"/Logos_Clubes/Liga A/alianzalima.png",foundedYear:2023,stadium:"Quasar Dome",budget:175e5,manager:"DT Quantum Q",playStyle:"Vertical",primaryColor:"#8b008b",secondaryColor:"#7c2d12",description:"Equipo csmico y directo. Especialistas en ataques verticales.",titles:[],reputation:81,fanBase:8500},{id:"club3",name:"Atlanta",logo:"/Logos_Clubes/Liga D/atlantafc.png",foundedYear:2023,stadium:"Platinum Arena",budget:28e6,manager:"DT Platinum",playStyle:"Posesin",primaryColor:"#e5e7eb",secondaryColor:"#9ca3af",description:"Club premium con grandes aspiraciones. Especialistas en juego de posesin.",titles:[],reputation:88,fanBase:12e3},{id:"club4",name:"Avengers",logo:"/Logos_Clubes/Liga B/avengersfc.png",foundedYear:2023,stadium:"Azure Bay",budget:15e5,manager:"DT Azure",playStyle:"Ofensivo",primaryColor:"#0284c7",secondaryColor:"#0369a1",description:"Club fluido y creativo. Especialistas en ataques por bandas.",titles:[],reputation:56,fanBase:1700},{id:"club5",name:"Barcelona SC",logo:"/Logos_Clubes/Liga B/barcelonasc.png",foundedYear:2023,stadium:"Starlight Stadium",budget:35e5,manager:"DT Sapphire",playStyle:"Contraataque",primaryColor:"#2563eb",secondaryColor:"#1d4ed8",description:"Club brillante y efectivo. Especialistas en contraataques estelares.",titles:[],reputation:58,fanBase:2300},{id:"club6",name:"Beast FC",logo:"/Logos_Clubes/Liga D/beastfc.png",foundedYear:2023,stadium:"Lion's Den",budget:75e5,manager:"DT Golden",playStyle:"Equilibrado",primaryColor:"#fbbf24",secondaryColor:"#d97706",description:"Club noble y tradicional. Ftbol equilibrado con nfasis en la cantera.",titles:[],reputation:62,fanBase:3500},{id:"club7",name:"Club Atletico Ituzaing",logo:"/Logos_Clubes/Liga D/clubatleticoituzaingo.png",foundedYear:2023,stadium:"Crystal Dome",budget:115e5,manager:"DT Crystal",playStyle:"Contraataque",primaryColor:"#e11d48",secondaryColor:"#881337",description:"Club elegante y efectivo. Especialistas en contraataques bien elaborados.",titles:[],reputation:66,fanBase:4700},{id:"club8",name:"Club Atletico Libertadores",logo:"/Logos_Clubes/Liga A/clubatleticolibertadores.png",foundedYear:2023,stadium:"Titan Stadium",budget:135e5,manager:"DT Thunder",playStyle:"Tiki-Taka",primaryColor:"#7c2d12",secondaryColor:"#451a03",description:"Club con tradicin de buen ftbol. Especialistas en el toque y la posesin.",titles:[],reputation:68,fanBase:5300},{id:"club9",name:"Comando Sur",logo:"/Logos_Clubes/Liga D/comandosur.png",foundedYear:2023,stadium:"Binary Park",budget:21e6,manager:"DT Binary",playStyle:"Vertical",primaryColor:"#7c3aed",secondaryColor:"#334155",description:"Equipo de juego vertical y directo. Especializado en transiciones rpidas y ataques por banda.",titles:[],reputation:79,fanBase:8200},{id:"club10",name:"Deportes Provincial Osorno",logo:"/Logos_Clubes/Liga C/deportesprovincialosorno.png",foundedYear:2023,stadium:"Obsidian Fortress",budget:1e6,manager:"DT Obsidian",playStyle:"Defensivo",primaryColor:"#0c0a09",secondaryColor:"#292524",description:"Equipo slido como la roca. Especialistas en la defensa impenetrable.",titles:[],reputation:55,fanBase:1400},{id:"club11",name:"CADU",logo:"/Logos_Clubes/Liga A/cadu.png",foundedYear:2023,stadium:"Quantum Stadium",budget:185e5,manager:"DT Quantum",playStyle:"Posesin",primaryColor:"#8b5cf6",secondaryColor:"#312e81",description:"Club innovador que combina ciencia y ftbol. Especialistas en juego de posesin y pases precisos.",titles:[],reputation:73,fanBase:6800},{id:"club12",name:"El Santo Tucumano",logo:"/Logos_Clubes/Liga D/santo tucumano.png",foundedYear:2023,stadium:"Thunder Dome",budget:195e5,manager:"DT Storm",playStyle:"Contraataque",primaryColor:"#64748b",secondaryColor:"#1f2937",description:"Equipo aguerrido que se crece en las adversidades. Especialistas en transiciones rpidas.",titles:[],reputation:74,fanBase:7100},{id:"club13",name:"Elijo Creer",logo:"/Logos_Clubes/Liga B/elijocreer.png",foundedYear:2023,stadium:"Estadio Cyber Arena",budget:25e6,manager:"coach",playStyle:"Posesin",primaryColor:"#ef4444",secondaryColor:"#000000",description:"Club fundador de la Liga Master, conocido por su juego de posesin y formacin de talento joven.",titles:[{id:"title1",name:"Liga Master",year:2023,type:"league"},{id:"title2",name:"Copa PES",year:2024,type:"cup"}],reputation:85,fanBase:1e4},{id:"club14",name:"Estudiantes de La Plata",logo:"/Logos_Clubes/Liga C/estudiantesdelaplata.png",foundedYear:2023,stadium:"Frozen Stadium",budget:165e5,manager:"DT Ice",playStyle:"Defensivo",primaryColor:"#3b82f6",secondaryColor:"#1e40af",description:"Equipo slido y organizado. Especialistas en mantener la portera a cero.",titles:[],reputation:71,fanBase:6200},{id:"club15",name:"Furia Verde",logo:"/Logos_Clubes/Liga C/furiaverde.png",foundedYear:2023,stadium:"Quantum Field",budget:195e5,manager:"DT Quantum",playStyle:"Posesin",primaryColor:"#8b5cf6",secondaryColor:"#6366f1",description:"Club que representa la fsica cuntica del ftbol. Impredecibles y con un estilo nico.",titles:[],reputation:78,fanBase:7600},{id:"club16",name:"God Sport",logo:"/Logos_Clubes/Liga C/godsport.png",foundedYear:2023,stadium:"Shadow Colosseum",budget:145e5,manager:"DT Shadow",playStyle:"Presin alta",primaryColor:"#374151",secondaryColor:"#111827",description:"Equipo misterioso y efectivo. Especialistas en presionar y recuperar rpido.",titles:[],reputation:69,fanBase:5600},{id:"club17",name:"Granate",logo:"/Logos_Clubes/Liga A/granate.png",foundedYear:2023,stadium:"Bear Cave",budget:265e5,manager:"DT Titanium",playStyle:"Contraataque",primaryColor:"#6b7280",secondaryColor:"#4b5563",description:"Equipo fuerte y resistente. Especialistas en contraataques potentes.",titles:[],reputation:87,fanBase:11500},{id:"club18",name:"Jackson FC",logo:"/Logos_Clubes/Liga D/jacksonfc.png",foundedYear:2023,stadium:"Frog Pond",budget:2e6,manager:"DT Frog",playStyle:"Ofensivo",primaryColor:"#22c55e",secondaryColor:"#16a34a",description:"Equipo imprevisible y tctico. Saltan al ataque cuando menos lo esperas.",titles:[],reputation:58,fanBase:2200},{id:"club19",name:"Kod FC",logo:"/Logos_Clubes/Liga A/kodfc.png",foundedYear:2023,stadium:"Devil's Lair",budget:45e5,manager:"DT Ruby",playStyle:"Vertical",primaryColor:"#b91c1c",secondaryColor:"#991b1b",description:"Equipo apasionado y agresivo. Especialistas en juego directo y vertical.",titles:[],reputation:59,fanBase:2600},{id:"club20",name:"La Barraca",logo:"/Logos_Clubes/Liga C/labarraca.png",foundedYear:2023,stadium:"Shark Tank",budget:85e5,manager:"DT Silver",playStyle:"Defensivo",primaryColor:"#0ea5e9",secondaryColor:"#0284c7",description:"Equipo depredador y efectivo. Especialistas en defender y contraatacar.",titles:[],reputation:63,fanBase:3800},{id:"club21",name:"La Cuarta",logo:"/Logos_Clubes/Liga C/lacuarta.png",foundedYear:2023,stadium:"Eagle Nest",budget:105e5,manager:"DT Iron",playStyle:"Total",primaryColor:"#059669",secondaryColor:"#064e3b",description:"Equipo fuerte y determinado. Ftbol total con nfasis en lo colectivo.",titles:[],reputation:65,fanBase:4400},{id:"club22",name:"La Cumbre FC",logo:"/Logos_Clubes/Liga B/lacumbre.png",foundedYear:2023,stadium:"Phoenix Stadium",budget:95e5,manager:"DT Phoenix",playStyle:"Ofensivo",primaryColor:"#ea580c",secondaryColor:"#9a3412",description:"Club que renace de sus cenizas. Especialistas en remontadas picas.",titles:[],reputation:64,fanBase:4100},{id:"club23",name:"La Tobyneta",logo:"/Logos_Clubes/Liga A/latobyneta.png",foundedYear:2023,stadium:"Cloud Arena",budget:175e5,manager:"DT Cloud",playStyle:"Vertical",primaryColor:"#06d6a0",secondaryColor:"#10b981",description:"Equipo ligero y rpido como la nube. Especializados en ataques relmpago y transiciones.",titles:[],reputation:76,fanBase:7200},{id:"club24",name:"Liga de Quito",logo:"/Logos_Clubes/Liga D/ligadequito.png",foundedYear:2023,stadium:"Raven's Nest",budget:65e5,manager:"DT Midnight",playStyle:"Presin alta",primaryColor:"#1f2937",secondaryColor:"#0f172a",description:"Equipo misterioso y nocturno. Especialistas en presionar en campo rival.",titles:[],reputation:61,fanBase:3200},{id:"club25",name:"Liverpool",logo:"/Logos_Clubes/Liga C/liverpool.png",foundedYear:2023,stadium:"Galactic Arena",budget:24e6,manager:"DT Galaxy",playStyle:"Total",primaryColor:"#14b8a6",secondaryColor:"#1e1e2e",description:"Club ambicioso con un estilo de ftbol total. Excelente cantera y desarrollo de jugadores.",titles:[{id:"title6",name:"Supercopa Digital",year:2023,type:"supercup"}],reputation:82,fanBase:9e3},{id:"club26",name:"Los Guerreros del Rosario",logo:"/Logos_Clubes/Liga B/losguerrerosderosario.png",foundedYear:2023,stadium:"Mountain Peak",budget:8e6,manager:"DT Summit",playStyle:"Equilibrado",primaryColor:"#64748b",secondaryColor:"#475569",description:"Equipo que domina las alturas. Especialistas en juego equilibrado y control del medio campo.",titles:[],reputation:62,fanBase:3600},{id:"club27",name:"Los Terribles FC",logo:"/Logos_Clubes/Liga A/losterriblesfc.png",foundedYear:2023,stadium:"Carbon Arena",budget:235e5,manager:"DT Carbon",playStyle:"Defensivo",primaryColor:"#262626",secondaryColor:"#525252",description:"Equipo slido y resistente. Especialistas en defensa organizada.",titles:[],reputation:85,fanBase:10500},{id:"club28",name:"Los Villeros del Saca",logo:"/Logos_Clubes/Liga C/losvillerosdesaca.png",foundedYear:2023,stadium:"Aurora Stadium",budget:225e5,manager:"DT Aurora",playStyle:"Ofensivo",primaryColor:"#fbbf24",secondaryColor:"#f59e0b",description:"Club legendario con tradicin ganadora. Especialistas en juego ofensivo y creativo.",titles:[{id:"title11",name:"Copa Aurora",year:2024,type:"cup"}],reputation:86,fanBase:11e3},{id:"club29",name:"Lunatics FC",logo:"/Logos_Clubes/Liga A/lunaticsfc.png",foundedYear:2023,stadium:"Viper's Pit",budget:25e5,manager:"DT Crimson",playStyle:"Total",primaryColor:"#dc2626",secondaryColor:"#b91c1c",description:"Equipo venenoso y letal. Ftbol total con nfasis en lo colectivo.",titles:[],reputation:57,fanBase:2e3},{id:"club30",name:"CD Seor del Mar Callao",logo:"/Logos_Clubes/Liga A/cdsenordelmar.png",foundedYear:2023,stadium:"Emerald Castle",budget:55e5,manager:"DT Emerald",playStyle:"Tiki-Taka",primaryColor:"#16a34a",secondaryColor:"#15803d",description:"Club elegante y preciso. Especialistas en el toque y la posesin.",titles:[],reputation:60,fanBase:2900},{id:"club31",name:"Melgar",logo:"/Logos_Clubes/Liga A/melgar.png",foundedYear:2023,stadium:"Phoenix Nest",budget:205e5,manager:"DT Phoenix",playStyle:"Presin alta",primaryColor:"#be123c",secondaryColor:"#dc2626",description:"Club que renace de las cenizas. Especialistas en presin alta y recuperacin rpida.",titles:[{id:"title10",name:"Copa Phoenix",year:2024,type:"cup"}],reputation:82,fanBase:8700},{id:"club32",name:"Nacional",logo:"/Logos_Clubes/Liga B/nacional.png",foundedYear:2023,stadium:"Fortress Wall",budget:11e6,manager:"DT Stone",playStyle:"Defensivo",primaryColor:"#78716c",secondaryColor:"#57534e",description:"Defensa impenetrable como una muralla. Especialistas en mantener el cero en su arco.",titles:[],reputation:66,fanBase:4600},{id:"club33",name:"Pearol",logo:"/Logos_Clubes/Liga C/penarol.png",foundedYear:2023,stadium:"Divine Temple",budget:15e6,manager:"DT Divine",playStyle:"Equilibrado",primaryColor:"#fbbf24",secondaryColor:"#f59e0b",description:"Club con poderes divinos. Equilibrio perfecto entre ataque y defensa.",titles:[],reputation:70,fanBase:5800},{id:"club34",name:"Peritas FC",logo:"/Logos_Clubes/Liga C/peritasfc.png",foundedYear:2023,stadium:"Plasma Stadium",budget:19e6,manager:"DT Plasma",playStyle:"Tiki-Taka",primaryColor:"#ff4500",secondaryColor:"#ea580c",description:"Club ardiente y tcnico. Especialistas en el toque y la posesin.",titles:[],reputation:82,fanBase:9e3},{id:"club35",name:"Pibe de Oro",logo:"/Logos_Clubes/Liga D/pibedeoro.png",foundedYear:2023,stadium:"Cyber Nest",budget:16e6,manager:"DT Cyber C",playStyle:"Contraataque",primaryColor:"#00ff00",secondaryColor:"#16a34a",description:"Club ciberntico y letal. Especialistas en contraataques rpidos.",titles:[],reputation:80,fanBase:8e3},{id:"club36",name:"La Boca del Sapo",logo:"/Logos_Clubes/Liga B/labocadelsapo.png",foundedYear:2023,stadium:"Fourth Dimension",budget:1e7,manager:"DT Quantum",playStyle:"Ofensivo",primaryColor:"#8b5cf6",secondaryColor:"#7c3aed",description:"Equipo multidimensional. Juegan en otra dimensin del ftbol.",titles:[],reputation:65,fanBase:4300},{id:"club37",name:"Quilmes",logo:"/Logos_Clubes/Liga D/quilmes.png",foundedYear:2023,stadium:"Estadio Buffer",budget:18e6,manager:"DT Defensor",playStyle:"Defensivo",primaryColor:"#a855f7",secondaryColor:"#111111",description:"Conocido por su slida defensa y juego tctico. Difcil de vencer en casa.",titles:[],reputation:75,fanBase:7200},{id:"club38",name:"Real Madrid",logo:"/Logos_Clubes/Liga A/realmadrid.png",foundedYear:2023,stadium:"Matrix Colosseum",budget:215e5,manager:"DT Matrix",playStyle:"Total",primaryColor:"#059669",secondaryColor:"#10b981",description:"Club que domina la realidad del ftbol. Especialistas en controlar todos los aspectos del juego.",titles:[{id:"title8",name:"Supercopa Matrix",year:2024,type:"supercup"}],reputation:84,fanBase:9200},{id:"club39",name:"River Plate",logo:"/Logos_Clubes/Liga C/riverplate.png",foundedYear:2023,stadium:"Digital Lair",budget:145e5,manager:"DT Digital",playStyle:"Total",primaryColor:"#ff6600",secondaryColor:"#ea580c",description:"Club digital y completo. Especialistas en ftbol total moderno.",titles:[],reputation:79,fanBase:7500},{id:"club40",name:"Riverpool",logo:"/Logos_Clubes/Liga B/riverpool.png",foundedYear:2023,stadium:"Server Stadium",budget:16e6,manager:"DT Connect",playStyle:"Contraataque",primaryColor:"#eab308",secondaryColor:"#0f172a",description:"Club que espera al rival y aprovecha los espacios. Especialista en contragolpes letales.",titles:[],reputation:74,fanBase:7e3},{id:"club41",name:"Sahur FC",logo:"/Logos_Clubes/Liga B/tuntunsahur.png",foundedYear:2023,stadium:"Neon Aquarium",budget:22e6,manager:"DT Neon Shark",playStyle:"Equilibrado",primaryColor:"#00ffff",secondaryColor:"#0891b2",description:"Club colorido y equilibrado. Especialistas en juego verstil.",titles:[],reputation:84,fanBase:1e4},{id:"club42",name:"San Francisco",logo:"/Logos_Clubes/Liga D/sanfrancisco.png",foundedYear:2023,stadium:"Eagle's Peak",budget:7e6,manager:"DT Andean",playStyle:"Vertical",primaryColor:"#374151",secondaryColor:"#1f2937",description:"Club de las alturas andinas. Juega con la intensidad de la montaa.",titles:[],reputation:62,fanBase:3400},{id:"club43",name:"San Martin de Tolosa",logo:"/Logos_Clubes/Liga B/sanmartindetolosa.png",foundedYear:2023,stadium:"Lightning Arena",budget:125e5,manager:"DT Lightning",playStyle:"Vertical",primaryColor:"#facc15",secondaryColor:"#a16207",description:"Equipo rpido y electrizante. Especialistas en ataques por bandas.",titles:[],reputation:67,fanBase:5e3},{id:"club44",name:"Seor de los Milagros",logo:"/Logos_Clubes/Liga C/srdelosmilagros.png",foundedYear:2023,stadium:"Sacred Mountain",budget:2e7,manager:"DT Sacred",playStyle:"Contraataque",primaryColor:"#92400e",secondaryColor:"#78350f",description:"Club sagrado de las montaas. Fuerza espiritual en cada jugada.",titles:[],reputation:75,fanBase:7200},{id:"club45",name:"Sporting Cristal",logo:"/Logos_Clubes/Liga D/sportingcristal.png",foundedYear:2023,stadium:"Crystal Palace",budget:21e6,manager:"DT Crystal",playStyle:"Posesin",primaryColor:"#06b6d4",secondaryColor:"#0891b2",description:"Club transparente y preciso. Cristalino en su estilo de juego.",titles:[],reputation:83,fanBase:9100},{id:"club46",name:"U de Chile",logo:"/Logos_Clubes/Liga B/universidaddechile.png",foundedYear:2023,stadium:"Cyber Fortress",budget:19e6,manager:"DT Cyber",playStyle:"Tiki-Taka",primaryColor:"#06b6d4",secondaryColor:"#475569",description:"Club con filosofa de toque y posesin extrema. Especialistas en dominar el centro del campo.",titles:[],reputation:78,fanBase:7800},{id:"club47",name:"Union Milagro",logo:"/Logos_Clubes/Liga D/unionmilagrofc.png",foundedYear:2023,stadium:"Error Arena",budget:17e6,manager:"DT Glitch",playStyle:"Presin alta",primaryColor:"#84cc16",secondaryColor:"#1e293b",description:"Club imprevisible conocido por su intensa presin y recuperacin rpida del baln.",titles:[{id:"title5",name:"Copa PES",year:2023,type:"cup"}],reputation:76,fanBase:7500},{id:"club48",name:"Universitario de Peru",logo:"/Logos_Clubes/Liga A/universitariodeperu.png",foundedYear:2023,stadium:"Academic Temple",budget:2e7,manager:"DT Academic",playStyle:"Equilibrado",primaryColor:"#7c2d12",secondaryColor:"#a16207",description:"Club universitario con sabidura tctica. Equilibrio acadmico en el campo.",titles:[],reputation:81,fanBase:8600}];try{const e=lt.findIndex(t=>t.id==="club28");e>=0&&(lt[e].name="Los Villeros del Saca",lt[e].logo="/Logos_Clubes/Liga C/losvillerosdesaca.png")}catch{}const er=[],kl=[],FA=[],RA={},LA=[],Vu=[],Fh=[],Iv=[],Ov=[];class NA{db=null;config;constructor(t){this.config=t}async ensureDb(){return this.db?this.db:new Promise((t,r)=>{const n=indexedDB.open(this.config.name,this.config.version);n.onerror=()=>{console.error("IndexedDB error:",n.error),r(n.error)},n.onsuccess=()=>{this.db=n.result,console.log(`IndexedDB '${this.config.name}' opened successfully`),t(this.db)},n.onupgradeneeded=a=>{const s=a.target.result;console.log(`Upgrading IndexedDB '${this.config.name}' to version ${this.config.version}`),this.config.stores.forEach(i=>{if(!s.objectStoreNames.contains(i.name)){const c=s.createObjectStore(i.name,{keyPath:i.keyPath});i.indexes&&i.indexes.forEach(u=>{c.createIndex(u.name,u.keyPath,{unique:u.unique})})}})}})}async withStore(t,r,n){const i=(await this.ensureDb()).transaction([t],r).objectStore(t);return n(i)}async getAll(t){return this.withStore(t,"readonly",r=>new Promise((n,a)=>{const s=r.getAll();s.onsuccess=()=>n(s.result),s.onerror=()=>{console.error(`Error getting all from ${t}:`,s.error),a(s.error)}}))}async get(t,r){return this.withStore(t,"readonly",n=>new Promise((a,s)=>{const i=n.get(r);i.onsuccess=()=>a(i.result||null),i.onerror=()=>{console.error(`Error getting item from ${t}:`,i.error),s(i.error)}}))}async put(t,r){await this.withStore(t,"readwrite",n=>new Promise((a,s)=>{const i=n.put(r);i.onsuccess=()=>a(),i.onerror=()=>{console.error(`Error putting item in ${t}:`,i.error),s(i.error)}}))}async update(t,r){await this.put(t,r)}async count(t){return this.withStore(t,"readonly",r=>new Promise((n,a)=>{const s=r.count();s.onsuccess=()=>n(s.result),s.onerror=()=>{console.error(`Error counting items in ${t}:`,s.error),a(s.error)}}))}async clear(t){await this.withStore(t,"readwrite",r=>new Promise((n,a)=>{const s=r.clear();s.onsuccess=()=>n(),s.onerror=()=>{console.error(`Error clearing ${t}:`,s.error),a(s.error)}}))}async putMany(t,r){if(r.length===0){console.log("putMany: No hay elementos para guardar");return}console.log(`putMany: Procesando ${r.length} elementos para ${t}`),await this.withStore(t,"readwrite",n=>new Promise((a,s)=>{let i=0,c=0;const u=r.length,f=Math.max(1,Math.ceil(u/20)),h=()=>{i++,(i%f===0||i===u)&&console.log(`putMany progreso: ${i}/${u} elementos procesados`),i===u&&(c>0?(console.error(`putMany: ${c} errores durante el proceso`),s(new Error(`${c} errores al guardar elementos`))):(console.log(`putMany: Todos los ${u} elementos guardados exitosamente`),a()))},p=m=>{c++,console.error(`Error putting item in ${t}:`,m),h()};r.forEach((m,y)=>{try{const w=n.put(m);w.onsuccess=h,w.onerror=()=>p(w.error)}catch(w){console.error(`Error preparing item ${y} for ${t}:`,w),p(w)}})}))}}const ht=new NA({name:Ke.indexedDB.name,version:Ke.indexedDB.version,stores:[{name:"players",keyPath:"id"},{name:"clubs",keyPath:"id"},{name:"tournaments",keyPath:"id"},{name:"matches",keyPath:"id"},{name:"transfers",keyPath:"id"}]}),Nw=[{localKey:"virtual_zone_players",store:"players",description:"jugadores"},{localKey:"virtual_zone_clubs",store:"clubs",description:"clubes"},{localKey:"virtual_zone_tournaments",store:"tournaments",description:"torneos"},{localKey:"virtual_zone_transfers",store:"transfers",description:"traspasos"}],MA=["virtual_zone_players","virtual_zone_players_updated","virtual_zone_players_initialized","virtual_zone_clubs","virtual_zone_clubs_updated","virtual_zone_clubs_backup","virtual_zone_clubs_backup_light","virtual_zone_initialized","virtual_zone_transfers","virtual_zone_comments","virtual_zone_migration_done"],fg=()=>typeof window>"u"?null:window.localStorage,BA=e=>Array.isArray(e)?e:e&&typeof e=="object"?Object.values(e):[],jA=()=>{const e=fg();return!e||e.getItem("virtual_zone_migration_done")==="true"?!1:Nw.some(r=>!!e.getItem(r.localKey))},$A=async()=>{const e=fg();if(!e){console.warn("IndexedDBService: No localStorage available for migration");return}for(const t of Nw){const r=e.getItem(t.localKey);if(r)try{const n=JSON.parse(r),a=BA(n);if(a.length===0){console.log(`IndexedDBService: Nada que migrar desde ${t.description}`);continue}console.log(`IndexedDBService: Migrando ${a.length} elementos de ${t.description}`),await ht.putMany(t.store,a)}catch(n){console.error(`IndexedDBService: Error migrando ${t.description}:`,n)}}},UA=()=>{const e=fg();e&&MA.forEach(t=>{e.getItem(t)&&(e.removeItem(t),console.log(`IndexedDBService: Removed legacy key ${t} from localStorage`))})},xn="players",fi="virtual_zone_players_initialized",di=async()=>{if(localStorage.getItem(fi)==="true"){console.log("PlayerService: Already initialized, skipping");return}console.log("PlayerService: Initializing IndexedDB");try{const t=await ht.getAll(xn);if(t.length===0)console.log("PlayerService: Initializing IndexedDB with seed players"),await ht.putMany(xn,er);else{console.log("PlayerService: Found",t.length,"existing players in IndexedDB");const r=["PT","DEC","LI","LD","MCD","MC","MO","MDI","MDD","EXI","EXD","CD","SD"];t.some(a=>!r.includes(a.position))?(console.log("PlayerService: Detected invalid positions, regenerating players with correct positions"),await ht.clear(xn),await ht.putMany(xn,er)):console.log("PlayerService: Existing players are valid, preserving IndexedDB data")}localStorage.setItem(fi,"true")}catch(t){console.error("PlayerService: Error initializing IndexedDB:",t);try{await ht.clear(xn),await ht.putMany(xn,er),localStorage.setItem(fi,"true")}catch(r){console.error("PlayerService: Error in fallback initialization:",r)}}},tr=async()=>{try{const e=await ht.getAll(xn);return console.log("PlayerService: Successfully retrieved",e.length,"players from IndexedDB"),e}catch(e){return console.error("PlayerService: Error getting players from IndexedDB:",e),[]}},Sr=async e=>{try{console.log("PlayerService: Saving",e.length,"players to IndexedDB"),await ht.clear(xn),await ht.putMany(xn,e),console.log("PlayerService: Successfully saved players to IndexedDB")}catch(t){throw console.error("PlayerService: Error saving players to IndexedDB:",t),t}},zA=async e=>{console.log(" Intentando reparar asignaciones de club...");try{const t=await tr();let r=0;const n=t.filter(s=>!s.clubId&&(s.originalClubId||s.originalClubName));if(n.length===0){console.log(" No hay jugadores sin club asignado que puedan ser reparados");const s=t.filter(i=>!i.clubId).length;return s>0&&console.log(` Hay ${s} jugadores sin club, pero sin datos originales para reparar`),{fixed:0,total:t.length}}console.log(` Encontrados ${n.length} jugadores que pueden ser reparados`);const a=t.map(s=>{if(!s.clubId&&(s.originalClubId||s.originalClubName)){let i=null;if(s.originalClubId&&s.originalClubId!=="undefined"&&(i=e.find(c=>c.id===s.originalClubId),i&&console.log(` Reparado ${s.name}: ${s.originalClubId} -> ${i.name}`)),!i&&s.originalClubName&&s.originalClubName!=="undefined"&&(i=e.find(c=>c.name===s.originalClubName),i&&console.log(` Reparado ${s.name}: "${s.originalClubName}" -> ${i.name}`)),i)return r++,{...s,clubId:i.id}}return s});return r>0&&(console.log(` Guardando ${r} asignaciones reparadas...`),await Sr(a),console.log(" Asignaciones de club reparadas exitosamente")),{fixed:r,total:t.length}}catch(t){return console.error(" Error reparando asignaciones de club:",t),{fixed:0,total:0}}},$r=async e=>{console.log("PlayerService: Getting players from IndexedDB");const t=e?.skipSupabase??!1;try{if(!t){const n=await $w();if(Array.isArray(n)){if(n.length>0)return console.log("PlayerService: Synced",n.length,"players from Supabase"),await Sr(n),n;n.length===0&&console.log("PlayerService: Supabase returned 0 players, falling back to local")}}const r=await tr();if(console.log("PlayerService: getPlayers() returned",r.length,"players"),r.length===0)if(console.log("PlayerService: No players in IndexedDB, checking initialization status"),localStorage.getItem(fi)!=="true"){console.log("PlayerService: Not initialized yet, initializing with seed data"),await di();const a=await tr();return console.log("PlayerService: After initialization, found",a.length,"players"),a}else{console.log("PlayerService: Already initialized but no players found, this might be an issue"),console.log("PlayerService: Reinitializing due to missing players after initialization"),await di();const a=await tr();return console.log("PlayerService: After reinitialization, found",a.length,"players"),a}return console.log("PlayerService: Found",r.length,"players in IndexedDB"),r}catch(r){console.error("PlayerService: Error getting players from IndexedDB:",r);try{console.log("PlayerService: Attempting recovery initialization"),await di();const n=await tr();return console.log("PlayerService: After error recovery, found",n.length,"players"),n}catch(n){return console.error("PlayerService: Error in fallback initialization:",n),console.log("PlayerService: Returning seed players as last resort"),er}}},dg=async()=>(console.log("PlayerService: Forcing regeneration of players with correct positions"),await hg(),await ht.clear(xn),await ht.putMany(xn,er),console.log("PlayerService: Players regenerated with unique IDs"),er),hg=async()=>{console.log("PlayerService: Complete cache cleanup and regeneration"),await ht.clear(xn),localStorage.removeItem(fi);for(let e=0;e<localStorage.length;e++){const t=localStorage.key(e);t&&(t.includes("player")||t.includes("virtual_zone"))&&(localStorage.removeItem(t),console.log(`PlayerService: Removed localStorage key: ${t}`))}return await ht.putMany(xn,er),localStorage.setItem(fi,"true"),console.log("PlayerService: Cache completely cleared and regenerated"),er},Mw=async e=>{const t=await tr(),r=t.map(f=>parseInt(f.id.split("-").pop()||"0")),a=`player-${Math.max(0,...r)+1}`,s=e.nationality||"Argentina",i=Math.min(101,e.overall+Math.floor(Math.random()*6)),c=e.image?e.image:"/default.png",u={id:a,name:e.name,age:e.age,position:e.position,nationality:s,clubId:e.clubId||"",overall:e.overall,potential:i,transferListed:!0,transferValue:e.transferValue??Math.max(0,e.overall*25e4),image:c,attributes:e.attributes,skills:e.skills,playingStyles:e.playingStyles,contract:{expires:new Date(new Date().setFullYear(new Date().getFullYear()+3)).toISOString(),salary:Rf(e.overall)},form:e.attributes?.form||3,goals:0,assists:0,appearances:0,matches:0,dorsal:e.dorsal,injuryResistance:e.injuryResistance,height:e.height,weight:e.weight};return t.push(u),await Sr(t),console.log("PlayerService: Successfully created player locally",u.id),await ql(u),u},gg=e=>{const t=!e.clubId||e.clubId==="libre"||e.clubId==="free";return{id:e.id,name:e.name,age:e.age||25,position:e.position,nationality:e.nationality||"Argentina",club_id:t?null:e.clubId,overall:e.overall||50,potential:e.potential||e.overall||50,transfer_listed:e.transferListed||!1,transfer_value:e.transferValue??e.marketValue??0,image:e.image||"",attributes:e.attributes,skills:e.skills||[],playing_styles:e.playingStyles||[],contract:e.contract||{expires:new Date().toISOString(),salary:0},form:e.form||3,goals:e.goals||0,assists:e.assists||0,appearances:e.appearances||0,matches:e.matches||0,dorsal:e.dorsal||1,injury_resistance:e.injuryResistance||50,height:e.height,weight:e.weight,updated_at:new Date().toISOString()}},ql=async e=>{try{const{config:t}=await Z(async()=>{const{config:c}=await Promise.resolve().then(()=>ft);return{config:c}},void 0);if(!t.useSupabase){console.log("PlayerService: Supabase sync disabled, skipping...");return}const{getSupabaseAdminClient:r,getSupabaseClient:n}=await Z(async()=>{const{getSupabaseAdminClient:c,getSupabaseClient:u}=await Promise.resolve().then(()=>dt);return{getSupabaseAdminClient:c,getSupabaseClient:u}},void 0),a=t.supabase.serviceRoleKey?r():n(),s=gg(e);console.log("PlayerService: Syncing player to Supabase:",e.id);const{error:i}=await a.from("players").upsert(s,{onConflict:"id"});i?console.error("PlayerService: Error syncing player to Supabase:",i):console.log("PlayerService: Player synced to Supabase successfully:",e.id)}catch(t){console.error("PlayerService: Failed to sync player to Supabase:",t)}},VA=async e=>{try{const{config:t}=await Z(async()=>{const{config:u}=await Promise.resolve().then(()=>ft);return{config:u}},void 0);if(!t.useSupabase)throw new Error("La integracin con Supabase est deshabilitada.");const{getSupabaseAdminClient:r,getSupabaseClient:n}=await Z(async()=>{const{getSupabaseAdminClient:u,getSupabaseClient:f}=await Promise.resolve().then(()=>dt);return{getSupabaseAdminClient:u,getSupabaseClient:f}},void 0),a=t.supabase.serviceRoleKey?r():n();console.log("PlayerService: Eliminando transferencias dependientes en Supabase...");const{error:s}=await a.from("transfers").delete().not("id","is",null);if(s)throw s;console.log(`PlayerService: Eliminando jugadores existentes en Supabase antes de importar ${e.length} registros...`);const{error:i}=await a.from("players").delete().not("id","is",null);if(i)throw i;const c=100;for(let u=0;u<e.length;u+=c){const f=e.slice(u,u+c).map(gg),{error:h}=await a.from("players").insert(f);if(h)throw h;console.log(`PlayerService: Subidos ${Math.min(u+c,e.length)} / ${e.length} jugadores a Supabase`)}console.log("PlayerService: Reemplazo completo de jugadores en Supabase finalizado")}catch(t){throw console.error("PlayerService: Error al reemplazar jugadores en Supabase:",t),t}},Bw=async e=>{console.log("PlayerService: Updating player",e.id);const t=await tr();console.log("PlayerService: Found",t.length,"existing players");const r=t.findIndex(n=>n.id===e.id);if(r!==-1){const n=t[r];console.log("PlayerService: Found existing player, updating...");const a={...n,...e,matches:e.matches??n.matches??0,dorsal:e.dorsal??n.dorsal??1,height:e.height??n.height,weight:e.weight??n.weight},s=t.map(i=>i.id===e.id?a:i);return await Sr(s),console.log("PlayerService: Successfully updated player locally",e.id),await ql(a),a}return console.log("PlayerService: Player not found, adding new player"),await Sr([...t,e]),console.log("PlayerService: Successfully added player locally",e.id),await ql(e),e},WA=async e=>{const t=await tr();await Sr(t.filter(r=>r.id!==e)),console.log("PlayerService: Successfully deleted player locally",e);try{const{config:r}=await Z(async()=>{const{config:c}=await Promise.resolve().then(()=>ft);return{config:c}},void 0);if(!r.useSupabase){console.log("PlayerService: Supabase sync disabled, skipping deletion...");return}const{getSupabaseAdminClient:n,getSupabaseClient:a}=await Z(async()=>{const{getSupabaseAdminClient:c,getSupabaseClient:u}=await Promise.resolve().then(()=>dt);return{getSupabaseAdminClient:c,getSupabaseClient:u}},void 0),s=r.supabase.serviceRoleKey?n():a();console.log("PlayerService: Deleting player from Supabase:",e);const{error:i}=await s.from("players").delete().eq("id",e);i?console.error("PlayerService: Error deleting player from Supabase:",i):console.log("PlayerService: Player deleted from Supabase successfully:",e)}catch(r){console.error("PlayerService: Failed to delete player from Supabase:",r)}},HA=e=>{const t=e.position,r=e.overall,n=(y,w=0)=>{const x=Math.floor(Math.random()*20)-10;return Math.max(40,Math.min(101,y+x+w))},a=y=>({GK:{goalkeeping:20,catching:15,reflexes:15,coverage:15,speed:-5,finishing:-15,lowPass:-5,offensiveAwareness:-10},CB:{defensiveAwareness:15,ballWinning:15,heading:10,physicalContact:10,jumping:10,aggression:5},LB:{speed:10,acceleration:10,stamina:10,defensiveAwareness:10,loftedPass:5,lowPass:5},RB:{speed:10,acceleration:10,stamina:10,defensiveAwareness:10,loftedPass:5,lowPass:5},CDM:{defensiveAwareness:15,ballWinning:15,stamina:10,aggression:10,lowPass:5},CM:{lowPass:10,loftedPass:10,stamina:5,ballControl:5},CAM:{lowPass:15,ballControl:10,dribbling:10,finishing:5,offensiveAwareness:10},LM:{loftedPass:10,dribbling:10,speed:10,acceleration:10,stamina:5},RM:{loftedPass:10,dribbling:10,speed:10,acceleration:10,stamina:5},LW:{dribbling:15,speed:15,acceleration:15,loftedPass:10,finishing:10},RW:{dribbling:15,speed:15,acceleration:15,loftedPass:10,finishing:10},ST:{finishing:20,heading:10,speed:5,acceleration:5,physicalContact:10,jumping:10,offensiveAwareness:15}})[t]?.[y]||0,s={offensiveAwareness:n(65,a("offensiveAwareness")),ballControl:n(70,a("ballControl")),dribbling:n(65,a("dribbling")),tightPossession:n(68,a("tightPossession")),lowPass:n(70,a("lowPass")),loftedPass:n(68,a("loftedPass")),finishing:n(60,a("finishing")),heading:n(60,a("heading")),setPieceTaking:n(65,a("setPieceTaking")),curl:n(65,a("curl")),speed:n(70,a("speed")),acceleration:n(68,a("acceleration")),kickingPower:n(70,a("kickingPower")),jumping:n(65,a("jumping")),physicalContact:n(68,a("physicalContact")),balance:n(70,a("balance")),stamina:n(70,a("stamina")),defensiveAwareness:n(65,a("defensiveAwareness")),ballWinning:n(65,a("ballWinning")),aggression:n(68,a("aggression")),goalkeeping:n(t==="PT"?75:45,a("goalkeeping")),catching:n(t==="PT"?72:45,a("catching")),reflexes:n(t==="PT"?75:45,a("reflexes")),coverage:n(t==="PT"?70:45,a("coverage")),weakFootUsage:1+Math.floor(Math.random()*4),weakFootAccuracy:1+Math.floor(Math.random()*4),form:1+Math.floor(Math.random()*5),pace:n(70,a("speed")),shooting:n(65,a("finishing")+a("kickingPower")),passing:n(70,a("lowPass")+a("loftedPass")),defending:n(65,a("defensiveAwareness")+a("ballWinning")),physical:n(68,a("physicalContact")+a("stamina"))},i={scissorKick:Math.random()>.85&&r>75,doubleTouch:Math.random()>.75&&r>70,flipFlap:Math.random()>.9&&r>75,marseilleTurn:Math.random()>.85&&r>70,rainbow:Math.random()>.95&&r>75,chopTurn:Math.random()>.8&&r>70,cutBehindAndTurn:Math.random()>.85&&r>70,scotchMove:Math.random()>.9&&r>75,stepOnSkillControl:Math.random()>.75&&r>70,heading:Math.random()>.6&&(t==="CD"||t==="DEC"||t==="MC"),longRangeDrive:Math.random()>.7&&r>75,chipShotControl:Math.random()>.8&&r>70,longRanger:Math.random()>.8&&r>75,knuckleShot:Math.random()>.85&&r>75,dippingShot:Math.random()>.85&&r>75,risingShot:Math.random()>.85&&r>75,acrobaticFinishing:Math.random()>.9&&r>80,heelTrick:Math.random()>.85&&r>75,firstTimeShot:Math.random()>.7&&r>70,oneTouchPass:Math.random()>.65&&r>70,throughPassing:Math.random()>.7&&(t==="MC"||t==="MO"||t==="CD"),weightedPass:Math.random()>.75&&r>75,pinpointCrossing:Math.random()>.7&&(t==="MDI"||t==="MDD"||t==="EXD"||t==="EXI"),outsideCurler:Math.random()>.8&&r>75,rabona:Math.random()>.9&&r>80,noLookPass:Math.random()>.85&&r>75,lowLoftedPass:Math.random()>.8&&r>70,giantKill:Math.random()>.8&&r>75,longThrow:Math.random()>.7&&(t==="LI"||t==="LD"),longThrow2:Math.random()>.8&&(t==="LI"||t==="LD"),gkLongThrow:t==="PT"&&Math.random()>.6,penaltySpecialist:Math.random()>.8&&r>75,gkPenaltySaver:t==="PT"&&Math.random()>.7,fightingSpirit:Math.random()>.6,manMarking:Math.random()>.7&&(t==="DEC"||t==="MCD"),trackBack:Math.random()>.65&&(t==="EXI"||t==="EXD"||t==="CD"),interception:Math.random()>.7&&(t==="MC"||t==="MCD"||t==="DEC"),acrobaticClear:t==="PT"&&Math.random()>.7,captaincy:Math.random()>.8&&r>80,superSub:Math.random()>.75,comPlayingStyles:Math.random()>.6},c={goalPoacher:t==="CD"&&Math.random()>.7,dummyRunner:Math.random()>.8,foxInTheBox:t==="CD"&&Math.random()>.7,targetMan:(t==="CD"||t==="DEC")&&Math.random()>.6,classicNo10:t==="MO"&&Math.random()>.7,prolificWinger:(t==="EXD"||t==="EXI")&&Math.random()>.7,roamingFlank:(t==="MDI"||t==="MDD")&&Math.random()>.6,crossSpecialist:(t==="MDI"||t==="MDD"||t==="EXD"||t==="EXI")&&Math.random()>.7,holePlayer:t==="MO"&&Math.random()>.7,boxToBox:t==="MC"&&Math.random()>.7,theDestroyer:t==="MCD"&&Math.random()>.7,orchestrator:t==="MC"&&Math.random()>.8,anchor:t==="MCD"&&Math.random()>.7,offensiveFullback:t==="LD"&&Math.random()>.7,fullbackFinisher:t==="LI"&&Math.random()>.8,defensiveFullback:(t==="LI"||t==="LD")&&Math.random()>.7,buildUp:Math.random()>.6,extraFrontman:t==="CD"&&Math.random()>.7,offensiveGoalkeeper:t==="PT"&&Math.random()>.6,defensiveGoalkeeper:t==="PT"&&Math.random()>.7},u=1+Math.floor(Math.random()*5),f=Math.floor(Math.random()*30)+5,h=t==="CD"?Math.floor(Math.random()*20)+3:t==="EXI"||t==="EXD"?Math.floor(Math.random()*12)+2:t==="MO"||t==="MC"?Math.floor(Math.random()*8)+1:t==="PT"?0:Math.floor(Math.random()*5),p=Math.floor(Math.random()*12)+1,m=Math.floor(Math.random()*35)+5;return{attributes:s,skills:i,playingStyles:c,form:u,matches:f,goals:h,assists:p,appearances:m,injuryResistance:1+Math.floor(Math.random()*3)}},jw=async()=>{console.log("=== RANDOMIZING ALL PLAYERS STATS ===");const e=await tr();console.log("Found",e.length,"players to randomize");const t=e.map(r=>{const n=HA(r),a={...r,...n};return console.log(`Updated ${r.name} (${r.position}) - Overall: ${r.overall}`),a});return console.log("Saving updated players to IndexedDB..."),await Sr(t),console.log("Randomization complete!"),t},GA=async()=>await jw(),qA=async e=>{const t=await tr(),r=t.findIndex(i=>i.id===e);if(r===-1)return null;const n=t[r],a={...n,transferListed:!n.transferListed},s=[...t];return s[r]=a,await Sr(s),await ql(a),a},KA=async()=>(await tr()).filter(t=>t.transferListed).length,XA=async()=>{const e=await tr(),t={},r=[],n=[];return e.forEach(a=>{t[a.name]?(t[a.name]++,r.push(a)):(t[a.name]=1,n.push(a.name))}),console.log("PlayerService: Duplicate detection results:"),console.log(`- Total players: ${e.length}`),console.log(`- Unique names: ${n.length}`),console.log(`- Duplicate players found: ${r.length}`),r.length>0&&(console.log("Duplicate players:"),r.forEach(a=>{console.log(`  - ${a.name} (${a.position}) - ID: ${a.id}`)})),{duplicates:r,uniqueNames:n}},JA=async()=>{const e=await tr(),t=new Set,r=[],n=[];if(e.forEach(a=>{const s=`${a.name.toLowerCase()}-${a.position}`;t.has(s)?n.push(a):(t.add(s),r.push(a))}),n.length===0)return console.log("PlayerService: No duplicate players found to remove"),{removed:0,remainingPlayers:e,removedPlayers:[]};await Sr(r),console.log(`PlayerService: Removed ${n.length} duplicate players locally`);try{const{config:a}=await Z(async()=>{const{config:s}=await Promise.resolve().then(()=>ft);return{config:s}},void 0);if(a.useSupabase){const{getSupabaseClient:s}=await Z(async()=>{const{getSupabaseClient:c}=await Promise.resolve().then(()=>dt);return{getSupabaseClient:c}},void 0),i=s();for(const c of n){const{error:u}=await i.from("players").delete().eq("id",c.id);u?console.error(`PlayerService: Error deleting duplicate player ${c.id} from Supabase:`,u):console.log(`PlayerService: Duplicate player ${c.id} removed from Supabase`)}}}catch(a){console.error("PlayerService: Failed to remove duplicate players from Supabase:",a)}return{removed:n.length,remainingPlayers:r,removedPlayers:n}},YA=async()=>(await tr()).filter(t=>t.transferListed),QA=async()=>{console.log("=== UPDATING ALL PLAYERS TO TRANSFER LISTED ===");const e=await tr();console.log("Found",e.length,"players to update");const t=e.map(r=>({...r,transferListed:!0}));console.log("Saving updated players to IndexedDB..."),await Sr(t);try{const{config:r}=await Z(async()=>{const{config:n}=await Promise.resolve().then(()=>ft);return{config:n}},void 0);if(!r.useSupabase)console.log("Supabase sync disabled, skipping remote transfer listing update.");else{const{getSupabaseAdminClient:n,getSupabaseClient:a}=await Z(async()=>{const{getSupabaseAdminClient:c,getSupabaseClient:u}=await Promise.resolve().then(()=>dt);return{getSupabaseAdminClient:c,getSupabaseClient:u}},void 0),s=r.supabase.serviceRoleKey?n():a();console.log(" Sincronizando cambios de transfer listing con Supabase en lotes...");const i=100;for(let c=0;c<t.length;c+=i){const u=t.slice(c,c+i).map(gg),{error:f}=await s.from("players").upsert(u,{onConflict:"id"});if(f)throw f;console.log(`PlayerService: Transfer listing batch ${Math.min(c+i,t.length)} / ${t.length} sincronizado`)}console.log(` Sincronizacin con Supabase completada para ${t.length} jugadores`)}}catch(r){console.error("Error sincronizando transfer listing en Supabase:",r)}return console.log("Update complete!"),t},$w=async()=>{try{const{config:e}=await Z(async()=>{const{config:c}=await Promise.resolve().then(()=>ft);return{config:c}},void 0);if(!e.useSupabase)return await tr();const{getSupabaseClient:t}=await Z(async()=>{const{getSupabaseClient:c}=await Promise.resolve().then(()=>dt);return{getSupabaseClient:c}},void 0),r=t(),n=1e3;let a=0;const s=[];for(;;){const{data:c,error:u}=await r.from("players").select("*").range(a,a+n-1);if(u)throw u;const f=c||[];if(s.push(...f),f.length<n)break;a+=n}return s.map(c=>{const u=c.club_id??"",f=!u||u==="free"?"libre":u;return{id:c.id,name:c.name??"",age:Number(c.age??25),position:c.position??"MC",nationality:c.nationality??"Argentina",clubId:f,overall:Number(c.overall??50),potential:Number(c.potential??c.overall??50),transferListed:!!(c.transfer_listed??!1),transferValue:Number(c.transfer_value??0),image:c.image??"",attributes:c.attributes??{},skills:c.skills??{},playingStyles:c.playing_styles??{},contract:c.contract??{expires:new Date().toISOString(),salary:0},form:Number(c.form??3),goals:Number(c.goals??0),assists:Number(c.assists??0),appearances:Number(c.appearances??0),matches:Number(c.matches??0),dorsal:Number(c.dorsal??1),injuryResistance:Number(c.injury_resistance??50),height:c.height??void 0,weight:c.weight??void 0}})}catch(e){return console.error("PlayerService: fetchPlayersFromSupabase failed:",e),await tr()}},pg=()=>({"Jackson FC":["Akim Zedadka.png","Braian Martnez.png","Bruno Zapelli.png","Corentin Jean.png","Dejan Stojanovic.png","Enric Saborit.png","Felix Beijmo.png","Gabi Kanichowsky.png","Jacob Barrett Laursen.png","Jasper Lffelsend.png","Joyskim Dawa.png","Jn Dai Bvarsson.png","Kevin Escamilla.png","Marcelo Ferreira.png","Markus Henriksen.png","Nuraly Alip.png","Oday Dabbagh.png","Pere Milla.png","Sergio Gonzlez.png","Sergio Padt.png","Shoya Nakajima.png","Valeri Qazaishvili.png","Zan Majer.png"],Libres:["Alisson Becker.png","Bernardo Silva.png","Bruno Fernandes.png","Bukayo Saka.png","Cristiano Ronaldo.png","Erling Haaland.png","Harry Kane.png","Heung-min Son.png","Jan Oblak.png","Joshua Kimmich.png","Jude Bellingham.png","Kevin De Bruyne.png","Kylian Mbapp.png","Lautaro Martinez.png","Lionel Messi.png","Marc-Andre ter Stegen.png","Martin degaard.png","Mohamed Salah.png","Neymar Jr.png","Phil Foden.png","Robert Lewandowski.png","Rodri.png","Thibaut Courtois.png","Victor Osimhen.png","Vinicius Junior.png","Virgil van Dijk.png"]}),Uw=e=>({club1:"Alianza Atletico Sullana",club2:"Alianza Lima",club3:"Atlanta",club4:"Avengers",club5:"Barcelona SC",club6:"Beast FC",club7:"Club Atletico Ituzaing",club8:"Club Atletico Libertadores",club9:"Comando Sur",club10:"Deportes Provincial Osorno",club11:"CADU",club12:"El Santo Tucumano",club13:"Elijo Creer",club14:"Estudiantes de La Plata",club15:"Furia Verde",club16:"God Sport",club17:"Granate",club18:"Jackson FC",club19:"Kod FC",club20:"La Barraca",club21:"La Cuarta",club22:"La Cumbre FC",club23:"La Tobyneta",club24:"Liga de Quito",club25:"Liverpool",club26:"Los Guerreros del Rosario",club27:"Los Terribles FC",club28:"Los Villeros del Saca",club29:"Lunatics FC",club30:"CD Seor del Mar Callao",club31:"Melgar",club32:"Nacional",club33:"Pearol",club34:"Peritas FC",club35:"Pibe de Oro",club36:"La Boca del Sapo",club37:"Quilmes",club38:"Real Madrid",club39:"River Plate",club40:"Riverpool",club41:"Sahur FC",club42:"San Francisco",club43:"San Martin de Tolosa",club44:"Seor de los Milagros",club45:"Sporting Cristal",club46:"U de Chile",club47:"Union Milagro",club48:"Universitario de Peru"})[e]||null,ro=e=>e.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/[^a-zA-Z\s]/g,"").trim(),ZA=(e,t)=>{const r=e.length,n=t.length;if(r===0)return n;if(n===0)return r;const a=Array.from({length:r+1},()=>Array(n+1).fill(0));for(let s=0;s<=r;s++)a[s][0]=s;for(let s=0;s<=n;s++)a[0][s]=s;for(let s=1;s<=r;s++)for(let i=1;i<=n;i++){const c=e[s-1]===t[i-1]?0:1;a[s][i]=Math.min(a[s-1][i]+1,a[s][i-1]+1,a[s-1][i-1]+c)}return a[r][n]},e4=(e,t)=>{const r=ro(e),n=ro(t),a=r.length>=n.length?r:n,s=r.length>=n.length?n:r;if(a.length===0)return 1;const i=ZA(a,s);return(a.length-i)/a.length},zw=(e,t)=>{const r=ro(e);for(const a of t){const s=ro(a.replace(".png",""));if(r===s)return{photoName:a,confidence:1}}for(const a of t){const s=ro(a.replace(".png",""));if(r.includes(s)||s.includes(r))return{photoName:a,confidence:.8};const i=r.split(" "),c=s.split(" ");if(i.length>=2&&c.length>=2&&i[0]===c[0]&&i[1]===c[1])return{photoName:a,confidence:.9};if(i.length>=2&&c.length>=1&&i[0]===c[0])return{photoName:a,confidence:.7}}let n=null;for(const a of t){const s=a.replace(".png",""),i=e4(r,s);if(i>=.85){const c=Math.min(.95,i);(!n||c>n.confidence)&&(n={photoName:a,confidence:c})}}return n||null},t4=async(e={})=>{console.log(" Emparejando fotos de TODOS los jugadores...");const t=await tr(),r=pg(),n=t.length,a=Math.max(1,e.batchSize??(n||1)),s=e.minConfidence??0;console.log(" Fotos disponibles por club:",Object.keys(r).map(f=>f+": "+r[f].length+" fotos").join(", "));let i=0,c=0,u=0;for(let f=0;f<n;f+=a){const h=Math.min(f+a,n),p=t.slice(f,h),m=Math.floor(f/a)+1;console.log(`
 Procesando lote ${m} (${f+1}-${h}) de ${n} jugadores`);for(const y of p){c++;let w=[],x="";if(y.clubId==="libre"||y.clubId==="free"||!y.clubId)w=r.Libres||[],x="/Fotos_Jugadores/Libres/";else if(r[y.clubId])w=r[y.clubId],x="/Fotos_Jugadores/"+y.clubId+"/";else{const E=Uw(y.clubId||"");if(E&&r[E])w=r[E],x="/Fotos_Jugadores/"+E+"/";else{const k=Object.keys(r).find(b=>ro(b)===ro(y.clubId||""));k&&(w=r[k],x="/Fotos_Jugadores/"+k+"/")}}if(w.length===0)continue;const _=zw(y.name,w);if(_&&_.confidence<s){u++;continue}if(_){const E=x+_.photoName;if(y.image!==E){console.log(" Actualizando "+y.name+" ("+(y.clubId||"libre")+"): "+(y.image||"sin imagen")+" -> "+E+" ("+(_.confidence*100).toFixed(0)+"% confianza)");const k={...y,image:E};await Bw(k),i++}}}}return s>0&&console.log(" Coincidencias descartadas por baja confianza ("+(s*100).toFixed(0)+"% mnimo): "+u),console.log(" Proceso completado: "+i+" fotos actualizadas de "+c+" jugadores procesados"),{updated:i,total:c}},r4=async()=>{console.log(" Creando jugadores especficos de Jackson FC...");const e=await tr(),t=[{name:"Akim Zedadka",position:"LI",overall:78,age:28},{name:"Braian Martnez",position:"SD",overall:76,age:24},{name:"Bruno Zapelli",position:"MCD",overall:75,age:26},{name:"Corentin Jean",position:"SD",overall:79,age:27},{name:"Dejan Stojanovic",position:"PT",overall:80,age:29},{name:"Enric Saborit",position:"LD",overall:74,age:30},{name:"Felix Beijmo",position:"DEC",overall:77,age:25},{name:"Gabi Kanichowsky",position:"EXD",overall:73,age:26},{name:"Jacob Barrett Laursen",position:"LI",overall:76,age:24},{name:"Jasper Lffelsend",position:"MC",overall:78,age:27},{name:"Jn Dai Bvarsson",position:"SD",overall:77,age:31},{name:"Joyskim Dawa",position:"EXI",overall:75,age:26},{name:"Kevin Escamilla",position:"EXI",overall:74,age:28},{name:"Marcelo Ferreira",position:"DEC",overall:76,age:25},{name:"Markus Henriksen",position:"MCD",overall:79,age:30},{name:"Nuraly Alip",position:"DEC",overall:77,age:23},{name:"Oday Dabbagh",position:"SD",overall:78,age:29},{name:"Pere Milla",position:"SD",overall:76,age:31},{name:"Sergio Gonzlez",position:"LI",overall:75,age:26},{name:"Sergio Padt",position:"PT",overall:79,age:32},{name:"Shoya Nakajima",position:"EXD",overall:77,age:28},{name:"Valeri Qazaishvili",position:"MO",overall:78,age:30},{name:"Zan Majer",position:"MO",overall:76,age:31}];let r=0;for(const n of t)if(e.find(s=>s.name===n.name))console.log(` Jugador ya existe: ${n.name}`);else{console.log(` Creando jugador de Jackson FC: ${n.name}`);const s={name:n.name,age:n.age,position:n.position,overall:n.overall,transferValue:Math.max(0,n.overall*2e5),clubId:"club18",nationality:"Argentina",dorsal:Math.floor(Math.random()*99)+1,image:`/Fotos_Jugadores/Jackson FC/${n.name}.png`,height:170+Math.floor(Math.random()*30),weight:65+Math.floor(Math.random()*25),attributes:{shooting:Math.max(40,n.overall-10+Math.floor(Math.random()*20)),defending:Math.max(40,n.overall-10+Math.floor(Math.random()*20)),pace:Math.max(40,n.overall-10+Math.floor(Math.random()*20)),passing:Math.max(40,n.overall-10+Math.floor(Math.random()*20)),physical:Math.max(40,n.overall-10+Math.floor(Math.random()*20)),offensiveAwareness:Math.max(40,n.overall-5+Math.floor(Math.random()*15)),ballControl:Math.max(40,n.overall-5+Math.floor(Math.random()*15)),dribbling:Math.max(40,n.overall-5+Math.floor(Math.random()*15)),tightPossession:Math.max(40,n.overall-5+Math.floor(Math.random()*15)),lowPass:Math.max(40,n.overall-5+Math.floor(Math.random()*15)),loftedPass:Math.max(40,n.overall-5+Math.floor(Math.random()*15)),finishing:Math.max(40,n.overall-5+Math.floor(Math.random()*15)),heading:Math.max(40,n.overall-10+Math.floor(Math.random()*20)),setPieceTaking:Math.max(40,n.overall-10+Math.floor(Math.random()*20)),curl:Math.max(40,n.overall-10+Math.floor(Math.random()*20)),speed:Math.max(40,n.overall-5+Math.floor(Math.random()*15)),acceleration:Math.max(40,n.overall-5+Math.floor(Math.random()*15)),kickingPower:Math.max(40,n.overall-5+Math.floor(Math.random()*15)),jumping:Math.max(40,n.overall-10+Math.floor(Math.random()*20)),physicalContact:Math.max(40,n.overall-5+Math.floor(Math.random()*15)),balance:Math.max(40,n.overall-5+Math.floor(Math.random()*15)),stamina:Math.max(40,n.overall-5+Math.floor(Math.random()*15)),defensiveAwareness:Math.max(40,n.overall-10+Math.floor(Math.random()*20)),ballWinning:Math.max(40,n.overall-10+Math.floor(Math.random()*20)),aggression:Math.max(40,n.overall-15+Math.floor(Math.random()*25)),goalkeeping:n.position==="PT"?Math.max(60,n.overall-5):Math.max(20,n.overall-30),catching:n.position==="PT"?Math.max(60,n.overall-5):Math.max(20,n.overall-30),reflexes:n.position==="PT"?Math.max(60,n.overall-5):Math.max(20,n.overall-30),coverage:n.position==="PT"?Math.max(60,n.overall-5):Math.max(20,n.overall-30),gkHandling:n.position==="PT"?Math.max(60,n.overall-5):Math.max(20,n.overall-30)},skills:[],playingStyles:[],injuryResistance:1+Math.floor(Math.random()*3)};await Mw(s),r++}return console.log(` Proceso completado: ${r} jugadores de Jackson FC creados`),{created:r}},n4=async()=>{const e=await tr(),t=pg(),r=e.filter(s=>s.image&&s.image!=="/default.png"&&(s.image.startsWith("/Fotos_Jugadores/")||s.image.startsWith("/public/Fotos_Jugadores/"))),n=e.filter(s=>!s.image||s.image==="/default.png"||!(s.image.startsWith("/Fotos_Jugadores/")||s.image.startsWith("/public/Fotos_Jugadores/"))),a={};return e.forEach(s=>{const i=s.clubId||"libre";a[i]||(a[i]={withPhotos:0,withoutPhotos:0,total:0}),a[i].total++,s.image&&s.image!=="/default.png"&&(s.image.startsWith("/Fotos_Jugadores/")||s.image.startsWith("/public/Fotos_Jugadores/"))?a[i].withPhotos++:a[i].withoutPhotos++}),console.log(" Estado general de fotos de jugadores:"),console.log(`  Total jugadores: ${e.length}`),console.log(`  Con fotos asignadas: ${r.length}`),console.log(`  Sin fotos: ${n.length}`),console.log(`  Fotos disponibles: ${Object.values(t).reduce((s,i)=>s+i.length,0)}`),console.log(`
 Estadsticas por club:`),Object.entries(a).forEach(([s,i])=>{const c=t[s]?.length||0;console.log(`  ${s}: ${i.withPhotos}/${i.total} fotos asignadas (${c} disponibles)`)}),n.length>0&&(console.log(`
 Jugadores sin fotos (primeros 10):`),n.slice(0,10).forEach(s=>{console.log(`  - ${s.name} (${s.clubId||"libre"}) - ${s.image||"sin imagen"}`)}),n.length>10&&console.log(`  ... y ${n.length-10} ms`)),{withPhotos:r,withoutPhotos:n,byClub:a,total:e.length}},a4=async()=>{console.log(" Probando sistema de emparejamiento de fotos...");const e=pg();console.log(" Fotos disponibles por club:",Object.keys(e).map(n=>`${n}: ${e[n].length} fotos`).join(", "));const r=(await tr()).slice(0,10);console.log(`
 Probando con jugadores reales:`),r.forEach(n=>{console.log(`
Jugador: ${n.name} (clubId: ${n.clubId||"SIN CLUB"})`);let a="Libres",s="/Fotos_Jugadores/Libres/";if(n.clubId==="libre"||n.clubId==="free"||!n.clubId)a="Libres",s="/Fotos_Jugadores/Libres/";else{const u=Uw(n.clubId||"");if(u&&e[u])a=u,s=`/Fotos_Jugadores/${u}/`,console.log(`   Club mapeado: ${n.clubId}  ${u}`);else{console.log(`   Club no encontrado en fotos disponibles: ${n.clubId}`);return}}const i=e[a]||[];console.log(`   Buscando en ${a} (${i.length} fotos disponibles)`);const c=zw(n.name,i);if(c){const u=`${s}${c.photoName}`;console.log(`   COINCIDENCIA: ${c.photoName}  ${u} (${(c.confidence*100).toFixed(0)}% confianza)`)}else console.log(`   SIN COINCIDENCIA - Fotos disponibles: ${i.slice(0,3).join(", ")}${i.length>3?"...":""}`)}),console.log(`
 Prueba completada`)},af=Object.freeze(Object.defineProperty({__proto__:null,checkAllPlayersPhotos:n4,clearAllCache:hg,createJacksonFCPlayers:r4,createPlayer:Mw,deletePlayer:WA,fetchPlayersFromSupabase:$w,findDuplicatePlayers:XA,fixClubAssignments:zA,getRandomizedPlayers:GA,getTransferListedPlayers:YA,getTransferListedPlayersCount:KA,initializePlayers:di,listPlayers:$r,matchAllPlayerPhotos:t4,randomizeAllPlayersStats:jw,regeneratePlayers:dg,removeDuplicatePlayers:JA,replaceSupabasePlayers:VA,savePlayers:Sr,syncPlayerToSupabase:ql,testPhotoMatching:a4,togglePlayerTransferListing:qA,updateAllPlayersToTransferListed:QA,updatePlayer:Bw},Symbol.toStringTag,{value:"Module"})),mg=e=>e.toString().toLowerCase().normalize("NFD").replace(new RegExp("\\p{Diacritic}","gu"),"").replace(/[^a-z0-9]+/g,"-").replace(/(^-|-$)+/g,""),s4=async(e,t)=>{const r=mg(t);try{const{data:n,error:a}=await e.from("blog_posts").select("slug").ilike("slug",`${r}%`);if(a)return console.warn("PostService: Could not verify slug uniqueness, fallback to timestamp suffix",a),`${r}-${Date.now()}`;const s=(n||[]).map(u=>u.slug);if(!s.includes(r))return r;let i=2,c=`${r}-${i}`;for(;s.includes(c);)i+=1,c=`${r}-${i}`;return c}catch(n){return console.error("PostService: Failed while generating unique slug, using timestamp fallback",n),`${r}-${Date.now()}`}},vg=e=>({id:e.id,title:e.title,slug:e.slug,excerpt:e.excerpt,content:e.content,image:e.image||"",date:e.date,author:e.author,category:e.category,tags:e.tags||[]}),o4=e=>({id:e.id,title:e.title,slug:e.slug||mg(e.title),excerpt:e.excerpt,content:e.content,image:e.image||void 0,date:e.date?new Date(e.date).toISOString():void 0,author:e.author||"Redaccin",category:e.category||"Noticias",tags:e.tags||[]}),i4=async e=>{try{const t=nr(),r=`post-${Date.now()}`,n=await s4(t,e.title),a={id:r,title:e.title.trim(),slug:n,excerpt:e.excerpt.trim(),content:e.content.trim(),image:e.image?.trim()||"https://images.unsplash.com/photo-1511406361295-0a1ff814c0ce",date:e.date?new Date(e.date).toISOString():new Date().toISOString(),author:e.author?.trim()||"Redaccin",category:e.category||"Noticias",tags:e.tags||[]},{data:s,error:i}=await t.from("blog_posts").insert(a).select().single();if(i)throw console.error("PostService: Error creating post:",i),new Error(`Error creating post: ${i.message}`);if(!s)throw new Error("Post was not created");const c=vg(s),{updatePosts:u}=mr.getState(),f=await no();return u(f),c}catch(t){throw console.error("PostService: Error in createPost:",t),t}},l4=async e=>{try{const t=nr(),r={title:e.title.trim(),slug:e.slug||mg(e.title),excerpt:e.excerpt.trim(),content:e.content.trim(),image:e.image?.trim()||void 0,date:new Date(e.date).toISOString(),author:e.author?.trim(),category:e.category,tags:e.tags||[]},{data:n,error:a}=await t.from("blog_posts").update(r).eq("id",e.id).select().single();if(a)throw console.error("PostService: Error updating post:",a),new Error(`Error updating post: ${a.message}`);if(!n)throw new Error("Post was not updated");const s=vg(n),{updatePosts:i}=mr.getState(),c=await no();return i(c),s}catch(t){throw console.error("PostService: Error in updatePost:",t),t}},c4=async e=>{try{const t=nr(),{error:r}=await t.from("blog_posts").delete().eq("id",e);if(r)throw console.error("PostService: Error deleting post:",r),new Error(`Error deleting post: ${r.message}`);const{updatePosts:n}=mr.getState(),a=await no();n(a)}catch(t){throw console.error("PostService: Error in deletePost:",t),t}},no=async()=>{try{const e=nr(),{data:t,error:r}=await e.from("blog_posts").select("*").order("date",{ascending:!1});return r?(console.error("PostService: Error fetching posts:",r),[]):t?t.map(vg):[]}catch(e){return console.error("PostService: Error in listPosts:",e),[]}},Rh=async()=>{try{const e=nr(),{data:t,error:r}=await e.from("blog_posts").select("id").limit(1);if(r){console.error("PostService: Error checking existing posts:",r);return}if(t&&t.length>0){console.log("PostService: Posts already exist, skipping initialization");return}const n=Fh.map(s=>o4(s)),{error:a}=await e.from("blog_posts").insert(n);a?console.error("PostService: Error initializing posts:",a):console.log("PostService: Posts initialized with seed data")}catch(e){console.error("PostService: Error in initializePosts:",e)}},Lh=async()=>{try{const e=nr(),{error:t}=await e.from("blog_posts").delete().neq("id","");t?console.error("PostService: Error clearing posts:",t):console.log("PostService: All posts cleared")}catch(e){console.error("PostService: Error in clearPosts:",e)}},qd=Object.freeze(Object.defineProperty({__proto__:null,clearPosts:Lh,createPost:i4,deletePost:c4,initializePosts:Rh,listPosts:no,updatePost:l4},Symbol.toStringTag,{value:"Module"})),ra="clubs",Lf=async()=>{try{const e=await ht.getAll(ra);if(console.log(` getClubs: Encontrados ${e.length} clubes en IndexedDB`),e.length===0){if(console.log(" La BD est vaca, verificando si hay datos previos guardados..."),localStorage.getItem("virtual_zone_clubs_updated")==="true"){console.warn(" ADVERTENCIA: La BD est vaca pero haba datos previos. Intentando recuperar...");const r=localStorage.getItem("virtual_zone_clubs_backup_light"),n=localStorage.getItem("virtual_zone_clubs_backup");if(r)try{const a=JSON.parse(r);if(a.length>0){const s=a.map(i=>({...lt.find(u=>u.id===i.id),...i})).filter(i=>i!==void 0);return console.log(` Recuperando ${s.length} clubes desde backup ligero`),await ht.putMany(ra,s),s}}catch(a){console.error(" Error recuperando backup ligero:",a)}if(n)try{const a=JSON.parse(n);if(a.length>0)return console.log(` Recuperando ${a.length} clubes desde backup completo`),await ht.putMany(ra,a),a}catch(a){console.error(" Error recuperando backup completo:",a)}console.log(" No se pudo recuperar backup. Inicializando con datos seed (pueden perderse cambios)")}return await ht.putMany(ra,lt),console.log(` Inicializados ${lt.length} clubes desde datos seed`),lt}return e.length<10&&(console.warn(` ADVERTENCIA: Solo se encontraron ${e.length} clubes (esperados ~48)`),console.warn("Esto podra indicar datos corruptos. Considera usar forceUpdateClubs()")),e}catch(e){console.error(" Error crtico getting clubs from IndexedDB:",e);try{const t=localStorage.getItem("virtual_zone_clubs_backup");if(t){const r=JSON.parse(t);return console.log(` Recuperando ${r.length} clubes desde backup localStorage`),r}}catch(t){console.error(" Error recuperando backup de localStorage:",t)}console.error(" ULTIMO RECURSO: Usando datos seed (POSIBLE PRDIDA DE CAMBIOS)"),console.error(" Recomendacin: Revisa la consola para errores de IndexedDB");try{console.log(" Intentando preservar asignaciones de club en players...");const{listPlayers:t}=await Z(async()=>{const{listPlayers:a}=await Promise.resolve().then(()=>af);return{listPlayers:a}},void 0),n=(await t()).filter(a=>a.clubId);if(n.length>0){console.log(` Encontrados ${n.length} players con asignaciones de club`);const a={};n.forEach(s=>{a[s.clubId]||(a[s.clubId]=[]),a[s.clubId].push(s.name)}),console.log(" Asignaciones de club preservadas:"),Object.entries(a).forEach(([s,i])=>{const c=lt.find(u=>u.id===s)?.name||"Club desconocido";console.log(`   ${c} (${s}): ${i.length} players`)}),console.log(" IMPORTANTE: Las asignaciones se perdern al usar datos seed"),console.log(" Recomendacin: No recargues la pgina despus de importar hasta verificar que los datos se guardaron correctamente")}}catch(t){console.error(" Error intentando preservar asignaciones:",t)}return lt}},Vw=e=>{try{if(e.length>=10){const t=e.map(r=>({id:r.id,name:r.name,budget:r.budget,manager:r.manager,playStyle:r.playStyle,primaryColor:r.primaryColor,secondaryColor:r.secondaryColor,foundedYear:r.foundedYear,stadium:r.stadium,reputation:r.reputation,fanBase:r.fanBase}));try{localStorage.setItem("virtual_zone_clubs_backup_light",JSON.stringify(t)),console.log(` Backup ligero creado: ${e.length} clubes guardados en localStorage`)}catch{console.warn(" Backup ligero fall, limpiando datos antiguos...");try{localStorage.removeItem("virtual_zone_clubs_backup"),localStorage.removeItem("virtual_zone_clubs_backup_light"),localStorage.setItem("virtual_zone_clubs_backup_light",JSON.stringify(t)),console.log(` Backup ligero recreado despus de limpieza: ${e.length} clubes`)}catch(n){console.warn(" No se pudo crear backup ligero ni despus de limpieza:",n)}}}}catch(t){console.warn(" Error general en backup de clubes:",t)}},En=async e=>{try{console.log(` Guardando ${e.length} clubes en IndexedDB...`),Vw(e),await ht.clear(ra),console.log(" Datos existentes limpiados"),await ht.putMany(ra,e),console.log(` ${e.length} clubes guardados exitosamente`);const t=await ht.count(ra);if(console.log(` Verificacin: ${t} clubes en la base de datos`),t!==e.length)throw console.warn(` ADVERTENCIA: Se intentaron guardar ${e.length} clubes pero la BD tiene ${t}`),new Error(`Discrepancia en guardado: esperado ${e.length}, guardado ${t}`);localStorage.setItem("virtual_zone_clubs_updated","true")}catch(t){throw console.error(" Error saving clubs to IndexedDB:",t),t}},$t=async()=>await Lf(),Nh=(e,t)=>{const r=new Map(e.map(i=>[i.id,i])),n=new Map(e.map(i=>[i.name.toLowerCase(),i])),a=i=>{const c=r.get(i.id)||n.get(i.name.toLowerCase());return c?{...i,logo:c.logo||i.logo,manager:c.manager??i.manager,budget:typeof c.budget=="number"?c.budget:i.budget,playStyle:c.playStyle||i.playStyle,primaryColor:c.primaryColor||i.primaryColor,secondaryColor:c.secondaryColor||i.secondaryColor,description:c.description||i.description,foundedYear:typeof c.foundedYear=="number"?c.foundedYear:i.foundedYear,stadium:c.stadium||i.stadium,titles:Array.isArray(c.titles)&&c.titles.length>0?c.titles:i.titles,reputation:typeof c.reputation=="number"?c.reputation:i.reputation,fanBase:typeof c.fanBase=="number"?c.fanBase:i.fanBase}:i},s=t.map(a);for(const i of e)s.find(u=>u.id===i.id||u.name.toLowerCase()===i.name.toLowerCase())||s.push(i);return s},u4=async e=>{const t=await Lf(),n={id:`club-${Date.now()}`,name:e.name.trim(),logo:e.logo||`https://ui-avatars.com/api/?name=${encodeURIComponent(e.name)}&background=111827&color=fff&size=128&bold=true`,foundedYear:e.foundedYear??new Date().getFullYear(),stadium:e.stadium??"",budget:e.budget??0,manager:e.manager??"",playStyle:e.playStyle??"Equilibrado",primaryColor:e.primaryColor??"#ffffff",secondaryColor:e.secondaryColor??"#000000",description:e.description??"",titles:e.titles??[],reputation:e.reputation??0,fanBase:e.fanBase??0};return t.push(n),await En(t),await Ww(n),n},Ww=async e=>{try{const{config:t}=await Z(async()=>{const{config:s}=await Promise.resolve().then(()=>ft);return{config:s}},void 0);if(!t.useSupabase){console.log(" Modo offline - saltando sincronizacin de club a Supabase");return}const{getSupabaseClient:r}=await Z(async()=>{const{getSupabaseClient:s}=await Promise.resolve().then(()=>dt);return{getSupabaseClient:s}},void 0),n=r();console.log("ClubService: Syncing club to Supabase:",e.id);const{error:a}=await n.from("clubs").upsert({id:e.id,name:e.name,logo:e.logo,foundedYear:e.foundedYear,stadium:e.stadium,budget:e.budget,manager:e.manager,playStyle:e.playStyle,primaryColor:e.primaryColor,secondaryColor:e.secondaryColor,description:e.description,reputation:e.reputation,fanBase:e.fanBase,updated_at:new Date().toISOString()},{onConflict:"id"});if(a)throw console.error("ClubService: Error syncing club to Supabase:",a),a;console.log("ClubService: Club synced to Supabase successfully:",e.id)}catch(t){throw console.error("ClubService: Error syncing club to Supabase:",t),t}},Hw=async e=>{try{console.log(` Actualizando club especfico: ${e.name} (${e.id})`);const t=await Lf();if(Vw(t),await ht.update(ra,e),!await ht.get(ra,e.id))throw new Error(`No se pudo verificar la actualizacin del club ${e.name}`);return console.log(` Club ${e.name} actualizado exitosamente`),await Ww(e),e}catch(t){console.error(" Error updating specific club:",t);try{const r=localStorage.getItem("virtual_zone_clubs_backup_light"),n=localStorage.getItem("virtual_zone_clubs_backup");if(r){const s=JSON.parse(r).map(i=>({...lt.find(u=>u.id===i.id),...i})).filter(i=>i!==void 0);console.log(" Restaurando desde backup ligero despus de error de actualizacin"),await En(s)}else if(n){const a=JSON.parse(n);console.log(" Restaurando desde backup completo despus de error de actualizacin"),await En(a)}}catch(r){console.error(" Error restaurando backup:",r)}throw t}},Gw=async e=>{const r=(await Lf()).filter(n=>n.id!==e);await En(r);try{const{config:n}=await Z(async()=>{const{config:a}=await Promise.resolve().then(()=>ft);return{config:a}},void 0);if(n.useSupabase){const{getSupabaseClient:a}=await Z(async()=>{const{getSupabaseClient:c}=await Promise.resolve().then(()=>dt);return{getSupabaseClient:c}},void 0),s=a();console.log("ClubService: Deleting club from Supabase:",e);const{error:i}=await s.from("clubs").delete().eq("id",e);i?console.error("ClubService: Error deleting club from Supabase:",i):console.log("ClubService: Club deleted from Supabase successfully:",e)}}catch(n){console.error("ClubService: Error syncing club deletion to Supabase:",n)}},f4=async()=>{try{const{config:e}=await Z(async()=>{const{config:c}=await Promise.resolve().then(()=>ft);return{config:c}},void 0);if(!e.useSupabase)return await ht.getAll(ra);const{getSupabaseClient:t}=await Z(async()=>{const{getSupabaseClient:c}=await Promise.resolve().then(()=>dt);return{getSupabaseClient:c}},void 0),r=t(),{data:n,error:a}=await r.from("clubs").select("*");if(a)throw a;return(n||[]).map(c=>({id:c.id,name:c.name,logo:c.logo,foundedYear:c.foundedyear??c.foundedYear??void 0,stadium:c.stadium??"",budget:c.budget??0,manager:c.manager??"",playStyle:c.playstyle??c.playStyle??"Equilibrado",primaryColor:c.primarycolor??c.primaryColor??"#ffffff",secondaryColor:c.secondarycolor??c.secondaryColor??"#000000",description:c.description??"",titles:c.titles??[],reputation:c.reputation??0,fanBase:c.fanbase??c.fanBase??0}))}catch(e){console.error("ClubService: fetchClubsFromSupabase failed:",e);try{return await ht.getAll(ra)}catch{return[]}}},Kd=Object.freeze(Object.defineProperty({__proto__:null,createClub:u4,deleteClub:Gw,fetchClubsFromSupabase:f4,listClubs:$t,mergeClubsPreservingCustom:Nh,saveClubs:En,updateClub:Hw},Symbol.toStringTag,{value:"Module"})),xg="matches";let _l=!1,Dv=0;const d4=5e3,vo=async()=>{try{return await ht.getAll(xg)||[]}catch(e){return e instanceof Error&&e.name==="NotFoundError"?(console.log(' Tabla "matches" no existe an en IndexedDB, retornando array vaco'),[]):(console.error(" Error getting matches from IndexedDB:",e),[])}},hc=async e=>{try{await ht.putMany(xg,e),console.log(` Saved ${e.length} matches to IndexedDB`)}catch(t){throw console.error(" Error saving matches to IndexedDB:",t),t}},qw=async()=>{if(_l){console.log("MatchService: Sync already in progress, skipping...");return}const e=Date.now();if(e-Dv<d4){console.log("MatchService: Sync cooldown active, skipping...");return}_l=!0,Dv=e;try{const{config:t}=await Z(async()=>{const{config:f}=await Promise.resolve().then(()=>ft);return{config:f}},void 0);if(!t.useSupabase){console.log("MatchService: Supabase sync disabled, skipping download..."),_l=!1;return}const{getSupabaseClient:r}=await Z(async()=>{const{getSupabaseClient:f}=await Promise.resolve().then(()=>dt);return{getSupabaseClient:f}},void 0),n=r();console.log("MatchService: Downloading matches from Supabase...");const{data:a,error:s}=await n.from("matches").select("*").order("date",{ascending:!0});if(s){console.error("MatchService: Error downloading matches from Supabase:",s);return}if(!a||a.length===0){console.log("MatchService: No matches found in Supabase"),_l=!1;return}console.log(`MatchService: Found ${a.length} matches in Supabase`);const i=a.map(f=>({id:f.id,tournamentId:f.tournament_id,round:f.round,date:f.date,homeTeam:f.home_team,awayTeam:f.away_team,homeScore:f.home_score,awayScore:f.away_score,status:f.status,scorers:f.scorers||[],highlights:f.highlights||[]})),u=[...await vo()];i.forEach(f=>{const h=u.findIndex(p=>p.id===f.id);h!==-1?u[h]=f:u.push(f)}),await hc(u),console.log(`MatchService: Successfully synced ${u.length} matches from Supabase`)}catch(t){console.error("MatchService: Failed to sync matches from Supabase:",t)}finally{_l=!1}},Kw=async e=>{try{const{config:t}=await Z(async()=>{const{config:i}=await Promise.resolve().then(()=>ft);return{config:i}},void 0);if(!t.useSupabase){console.log("MatchService: Supabase sync disabled, skipping...");return}const{getSupabaseClient:r}=await Z(async()=>{const{getSupabaseClient:i}=await Promise.resolve().then(()=>dt);return{getSupabaseClient:i}},void 0),n=r(),a={id:e.id,tournament_id:e.tournamentId,round:e.round,date:e.date,home_team:e.homeTeam,away_team:e.awayTeam,home_score:e.homeScore||null,away_score:e.awayScore||null,status:e.status||"scheduled",scorers:e.scorers||[],highlights:e.highlights||[],updated_at:new Date().toISOString()},{error:s}=await n.from("matches").upsert(a,{onConflict:"id"});s?console.error("MatchService: Error syncing match to Supabase:",s):console.log("MatchService: Match synced to Supabase successfully:",e.id)}catch(t){console.error("MatchService: Failed to sync match to Supabase:",t)}},Nf=async()=>(await qw(),await vo()),h4=async e=>(await Nf()).filter(r=>r.tournamentId===e),g4=async e=>(await Nf()).find(r=>r.id===e)||null,yg=async e=>{const t=await vo(),n={id:`match-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,tournamentId:e.tournamentId,round:e.round,date:new Date(e.date).toISOString(),homeTeam:e.homeTeam,awayTeam:e.awayTeam,status:e.status||"scheduled"},a=[...t,n];return await hc(a),await Kw(n),n},p4=async(e,t)=>{const r=await vo(),n=r.findIndex(s=>s.id===e);if(n===-1)throw new Error(`Match with id ${e} not found`);const a={...r[n],...t};return r[n]=a,await hc(r),await Kw(a),a},m4=async e=>{const r=(await vo()).filter(n=>n.id!==e);await hc(r);try{const{config:n}=await Z(async()=>{const{config:a}=await Promise.resolve().then(()=>ft);return{config:a}},void 0);if(n.useSupabase){const{getSupabaseClient:a}=await Z(async()=>{const{getSupabaseClient:c}=await Promise.resolve().then(()=>dt);return{getSupabaseClient:c}},void 0),s=a(),{error:i}=await s.from("matches").delete().eq("id",e);i&&console.error("MatchService: Error deleting match from Supabase:",i)}}catch(n){console.error("MatchService: Failed to delete match from Supabase:",n)}},Xw=async e=>{const t=await vo(),r=t.filter(a=>a.tournamentId!==e),n=t.length-r.length;if(await hc(r),n>0)try{const{config:a}=await Z(async()=>{const{config:s}=await Promise.resolve().then(()=>ft);return{config:s}},void 0);if(a.useSupabase){const{getSupabaseClient:s}=await Z(async()=>{const{getSupabaseClient:u}=await Promise.resolve().then(()=>dt);return{getSupabaseClient:u}},void 0),i=s(),{error:c}=await i.from("matches").delete().eq("tournament_id",e);c&&console.error("MatchService: Error deleting matches from Supabase:",c)}}catch(a){console.error("MatchService: Failed to delete matches from Supabase:",a)}return n},v4=async()=>{console.log("MatchService: Iniciando eliminacin de todos los partidos..."),await qw();const e=await vo(),t=e.length;if(t===0)return console.log("MatchService: No hay partidos para eliminar"),0;console.log(`MatchService: Eliminando ${t} partidos...`);let r=!1;try{const{config:n}=await Z(async()=>{const{config:a}=await Promise.resolve().then(()=>ft);return{config:a}},void 0);if(n.useSupabase){const{getSupabaseClient:a}=await Z(async()=>{const{getSupabaseClient:u}=await Promise.resolve().then(()=>dt);return{getSupabaseClient:u}},void 0),s=a(),{error:i,count:c}=await s.from("matches").delete({count:"exact"}).neq("id","");if(i)if(console.error("MatchService: Error eliminando todos los partidos de Supabase:",i),e.length>0){const u=e.map(h=>h.id);console.log(`MatchService: Intentando eliminar ${u.length} partidos por ID...`);const{error:f}=await s.from("matches").delete().in("id",u);if(f)throw console.error("MatchService: Error eliminando partidos por ID:",f),f;console.log(`MatchService: Eliminados ${u.length} partidos de Supabase por ID`),r=!0}else throw i;else console.log(`MatchService: Eliminados ${c??t} partidos de Supabase`),r=!0}else console.log("MatchService: Supabase deshabilitado, solo eliminando de IndexedDB")}catch(n){console.error("MatchService: Error al eliminar partidos de Supabase:",n)}try{await ht.clear(xg),console.log(`MatchService: Eliminados ${t} partidos de IndexedDB`)}catch(n){throw console.error("MatchService: Error limpiando IndexedDB:",n),n}if(!r){const{config:n}=await Z(async()=>{const{config:a}=await Promise.resolve().then(()=>ft);return{config:a}},void 0);n.useSupabase&&console.warn("MatchService:  Los partidos se eliminaron de IndexedDB pero puede que no se hayan eliminado de Supabase. Los partidos podran reaparecer despus de sincronizar.")}return console.log(`MatchService:  Eliminacin completada. Total eliminado: ${t}`),t},hf=Object.freeze(Object.defineProperty({__proto__:null,createMatch:yg,deleteAllMatches:v4,deleteMatch:m4,deleteMatchesByTournament:Xw,getMatchById:g4,getMatchesByTournament:h4,listMatches:Nf,updateMatch:p4},Symbol.toStringTag,{value:"Module"})),Mh="tournaments";let Wu=!1,Fv=0;const x4=5e3,Va=async()=>{try{const e=await ht.getAll(Mh);return console.log(` getTournaments: Encontrados ${e.length} torneos en IndexedDB`),e.length===0?(console.log(" La BD est vaca, inicializando con datos seed..."),await ht.putMany(Mh,kl),console.log(` Inicializados ${kl.length} torneos desde datos seed`),kl):e}catch(e){return console.error(" Error crtico getting tournaments from IndexedDB:",e),console.error(" Usando datos seed como ltimo recurso"),kl}},Ii=async e=>{try{await ht.putMany(Mh,e),console.log(` Saved ${e.length} tournaments to IndexedDB`)}catch(t){throw console.error(" Error saving tournaments to IndexedDB:",t),t}},Jw=async()=>(await Yw(),await Va()),y4=async()=>{console.log(" Forzando sincronizacin de torneos desde Supabase..."),await Yw(),console.log(" Sincronizacin completada")},Yw=async()=>{if(Wu){console.log("TournamentService: Sync already in progress, skipping...");return}const e=Date.now();if(e-Fv<x4){console.log("TournamentService: Sync cooldown active, skipping...");return}Wu=!0,Fv=e;try{const{config:t}=await Z(async()=>{const{config:h}=await Promise.resolve().then(()=>ft);return{config:h}},void 0);if(!t.useSupabase){console.log("TournamentService: Supabase sync disabled, skipping download..."),Wu=!1;return}const{getSupabaseClient:r}=await Z(async()=>{const{getSupabaseClient:h}=await Promise.resolve().then(()=>dt);return{getSupabaseClient:h}},void 0),n=r();console.log("TournamentService: Downloading tournaments from Supabase...");const{data:a,error:s}=await n.from("tournaments").select("*");if(s){console.error("TournamentService: Error downloading tournaments from Supabase:",s);return}if(!a||a.length===0){console.log("TournamentService: No tournaments found in Supabase");return}console.log(`TournamentService: Found ${a.length} tournaments in Supabase`);const i=a.map(h=>({id:h.id,name:h.name,type:h.type,logo:h.logo,startDate:h.start_date,endDate:h.end_date,status:h.status,teams:h.teams||[],rounds:h.rounds||1,matches:h.matches||[],winner:h.winner||void 0,topScorer:h.top_scorer||void 0,description:h.description||""})),u=[...await Va()];i.forEach(h=>{const p=u.findIndex(m=>m.id===h.id);p!==-1?(u[p]=h,console.log(`TournamentService: Updated tournament ${h.name} from Supabase`)):(u.push(h),console.log(`TournamentService: Added new tournament ${h.name} from Supabase`))}),await Ii(u);const{updateTournaments:f}=mr.getState();f(u),console.log(`TournamentService: Successfully synced ${i.length} tournaments from Supabase`)}catch(t){console.error("TournamentService: Failed to sync tournaments from Supabase:",t)}finally{Wu=!1}},gc=async e=>{try{const{config:t}=await Z(async()=>{const{config:i}=await Promise.resolve().then(()=>ft);return{config:i}},void 0);if(!t.useSupabase){console.log("TournamentService: Supabase sync disabled, skipping...");return}const{getSupabaseClient:r}=await Z(async()=>{const{getSupabaseClient:i}=await Promise.resolve().then(()=>dt);return{getSupabaseClient:i}},void 0),n=r(),a={id:e.id,name:e.name,type:e.type,logo:e.logo,start_date:e.startDate,end_date:e.endDate,status:e.status||"upcoming",teams:e.teams||[],rounds:e.rounds||1,matches:e.matches||[],description:e.description||"",winner:e.winner||null,top_scorer:e.topScorer||null,updated_at:new Date().toISOString()};console.log("TournamentService: Syncing tournament to Supabase:",e.id);const{error:s}=await n.from("tournaments").upsert(a,{onConflict:"id"});s?console.error("TournamentService: Error syncing tournament to Supabase:",s):console.log("TournamentService: Tournament synced to Supabase successfully:",e.id)}catch(t){console.error("TournamentService: Failed to sync tournament to Supabase:",t)}},w4=async e=>{const t=await Va(),n={id:`t-${Date.now()}`,name:e.name.trim(),type:e.type,logo:e.logo||`https://ui-avatars.com/api/?name=${encodeURIComponent(e.name)}&background=111827&color=fff&size=128&bold=true`,startDate:new Date(e.startDate).toISOString(),endDate:new Date(e.endDate).toISOString(),status:e.status||"upcoming",teams:e.teams,rounds:e.rounds,matches:[],description:e.description||""},a=[n,...t];await Ii(a);const{updateTournaments:s}=mr.getState();return s(a),await gc(n),n},_4=async e=>{const r=(await Va()).map(a=>a.id===e.id?e:a);await Ii(r);const{updateTournaments:n}=mr.getState();return n(r),await gc(e),e},S4=async e=>{const r=(await Va()).map(s=>s.id===e?{...s,status:"finished"}:s);await Ii(r);const{updateTournaments:n}=mr.getState();n(r);const a=r.find(s=>s.id===e);a&&await gc(a)},E4=async e=>{const r=(await Va()).filter(a=>a.id!==e);await Ii(r);const{updateTournaments:n}=mr.getState();n(r);try{const{config:a}=await Z(async()=>{const{config:u}=await Promise.resolve().then(()=>ft);return{config:u}},void 0);if(!a.useSupabase){console.log("TournamentService: Supabase sync disabled, skipping deletion...");return}const{getSupabaseClient:s}=await Z(async()=>{const{getSupabaseClient:u}=await Promise.resolve().then(()=>dt);return{getSupabaseClient:u}},void 0),i=s();console.log("TournamentService: Deleting tournament from Supabase:",e);const{error:c}=await i.from("tournaments").delete().eq("id",e);c?console.error("TournamentService: Error deleting tournament from Supabase:",c):console.log("TournamentService: Tournament deleted from Supabase successfully:",e)}catch(a){console.error("TournamentService: Failed to delete tournament from Supabase:",a)}},b4=async(e,t)=>{if(!(await Va()).find(s=>s.id===e))throw new Error(`Tournament with id ${e} not found`);return await yg({tournamentId:e,round:t.round||0,date:t.date,homeTeam:t.homeTeam,awayTeam:t.awayTeam,status:"scheduled"})},k4=async e=>{console.log(`TournamentService: Generando fixture round-robin para torneo ${e}...`);const t=await Va(),r=t.find(X=>X.id===e);if(!r)throw new Error(`Tournament with id ${e} not found`);if(!r.teams||r.teams.length<2)throw new Error(`El torneo debe tener al menos 2 equipos para generar un fixture. Actualmente tiene ${r.teams?.length||0} equipos.`);console.log(`TournamentService: Torneo "${r.name}" tiene ${r.teams.length} equipos`);const n=await Xw(e);n>0&&console.log(`TournamentService: Eliminados ${n} partidos existentes del torneo`);const a=r.rounds||1;console.log(`TournamentService: Torneo configurado con ${a} vuelta(s) (${a===1?"solo ida":a===2?"ida y vuelta":`${a} vueltas`})`);const s=[...r.teams];s.length%2===0||s.push("BYE");const c=s.length,u=c-1,f=u*a,h=c/2,p=new Date(r.startDate),m=[];let y=0;const w=Date.now(),x=p.getTime(),_=new Date(r.endDate).getTime(),E=Math.max(1,Math.floor((_-x)/(1e3*60*60*24))),k=Math.max(1,Math.floor(E/Math.max(1,f))),b=[];let O=s.slice(0,h),z=s.slice(h).reverse();for(let X=0;X<u;X++){for(let Te=0;Te<h;Te++){const oe=O[Te],ge=z[Te];if(oe==="BYE"||ge==="BYE")continue;const K=X%2===0?oe:ge,fe=X%2===0?ge:oe;b.push({homeTeam:K,awayTeam:fe,roundInLeg:X+1})}const he=O[0],Ie=O.pop(),Ee=z.shift();O=[he,Ee,...O.slice(1)],z=[...z,Ie]}const L={};b.forEach(X=>{L[X.roundInLeg]||(L[X.roundInLeg]=[]),L[X.roundInLeg].push(X)});let P=1,J=0;for(let X=0;X<a;X++){console.log(`TournamentService: Generando vuelta ${X+1} de ${a}...`);const he=Object.keys(L).map(Number).sort((Ie,Ee)=>Ie-Ee);for(const Ie of he){const Ee=new Date(x+J*24*60*60*1e3);for(const Te of L[Ie]){const oe=X%2===0?Te.homeTeam:Te.awayTeam,ge=X%2===0?Te.awayTeam:Te.homeTeam,K=`match-${w}-${y}-${Math.random().toString(36).substr(2,9)}`;y++;const fe={id:K,tournamentId:r.id,round:P,date:Ee.toISOString(),homeTeam:oe,awayTeam:ge,status:"scheduled"};m.push(fe),await yg({tournamentId:fe.tournamentId,round:fe.round,date:fe.date,homeTeam:fe.homeTeam,awayTeam:fe.awayTeam,status:fe.status})}J+=k,P++}}console.log(`TournamentService: Generados ${m.length} partidos para el fixture`);const V=t.map(X=>X.id===r.id?{...X,matches:[]}:X);await Ii(V);const{updateTournaments:le}=mr.getState();le(V);const ee=V.find(X=>X.id===e);return ee&&await gc(ee),console.log(`TournamentService:  Fixture generado exitosamente. ${m.length} partidos creados.`),m.length},T4=async(e,t,r)=>{const{updateMatch:n}=await Z(async()=>{const{updateMatch:s}=await Promise.resolve().then(()=>hf);return{updateMatch:s}},void 0),a=await n(t,r);if(a.tournamentId!==e)throw new Error(`Match ${t} does not belong to tournament ${e}`);return a},C4=async(e,t)=>{const{getMatchById:r}=await Z(async()=>{const{getMatchById:s}=await Promise.resolve().then(()=>hf);return{getMatchById:s}},void 0),n=await r(t);if(!n)throw new Error(`Match with id ${t} not found`);if(n.tournamentId!==e)throw new Error(`Match ${t} does not belong to tournament ${e}`);const{deleteMatch:a}=await Z(async()=>{const{deleteMatch:s}=await Promise.resolve().then(()=>hf);return{deleteMatch:s}},void 0);await a(t)},A4=async()=>{const{deleteAllMatches:e}=await Z(async()=>{const{deleteAllMatches:t}=await Promise.resolve().then(()=>hf);return{deleteAllMatches:t}},void 0);return await e()},P4=async()=>{try{const{config:e}=await Z(async()=>{const{config:s}=await Promise.resolve().then(()=>ft);return{config:s}},void 0);if(!e.useSupabase)throw new Error("Supabase no est habilitado. Habilita Supabase en la configuracin primero.");console.log(" Iniciando migracin de todos los partidos a Supabase...");const t=await Va();let r=0;const n=[];for(const s of t)try{const i=(s.matches||[]).length;r+=i,console.log(` Sincronizando torneo "${s.name}" con ${i} partidos...`),await gc(s),console.log(` Torneo "${s.name}" sincronizado exitosamente`)}catch(i){const c=`Error sincronizando torneo "${s.name}": ${i instanceof Error?i.message:"Error desconocido"}`;console.error(` ${c}`),n.push(c)}const a={tournaments:t.length,matches:r,errors:n};return n.length===0?console.log(` Migracin completada: ${t.length} torneos y ${r} partidos migrados exitosamente a Supabase`):console.warn(` Migracin completada con errores: ${t.length} torneos, ${r} partidos, ${n.length} errores`),a}catch(e){throw console.error(" Error en la migracin de partidos a Supabase:",e),e}},Bh=Object.freeze(Object.defineProperty({__proto__:null,addMatch:b4,createTournament:w4,deleteAllMatches:A4,deleteMatch:C4,deleteTournament:E4,finishTournament:S4,forceSyncTournamentsFromSupabase:y4,generateRoundRobin:k4,listTournaments:Jw,migrateAllMatchesToSupabase:P4,updateMatch:T4,updateTournament:_4},Symbol.toStringTag,{value:"Module"})),I4=(e,t,r=!1)=>{const n=[],a=r?1:2,s=6,i=new Date;i.setDate(i.getDate()-s*7);let c=1;for(let u=1;u<=a;u++)for(let f=0;f<e.length;f++)for(let h=f+1;h<e.length;h++){const p=u===1?e[f]:e[h],m=u===1?e[h]:e[f],y=new Date(i);y.setDate(i.getDate()+(c-1)*7);const w=c<=s,x={id:`match${c}`,tournamentId:t,round:Math.ceil(c/(e.length*(e.length-1)/2)),date:y.toISOString(),homeTeam:p,awayTeam:m,status:w?"finished":"scheduled"};w&&(x.homeScore=Math.floor(Math.random()*5),x.awayScore=Math.floor(Math.random()*5),x.scorers=[]),n.push(x),c++}return n},O4=(e,t)=>({clubs:[],players:[],tournaments:[],posts:[],postsLoading:!1,isDataLoaded:!1,initializeDataFromService:async()=>{try{console.log("dataStore - Starting data initialization...");const[r,n,a,s]=await Promise.all([$t(),$r(),Jw(),no()]);console.log(`dataStore - Loaded ${r.length} clubs, ${n.length} players, ${a.length} tournaments and ${s.length} posts`),e({clubs:r.length>0?r:lt,players:n.length>0?n:er,tournaments:a,posts:s.length>0?s:Fh,isDataLoaded:!0}),console.log(`dataStore - State updated. Tournaments: ${a.length}, Posts: ${s.length}`)}catch(r){console.error("dataStore - Error initializing data from service:",r),console.log("dataStore - Using seed data as fallback"),e({clubs:lt,players:er,tournaments:kl,posts:Fh,isDataLoaded:!0})}},initializeTournamentSync:()=>{t().syncTournamentTeams()},updateClubs:async r=>{try{await En(r)}catch{}e({clubs:r}),t().syncTournamentTeams()},updateClub:async r=>{try{await Hw(r),e(n=>({clubs:n.clubs.map(a=>a.id===r.id?r:a)})),t().syncTournamentTeams()}catch(n){throw console.error(" Error updating club in store:",n),n}},removeClub:async r=>{try{await Gw(r),e(n=>({clubs:n.clubs.filter(a=>a.id!==r)})),t().syncTournamentTeams()}catch(n){throw console.error(" Error removing club from store:",n),n}},updatePlayers:async r=>{try{await Sr(r),e({players:r})}catch(n){console.error("dataStore - Error updating players:",n)}},updateTournaments:r=>e({tournaments:r}),updatePosts:r=>{e({posts:r})},refreshPlayers:async r=>{try{const n=await $r(r);if(n&&n.length>0){const a="virtual_zone_salaries_updated",s=localStorage.getItem(a),i=n.some(c=>(c.contract?.salary||0)>1e5||(c.transferValue||0)>5e5);!s&&!i?(console.log(" Inicializando datos de mercado para datos seed..."),va(),localStorage.setItem(a,"true")):!s&&i&&(console.log(" Datos editados detectados - preservando cambios del usuario"),localStorage.setItem(a,"true")),e({players:n})}else try{await di();const a=await $r(r);va(),e({players:a})}catch(a){console.error("dataStore - Error during initialization:",a),e({players:er})}}catch(n){console.error("dataStore - Error refreshing players:",n);try{await di();const a=await $r(r);e({players:a})}catch(a){console.error("dataStore - Error in fallback initialization:",a),e({players:er})}}},refreshPosts:async()=>{e({postsLoading:!0});try{const r=await no();e({posts:r,postsLoading:!1})}catch(r){console.error("dataStore - Error refreshing posts:",r),e({posts:[],postsLoading:!1})}},initializePosts:async()=>{try{await Rh(),await t().refreshPosts()}catch(r){console.error("dataStore - Error initializing posts:",r)}},clearPosts:async()=>{try{await Lh(),e({posts:[]})}catch(r){console.error("dataStore - Error clearing posts:",r)}},refreshClubs:async()=>{const r=await $t();e({clubs:r}),t().syncTournamentTeams()},refreshClubsFromSeed:async()=>{const r=await $t(),n=Nh(r,lt);await En(n),e({clubs:n}),t().syncTournamentTeams()},syncTournamentTeams:async()=>{const n=(await $t()).map(i=>i.name),s=t().tournaments.map(i=>i.id==="tournament1"?{...i,teams:n,matches:I4(n,i.id,!1)}:i);e({tournaments:s})},refreshPlayersFromSeed:async()=>{await Sr(er),va(),e({players:er})},regenerateAllPlayers:async()=>{const r=await dg();await Sr(r),va();const n=await $r();e({players:n})},clearAllDataCache:async()=>{console.log("dataStore - clearAllDataCache called"),await Lh();const r=await hg();await Sr(r),va();const n=await $r();e({players:n,posts:[]})},forceUpdateFromSeedData:async()=>{console.log("dataStore - Forcing update from seed data");try{localStorage.removeItem("virtual_zone_clubs"),localStorage.removeItem("virtual_zone_players"),localStorage.removeItem("virtual_zone_initialized");for(let n=0;n<localStorage.length;n++){const a=localStorage.key(n);a&&(a.includes("virtual_zone")||a.includes("player")||a.includes("club"))&&localStorage.removeItem(a)}await En(Nh(await $t(),lt)),await Sr(er),await Rh(),va();const r=await no();e({clubs:lt,players:er,posts:r}),console.log("dataStore - Successfully updated all data from seed"),console.log(`- Clubs: ${lt.length}`),console.log(`- Players: ${er.length}`),console.log(`- Posts: ${r.length}`)}catch(r){console.error("dataStore - Error updating from seed data:",r)}}}),D4=()=>Ke.useSupabase&&!!Ke.supabase.url&&!!Ke.supabase.anonKey,xo=()=>{if(!D4())return null;try{return nr()}catch(e){return console.warn("supabaseMarketSync: Supabase not configured:",e),null}},F4=async e=>{const t=xo();if(!t)return;const r=s=>s?/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(s):!1,n={id:e.id,player_id:e.playerId,player_name:e.playerName,from_club:e.fromClub,to_club:e.toClub,amount:e.amount,status:e.status,user_id:r(e.userId)?e.userId:null,date:e.date??new Date().toISOString(),counter_amount:e.counterAmount??null,counter_message:e.counterMessage??null},{error:a}=await t.from("offers").upsert(n,{onConflict:"id"});a&&console.error("supabaseMarketSync: Error upserting offer:",a)},R4=async(e,t)=>{const r=xo();if(!r)return;const n={};if(t.status&&(n.status=t.status),t.counterAmount!==void 0&&(n.counter_amount=t.counterAmount),t.counterMessage!==void 0&&(n.counter_message=t.counterMessage),Object.keys(n).length===0)return;const{error:a}=await r.from("offers").update(n).eq("id",e);a&&console.error("supabaseMarketSync: Error updating offer status:",a)},L4=async e=>{const t=xo();t&&await t.from("transfers").upsert({id:e.id,player_id:e.playerId,player_name:e.playerName,from_club:e.fromClub,to_club:e.toClub,fee:e.fee,date:e.date??new Date().toISOString()},{onConflict:"id"})},N4=async()=>{const e=xo();if(!e)return[];const{data:t,error:r}=await e.from("offers").select("*");return r?(console.error("supabaseMarketSync: Error fetching offers:",r),[]):(t||[]).map(n=>({id:n.id,playerId:n.player_id,playerName:n.player_name,fromClub:n.from_club,toClub:n.to_club,amount:Number(n.amount)||0,status:n.status,date:n.date,userId:n.user_id,history:n.history||[],counterAmount:n.counter_amount,counterMessage:n.counter_message}))},M4=async()=>{const e=xo();if(!e)return[];const{data:t,error:r}=await e.from("transfers").select("*");return r?(console.error("supabaseMarketSync: Error fetching transfers:",r),[]):(t||[]).map(n=>({id:n.id,playerId:n.player_id,playerName:n.player_name,fromClub:n.from_club,toClub:n.to_club,fee:Number(n.fee)||0,date:n.date}))},Qw="market_status",Zw="global_status",B4=async()=>{const e=xo();if(!e)return null;try{const{data:t,error:r}=await e.from(Qw).select("is_open").eq("id",Zw).maybeSingle();if(r)throw r;return!t||typeof t.is_open!="boolean"?null:t.is_open}catch(t){return console.error("supabaseMarketSync: Error fetching market status:",t),null}},j4=async e=>{const t=xo();if(t)try{await t.from(Qw).upsert({id:Zw,is_open:e,updated_at:new Date().toISOString()},{onConflict:"id"})}catch(r){console.error("supabaseMarketSync: Error updating market status:",r)}},jh="virtual_zone_market_status",ri="virtual_zone_offers",Sl="virtual_zone_transfers";function Rv(e){try{const t=localStorage.getItem(jh);return t===null?e:t==="true"}catch{return e}}function Hu(e,t){try{const r=localStorage.getItem(e);return r?JSON.parse(r):t}catch{return t}}function Xs(e,t){try{localStorage.setItem(e,JSON.stringify(t))}catch{}}const $4=(e,t)=>{const r={marketStatus:Rv(RA),transfers:Hu(Sl,Ov),offers:Hu(ri,Iv),updateTransfers:n=>{Xs(Sl,n),e({transfers:n})},updateOffers:n=>{Xs(ri,n),e({offers:n})},updateMarketStatus:n=>{try{localStorage.setItem(jh,String(n))}catch{}e({marketStatus:n}),Ke.useSupabase&&j4(n)},addOffer:n=>e(a=>{const s=[...a.offers,n];return Xs(ri,s),Ke.useSupabase&&F4(n),{offers:s}}),updateOfferStatus:(n,a,s)=>e(i=>{const c=i.offers.map(u=>{if(u.id!==n)return u;const f={...u,status:a,...s};if(s&&s.historyEntry){const h=s.historyEntry;f.history=[...f.history||[],h]}return Ke.useSupabase&&R4(n,f),f});return Xs(ri,c),{offers:c}}),addTransfer:n=>e(a=>{const s=[n,...a.transfers];return Xs(Sl,s),Ke.useSupabase&&L4(n),{transfers:s}}),refreshOffers:async()=>{try{if(Ke.useSupabase){const n=await N4();Xs(ri,n),e({offers:n});return}}catch(n){console.error("marketSlice - Error fetching offers from Supabase:",n)}e({offers:Hu(ri,Iv)})},refreshTransfers:async()=>{try{if(Ke.useSupabase){const n=await M4();Xs(Sl,n),e({transfers:n});return}}catch(n){console.error("marketSlice - Error fetching transfers from Supabase:",n)}e({transfers:Hu(Sl,Ov)})},refreshMarketStatus:async()=>{try{if(Ke.useSupabase){const n=await B4();if(typeof n=="boolean"){localStorage.setItem(jh,String(n)),e({marketStatus:n});return}}}catch(n){console.error("marketSlice - Error fetching market status from Supabase:",n)}e({marketStatus:Rv(t().marketStatus)})}};return Ke.useSupabase&&(async()=>await Promise.all([r.refreshOffers(),r.refreshTransfers(),r.refreshMarketStatus()]))(),r},U4=()=>Ke.useSupabase&&!!Ke.supabase.url&&!!Ke.supabase.anonKey,pc=()=>{if(!U4())return null;try{return nr()}catch(e){return console.warn("supabaseMediaSync: Supabase not configured:",e),null}},z4=e=>({id:e.id,title:e.title,description:e.description||null,type:e.type,url:e.url,thumbnail_url:e.thumbnailUrl||null,category:e.category||"General",uploader:e.uploader||e.author||"anon",upload_date:e.uploadDate||e.date||new Date().toISOString(),likes:e.likes||0,views:e.views||0,file_size:e.fileSize||null,mime_type:e.mimeType||null}),V4=e=>({id:e.id,title:e.title,description:e.description,type:e.type,url:e.url,thumbnailUrl:e.thumbnail_url,category:e.category,uploader:e.uploader,uploadDate:e.upload_date,likes:e.likes||0,views:e.views||0,fileSize:e.file_size,mimeType:e.mime_type,image:e.url,author:e.uploader,date:e.upload_date}),e_=async e=>{const t=pc();if(t)try{const r=z4(e),{error:n}=await t.from("media").upsert(r,{onConflict:"id"});n?console.error("supabaseMediaSync: Error upserting media item:",n):console.log(" Media item synced to Supabase:",e.id)}catch(r){console.error("supabaseMediaSync: Error in upsertMediaItemToSupabase:",r)}},t_=async()=>{const e=pc();if(!e)return[];try{const{data:t,error:r}=await e.from("media").select("*").order("upload_date",{ascending:!1});return r?(console.error("supabaseMediaSync: Error fetching media items:",r),[]):(t||[]).map(V4)}catch(t){return console.error("supabaseMediaSync: Error in fetchMediaItemsFromSupabase:",t),[]}},W4=async e=>{const t=pc();if(t)try{const{error:r}=await t.from("media").delete().eq("id",e);r?console.error("supabaseMediaSync: Error deleting media item:",r):console.log(" Media item deleted from Supabase:",e)}catch(r){console.error("supabaseMediaSync: Error in deleteMediaItemFromSupabase:",r)}},H4=async e=>{if(pc())try{console.log(" Starting media sync to Supabase...");const r=await t_(),n=new Set(r.map(c=>c.id)),a=e.filter(c=>!n.has(c.id));for(const c of a)await e_(c);const s=new Set(e.map(c=>c.id)),i=r.filter(c=>!s.has(c.id));for(const c of i)await W4(c.id);console.log(` Media sync completed. Uploaded: ${a.length}, Deleted: ${i.length}`)}catch(r){console.error("supabaseMediaSync: Error in syncAllMediaItemsToSupabase:",r)}},Lv=async()=>{if(!pc())return[];try{console.log(" Syncing media items from Supabase...");const t=await t_();return console.log(` Fetched ${t.length} media items from Supabase`),t}catch(t){return console.error("supabaseMediaSync: Error in syncMediaItemsFromSupabase:",t),[]}},r_="virtual_zone_media_items";function Xd(e){try{const t=localStorage.getItem(r_);if(!t)return e;const r=JSON.parse(t);return Array.isArray(r)?r:e}catch{return e}}function Gu(e){try{localStorage.setItem(r_,JSON.stringify(e))}catch(t){console.error("Error saving media items to localStorage:",t)}}const G4=(e,t)=>({mediaItems:[],mediaLoading:!1,addMediaItem:async r=>{e({mediaLoading:!0});try{const n=t().mediaItems,a=[r,...n];Gu(a),e({mediaItems:a}),Ke.useSupabase&&await e_(r)}catch(n){console.error("Error adding media item:",n)}finally{e({mediaLoading:!1})}},updateMediaItems:r=>{Gu(r),e({mediaItems:r})},syncMediaItems:async()=>{if(Ke.useSupabase)try{const r=await Lv();r.length>0&&(Gu(r),e({mediaItems:r}),console.log(" Media items synced from Supabase"))}catch(r){console.error("Error syncing media items:",r)}},initializeMediaItems:async()=>{e({mediaLoading:!0});try{let r;if(Ke.useSupabase)try{const n=await Lv();n.length>0?(r=n,Gu(r),console.log(" Loaded media items from Supabase")):(r=Xd(Vu),await H4(r),console.log(" Synced local media items to Supabase"))}catch(n){console.warn("Failed to load from Supabase, using local data:",n),r=Xd(Vu)}else r=Xd(Vu);e({mediaItems:r})}catch(r){console.error("Error initializing media items:",r),e({mediaItems:Vu})}finally{e({mediaLoading:!1})}}}),q4=e=>({standings:FA,updateStandings:t=>e({standings:t})}),K4=e=>({faqs:LA,updateFaqs:t=>e({faqs:t})}),mr=uy()((...e)=>({...O4(...e),...$4(...e),...G4(...e),...q4(...e),...K4(...e)}));(async()=>{try{const e=mr.getState();await e.initializeDataFromService(),await e.initializeMediaItems(),console.log("Data store initialized successfully"),typeof window<"u"&&(window.dataStore=e)}catch(e){console.error("Error initializing data store:",e)}})();const Kl=Object.freeze(Object.defineProperty({__proto__:null,useDataStore:mr},Symbol.toStringTag,{value:"Module"})),X4=e=>new Intl.NumberFormat("es-ES",{style:"currency",currency:"EUR",maximumFractionDigits:0}).format(e),J4=e=>{const t=new Date(e);return new Intl.DateTimeFormat("es-ES",{day:"2-digit",month:"2-digit",year:"numeric"}).format(t)},rB=e=>{const t=new Date(e);return new Intl.DateTimeFormat("es-ES",{hour:"2-digit",minute:"2-digit"}).format(t)},Y4=e=>e==="GK"||e==="PT"?"goalkeeper":["CB","LB","RB","LWB","RWB","DEC","LI","LD"].includes(e)?"defender":["CDM","CM","CAM","LM","RM","MCD","MC","MO","MDI","MDD"].includes(e)?"midfielder":"attacker",nB=e=>{switch(e){case"PT":return"text-yellow-500 bg-yellow-500/10";case"DEC":return"text-blue-500 bg-blue-500/10";case"CD":return"text-red-500 bg-red-500/10";case"SD":return"text-red-500 bg-red-500/10"}switch(Y4(e)){case"goalkeeper":return"text-yellow-500 bg-yellow-500/10";case"defender":return"text-blue-500 bg-blue-500/10";case"midfielder":return"text-green-500 bg-green-500/10";case"attacker":return"text-red-500 bg-red-500/10";default:return"text-gray-500 bg-gray-500/10"}},Q4=e=>{switch(e){case"pending":return"Pendiente";case"accepted":return"Aceptada";case"rejected":return"Rechazada";case"counter-offer":return"Contraoferta";default:return"Desconocido"}},aB=(e,t)=>e.status!=="finished"||e.homeScore===void 0||e.awayScore===void 0?null:e.homeTeam===t?e.homeScore>e.awayScore?"win":e.homeScore<e.awayScore?"loss":"draw":e.awayTeam===t?e.awayScore>e.homeScore?"win":e.awayScore<e.homeScore?"loss":"draw":null,sB=e=>{switch(e){case"transfer":return"Fichaje";case"rumor":return"Rumor";case"result":return"Resultado";case"announcement":return"Anuncio";case"statement":return"Declaracin";default:return e}},oB=e=>{switch(e){case"transfer":return"bg-green-500/20 text-green-400";case"rumor":return"bg-blue-500/20 text-blue-400";case"result":return"bg-yellow-500/20 text-yellow-400";case"announcement":return"bg-purple-500/20 text-purple-400";case"statement":return"bg-red-500/20 text-red-400";default:return"bg-gray-500/20 text-gray-400"}},iB=e=>new Promise((t,r)=>{const n=new FileReader;n.onload=()=>{const a=n.result;t(a)},n.onerror=()=>{r(new Error("Error reading file"))},n.readAsDataURL(e)}),lB=e=>e.type.startsWith("image/")?e.size>5*1024*1024?"La imagen no puede ser mayor a 5MB":["image/jpeg","image/jpg","image/png","image/gif","image/webp"].includes(e.type)?null:"Formato de imagen no soportado. Usa JPG, PNG, GIF o WebP":"Solo se permiten archivos de imagen",cB=e=>{if(!e)return!1;const t=e.trim();return t?!!(/^https?:\/\//i.test(t)||t.toLowerCase().startsWith("data:image/")||t.startsWith("/")||t.startsWith("./")||t.startsWith("../")||/^(?:\.{0,2}\/)?(?:[^\/?#]+\/)*[^\/?#]+\.(?:png|jpe?g|gif|webp|svg)$/i.test(t)):!1},Z4={GK:"PT",CB:"DEC",LB:"LI",RB:"LD",LWB:"LI",RWB:"LD",DMF:"MCD",CMF:"MC",LMF:"MDI",RMF:"MDD",AMF:"MO",SS:"MO",CF:"CD",LWF:"EXI",RWF:"EXD",CDM:"MCD",CM:"MC",CAM:"MO",LM:"MDI",RM:"MDD",LW:"EXI",RW:"EXD",ST:"CD",DEF:"DEF",POR:"PT"};function uB(e){return Z4[e]||e}function fB(e,t){const r=e?.trim().toLowerCase();if(!r||r==="libre"||r==="free")return"Libre";const n=t.find(a=>a.id===e);return n?n.name:"Desconocido"}function dB(e,t){const r=e?.trim().toLowerCase();if(!r||r==="libre"||r==="free")return"";const n=t.find(a=>a.id===e);return n?n.logo:"/default-club.svg"}const Nv={pending:"bg-yellow-500/10 text-yellow-300 border-yellow-500/30",accepted:"bg-green-500/10 text-green-300 border-green-500/30",rejected:"bg-red-500/10 text-red-300 border-red-500/30","counter-offer":"bg-purple-500/10 text-purple-300 border-purple-500/30",default:"bg-gray-500/10 text-gray-300 border-gray-600/40"},eP=()=>{const[e,t]=ue.useState(!1),[r,n]=ue.useState(!1),[a,s]=ue.useState(!1),[i,c]=ue.useState({}),{user:u,isAuthenticated:f,logout:h,hasRole:p}=wi(),{offers:m=[],clubs:y=[]}=mr(),w=uc(),x=u?`vz_market_notifications_${u.id}`:null;ue.useEffect(()=>{if(!x){c({});return}try{const oe=localStorage.getItem(x);c(oe?JSON.parse(oe):{})}catch{c({})}},[x]);const _=ue.useMemo(()=>u?u.role==="dt"?!0:Array.isArray(u?.roles)&&u.roles.includes("dt"):!1,[u]),k=ue.useMemo(()=>{if(!u)return null;if(u?.clubId){const oe=y.find(ge=>ge.id===u.clubId);if(oe)return oe}if(u?.club){const oe=y.find(ge=>ge.name===u.club);if(oe)return oe}return null},[u,y])?.name,b=ue.useMemo(()=>!f||!_||!k?[]:m.filter(oe=>oe.toClub===k),[m,f,_,k]),O=ue.useMemo(()=>!f||!_||!k?[]:m.filter(oe=>oe.fromClub===k),[m,f,_,k]),z=b.filter(oe=>oe.status==="counter-offer"?!0:oe.status==="accepted"?!i[oe.id]:!1),L=O.filter(oe=>oe.status==="pending"?!0:oe.status==="accepted"?!i[oe.id]:!1),P=b.filter(oe=>oe.status!=="accepted"||!i[oe.id]),J=O.filter(oe=>oe.status!=="accepted"||!i[oe.id]),V=z.length+L.length,le=V>9?"9+":String(V),ee=_&&!!k,X=V>0?`${V} nuevas`:"Sin novedades",he=oe=>Nv[oe]||Nv.default,Ie=(oe,ge)=>{const K=ge==="buyer"?oe.fromClub:oe.toClub,fe=oe.counterAmount??oe.amount,H=he(oe.status);return R.jsxs("div",{className:"bg-gray-800/60 border border-gray-700/60 rounded-lg p-3 space-y-1",children:[R.jsxs("div",{className:"flex items-center justify-between text-xs text-gray-400",children:[R.jsx("span",{className:"text-gray-100 font-semibold",children:oe.playerName}),R.jsx("span",{children:J4(oe.date)})]}),R.jsx("p",{className:"text-xs text-gray-400",children:ge==="buyer"?`Club vendedor: ${K}`:`Club comprador: ${K}`}),R.jsxs("div",{className:"flex items-center justify-between mt-2",children:[R.jsx("span",{className:"text-sm font-semibold text-white",children:X4(fe)}),R.jsx("span",{className:`text-[11px] px-2 py-0.5 rounded-full border ${H}`,children:Q4(oe.status)})]})]},`${ge}-${oe.id}`)},Ee=(oe,ge,K,fe)=>R.jsxs("div",{className:"p-4 border-b border-gray-800 last:border-b-0",children:[R.jsxs("div",{className:"flex items-center justify-between mb-3",children:[R.jsx("span",{className:"text-sm font-semibold text-white",children:oe}),R.jsx("span",{className:"text-xs text-gray-400",children:ge.length})]}),ge.length?R.jsx("div",{className:"space-y-3",children:ge.slice(0,3).map(H=>Ie(H,K))}):R.jsx("p",{className:"text-xs text-gray-500",children:fe})]});ue.useEffect(()=>{const oe=()=>{t(!1),n(!1),s(!1)};return window.addEventListener("popstate",oe),()=>{window.removeEventListener("popstate",oe)}},[]),ue.useEffect(()=>{f||s(!1)},[f]),ue.useEffect(()=>{if(!a||!f||!x)return;const oe=[...b,...O].filter(ge=>ge.status==="accepted"&&!i[ge.id]).map(ge=>ge.id);oe.length&&c(ge=>{const K={...ge};let fe=!1;if(oe.forEach(H=>{K[H]||(K[H]=!0,fe=!0)}),fe){try{localStorage.setItem(x,JSON.stringify(K))}catch{}return K}return ge})},[a,f,x,b,O,i]);const Te=()=>{h(),w("/"),t(!1),n(!1),s(!1)};return R.jsxs("nav",{className:"bg-gray-900 border-b border-gray-800 sticky top-0 z-50",children:[R.jsx("div",{className:"container mx-auto px-4",children:R.jsxs("div",{className:"flex justify-between h-16",children:[R.jsxs("div",{className:"flex",children:[R.jsx("div",{className:"flex-shrink-0 flex items-center",children:R.jsxs(ut,{to:"/",className:"flex items-center",children:[R.jsx("img",{src:"/logo.png",alt:"La Virtual Zone",className:"h-8 w-8 mr-2"}),R.jsx("span",{className:"text-white font-bold text-xl font-display",children:"La Virtual Zone"})]})}),R.jsxs("div",{className:"hidden md:ml-6 md:flex md:items-center md:space-x-2",children:[R.jsx(ut,{to:"/liga-master",className:"text-gray-300 hover:bg-gray-800 hover:text-white px-3 py-2 rounded-md text-sm font-medium",children:"Liga Master"}),R.jsx(ut,{to:"/torneos",className:"text-gray-300 hover:bg-gray-800 hover:text-white px-3 py-2 rounded-md text-sm font-medium",children:"Torneos"}),R.jsx(ut,{to:"/blog",className:"text-gray-300 hover:bg-gray-800 hover:text-white px-3 py-2 rounded-md text-sm font-medium",children:"Blog"}),R.jsx(ut,{to:"/galeria",className:"text-gray-300 hover:bg-gray-800 hover:text-white px-3 py-2 rounded-md text-sm font-medium",children:"Galera"}),R.jsx(ut,{to:"/ayuda",className:"text-gray-300 hover:bg-gray-800 hover:text-white px-3 py-2 rounded-md text-sm font-medium",children:"Ayuda"})]})]}),R.jsxs("div",{className:"flex items-center space-x-2 md:space-x-4",children:[f&&R.jsxs("div",{className:"relative",children:[R.jsxs("button",{onClick:()=>{s(oe=>!oe),n(!1)},className:"relative p-2 rounded-full text-gray-300 hover:text-white hover:bg-gray-800 focus:outline-none transition-colors","aria-label":"Notificaciones del mercado",children:[R.jsx(mk,{size:18}),V>0&&R.jsx("span",{className:"absolute -top-0.5 -right-0.5 bg-red-500 text-white text-[10px] leading-none px-1.5 py-0.5 rounded-full",children:le})]}),a&&R.jsxs("div",{className:"absolute right-0 mt-3 w-80 bg-gray-900 border border-gray-800 rounded-2xl shadow-2xl z-30",children:[R.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b border-gray-800",children:[R.jsx("p",{className:"text-sm font-semibold text-white",children:"Notificaciones"}),R.jsx("span",{className:"text-xs text-gray-400",children:X})]}),ee?R.jsxs(R.Fragment,{children:[Ee("Mis Ofertas",P,"buyer","Todavia no has hecho ofertas."),Ee("Ofertas Recibidas",J,"seller","Aun no recibes ofertas."),R.jsx("div",{className:"p-3 border-t border-gray-800 bg-gray-900/80",children:R.jsx(ut,{to:"/liga-master/mercado",className:"block text-center text-sm font-semibold text-primary hover:text-white transition-colors",onClick:()=>s(!1),children:"Ir al Mercado de Fichajes"})})]}):R.jsx("div",{className:"p-4 text-sm text-gray-400",children:"Asigna un club como DT para recibir notificaciones del mercado."})]})]}),f?R.jsxs("div",{className:"relative",children:[R.jsx("div",{children:R.jsxs("button",{onClick:()=>{n(!r),s(!1)},className:"flex items-center text-sm rounded-full focus:outline-none",children:[R.jsx("img",{src:u?.avatar,alt:u?.username,className:"h-8 w-8 rounded-full"}),R.jsx("div",{className:"hidden md:flex md:flex-col md:ml-2 md:items-start",children:R.jsx("span",{className:"text-white text-sm",children:u?.username})}),R.jsx(vk,{size:16,className:"ml-2 text-gray-400"})]})}),r&&R.jsx("div",{className:"origin-top-right absolute right-0 mt-2 w-48 rounded-md shadow-lg bg-gray-800 ring-1 ring-black ring-opacity-5 focus:outline-none z-10",children:R.jsxs("div",{className:"py-1",children:[R.jsx(ut,{to:"/usuario",className:"text-gray-300 hover:bg-gray-700 hover:text-white block px-4 py-2 text-sm",onClick:()=>n(!1),children:R.jsxs("div",{className:"flex items-center",children:[R.jsx(Pk,{size:16,className:"mr-2"}),R.jsx("span",{children:"Mi Perfil"})]})}),p("admin")&&R.jsx(ut,{to:"/admin",className:"text-gray-300 hover:bg-gray-700 hover:text-white block px-4 py-2 text-sm",onClick:()=>n(!1),children:R.jsxs("div",{className:"flex items-center",children:[R.jsx(Tk,{size:16,className:"mr-2"}),R.jsx("span",{children:"Panel Admin"})]})}),R.jsx(ut,{to:"/usuario?tab=settings",className:"text-gray-300 hover:bg-gray-700 hover:text-white block px-4 py-2 text-sm",onClick:()=>n(!1),children:R.jsxs("div",{className:"flex items-center",children:[R.jsx(kk,{size:16,className:"mr-2"}),R.jsx("span",{children:"Configuracin"})]})}),R.jsx("button",{onClick:Te,className:"text-gray-300 hover:bg-gray-700 hover:text-white block w-full text-left px-4 py-2 text-sm",children:R.jsxs("div",{className:"flex items-center",children:[R.jsx(Sk,{size:16,className:"mr-2"}),R.jsx("span",{children:"Cerrar Sesin"})]})})]})})]}):R.jsxs("div",{className:"flex items-center space-x-2",children:[R.jsx(ut,{to:"/login",className:"text-white bg-transparent hover:bg-gray-800 px-3 py-2 rounded-md text-sm",children:"Iniciar Sesin"}),R.jsx(ut,{to:"/registro",className:"bg-primary hover:bg-primary-light text-white px-3 py-2 rounded-md text-sm",children:"Crear Cuenta"})]}),R.jsx("div",{className:"flex md:hidden ml-3",children:R.jsxs("button",{onClick:()=>t(!e),className:"bg-gray-800 inline-flex items-center justify-center p-2 rounded-md text-gray-400 hover:text-white hover:bg-gray-700 focus:outline-none",children:[R.jsx("span",{className:"sr-only",children:"Open main menu"}),e?R.jsx(ly,{size:24,"aria-hidden":"true"}):R.jsx(bk,{size:24,"aria-hidden":"true"})]})})]})]})}),e&&R.jsx("div",{className:"md:hidden",children:R.jsxs("div",{className:"px-2 pt-2 pb-3 space-y-1 sm:px-3",children:[R.jsx(ut,{to:"/liga-master",className:"text-gray-300 hover:bg-gray-700 hover:text-white block px-3 py-2 rounded-md text-base font-medium",onClick:()=>t(!1),children:"Liga Master"}),R.jsx(ut,{to:"/torneos",className:"text-gray-300 hover:bg-gray-700 hover:text-white block px-3 py-2 rounded-md text-base font-medium",onClick:()=>t(!1),children:"Torneos"}),R.jsx(ut,{to:"/blog",className:"text-gray-300 hover:bg-gray-700 hover:text-white block px-3 py-2 rounded-md text-base font-medium",onClick:()=>t(!1),children:"Blog"}),R.jsx(ut,{to:"/galeria",className:"text-gray-300 hover:bg-gray-700 hover:text-white block px-3 py-2 rounded-md text-base font-medium",onClick:()=>t(!1),children:"Galera"}),R.jsx(ut,{to:"/tienda",className:"text-gray-300 hover:bg-gray-700 hover:text-white block px-3 py-2 rounded-md text-base font-medium",onClick:()=>t(!1),children:"Tienda"}),R.jsx(ut,{to:"/ayuda",className:"text-gray-300 hover:bg-gray-700 hover:text-white block px-3 py-2 rounded-md text-base font-medium",onClick:()=>t(!1),children:"Ayuda"}),f&&R.jsxs(R.Fragment,{children:[R.jsx("div",{className:"border-t border-gray-700 my-2 pt-2"}),R.jsx(ut,{to:"/usuario",className:"text-gray-300 hover:bg-gray-700 hover:text-white block px-3 py-2 rounded-md text-base font-medium",onClick:()=>t(!1),children:"Mi Perfil"}),p("admin")&&R.jsx(ut,{to:"/admin",className:"text-gray-300 hover:bg-gray-700 hover:text-white block px-3 py-2 rounded-md text-base font-medium",onClick:()=>t(!1),children:"Panel Admin"}),R.jsx("button",{onClick:Te,className:"text-gray-300 hover:bg-gray-700 hover:text-white block w-full text-left px-3 py-2 rounded-md text-base font-medium",children:"Cerrar Sesin"})]}),!f&&R.jsxs(R.Fragment,{children:[R.jsx("div",{className:"border-t border-gray-700 my-2 pt-2"}),R.jsx(ut,{to:"/login",className:"text-gray-300 hover:bg-gray-700 hover:text-white block px-3 py-2 rounded-md text-base font-medium",onClick:()=>t(!1),children:"Iniciar Sesin"}),R.jsx(ut,{to:"/registro",className:"bg-primary text-white block px-3 py-2 rounded-md text-base font-medium",onClick:()=>t(!1),children:"Crear Cuenta"})]})]})})]})},tP=()=>R.jsx("footer",{className:"bg-gray-900 border-t border-gray-800",children:R.jsxs("div",{className:"container mx-auto px-4 py-12",children:[R.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-8",children:[R.jsxs("div",{children:[R.jsxs(ut,{to:"/",className:"flex items-center mb-4",children:[R.jsx("div",{className:"bg-primary h-8 w-8 rounded flex items-center justify-center mr-2",children:R.jsx(Ck,{size:20,className:"text-white"})}),R.jsx("span",{className:"text-white font-bold text-xl font-display",children:"La Virtual Zone"})]}),R.jsx("p",{className:"text-gray-400 mb-4",children:"La plataforma lder para torneos y ligas de PES 2021. Gestiona tu club, ficha jugadores, y compite en ligas y torneos."}),R.jsxs("div",{className:"flex space-x-4",children:[R.jsx("a",{href:"#",className:"text-gray-400 hover:text-white",children:R.jsx(yk,{size:20})}),R.jsx("a",{href:"#",className:"text-gray-400 hover:text-white",children:R.jsx(Ak,{size:20})}),R.jsx("a",{href:"#",className:"text-gray-400 hover:text-white",children:R.jsx(_k,{size:20})}),R.jsx("a",{href:"#",className:"text-gray-400 hover:text-white",children:R.jsx(xk,{size:20})})]})]}),R.jsxs("div",{children:[R.jsx("h3",{className:"text-white font-bold mb-4",children:"Liga Master"}),R.jsxs("ul",{className:"space-y-2",children:[R.jsx("li",{children:R.jsx(ut,{to:"/liga-master",className:"text-gray-400 hover:text-white",children:"Vista General"})}),R.jsx("li",{children:R.jsx(ut,{to:"/liga-master/mercado",className:"text-gray-400 hover:text-white",children:"Mercado de Fichajes"})}),R.jsx("li",{children:R.jsx(ut,{to:"/liga-master/fixture",className:"text-gray-400 hover:text-white",children:"Fixture y Resultados"})}),R.jsx("li",{children:R.jsx(ut,{to:"/liga-master/rankings",className:"text-gray-400 hover:text-white",children:"Rankings"})}),R.jsx("li",{children:R.jsx(ut,{to:"/liga-master/hall-of-fame",className:"text-gray-400 hover:text-white",children:"Hall of Fame"})})]})]}),R.jsxs("div",{children:[R.jsx("h3",{className:"text-white font-bold mb-4",children:"Navegar"}),R.jsxs("ul",{className:"space-y-2",children:[R.jsx("li",{children:R.jsx(ut,{to:"/torneos",className:"text-gray-400 hover:text-white",children:"Torneos"})}),R.jsx("li",{children:R.jsx(ut,{to:"/blog",className:"text-gray-400 hover:text-white",children:"Blog"})}),R.jsx("li",{children:R.jsx(ut,{to:"/galeria",className:"text-gray-400 hover:text-white",children:"Galera"})}),R.jsx("li",{children:R.jsx(ut,{to:"/tienda",className:"text-gray-400 hover:text-white",children:"Tienda"})}),R.jsx("li",{children:R.jsx(ut,{to:"/ayuda",className:"text-gray-400 hover:text-white",children:"Ayuda"})})]})]}),R.jsxs("div",{children:[R.jsx("h3",{className:"text-white font-bold mb-4",children:"Contacto"}),R.jsxs("ul",{className:"space-y-4",children:[R.jsxs("li",{className:"flex items-start",children:[R.jsx(Ek,{size:20,className:"text-gray-400 mr-2 mt-1 flex-shrink-0"}),R.jsx("span",{className:"text-gray-400",children:"support@lavirtualzone.com"})]}),R.jsxs("li",{className:"flex items-start",children:[R.jsx(wk,{size:20,className:"text-gray-400 mr-2 mt-1 flex-shrink-0"}),R.jsx("span",{className:"text-gray-400",children:"Soporte disponible: 9:00 - 21:00 (CET)"})]})]}),R.jsx("div",{className:"mt-6",children:R.jsx(ut,{to:"/ayuda",className:"btn-secondary text-sm",children:"Centro de Ayuda"})})]})]}),R.jsxs("div",{className:"border-t border-gray-800 mt-12 pt-8 flex flex-col md:flex-row justify-between",children:[R.jsxs("p",{className:"text-gray-400 text-sm",children:[" ",new Date().getFullYear()," La Virtual Zone. Todos los derechos reservados."]}),R.jsxs("div",{className:"flex space-x-6 mt-4 md:mt-0",children:[R.jsx(ut,{to:"/terminos",className:"text-gray-400 hover:text-white text-sm",children:"Trminos de Servicio"}),R.jsx(ut,{to:"/privacidad",className:"text-gray-400 hover:text-white text-sm",children:"Poltica de Privacidad"})]})]})]})}),rP=()=>R.jsxs("div",{className:"flex flex-col min-h-screen bg-gray-900",children:[R.jsx(eP,{}),R.jsx("main",{className:"flex-grow",children:R.jsx(Jb,{})}),R.jsx(tP,{})]}),Mv=({message:e="Cargando experiencia gaming..."})=>R.jsxs("div",{className:"flex w-full h-screen items-center justify-center flex-col space-y-6 p-2 bg-gray-900",children:[R.jsx("div",{className:"loader"}),R.jsxs("div",{className:"text-center",children:[R.jsx("h2",{className:"text-2xl font-bold mb-2",children:"La Virtual Zone"}),R.jsx("p",{className:"text-gray-400",children:e})]})]}),nP=6e3,aP=()=>{const e=wi(r=>r.authError),t=wi(r=>r.clearAuthError);return ue.useEffect(()=>{if(!e)return;const r=window.setTimeout(()=>{t()},nP);return()=>window.clearTimeout(r)},[e,t]),e?R.jsx("div",{className:"fixed inset-x-0 top-4 z-[2000] flex justify-center px-4",children:R.jsx("div",{className:"w-full max-w-xl rounded-xl border border-red-500/40 bg-red-600/90 text-white shadow-2xl backdrop-blur-lg",children:R.jsxs("div",{className:"flex items-start gap-3 px-4 py-3",children:[R.jsx(pk,{className:"mt-0.5 shrink-0",size:20}),R.jsx("div",{className:"flex-1 text-sm leading-relaxed",children:e}),R.jsx("button",{type:"button",onClick:t,className:"text-white/80 hover:text-white focus:outline-none","aria-label":"Cerrar alerta de autenticacin",children:R.jsx(ly,{size:18})})]})})}):null},sP=()=>{const e=wi(n=>n.accountBlock),t=Ts(),r=uc();return ue.useEffect(()=>{e&&t.pathname!=="/cuenta-suspendida"&&r("/cuenta-suspendida",{replace:!0})},[e,t.pathname,r]),null},oP=ue.lazy(()=>Z(()=>import("./Home-NomA3_67.js"),__vite__mapDeps([0,1,2,3,4,5,6]))),iP=ue.lazy(()=>Z(()=>import("./Login-DEd0Shkc.js"),[])),lP=ue.lazy(()=>Z(()=>import("./Register-CuL87jw-.js"),[])),cP=ue.lazy(()=>Z(()=>import("./RecoverPassword-DMi2hRUo.js"),__vite__mapDeps([7,8]))),uP=ue.lazy(()=>Z(()=>import("./UserPanel-DX5tEkTR.js"),__vite__mapDeps([9,10,2,6,5,11,12,13,14,15,16,17,18,19,20]))),fP=ue.lazy(()=>Z(()=>import("./LigaMaster-5lXgx0Vd.js"),__vite__mapDeps([21,22,23,2,24,25,26,1,5,27,17,4,6]))),dP=ue.lazy(()=>Z(()=>import("./Market-B1ldKt1i.js"),__vite__mapDeps([28,22,29,16,2,30,20,31,6,32,12,1,33,34,35,24,36,11,37,38,8,39,40]))),hP=ue.lazy(()=>Z(()=>import("./Tournaments-DhjNRKF4.js"),__vite__mapDeps([41,22,40,5,2,4]))),gP=ue.lazy(()=>Z(()=>import("./TournamentDetail-BH5Mijq7.js"),__vite__mapDeps([42,22,43,8,44,45]))),pP=ue.lazy(()=>Z(()=>import("./Blog-CXDRhpCc.js"),__vite__mapDeps([46,37,22,39,5,4,47]))),mP=ue.lazy(()=>Z(()=>import("./BlogPost-DwpfN1R6.js"),__vite__mapDeps([48,5,43,45]))),vP=ue.lazy(()=>Z(()=>import("./Gallery-DyRy-4as.js"),__vite__mapDeps([49,22,39,50,5,44,51]))),xP=ue.lazy(()=>Z(()=>import("./Help-DC6OHCzk.js"),__vite__mapDeps([52,22,34,47,5]))),yP=ue.lazy(()=>Z(()=>import("./AdminLayout-DURV24gs.js"),__vite__mapDeps([53,10,2,13,12,47,36,5]))),wP=ue.lazy(()=>Z(()=>import("./Dashboard-C7HGMq42.js"),__vite__mapDeps([54,2,13,47,32,1,55,36,5]))),_P=ue.lazy(()=>Z(()=>import("./Tournaments-BVOlGXOK.js"),__vite__mapDeps([56,37,11,47,8,44,51,5,2,57,58,50,59,10]))),SP=ue.lazy(()=>Z(()=>import("./Matches-D9SPVzPB.js"),__vite__mapDeps([60,57,11,37,59,50,39,40,5,43,4]))),EP=ue.lazy(()=>Z(()=>import("./News-DBmGaMLq.js"),__vite__mapDeps([61,30,50,44,51,58,11,59]))),bP=ue.lazy(()=>Z(()=>import("./Users-W3hJ9hdy.js"),__vite__mapDeps([62,63,11,8,64,65,58,55,50,59]))),kP=ue.lazy(()=>Z(()=>import("./Clubs--CVb8C0H.js"),__vite__mapDeps([66,11,14,51,32,1,8,58,55,50,59]))),TP=ue.lazy(()=>Z(()=>import("./Players-eay0AgMY.js"),__vite__mapDeps([67,36,33,20,11,14,51,17,12,6,32,19,1,35,58,37,39,40,2,47,15,68,50,59]))),CP=ue.lazy(()=>Z(()=>import("./Market-BBVGDnJn.js"),[])),AP=ue.lazy(()=>Z(()=>import("./Stats-B8kD1y18.js"),[])),PP=ue.lazy(()=>Z(()=>import("./Calendar-BIHrAgaS.js"),[])),IP=ue.lazy(()=>Z(()=>import("./UserProfile-B1LRDJo7.js"),__vite__mapDeps([69,17,18,19,20,2,5,63,38,6,16,12,11,31]))),OP=ue.lazy(()=>Z(()=>import("./NotFound-gCMu_xZ5.js"),__vite__mapDeps([70,27]))),DP=ue.lazy(()=>Z(()=>import("./ClubProfile-BFS9J339.js"),__vite__mapDeps([71,22,23,43,2,24,5,6,16]))),FP=ue.lazy(()=>Z(()=>import("./ClubSquad-CTI51NLF.js"),__vite__mapDeps([72,22,29,16,2,30,20,31,6,32,12,1,33,34,35,43,68,73,13]))),RP=ue.lazy(()=>Z(()=>import("./ClubFinances-BKeMx2iN.js"),__vite__mapDeps([74,22,43,32,10,73,35]))),LP=ue.lazy(()=>Z(()=>import("./ClubPalmares-Bl9z1R47.js"),__vite__mapDeps([75,22,43,5,2,24,16,76,6]))),NP=ue.lazy(()=>Z(()=>import("./HallOfFame-PvV9tSNN.js"),__vite__mapDeps([77,22,43,6,16]))),MP=ue.lazy(()=>Z(()=>import("./Rankings-Czp5pr4S.js"),__vite__mapDeps([78,22,3,43]))),BP=ue.lazy(()=>Z(()=>import("./Fixtures-DT1cfTZ_.js"),__vite__mapDeps([79,22,43,34,20,6]))),jP=ue.lazy(()=>Z(()=>import("./MarketTables-CKI6CEMW.js"),__vite__mapDeps([80,1,32,81]))),$P=ue.lazy(()=>Z(()=>import("./Zones-DmXwB-A7.js"),__vite__mapDeps([82,81,1,25,16,76,11]))),UP=ue.lazy(()=>Z(()=>import("./Users-Ct_u-A56.js"),__vite__mapDeps([83,22,84,39,6,2]))),zP=ue.lazy(()=>Z(()=>import("./DtCommunity-DVIuh_M2.js"),__vite__mapDeps([85,37,84,26,81,40,2,24,43,4]))),VP=ue.lazy(()=>Z(()=>import("./Terms-C9V0n_Xq.js"),__vite__mapDeps([86,22,11]))),WP=ue.lazy(()=>Z(()=>import("./Privacy-Cw11vsdf.js"),__vite__mapDeps([87,22,64]))),HP=ue.lazy(()=>Z(()=>import("./AccountStatus-BHhaDH-1.js"),__vite__mapDeps([88,65,11]))),GP=ue.lazy(()=>Z(()=>import("./Reglamento-xKHS02Gi.js"),__vite__mapDeps([89,22])));function qP(){const{isLoading:e,initializeAuth:t}=wi();return ue.useEffect(()=>{t()},[t]),e?R.jsx(Mv,{message:"Verificando sesin..."}):R.jsxs(ue.Suspense,{fallback:R.jsx(Mv,{}),children:[R.jsx(aP,{}),R.jsx(sP,{}),R.jsx(Qb,{children:R.jsxs(Qe,{path:"/",element:R.jsx(rP,{}),children:[R.jsx(Qe,{index:!0,element:R.jsx(oP,{})}),R.jsx(Qe,{path:"login",element:R.jsx(iP,{})}),R.jsx(Qe,{path:"cuenta-suspendida",element:R.jsx(HP,{})}),R.jsx(Qe,{path:"registro",element:R.jsx(lP,{})}),R.jsx(Qe,{path:"recuperar-password",element:R.jsx(cP,{})}),R.jsx(Qe,{path:"usuario",element:R.jsx(uP,{})}),R.jsxs(Qe,{path:"liga-master",children:[R.jsx(Qe,{index:!0,element:R.jsx(fP,{})}),R.jsx(Qe,{path:"reglamento",element:R.jsx(GP,{})}),R.jsx(Qe,{path:"mercado",element:R.jsx(dP,{})}),R.jsx(Qe,{path:"tablas-mercado",element:R.jsx(jP,{})}),R.jsx(Qe,{path:"club/:clubName",element:R.jsx(DP,{})}),R.jsx(Qe,{path:"club/:clubName/plantilla",element:R.jsx(FP,{})}),R.jsx(Qe,{path:"club/:clubName/finanzas",element:R.jsx(RP,{})}),R.jsx(Qe,{path:"club/:clubName/palmares",element:R.jsx(LP,{})}),R.jsx(Qe,{path:"hall-of-fame",element:R.jsx(NP,{})}),R.jsx(Qe,{path:"rankings",element:R.jsx(MP,{})}),R.jsx(Qe,{path:"fixture",element:R.jsx(BP,{})}),R.jsx(Qe,{path:"zonas",element:R.jsx($P,{})}),R.jsx(Qe,{path:"comunidad-dt",element:R.jsx(zP,{})})]}),R.jsxs(Qe,{path:"torneos",children:[R.jsx(Qe,{index:!0,element:R.jsx(hP,{})}),R.jsx(Qe,{path:":tournamentId",element:R.jsx(gP,{})})]}),R.jsxs(Qe,{path:"blog",children:[R.jsx(Qe,{index:!0,element:R.jsx(pP,{})}),R.jsx(Qe,{path:":postId",element:R.jsx(mP,{})})]}),R.jsx(Qe,{path:"galeria",element:R.jsx(vP,{})}),R.jsx(Qe,{path:"ayuda",element:R.jsx(xP,{})}),R.jsx(Qe,{path:"terminos",element:R.jsx(VP,{})}),R.jsx(Qe,{path:"privacidad",element:R.jsx(WP,{})}),R.jsxs(Qe,{path:"admin",element:R.jsx(yP,{}),children:[R.jsx(Qe,{index:!0,element:R.jsx(wP,{})}),R.jsx(Qe,{path:"torneos",element:R.jsx(_P,{})}),R.jsx(Qe,{path:"partidos",element:R.jsx(SP,{})}),R.jsx(Qe,{path:"noticias",element:R.jsx(EP,{})}),R.jsx(Qe,{path:"usuarios",element:R.jsx(bP,{})}),R.jsx(Qe,{path:"clubes",element:R.jsx(kP,{})}),R.jsx(Qe,{path:"jugadores",element:R.jsx(TP,{})}),R.jsx(Qe,{path:"mercado",element:R.jsx(CP,{})}),R.jsx(Qe,{path:"estadisticas",element:R.jsx(AP,{})}),R.jsx(Qe,{path:"calendario",element:R.jsx(PP,{})})]}),R.jsx(Qe,{path:"usuarios",element:R.jsx(UP,{})}),R.jsx(Qe,{path:"usuarios/:username",element:R.jsx(IP,{})}),R.jsx(Qe,{path:"*",element:R.jsx(OP,{})})]})})]})}/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var gf={};gf.version="0.18.5";var n_=1252,KP=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],wg={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},_g=function(e){KP.indexOf(e)!=-1&&(n_=wg[0]=e)};function XP(){_g(1252)}var na=function(e){_g(e)};function Sg(){na(1200),XP()}function Bv(e){for(var t=[],r=0,n=e.length;r<n;++r)t[r]=e.charCodeAt(r);return t}function JP(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r)+(e.charCodeAt(2*r+1)<<8));return t.join("")}function a_(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r+1)+(e.charCodeAt(2*r)<<8));return t.join("")}var Tl=function(e){var t=e.charCodeAt(0),r=e.charCodeAt(1);return t==255&&r==254?JP(e.slice(2)):t==254&&r==255?a_(e.slice(2)):t==65279?e.slice(1):e},qu=function(t){return String.fromCharCode(t)},jv=function(t){return String.fromCharCode(t)},Xl,ys="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Jl(e){for(var t="",r=0,n=0,a=0,s=0,i=0,c=0,u=0,f=0;f<e.length;)r=e.charCodeAt(f++),s=r>>2,n=e.charCodeAt(f++),i=(r&3)<<4|n>>4,a=e.charCodeAt(f++),c=(n&15)<<2|a>>6,u=a&63,isNaN(n)?c=u=64:isNaN(a)&&(u=64),t+=ys.charAt(s)+ys.charAt(i)+ys.charAt(c)+ys.charAt(u);return t}function Tn(e){var t="",r=0,n=0,a=0,s=0,i=0,c=0,u=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var f=0;f<e.length;)s=ys.indexOf(e.charAt(f++)),i=ys.indexOf(e.charAt(f++)),r=s<<2|i>>4,t+=String.fromCharCode(r),c=ys.indexOf(e.charAt(f++)),n=(i&15)<<4|c>>2,c!==64&&(t+=String.fromCharCode(n)),u=ys.indexOf(e.charAt(f++)),a=(c&3)<<6|u,u!==64&&(t+=String.fromCharCode(a));return t}var st=(function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node})(),Wa=(function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,r){return r?new Buffer(t,r):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}})();function Ss(e){return st?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function $v(e){return st?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var bn=function(t){return st?Wa(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)&255})};function Mf(e){if(typeof ArrayBuffer>"u")return bn(e);for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),n=0;n!=e.length;++n)r[n]=e.charCodeAt(n)&255;return t}function As(e){if(Array.isArray(e))return e.map(function(n){return String.fromCharCode(n)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function YP(e){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(e)}function Eg(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return Eg(new Uint8Array(e));for(var t=new Array(e.length),r=0;r<e.length;++r)t[r]=e[r];return t}var Er=st?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:Wa(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var n=new Uint8Array(r),a=0;for(t=0,r=0;t<e.length;r+=a,++t)if(a=e[t].length,e[t]instanceof Uint8Array)n.set(e[t],r);else{if(typeof e[t]=="string")throw"wtf";n.set(new Uint8Array(e[t]),r)}return n}return[].concat.apply([],e.map(function(s){return Array.isArray(s)?s:[].slice.call(s)}))};function QP(e){for(var t=[],r=0,n=e.length+250,a=Ss(e.length+255),s=0;s<e.length;++s){var i=e.charCodeAt(s);if(i<128)a[r++]=i;else if(i<2048)a[r++]=192|i>>6&31,a[r++]=128|i&63;else if(i>=55296&&i<57344){i=(i&1023)+64;var c=e.charCodeAt(++s)&1023;a[r++]=240|i>>8&7,a[r++]=128|i>>2&63,a[r++]=128|c>>6&15|(i&3)<<4,a[r++]=128|c&63}else a[r++]=224|i>>12&15,a[r++]=128|i>>6&63,a[r++]=128|i&63;r>n&&(t.push(a.slice(0,r)),r=0,a=Ss(65535),n=65530)}return t.push(a.slice(0,r)),Er(t)}var en=/\u0000/g,Cl=/[\u0001-\u0006]/g;function hi(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function aa(e,t){var r=""+e;return r.length>=t?r:qt("0",t-r.length)+r}function bg(e,t){var r=""+e;return r.length>=t?r:qt(" ",t-r.length)+r}function pf(e,t){var r=""+e;return r.length>=t?r:r+qt(" ",t-r.length)}function ZP(e,t){var r=""+Math.round(e);return r.length>=t?r:qt("0",t-r.length)+r}function eI(e,t){var r=""+e;return r.length>=t?r:qt("0",t-r.length)+r}var Uv=Math.pow(2,32);function ni(e,t){if(e>Uv||e<-Uv)return ZP(e,t);var r=Math.round(e);return eI(r,t)}function mf(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var zv=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],Jd=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function tI(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"/ "hh""mm""ss" "',e}var Ge={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},Vv={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},rI={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function vf(e,t,r){for(var n=e<0?-1:1,a=e*n,s=0,i=1,c=0,u=1,f=0,h=0,p=Math.floor(a);f<t&&(p=Math.floor(a),c=p*i+s,h=p*f+u,!(a-p<5e-8));)a=1/(a-p),s=i,i=c,u=f,f=h;if(h>t&&(f>t?(h=u,c=s):(h=f,c=i)),!r)return[0,n*c,h];var m=Math.floor(n*c/h);return[m,n*c-m*h,h]}function to(e,t,r){if(e>2958465||e<0)return null;var n=e|0,a=Math.floor(86400*(e-n)),s=0,i=[],c={D:n,T:a,u:86400*(e-n)-a,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(c.u)<1e-6&&(c.u=0),t&&t.date1904&&(n+=1462),c.u>.9999&&(c.u=0,++a==86400&&(c.T=a=0,++n,++c.D)),n===60)i=r?[1317,10,29]:[1900,2,29],s=3;else if(n===0)i=r?[1317,8,29]:[1900,1,0],s=6;else{n>60&&--n;var u=new Date(1900,0,1);u.setDate(u.getDate()+n-1),i=[u.getFullYear(),u.getMonth()+1,u.getDate()],s=u.getDay(),n<60&&(s=(s+6)%7),r&&(s=lI(u,i))}return c.y=i[0],c.m=i[1],c.d=i[2],c.S=a%60,a=Math.floor(a/60),c.M=a%60,a=Math.floor(a/60),c.H=a,c.q=s,c}var s_=new Date(1899,11,31,0,0,0),nI=s_.getTime(),aI=new Date(1900,2,1,0,0,0);function o_(e,t){var r=e.getTime();return t?r-=1461*24*60*60*1e3:e>=aI&&(r+=1440*60*1e3),(r-(nI+(e.getTimezoneOffset()-s_.getTimezoneOffset())*6e4))/(1440*60*1e3)}function kg(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function sI(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function oI(e){var t=e<0?12:11,r=kg(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10),r.length<=t)?r:e.toExponential(5)}function iI(e){var t=kg(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function Yl(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),r;return t>=-4&&t<=-1?r=e.toPrecision(10+t):Math.abs(t)<=9?r=oI(e):t===10?r=e.toFixed(10).substr(0,12):r=iI(e),kg(sI(r.toUpperCase()))}function co(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):Yl(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return Un(14,o_(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function lI(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}function cI(e,t,r,n){var a="",s=0,i=0,c=r.y,u,f=0;switch(e){case 98:c=r.y+543;case 121:switch(t.length){case 1:case 2:u=c%100,f=2;break;default:u=c%1e4,f=4;break}break;case 109:switch(t.length){case 1:case 2:u=r.m,f=t.length;break;case 3:return Jd[r.m-1][1];case 5:return Jd[r.m-1][0];default:return Jd[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:u=r.d,f=t.length;break;case 3:return zv[r.q][0];default:return zv[r.q][1]}break;case 104:switch(t.length){case 1:case 2:u=1+(r.H+11)%12,f=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:u=r.H,f=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:u=r.M,f=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return r.u===0&&(t=="s"||t=="ss")?aa(r.S,t.length):(n>=2?i=n===3?1e3:100:i=n===1?10:1,s=Math.round(i*(r.S+r.u)),s>=60*i&&(s=0),t==="s"?s===0?"0":""+s/i:(a=aa(s,2+n),t==="ss"?a.substr(0,2):"."+a.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":u=r.D*24+r.H;break;case"[m]":case"[mm]":u=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":u=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}f=t.length===3?1:2;break;case 101:u=c,f=1;break}var h=f>0?aa(u,f):"";return h}function ws(e){var t=3;if(e.length<=t)return e;for(var r=e.length%t,n=e.substr(0,r);r!=e.length;r+=t)n+=(n.length>0?",":"")+e.substr(r,t);return n}var i_=/%/g;function uI(e,t,r){var n=t.replace(i_,""),a=t.length-n.length;return Na(e,n,r*Math.pow(10,2*a))+qt("%",a)}function fI(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return Na(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function l_(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+l_(e,-t);var a=e.indexOf(".");a===-1&&(a=e.indexOf("E"));var s=Math.floor(Math.log(t)*Math.LOG10E)%a;if(s<0&&(s+=a),r=(t/Math.pow(10,s)).toPrecision(n+1+(a+s)%a),r.indexOf("e")===-1){var i=Math.floor(Math.log(t)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(i-r.length+s):r+="E+"+(i-s);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,a)+"."+r.substr(2+a),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(c,u,f,h){return u+f+h.substr(0,(a+s)%a)+"."+h.substr(s)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var c_=/# (\?+)( ?)\/( ?)(\d+)/;function dI(e,t,r){var n=parseInt(e[4],10),a=Math.round(t*n),s=Math.floor(a/n),i=a-s*n,c=n;return r+(s===0?"":""+s)+" "+(i===0?qt(" ",e[1].length+1+e[4].length):bg(i,e[1].length)+e[2]+"/"+e[3]+aa(c,e[4].length))}function hI(e,t,r){return r+(t===0?"":""+t)+qt(" ",e[1].length+2+e[4].length)}var u_=/^#*0*\.([0#]+)/,f_=/\).*[0#]/,d_=/\(###\) ###\\?-####/;function Qr(e){for(var t="",r,n=0;n!=e.length;++n)switch(r=e.charCodeAt(n)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function Wv(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function Hv(e,t){var r=e-Math.floor(e),n=Math.pow(10,t);return t<(""+Math.round(r*n)).length?0:Math.round(r*n)}function gI(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function pI(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function Ln(e,t,r){if(e.charCodeAt(0)===40&&!t.match(f_)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Ln("n",n,r):"("+Ln("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return fI(e,t,r);if(t.indexOf("%")!==-1)return uI(e,t,r);if(t.indexOf("E")!==-1)return l_(t,r);if(t.charCodeAt(0)===36)return"$"+Ln(e,t.substr(t.charAt(1)==" "?2:1),r);var a,s,i,c,u=Math.abs(r),f=r<0?"-":"";if(t.match(/^00+$/))return f+ni(u,t.length);if(t.match(/^[#?]+$/))return a=ni(r,0),a==="0"&&(a=""),a.length>t.length?a:Qr(t.substr(0,t.length-a.length))+a;if(s=t.match(c_))return dI(s,u,f);if(t.match(/^#+0+$/))return f+ni(u,t.length-t.indexOf("0"));if(s=t.match(u_))return a=Wv(r,s[1].length).replace(/^([^\.]+)$/,"$1."+Qr(s[1])).replace(/\.$/,"."+Qr(s[1])).replace(/\.(\d*)$/,function(w,x){return"."+x+qt("0",Qr(s[1]).length-x.length)}),t.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),s=t.match(/^(0*)\.(#*)$/))return f+Wv(u,s[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=t.match(/^#{1,3},##0(\.?)$/))return f+ws(ni(u,0));if(s=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Ln(e,t,-r):ws(""+(Math.floor(r)+gI(r,s[1].length)))+"."+aa(Hv(r,s[1].length),s[1].length);if(s=t.match(/^#,#*,#0/))return Ln(e,t.replace(/^#,#*,/,""),r);if(s=t.match(/^([0#]+)(\\?-([0#]+))+$/))return a=hi(Ln(e,t.replace(/[\\-]/g,""),r)),i=0,hi(hi(t.replace(/\\/g,"")).replace(/[0#]/g,function(w){return i<a.length?a.charAt(i++):w==="0"?"0":""}));if(t.match(d_))return a=Ln(e,"##########",r),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var h="";if(s=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(s[4].length,7),c=vf(u,Math.pow(10,i)-1,!1),a=""+f,h=Na("n",s[1],c[1]),h.charAt(h.length-1)==" "&&(h=h.substr(0,h.length-1)+"0"),a+=h+s[2]+"/"+s[3],h=pf(c[2],i),h.length<s[4].length&&(h=Qr(s[4].substr(s[4].length-h.length))+h),a+=h,a;if(s=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(Math.max(s[1].length,s[4].length),7),c=vf(u,Math.pow(10,i)-1,!0),f+(c[0]||(c[1]?"":"0"))+" "+(c[1]?bg(c[1],i)+s[2]+"/"+s[3]+pf(c[2],i):qt(" ",2*i+1+s[2].length+s[3].length));if(s=t.match(/^[#0?]+$/))return a=ni(r,0),t.length<=a.length?a:Qr(t.substr(0,t.length-a.length))+a;if(s=t.match(/^([#0?]+)\.([#0]+)$/)){a=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),i=a.indexOf(".");var p=t.indexOf(".")-i,m=t.length-a.length-p;return Qr(t.substr(0,p)+a+t.substr(t.length-m))}if(s=t.match(/^00,000\.([#0]*0)$/))return i=Hv(r,s[1].length),r<0?"-"+Ln(e,t,-r):ws(pI(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(w){return"00,"+(w.length<3?aa(0,3-w.length):"")+w})+"."+aa(i,s[1].length);switch(t){case"###,##0.00":return Ln(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var y=ws(ni(u,0));return y!=="0"?f+y:"";case"###,###.00":return Ln(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return Ln(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function mI(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return Na(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function vI(e,t,r){var n=t.replace(i_,""),a=t.length-n.length;return Na(e,n,r*Math.pow(10,2*a))+qt("%",a)}function h_(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+h_(e,-t);var a=e.indexOf(".");a===-1&&(a=e.indexOf("E"));var s=Math.floor(Math.log(t)*Math.LOG10E)%a;if(s<0&&(s+=a),r=(t/Math.pow(10,s)).toPrecision(n+1+(a+s)%a),!r.match(/[Ee]/)){var i=Math.floor(Math.log(t)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(i-r.length+s):r+="E+"+(i-s),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(c,u,f,h){return u+f+h.substr(0,(a+s)%a)+"."+h.substr(s)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function pa(e,t,r){if(e.charCodeAt(0)===40&&!t.match(f_)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?pa("n",n,r):"("+pa("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return mI(e,t,r);if(t.indexOf("%")!==-1)return vI(e,t,r);if(t.indexOf("E")!==-1)return h_(t,r);if(t.charCodeAt(0)===36)return"$"+pa(e,t.substr(t.charAt(1)==" "?2:1),r);var a,s,i,c,u=Math.abs(r),f=r<0?"-":"";if(t.match(/^00+$/))return f+aa(u,t.length);if(t.match(/^[#?]+$/))return a=""+r,r===0&&(a=""),a.length>t.length?a:Qr(t.substr(0,t.length-a.length))+a;if(s=t.match(c_))return hI(s,u,f);if(t.match(/^#+0+$/))return f+aa(u,t.length-t.indexOf("0"));if(s=t.match(u_))return a=(""+r).replace(/^([^\.]+)$/,"$1."+Qr(s[1])).replace(/\.$/,"."+Qr(s[1])),a=a.replace(/\.(\d*)$/,function(w,x){return"."+x+qt("0",Qr(s[1]).length-x.length)}),t.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),s=t.match(/^(0*)\.(#*)$/))return f+(""+u).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=t.match(/^#{1,3},##0(\.?)$/))return f+ws(""+u);if(s=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+pa(e,t,-r):ws(""+r)+"."+qt("0",s[1].length);if(s=t.match(/^#,#*,#0/))return pa(e,t.replace(/^#,#*,/,""),r);if(s=t.match(/^([0#]+)(\\?-([0#]+))+$/))return a=hi(pa(e,t.replace(/[\\-]/g,""),r)),i=0,hi(hi(t.replace(/\\/g,"")).replace(/[0#]/g,function(w){return i<a.length?a.charAt(i++):w==="0"?"0":""}));if(t.match(d_))return a=pa(e,"##########",r),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var h="";if(s=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(s[4].length,7),c=vf(u,Math.pow(10,i)-1,!1),a=""+f,h=Na("n",s[1],c[1]),h.charAt(h.length-1)==" "&&(h=h.substr(0,h.length-1)+"0"),a+=h+s[2]+"/"+s[3],h=pf(c[2],i),h.length<s[4].length&&(h=Qr(s[4].substr(s[4].length-h.length))+h),a+=h,a;if(s=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(Math.max(s[1].length,s[4].length),7),c=vf(u,Math.pow(10,i)-1,!0),f+(c[0]||(c[1]?"":"0"))+" "+(c[1]?bg(c[1],i)+s[2]+"/"+s[3]+pf(c[2],i):qt(" ",2*i+1+s[2].length+s[3].length));if(s=t.match(/^[#0?]+$/))return a=""+r,t.length<=a.length?a:Qr(t.substr(0,t.length-a.length))+a;if(s=t.match(/^([#0]+)\.([#0]+)$/)){a=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),i=a.indexOf(".");var p=t.indexOf(".")-i,m=t.length-a.length-p;return Qr(t.substr(0,p)+a+t.substr(t.length-m))}if(s=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+pa(e,t,-r):ws(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(w){return"00,"+(w.length<3?aa(0,3-w.length):"")+w})+"."+aa(0,s[1].length);switch(t){case"###,###":case"##,###":case"#,###":var y=ws(""+u);return y!=="0"?f+y:"";default:if(t.match(/\.[0#?]*$/))return pa(e,t.slice(0,t.lastIndexOf(".")),r)+Qr(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function Na(e,t,r){return(r|0)===r?pa(e,t,r):Ln(e,t,r)}function xI(e){for(var t=[],r=!1,n=0,a=0;n<e.length;++n)switch(e.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:t[t.length]=e.substr(a,n-a),a=n+1}if(t[t.length]=e.substr(a),r===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var g_=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function Oi(e){for(var t=0,r="",n="";t<e.length;)switch(r=e.charAt(t)){case"G":mf(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="/")return!0;++t;break;case"[":for(n=r;e.charAt(t++)!=="]"&&t<e.length;)n+=e.charAt(t);if(n.match(g_))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||r=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function yI(e,t,r,n){for(var a=[],s="",i=0,c="",u="t",f,h,p,m="H";i<e.length;)switch(c=e.charAt(i)){case"G":if(!mf(e,i))throw new Error("unrecognized character "+c+" in "+e);a[a.length]={t:"G",v:"General"},i+=7;break;case'"':for(s="";(p=e.charCodeAt(++i))!==34&&i<e.length;)s+=String.fromCharCode(p);a[a.length]={t:"t",v:s},++i;break;case"\\":var y=e.charAt(++i),w=y==="("||y===")"?y:"t";a[a.length]={t:w,v:y},++i;break;case"_":a[a.length]={t:"t",v:" "},i+=2;break;case"@":a[a.length]={t:"T",v:t},++i;break;case"B":case"b":if(e.charAt(i+1)==="1"||e.charAt(i+1)==="2"){if(f==null&&(f=to(t,r,e.charAt(i+1)==="2"),f==null))return"";a[a.length]={t:"X",v:e.substr(i,2)},u=c,i+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":c=c.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||f==null&&(f=to(t,r),f==null))return"";for(s=c;++i<e.length&&e.charAt(i).toLowerCase()===c;)s+=c;c==="m"&&u.toLowerCase()==="h"&&(c="M"),c==="h"&&(c=m),a[a.length]={t:c,v:s},u=c;break;case"A":case"a":case"":var x={t:c,v:c};if(f==null&&(f=to(t,r)),e.substr(i,3).toUpperCase()==="A/P"?(f!=null&&(x.v=f.H>=12?"P":"A"),x.t="T",m="h",i+=3):e.substr(i,5).toUpperCase()==="AM/PM"?(f!=null&&(x.v=f.H>=12?"PM":"AM"),x.t="T",i+=5,m="h"):e.substr(i,5).toUpperCase()==="/"?(f!=null&&(x.v=f.H>=12?"":""),x.t="T",i+=5,m="h"):(x.t="t",++i),f==null&&x.t==="T")return"";a[a.length]=x,u=c;break;case"[":for(s=c;e.charAt(i++)!=="]"&&i<e.length;)s+=e.charAt(i);if(s.slice(-1)!=="]")throw'unterminated "[" block: |'+s+"|";if(s.match(g_)){if(f==null&&(f=to(t,r),f==null))return"";a[a.length]={t:"Z",v:s.toLowerCase()},u=s.charAt(1)}else s.indexOf("$")>-1&&(s=(s.match(/\$([^-\[\]]*)/)||[])[1]||"$",Oi(e)||(a[a.length]={t:"t",v:s}));break;case".":if(f!=null){for(s=c;++i<e.length&&(c=e.charAt(i))==="0";)s+=c;a[a.length]={t:"s",v:s};break}case"0":case"#":for(s=c;++i<e.length&&"0#?.,E+-%".indexOf(c=e.charAt(i))>-1;)s+=c;a[a.length]={t:"n",v:s};break;case"?":for(s=c;e.charAt(++i)===c;)s+=c;a[a.length]={t:c,v:s},u=c;break;case"*":++i,(e.charAt(i)==" "||e.charAt(i)=="*")&&++i;break;case"(":case")":a[a.length]={t:n===1?"t":c,v:c},++i;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(s=c;i<e.length&&"0123456789".indexOf(e.charAt(++i))>-1;)s+=e.charAt(i);a[a.length]={t:"D",v:s};break;case" ":a[a.length]={t:c,v:c},++i;break;case"$":a[a.length]={t:"t",v:"$"},++i;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(c)===-1)throw new Error("unrecognized character "+c+" in "+e);a[a.length]={t:"t",v:c},++i;break}var _=0,E=0,k;for(i=a.length-1,u="t";i>=0;--i)switch(a[i].t){case"h":case"H":a[i].t=m,u="h",_<1&&(_=1);break;case"s":(k=a[i].v.match(/\.0+$/))&&(E=Math.max(E,k[0].length-1)),_<3&&(_=3);case"d":case"y":case"M":case"e":u=a[i].t;break;case"m":u==="s"&&(a[i].t="M",_<2&&(_=2));break;case"X":break;case"Z":_<1&&a[i].v.match(/[Hh]/)&&(_=1),_<2&&a[i].v.match(/[Mm]/)&&(_=2),_<3&&a[i].v.match(/[Ss]/)&&(_=3)}switch(_){case 0:break;case 1:f.u>=.5&&(f.u=0,++f.S),f.S>=60&&(f.S=0,++f.M),f.M>=60&&(f.M=0,++f.H);break;case 2:f.u>=.5&&(f.u=0,++f.S),f.S>=60&&(f.S=0,++f.M);break}var b="",O;for(i=0;i<a.length;++i)switch(a[i].t){case"t":case"T":case" ":case"D":break;case"X":a[i].v="",a[i].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":a[i].v=cI(a[i].t.charCodeAt(0),a[i].v,f,E),a[i].t="t";break;case"n":case"?":for(O=i+1;a[O]!=null&&((c=a[O].t)==="?"||c==="D"||(c===" "||c==="t")&&a[O+1]!=null&&(a[O+1].t==="?"||a[O+1].t==="t"&&a[O+1].v==="/")||a[i].t==="("&&(c===" "||c==="n"||c===")")||c==="t"&&(a[O].v==="/"||a[O].v===" "&&a[O+1]!=null&&a[O+1].t=="?"));)a[i].v+=a[O].v,a[O]={v:"",t:";"},++O;b+=a[i].v,i=O-1;break;case"G":a[i].t="t",a[i].v=co(t,r);break}var z="",L,P;if(b.length>0){b.charCodeAt(0)==40?(L=t<0&&b.charCodeAt(0)===45?-t:t,P=Na("n",b,L)):(L=t<0&&n>1?-t:t,P=Na("n",b,L),L<0&&a[0]&&a[0].t=="t"&&(P=P.substr(1),a[0].v="-"+a[0].v)),O=P.length-1;var J=a.length;for(i=0;i<a.length;++i)if(a[i]!=null&&a[i].t!="t"&&a[i].v.indexOf(".")>-1){J=i;break}var V=a.length;if(J===a.length&&P.indexOf("E")===-1){for(i=a.length-1;i>=0;--i)a[i]==null||"n?".indexOf(a[i].t)===-1||(O>=a[i].v.length-1?(O-=a[i].v.length,a[i].v=P.substr(O+1,a[i].v.length)):O<0?a[i].v="":(a[i].v=P.substr(0,O+1),O=-1),a[i].t="t",V=i);O>=0&&V<a.length&&(a[V].v=P.substr(0,O+1)+a[V].v)}else if(J!==a.length&&P.indexOf("E")===-1){for(O=P.indexOf(".")-1,i=J;i>=0;--i)if(!(a[i]==null||"n?".indexOf(a[i].t)===-1)){for(h=a[i].v.indexOf(".")>-1&&i===J?a[i].v.indexOf(".")-1:a[i].v.length-1,z=a[i].v.substr(h+1);h>=0;--h)O>=0&&(a[i].v.charAt(h)==="0"||a[i].v.charAt(h)==="#")&&(z=P.charAt(O--)+z);a[i].v=z,a[i].t="t",V=i}for(O>=0&&V<a.length&&(a[V].v=P.substr(0,O+1)+a[V].v),O=P.indexOf(".")+1,i=J;i<a.length;++i)if(!(a[i]==null||"n?(".indexOf(a[i].t)===-1&&i!==J)){for(h=a[i].v.indexOf(".")>-1&&i===J?a[i].v.indexOf(".")+1:0,z=a[i].v.substr(0,h);h<a[i].v.length;++h)O<P.length&&(z+=P.charAt(O++));a[i].v=z,a[i].t="t",V=i}}}for(i=0;i<a.length;++i)a[i]!=null&&"n?".indexOf(a[i].t)>-1&&(L=n>1&&t<0&&i>0&&a[i-1].v==="-"?-t:t,a[i].v=Na(a[i].t,a[i].v,L),a[i].t="t");var le="";for(i=0;i!==a.length;++i)a[i]!=null&&(le+=a[i].v);return le}var Gv=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function qv(e,t){if(t==null)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0;break}return!1}function wI(e,t){var r=xI(e),n=r.length,a=r[n-1].indexOf("@");if(n<4&&a>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof t!="number")return[4,r.length===4||a>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=a>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=a>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=a>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var s=t>0?r[0]:t<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,s];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var i=r[0].match(Gv),c=r[1].match(Gv);return qv(t,i)?[n,r[0]]:qv(t,c)?[n,r[1]]:[n,r[i!=null&&c!=null?2:1]]}return[n,s]}function Un(e,t,r){r==null&&(r={});var n="";switch(typeof e){case"string":e=="m/d/yy"&&r.dateNF?n=r.dateNF:n=e;break;case"number":e==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:Ge)[e],n==null&&(n=r.table&&r.table[Vv[e]]||Ge[Vv[e]]),n==null&&(n=rI[e]||"General");break}if(mf(n,0))return co(t,r);t instanceof Date&&(t=o_(t,r.date1904));var a=wI(n,t);if(mf(a[1]))return co(t,r);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return yI(a[1],t,r,a[0])}function Ma(e,t){if(typeof t!="number"){t=+t||-1;for(var r=0;r<392;++r){if(Ge[r]==null){t<0&&(t=r);continue}if(Ge[r]==e){t=r;break}}t<0&&(t=391)}return Ge[t]=e,t}function Bf(e){for(var t=0;t!=392;++t)e[t]!==void 0&&Ma(e[t],t)}function Di(){Ge=tI()}var _I={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},p_=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function SI(e){var t=typeof e=="number"?Ge[e]:e;return t=t.replace(p_,"(\\d+)"),new RegExp("^"+t+"$")}function EI(e,t,r){var n=-1,a=-1,s=-1,i=-1,c=-1,u=-1;(t.match(p_)||[]).forEach(function(p,m){var y=parseInt(r[m+1],10);switch(p.toLowerCase().charAt(0)){case"y":n=y;break;case"d":s=y;break;case"h":i=y;break;case"s":u=y;break;case"m":i>=0?c=y:a=y;break}}),u>=0&&c==-1&&a>=0&&(c=a,a=-1);var f=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(a>=1?a:1)).slice(-2)+"-"+("00"+(s>=1?s:1)).slice(-2);f.length==7&&(f="0"+f),f.length==8&&(f="20"+f);var h=("00"+(i>=0?i:0)).slice(-2)+":"+("00"+(c>=0?c:0)).slice(-2)+":"+("00"+(u>=0?u:0)).slice(-2);return i==-1&&c==-1&&u==-1?f:n==-1&&a==-1&&s==-1?h:f+"T"+h}var bI=(function(){var e={};e.version="1.2.0";function t(){for(var P=0,J=new Array(256),V=0;V!=256;++V)P=V,P=P&1?-306674912^P>>>1:P>>>1,P=P&1?-306674912^P>>>1:P>>>1,P=P&1?-306674912^P>>>1:P>>>1,P=P&1?-306674912^P>>>1:P>>>1,P=P&1?-306674912^P>>>1:P>>>1,P=P&1?-306674912^P>>>1:P>>>1,P=P&1?-306674912^P>>>1:P>>>1,P=P&1?-306674912^P>>>1:P>>>1,J[V]=P;return typeof Int32Array<"u"?new Int32Array(J):J}var r=t();function n(P){var J=0,V=0,le=0,ee=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(le=0;le!=256;++le)ee[le]=P[le];for(le=0;le!=256;++le)for(V=P[le],J=256+le;J<4096;J+=256)V=ee[J]=V>>>8^P[V&255];var X=[];for(le=1;le!=16;++le)X[le-1]=typeof Int32Array<"u"?ee.subarray(le*256,le*256+256):ee.slice(le*256,le*256+256);return X}var a=n(r),s=a[0],i=a[1],c=a[2],u=a[3],f=a[4],h=a[5],p=a[6],m=a[7],y=a[8],w=a[9],x=a[10],_=a[11],E=a[12],k=a[13],b=a[14];function O(P,J){for(var V=J^-1,le=0,ee=P.length;le<ee;)V=V>>>8^r[(V^P.charCodeAt(le++))&255];return~V}function z(P,J){for(var V=J^-1,le=P.length-15,ee=0;ee<le;)V=b[P[ee++]^V&255]^k[P[ee++]^V>>8&255]^E[P[ee++]^V>>16&255]^_[P[ee++]^V>>>24]^x[P[ee++]]^w[P[ee++]]^y[P[ee++]]^m[P[ee++]]^p[P[ee++]]^h[P[ee++]]^f[P[ee++]]^u[P[ee++]]^c[P[ee++]]^i[P[ee++]]^s[P[ee++]]^r[P[ee++]];for(le+=15;ee<le;)V=V>>>8^r[(V^P[ee++])&255];return~V}function L(P,J){for(var V=J^-1,le=0,ee=P.length,X=0,he=0;le<ee;)X=P.charCodeAt(le++),X<128?V=V>>>8^r[(V^X)&255]:X<2048?(V=V>>>8^r[(V^(192|X>>6&31))&255],V=V>>>8^r[(V^(128|X&63))&255]):X>=55296&&X<57344?(X=(X&1023)+64,he=P.charCodeAt(le++)&1023,V=V>>>8^r[(V^(240|X>>8&7))&255],V=V>>>8^r[(V^(128|X>>2&63))&255],V=V>>>8^r[(V^(128|he>>6&15|(X&3)<<4))&255],V=V>>>8^r[(V^(128|he&63))&255]):(V=V>>>8^r[(V^(224|X>>12&15))&255],V=V>>>8^r[(V^(128|X>>6&63))&255],V=V>>>8^r[(V^(128|X&63))&255]);return~V}return e.table=r,e.bstr=O,e.buf=z,e.str=L,e})(),Ve=(function(){var t={};t.version="1.2.1";function r(C,F){for(var I=C.split("/"),D=F.split("/"),N=0,M=0,ae=Math.min(I.length,D.length);N<ae;++N){if(M=I[N].length-D[N].length)return M;if(I[N]!=D[N])return I[N]<D[N]?-1:1}return I.length-D.length}function n(C){if(C.charAt(C.length-1)=="/")return C.slice(0,-1).indexOf("/")===-1?C:n(C.slice(0,-1));var F=C.lastIndexOf("/");return F===-1?C:C.slice(0,F+1)}function a(C){if(C.charAt(C.length-1)=="/")return a(C.slice(0,-1));var F=C.lastIndexOf("/");return F===-1?C:C.slice(F+1)}function s(C,F){typeof F=="string"&&(F=new Date(F));var I=F.getHours();I=I<<6|F.getMinutes(),I=I<<5|F.getSeconds()>>>1,C.write_shift(2,I);var D=F.getFullYear()-1980;D=D<<4|F.getMonth()+1,D=D<<5|F.getDate(),C.write_shift(2,D)}function i(C){var F=C.read_shift(2)&65535,I=C.read_shift(2)&65535,D=new Date,N=I&31;I>>>=5;var M=I&15;I>>>=4,D.setMilliseconds(0),D.setFullYear(I+1980),D.setMonth(M-1),D.setDate(N);var ae=F&31;F>>>=5;var pe=F&63;return F>>>=6,D.setHours(F),D.setMinutes(pe),D.setSeconds(ae<<1),D}function c(C){Ar(C,0);for(var F={},I=0;C.l<=C.length-4;){var D=C.read_shift(2),N=C.read_shift(2),M=C.l+N,ae={};switch(D){case 21589:I=C.read_shift(1),I&1&&(ae.mtime=C.read_shift(4)),N>5&&(I&2&&(ae.atime=C.read_shift(4)),I&4&&(ae.ctime=C.read_shift(4))),ae.mtime&&(ae.mt=new Date(ae.mtime*1e3));break}C.l=M,F[D]=ae}return F}var u;function f(){return u||(u={})}function h(C,F){if(C[0]==80&&C[1]==75)return Co(C,F);if((C[0]|32)==109&&(C[1]|32)==105)return Pc(C,F);if(C.length<512)throw new Error("CFB file size "+C.length+" < 512");var I=3,D=512,N=0,M=0,ae=0,pe=0,re=0,se=[],ie=C.slice(0,512);Ar(ie,0);var be=p(ie);switch(I=be[0],I){case 3:D=512;break;case 4:D=4096;break;case 0:if(be[1]==0)return Co(C,F);default:throw new Error("Major Version: Expected 3 or 4 saw "+I)}D!==512&&(ie=C.slice(0,D),Ar(ie,28));var Fe=C.slice(0,D);m(ie,I);var Ne=ie.read_shift(4,"i");if(I===3&&Ne!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Ne);ie.l+=4,ae=ie.read_shift(4,"i"),ie.l+=4,ie.chk("00100000","Mini Stream Cutoff Size: "),pe=ie.read_shift(4,"i"),N=ie.read_shift(4,"i"),re=ie.read_shift(4,"i"),M=ie.read_shift(4,"i");for(var Ae=-1,Ce=0;Ce<109&&(Ae=ie.read_shift(4,"i"),!(Ae<0));++Ce)se[Ce]=Ae;var et=y(C,D);_(re,M,et,D,se);var Ct=k(et,ae,se,D);Ct[ae].name="!Directory",N>0&&pe!==he&&(Ct[pe].name="!MiniFAT"),Ct[se[0]].name="!FAT",Ct.fat_addrs=se,Ct.ssz=D;var At={},Jt=[],Rs=[],Xa=[];b(ae,Ct,et,Jt,N,At,Rs,pe),w(Rs,Xa,Jt),Jt.shift();var ca={FileIndex:Rs,FullPaths:Xa};return F&&F.raw&&(ca.raw={header:Fe,sectors:et}),ca}function p(C){if(C[C.l]==80&&C[C.l+1]==75)return[0,0];C.chk(Ie,"Header Signature: "),C.l+=16;var F=C.read_shift(2,"u");return[C.read_shift(2,"u"),F]}function m(C,F){var I=9;switch(C.l+=2,I=C.read_shift(2)){case 9:if(F!=3)throw new Error("Sector Shift: Expected 9 saw "+I);break;case 12:if(F!=4)throw new Error("Sector Shift: Expected 12 saw "+I);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+I)}C.chk("0600","Mini Sector Shift: "),C.chk("000000000000","Reserved: ")}function y(C,F){for(var I=Math.ceil(C.length/F)-1,D=[],N=1;N<I;++N)D[N-1]=C.slice(N*F,(N+1)*F);return D[I-1]=C.slice(I*F),D}function w(C,F,I){for(var D=0,N=0,M=0,ae=0,pe=0,re=I.length,se=[],ie=[];D<re;++D)se[D]=ie[D]=D,F[D]=I[D];for(;pe<ie.length;++pe)D=ie[pe],N=C[D].L,M=C[D].R,ae=C[D].C,se[D]===D&&(N!==-1&&se[N]!==N&&(se[D]=se[N]),M!==-1&&se[M]!==M&&(se[D]=se[M])),ae!==-1&&(se[ae]=D),N!==-1&&D!=se[D]&&(se[N]=se[D],ie.lastIndexOf(N)<pe&&ie.push(N)),M!==-1&&D!=se[D]&&(se[M]=se[D],ie.lastIndexOf(M)<pe&&ie.push(M));for(D=1;D<re;++D)se[D]===D&&(M!==-1&&se[M]!==M?se[D]=se[M]:N!==-1&&se[N]!==N&&(se[D]=se[N]));for(D=1;D<re;++D)if(C[D].type!==0){if(pe=D,pe!=se[pe])do pe=se[pe],F[D]=F[pe]+"/"+F[D];while(pe!==0&&se[pe]!==-1&&pe!=se[pe]);se[D]=-1}for(F[0]+="/",D=1;D<re;++D)C[D].type!==2&&(F[D]+="/")}function x(C,F,I){for(var D=C.start,N=C.size,M=[],ae=D;I&&N>0&&ae>=0;)M.push(F.slice(ae*X,ae*X+X)),N-=X,ae=Zs(I,ae*4);return M.length===0?de(0):Er(M).slice(0,C.size)}function _(C,F,I,D,N){var M=he;if(C===he){if(F!==0)throw new Error("DIFAT chain shorter than expected")}else if(C!==-1){var ae=I[C],pe=(D>>>2)-1;if(!ae)return;for(var re=0;re<pe&&(M=Zs(ae,re*4))!==he;++re)N.push(M);_(Zs(ae,D-4),F-1,I,D,N)}}function E(C,F,I,D,N){var M=[],ae=[];N||(N=[]);var pe=D-1,re=0,se=0;for(re=F;re>=0;){N[re]=!0,M[M.length]=re,ae.push(C[re]);var ie=I[Math.floor(re*4/D)];if(se=re*4&pe,D<4+se)throw new Error("FAT boundary crossed: "+re+" 4 "+D);if(!C[ie])break;re=Zs(C[ie],se)}return{nodes:M,data:sx([ae])}}function k(C,F,I,D){var N=C.length,M=[],ae=[],pe=[],re=[],se=D-1,ie=0,be=0,Fe=0,Ne=0;for(ie=0;ie<N;++ie)if(pe=[],Fe=ie+F,Fe>=N&&(Fe-=N),!ae[Fe]){re=[];var Ae=[];for(be=Fe;be>=0;){Ae[be]=!0,ae[be]=!0,pe[pe.length]=be,re.push(C[be]);var Ce=I[Math.floor(be*4/D)];if(Ne=be*4&se,D<4+Ne)throw new Error("FAT boundary crossed: "+be+" 4 "+D);if(!C[Ce]||(be=Zs(C[Ce],Ne),Ae[be]))break}M[Fe]={nodes:pe,data:sx([re])}}return M}function b(C,F,I,D,N,M,ae,pe){for(var re=0,se=D.length?2:0,ie=F[C].data,be=0,Fe=0,Ne;be<ie.length;be+=128){var Ae=ie.slice(be,be+128);Ar(Ae,64),Fe=Ae.read_shift(2),Ne=Dg(Ae,0,Fe-se),D.push(Ne);var Ce={name:Ne,type:Ae.read_shift(1),color:Ae.read_shift(1),L:Ae.read_shift(4,"i"),R:Ae.read_shift(4,"i"),C:Ae.read_shift(4,"i"),clsid:Ae.read_shift(16),state:Ae.read_shift(4,"i"),start:0,size:0},et=Ae.read_shift(2)+Ae.read_shift(2)+Ae.read_shift(2)+Ae.read_shift(2);et!==0&&(Ce.ct=O(Ae,Ae.l-8));var Ct=Ae.read_shift(2)+Ae.read_shift(2)+Ae.read_shift(2)+Ae.read_shift(2);Ct!==0&&(Ce.mt=O(Ae,Ae.l-8)),Ce.start=Ae.read_shift(4,"i"),Ce.size=Ae.read_shift(4,"i"),Ce.size<0&&Ce.start<0&&(Ce.size=Ce.type=0,Ce.start=he,Ce.name=""),Ce.type===5?(re=Ce.start,N>0&&re!==he&&(F[re].name="!StreamData")):Ce.size>=4096?(Ce.storage="fat",F[Ce.start]===void 0&&(F[Ce.start]=E(I,Ce.start,F.fat_addrs,F.ssz)),F[Ce.start].name=Ce.name,Ce.content=F[Ce.start].data.slice(0,Ce.size)):(Ce.storage="minifat",Ce.size<0?Ce.size=0:re!==he&&Ce.start!==he&&F[re]&&(Ce.content=x(Ce,F[re].data,(F[pe]||{}).data))),Ce.content&&Ar(Ce.content,0),M[Ne]=Ce,ae.push(Ce)}}function O(C,F){return new Date((wn(C,F+4)/1e7*Math.pow(2,32)+wn(C,F)/1e7-11644473600)*1e3)}function z(C,F){return f(),h(u.readFileSync(C),F)}function L(C,F){var I=F&&F.type;switch(I||st&&Buffer.isBuffer(C)&&(I="buffer"),I||"base64"){case"file":return z(C,F);case"base64":return h(bn(Tn(C)),F);case"binary":return h(bn(C),F)}return h(C,F)}function P(C,F){var I=F||{},D=I.root||"Root Entry";if(C.FullPaths||(C.FullPaths=[]),C.FileIndex||(C.FileIndex=[]),C.FullPaths.length!==C.FileIndex.length)throw new Error("inconsistent CFB structure");C.FullPaths.length===0&&(C.FullPaths[0]=D+"/",C.FileIndex[0]={name:D,type:5}),I.CLSID&&(C.FileIndex[0].clsid=I.CLSID),J(C)}function J(C){var F="Sh33tJ5";if(!Ve.find(C,"/"+F)){var I=de(4);I[0]=55,I[1]=I[3]=50,I[2]=54,C.FileIndex.push({name:F,type:2,content:I,size:4,L:69,R:69,C:69}),C.FullPaths.push(C.FullPaths[0]+F),V(C)}}function V(C,F){P(C);for(var I=!1,D=!1,N=C.FullPaths.length-1;N>=0;--N){var M=C.FileIndex[N];switch(M.type){case 0:D?I=!0:(C.FileIndex.pop(),C.FullPaths.pop());break;case 1:case 2:case 5:D=!0,isNaN(M.R*M.L*M.C)&&(I=!0),M.R>-1&&M.L>-1&&M.R==M.L&&(I=!0);break;default:I=!0;break}}if(!(!I&&!F)){var ae=new Date(1987,1,19),pe=0,re=Object.create?Object.create(null):{},se=[];for(N=0;N<C.FullPaths.length;++N)re[C.FullPaths[N]]=!0,C.FileIndex[N].type!==0&&se.push([C.FullPaths[N],C.FileIndex[N]]);for(N=0;N<se.length;++N){var ie=n(se[N][0]);D=re[ie],D||(se.push([ie,{name:a(ie).replace("/",""),type:1,clsid:Te,ct:ae,mt:ae,content:null}]),re[ie]=!0)}for(se.sort(function(Ne,Ae){return r(Ne[0],Ae[0])}),C.FullPaths=[],C.FileIndex=[],N=0;N<se.length;++N)C.FullPaths[N]=se[N][0],C.FileIndex[N]=se[N][1];for(N=0;N<se.length;++N){var be=C.FileIndex[N],Fe=C.FullPaths[N];if(be.name=a(Fe).replace("/",""),be.L=be.R=be.C=-(be.color=1),be.size=be.content?be.content.length:0,be.start=0,be.clsid=be.clsid||Te,N===0)be.C=se.length>1?1:-1,be.size=0,be.type=5;else if(Fe.slice(-1)=="/"){for(pe=N+1;pe<se.length&&n(C.FullPaths[pe])!=Fe;++pe);for(be.C=pe>=se.length?-1:pe,pe=N+1;pe<se.length&&n(C.FullPaths[pe])!=n(Fe);++pe);be.R=pe>=se.length?-1:pe,be.type=1}else n(C.FullPaths[N+1]||"")==n(Fe)&&(be.R=N+1),be.type=2}}}function le(C,F){var I=F||{};if(I.fileType=="mad")return Ds(C,I);switch(V(C),I.fileType){case"zip":return Ka(C,I)}var D=(function(Ne){for(var Ae=0,Ce=0,et=0;et<Ne.FileIndex.length;++et){var Ct=Ne.FileIndex[et];if(Ct.content){var At=Ct.content.length;At>0&&(At<4096?Ae+=At+63>>6:Ce+=At+511>>9)}}for(var Jt=Ne.FullPaths.length+3>>2,Rs=Ae+7>>3,Xa=Ae+127>>7,ca=Rs+Ce+Jt+Xa,vr=ca+127>>7,ji=vr<=109?0:Math.ceil((vr-109)/127);ca+vr+ji+127>>7>vr;)ji=++vr<=109?0:Math.ceil((vr-109)/127);var Yt=[1,ji,vr,Xa,Jt,Ce,Ae,0];return Ne.FileIndex[0].size=Ae<<6,Yt[7]=(Ne.FileIndex[0].start=Yt[0]+Yt[1]+Yt[2]+Yt[3]+Yt[4]+Yt[5])+(Yt[6]+7>>3),Yt})(C),N=de(D[7]<<9),M=0,ae=0;{for(M=0;M<8;++M)N.write_shift(1,Ee[M]);for(M=0;M<8;++M)N.write_shift(2,0);for(N.write_shift(2,62),N.write_shift(2,3),N.write_shift(2,65534),N.write_shift(2,9),N.write_shift(2,6),M=0;M<3;++M)N.write_shift(2,0);for(N.write_shift(4,0),N.write_shift(4,D[2]),N.write_shift(4,D[0]+D[1]+D[2]+D[3]-1),N.write_shift(4,0),N.write_shift(4,4096),N.write_shift(4,D[3]?D[0]+D[1]+D[2]-1:he),N.write_shift(4,D[3]),N.write_shift(-4,D[1]?D[0]-1:he),N.write_shift(4,D[1]),M=0;M<109;++M)N.write_shift(-4,M<D[2]?D[1]+M:-1)}if(D[1])for(ae=0;ae<D[1];++ae){for(;M<236+ae*127;++M)N.write_shift(-4,M<D[2]?D[1]+M:-1);N.write_shift(-4,ae===D[1]-1?he:ae+1)}var pe=function(Ne){for(ae+=Ne;M<ae-1;++M)N.write_shift(-4,M+1);Ne&&(++M,N.write_shift(-4,he))};for(ae=M=0,ae+=D[1];M<ae;++M)N.write_shift(-4,oe.DIFSECT);for(ae+=D[2];M<ae;++M)N.write_shift(-4,oe.FATSECT);pe(D[3]),pe(D[4]);for(var re=0,se=0,ie=C.FileIndex[0];re<C.FileIndex.length;++re)ie=C.FileIndex[re],ie.content&&(se=ie.content.length,!(se<4096)&&(ie.start=ae,pe(se+511>>9)));for(pe(D[6]+7>>3);N.l&511;)N.write_shift(-4,oe.ENDOFCHAIN);for(ae=M=0,re=0;re<C.FileIndex.length;++re)ie=C.FileIndex[re],ie.content&&(se=ie.content.length,!(!se||se>=4096)&&(ie.start=ae,pe(se+63>>6)));for(;N.l&511;)N.write_shift(-4,oe.ENDOFCHAIN);for(M=0;M<D[4]<<2;++M){var be=C.FullPaths[M];if(!be||be.length===0){for(re=0;re<17;++re)N.write_shift(4,0);for(re=0;re<3;++re)N.write_shift(4,-1);for(re=0;re<12;++re)N.write_shift(4,0);continue}ie=C.FileIndex[M],M===0&&(ie.start=ie.size?ie.start-1:he);var Fe=M===0&&I.root||ie.name;if(se=2*(Fe.length+1),N.write_shift(64,Fe,"utf16le"),N.write_shift(2,se),N.write_shift(1,ie.type),N.write_shift(1,ie.color),N.write_shift(-4,ie.L),N.write_shift(-4,ie.R),N.write_shift(-4,ie.C),ie.clsid)N.write_shift(16,ie.clsid,"hex");else for(re=0;re<4;++re)N.write_shift(4,0);N.write_shift(4,ie.state||0),N.write_shift(4,0),N.write_shift(4,0),N.write_shift(4,0),N.write_shift(4,0),N.write_shift(4,ie.start),N.write_shift(4,ie.size),N.write_shift(4,0)}for(M=1;M<C.FileIndex.length;++M)if(ie=C.FileIndex[M],ie.size>=4096)if(N.l=ie.start+1<<9,st&&Buffer.isBuffer(ie.content))ie.content.copy(N,N.l,0,ie.size),N.l+=ie.size+511&-512;else{for(re=0;re<ie.size;++re)N.write_shift(1,ie.content[re]);for(;re&511;++re)N.write_shift(1,0)}for(M=1;M<C.FileIndex.length;++M)if(ie=C.FileIndex[M],ie.size>0&&ie.size<4096)if(st&&Buffer.isBuffer(ie.content))ie.content.copy(N,N.l,0,ie.size),N.l+=ie.size+63&-64;else{for(re=0;re<ie.size;++re)N.write_shift(1,ie.content[re]);for(;re&63;++re)N.write_shift(1,0)}if(st)N.l=N.length;else for(;N.l<N.length;)N.write_shift(1,0);return N}function ee(C,F){var I=C.FullPaths.map(function(re){return re.toUpperCase()}),D=I.map(function(re){var se=re.split("/");return se[se.length-(re.slice(-1)=="/"?2:1)]}),N=!1;F.charCodeAt(0)===47?(N=!0,F=I[0].slice(0,-1)+F):N=F.indexOf("/")!==-1;var M=F.toUpperCase(),ae=N===!0?I.indexOf(M):D.indexOf(M);if(ae!==-1)return C.FileIndex[ae];var pe=!M.match(Cl);for(M=M.replace(en,""),pe&&(M=M.replace(Cl,"!")),ae=0;ae<I.length;++ae)if((pe?I[ae].replace(Cl,"!"):I[ae]).replace(en,"")==M||(pe?D[ae].replace(Cl,"!"):D[ae]).replace(en,"")==M)return C.FileIndex[ae];return null}var X=64,he=-2,Ie="d0cf11e0a1b11ae1",Ee=[208,207,17,224,161,177,26,225],Te="00000000000000000000000000000000",oe={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:he,FREESECT:-1,HEADER_SIGNATURE:Ie,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:Te,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function ge(C,F,I){f();var D=le(C,I);u.writeFileSync(F,D)}function K(C){for(var F=new Array(C.length),I=0;I<C.length;++I)F[I]=String.fromCharCode(C[I]);return F.join("")}function fe(C,F){var I=le(C,F);switch(F&&F.type||"buffer"){case"file":return f(),u.writeFileSync(F.filename,I),I;case"binary":return typeof I=="string"?I:K(I);case"base64":return Jl(typeof I=="string"?I:K(I));case"buffer":if(st)return Buffer.isBuffer(I)?I:Wa(I);case"array":return typeof I=="string"?bn(I):I}return I}var H;function A(C){try{var F=C.InflateRaw,I=new F;if(I._processChunk(new Uint8Array([3,0]),I._finishFlushFlag),I.bytesRead)H=C;else throw new Error("zlib does not expose bytesRead")}catch(D){console.error("cannot use native zlib: "+(D.message||D))}}function G(C,F){if(!H)return ko(C,F);var I=H.InflateRaw,D=new I,N=D._processChunk(C.slice(C.l),D._finishFlushFlag);return C.l+=D.bytesRead,N}function U(C){return H?H.deflateRawSync(C):tt(C)}var W=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],ne=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],xe=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function ve(C){var F=(C<<1|C<<11)&139536|(C<<5|C<<15)&558144;return(F>>16|F>>8|F)&255}for(var me=typeof Uint8Array<"u",ye=me?new Uint8Array(256):[],Ze=0;Ze<256;++Ze)ye[Ze]=ve(Ze);function j(C,F){var I=ye[C&255];return F<=8?I>>>8-F:(I=I<<8|ye[C>>8&255],F<=16?I>>>16-F:(I=I<<8|ye[C>>16&255],I>>>24-F))}function yt(C,F){var I=F&7,D=F>>>3;return(C[D]|(I<=6?0:C[D+1]<<8))>>>I&3}function ot(C,F){var I=F&7,D=F>>>3;return(C[D]|(I<=5?0:C[D+1]<<8))>>>I&7}function wt(C,F){var I=F&7,D=F>>>3;return(C[D]|(I<=4?0:C[D+1]<<8))>>>I&15}function at(C,F){var I=F&7,D=F>>>3;return(C[D]|(I<=3?0:C[D+1]<<8))>>>I&31}function Re(C,F){var I=F&7,D=F>>>3;return(C[D]|(I<=1?0:C[D+1]<<8))>>>I&127}function Nt(C,F,I){var D=F&7,N=F>>>3,M=(1<<I)-1,ae=C[N]>>>D;return I<8-D||(ae|=C[N+1]<<8-D,I<16-D)||(ae|=C[N+2]<<16-D,I<24-D)||(ae|=C[N+3]<<24-D),ae&M}function Ir(C,F,I){var D=F&7,N=F>>>3;return D<=5?C[N]|=(I&7)<<D:(C[N]|=I<<D&255,C[N+1]=(I&7)>>8-D),F+3}function Or(C,F,I){var D=F&7,N=F>>>3;return I=(I&1)<<D,C[N]|=I,F+1}function Dr(C,F,I){var D=F&7,N=F>>>3;return I<<=D,C[N]|=I&255,I>>>=8,C[N+1]=I,F+8}function Sa(C,F,I){var D=F&7,N=F>>>3;return I<<=D,C[N]|=I&255,I>>>=8,C[N+1]=I&255,C[N+2]=I>>>8,F+16}function Vn(C,F){var I=C.length,D=2*I>F?2*I:F+5,N=0;if(I>=F)return C;if(st){var M=$v(D);if(C.copy)C.copy(M);else for(;N<C.length;++N)M[N]=C[N];return M}else if(me){var ae=new Uint8Array(D);if(ae.set)ae.set(C);else for(;N<I;++N)ae[N]=C[N];return ae}return C.length=D,C}function Fr(C){for(var F=new Array(C),I=0;I<C;++I)F[I]=0;return F}function Cn(C,F,I){var D=1,N=0,M=0,ae=0,pe=0,re=C.length,se=me?new Uint16Array(32):Fr(32);for(M=0;M<32;++M)se[M]=0;for(M=re;M<I;++M)C[M]=0;re=C.length;var ie=me?new Uint16Array(re):Fr(re);for(M=0;M<re;++M)se[N=C[M]]++,D<N&&(D=N),ie[M]=0;for(se[0]=0,M=1;M<=D;++M)se[M+16]=pe=pe+se[M-1]<<1;for(M=0;M<re;++M)pe=C[M],pe!=0&&(ie[M]=se[pe+16]++);var be=0;for(M=0;M<re;++M)if(be=C[M],be!=0)for(pe=j(ie[M],D)>>D-be,ae=(1<<D+4-be)-1;ae>=0;--ae)F[pe|ae<<be]=be&15|M<<4;return D}var Wn=me?new Uint16Array(512):Fr(512),Ea=me?new Uint16Array(32):Fr(32);if(!me){for(var sr=0;sr<512;++sr)Wn[sr]=0;for(sr=0;sr<32;++sr)Ea[sr]=0}(function(){for(var C=[],F=0;F<32;F++)C.push(5);Cn(C,Ea,32);var I=[];for(F=0;F<=143;F++)I.push(8);for(;F<=255;F++)I.push(9);for(;F<=279;F++)I.push(7);for(;F<=287;F++)I.push(8);Cn(I,Wn,288)})();var dn=(function(){for(var F=me?new Uint8Array(32768):[],I=0,D=0;I<xe.length-1;++I)for(;D<xe[I+1];++D)F[D]=I;for(;D<32768;++D)F[D]=29;var N=me?new Uint8Array(259):[];for(I=0,D=0;I<ne.length-1;++I)for(;D<ne[I+1];++D)N[D]=I;function M(pe,re){for(var se=0;se<pe.length;){var ie=Math.min(65535,pe.length-se),be=se+ie==pe.length;for(re.write_shift(1,+be),re.write_shift(2,ie),re.write_shift(2,~ie&65535);ie-- >0;)re[re.l++]=pe[se++]}return re.l}function ae(pe,re){for(var se=0,ie=0,be=me?new Uint16Array(32768):[];ie<pe.length;){var Fe=Math.min(65535,pe.length-ie);if(Fe<10){for(se=Ir(re,se,+(ie+Fe==pe.length)),se&7&&(se+=8-(se&7)),re.l=se/8|0,re.write_shift(2,Fe),re.write_shift(2,~Fe&65535);Fe-- >0;)re[re.l++]=pe[ie++];se=re.l*8;continue}se=Ir(re,se,+(ie+Fe==pe.length)+2);for(var Ne=0;Fe-- >0;){var Ae=pe[ie];Ne=(Ne<<5^Ae)&32767;var Ce=-1,et=0;if((Ce=be[Ne])&&(Ce|=ie&-32768,Ce>ie&&(Ce-=32768),Ce<ie))for(;pe[Ce+et]==pe[ie+et]&&et<250;)++et;if(et>2){Ae=N[et],Ae<=22?se=Dr(re,se,ye[Ae+1]>>1)-1:(Dr(re,se,3),se+=5,Dr(re,se,ye[Ae-23]>>5),se+=3);var Ct=Ae<8?0:Ae-4>>2;Ct>0&&(Sa(re,se,et-ne[Ae]),se+=Ct),Ae=F[ie-Ce],se=Dr(re,se,ye[Ae]>>3),se-=3;var At=Ae<4?0:Ae-2>>1;At>0&&(Sa(re,se,ie-Ce-xe[Ae]),se+=At);for(var Jt=0;Jt<et;++Jt)be[Ne]=ie&32767,Ne=(Ne<<5^pe[ie])&32767,++ie;Fe-=et-1}else Ae<=143?Ae=Ae+48:se=Or(re,se,1),se=Dr(re,se,ye[Ae]),be[Ne]=ie&32767,++ie}se=Dr(re,se,0)-1}return re.l=(se+7)/8|0,re.l}return function(re,se){return re.length<8?M(re,se):ae(re,se)}})();function tt(C){var F=de(50+Math.floor(C.length*1.1)),I=dn(C,F);return F.slice(0,I)}var Tt=me?new Uint16Array(32768):Fr(32768),tn=me?new Uint16Array(32768):Fr(32768),Ht=me?new Uint16Array(128):Fr(128),la=1,bc=1;function Li(C,F){var I=at(C,F)+257;F+=5;var D=at(C,F)+1;F+=5;var N=wt(C,F)+4;F+=4;for(var M=0,ae=me?new Uint8Array(19):Fr(19),pe=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],re=1,se=me?new Uint8Array(8):Fr(8),ie=me?new Uint8Array(8):Fr(8),be=ae.length,Fe=0;Fe<N;++Fe)ae[W[Fe]]=M=ot(C,F),re<M&&(re=M),se[M]++,F+=3;var Ne=0;for(se[0]=0,Fe=1;Fe<=re;++Fe)ie[Fe]=Ne=Ne+se[Fe-1]<<1;for(Fe=0;Fe<be;++Fe)(Ne=ae[Fe])!=0&&(pe[Fe]=ie[Ne]++);var Ae=0;for(Fe=0;Fe<be;++Fe)if(Ae=ae[Fe],Ae!=0){Ne=ye[pe[Fe]]>>8-Ae;for(var Ce=(1<<7-Ae)-1;Ce>=0;--Ce)Ht[Ne|Ce<<Ae]=Ae&7|Fe<<3}var et=[];for(re=1;et.length<I+D;)switch(Ne=Ht[Re(C,F)],F+=Ne&7,Ne>>>=3){case 16:for(M=3+yt(C,F),F+=2,Ne=et[et.length-1];M-- >0;)et.push(Ne);break;case 17:for(M=3+ot(C,F),F+=3;M-- >0;)et.push(0);break;case 18:for(M=11+Re(C,F),F+=7;M-- >0;)et.push(0);break;default:et.push(Ne),re<Ne&&(re=Ne);break}var Ct=et.slice(0,I),At=et.slice(I);for(Fe=I;Fe<286;++Fe)Ct[Fe]=0;for(Fe=D;Fe<30;++Fe)At[Fe]=0;return la=Cn(Ct,Tt,286),bc=Cn(At,tn,30),F}function Ni(C,F){if(C[0]==3&&!(C[1]&3))return[Ss(F),2];for(var I=0,D=0,N=$v(F||1<<18),M=0,ae=N.length>>>0,pe=0,re=0;(D&1)==0;){if(D=ot(C,I),I+=3,D>>>1)D>>1==1?(pe=9,re=5):(I=Li(C,I),pe=la,re=bc);else{I&7&&(I+=8-(I&7));var se=C[I>>>3]|C[(I>>>3)+1]<<8;if(I+=32,se>0)for(!F&&ae<M+se&&(N=Vn(N,M+se),ae=N.length);se-- >0;)N[M++]=C[I>>>3],I+=8;continue}for(;;){!F&&ae<M+32767&&(N=Vn(N,M+32767),ae=N.length);var ie=Nt(C,I,pe),be=D>>>1==1?Wn[ie]:Tt[ie];if(I+=be&15,be>>>=4,(be>>>8&255)===0)N[M++]=be;else{if(be==256)break;be-=257;var Fe=be<8?0:be-4>>2;Fe>5&&(Fe=0);var Ne=M+ne[be];Fe>0&&(Ne+=Nt(C,I,Fe),I+=Fe),ie=Nt(C,I,re),be=D>>>1==1?Ea[ie]:tn[ie],I+=be&15,be>>>=4;var Ae=be<4?0:be-2>>1,Ce=xe[be];for(Ae>0&&(Ce+=Nt(C,I,Ae),I+=Ae),!F&&ae<Ne&&(N=Vn(N,Ne+100),ae=N.length);M<Ne;)N[M]=N[M-Ce],++M}}}return F?[N,I+7>>>3]:[N.slice(0,M),I+7>>>3]}function ko(C,F){var I=C.slice(C.l||0),D=Ni(I,F);return C.l+=D[1],D[0]}function To(C,F){if(C)typeof console<"u"&&console.error(F);else throw new Error(F)}function Co(C,F){var I=C;Ar(I,0);var D=[],N=[],M={FileIndex:D,FullPaths:N};P(M,{root:F.root});for(var ae=I.length-4;(I[ae]!=80||I[ae+1]!=75||I[ae+2]!=5||I[ae+3]!=6)&&ae>=0;)--ae;I.l=ae+4,I.l+=4;var pe=I.read_shift(2);I.l+=6;var re=I.read_shift(4);for(I.l=re,ae=0;ae<pe;++ae){I.l+=20;var se=I.read_shift(4),ie=I.read_shift(4),be=I.read_shift(2),Fe=I.read_shift(2),Ne=I.read_shift(2);I.l+=8;var Ae=I.read_shift(4),Ce=c(I.slice(I.l+be,I.l+be+Fe));I.l+=be+Fe+Ne;var et=I.l;I.l=Ae+4,qa(I,se,ie,M,Ce),I.l=et}return M}function qa(C,F,I,D,N){C.l+=2;var M=C.read_shift(2),ae=C.read_shift(2),pe=i(C);if(M&8257)throw new Error("Unsupported ZIP encryption");for(var re=C.read_shift(4),se=C.read_shift(4),ie=C.read_shift(4),be=C.read_shift(2),Fe=C.read_shift(2),Ne="",Ae=0;Ae<be;++Ae)Ne+=String.fromCharCode(C[C.l++]);if(Fe){var Ce=c(C.slice(C.l,C.l+Fe));(Ce[21589]||{}).mt&&(pe=Ce[21589].mt),((N||{})[21589]||{}).mt&&(pe=N[21589].mt)}C.l+=Fe;var et=C.slice(C.l,C.l+se);switch(ae){case 8:et=G(C,ie);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+ae)}var Ct=!1;M&8&&(re=C.read_shift(4),re==134695760&&(re=C.read_shift(4),Ct=!0),se=C.read_shift(4),ie=C.read_shift(4)),se!=F&&To(Ct,"Bad compressed size: "+F+" != "+se),ie!=I&&To(Ct,"Bad uncompressed size: "+I+" != "+ie),ba(D,Ne,et,{unsafe:!0,mt:pe})}function Ka(C,F){var I=F||{},D=[],N=[],M=de(1),ae=I.compression?8:0,pe=0,re=0,se=0,ie=0,be=0,Fe=C.FullPaths[0],Ne=Fe,Ae=C.FileIndex[0],Ce=[],et=0;for(re=1;re<C.FullPaths.length;++re)if(Ne=C.FullPaths[re].slice(Fe.length),Ae=C.FileIndex[re],!(!Ae.size||!Ae.content||Ne=="Sh33tJ5")){var Ct=ie,At=de(Ne.length);for(se=0;se<Ne.length;++se)At.write_shift(1,Ne.charCodeAt(se)&127);At=At.slice(0,At.l),Ce[be]=bI.buf(Ae.content,0);var Jt=Ae.content;ae==8&&(Jt=U(Jt)),M=de(30),M.write_shift(4,67324752),M.write_shift(2,20),M.write_shift(2,pe),M.write_shift(2,ae),Ae.mt?s(M,Ae.mt):M.write_shift(4,0),M.write_shift(-4,Ce[be]),M.write_shift(4,Jt.length),M.write_shift(4,Ae.content.length),M.write_shift(2,At.length),M.write_shift(2,0),ie+=M.length,D.push(M),ie+=At.length,D.push(At),ie+=Jt.length,D.push(Jt),M=de(46),M.write_shift(4,33639248),M.write_shift(2,0),M.write_shift(2,20),M.write_shift(2,pe),M.write_shift(2,ae),M.write_shift(4,0),M.write_shift(-4,Ce[be]),M.write_shift(4,Jt.length),M.write_shift(4,Ae.content.length),M.write_shift(2,At.length),M.write_shift(2,0),M.write_shift(2,0),M.write_shift(2,0),M.write_shift(2,0),M.write_shift(4,0),M.write_shift(4,Ct),et+=M.l,N.push(M),et+=At.length,N.push(At),++be}return M=de(22),M.write_shift(4,101010256),M.write_shift(2,0),M.write_shift(2,0),M.write_shift(2,be),M.write_shift(2,be),M.write_shift(4,et),M.write_shift(4,ie),M.write_shift(2,0),Er([Er(D),Er(N),M])}var Os={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function kc(C,F){if(C.ctype)return C.ctype;var I=C.name||"",D=I.match(/\.([^\.]+)$/);return D&&Os[D[1]]||F&&(D=(I=F).match(/[\.\\]([^\.\\])+$/),D&&Os[D[1]])?Os[D[1]]:"application/octet-stream"}function Tc(C){for(var F=Jl(C),I=[],D=0;D<F.length;D+=76)I.push(F.slice(D,D+76));return I.join(`\r
`)+`\r
`}function Cc(C){var F=C.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(se){var ie=se.charCodeAt(0).toString(16).toUpperCase();return"="+(ie.length==1?"0"+ie:ie)});F=F.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),F.charAt(0)==`
`&&(F="=0D"+F.slice(1)),F=F.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var I=[],D=F.split(`\r
`),N=0;N<D.length;++N){var M=D[N];if(M.length==0){I.push("");continue}for(var ae=0;ae<M.length;){var pe=76,re=M.slice(ae,ae+pe);re.charAt(pe-1)=="="?pe--:re.charAt(pe-2)=="="?pe-=2:re.charAt(pe-3)=="="&&(pe-=3),re=M.slice(ae,ae+pe),ae+=pe,ae<M.length&&(re+="="),I.push(re)}}return I.join(`\r
`)}function Ac(C){for(var F=[],I=0;I<C.length;++I){for(var D=C[I];I<=C.length&&D.charAt(D.length-1)=="=";)D=D.slice(0,D.length-1)+C[++I];F.push(D)}for(var N=0;N<F.length;++N)F[N]=F[N].replace(/[=][0-9A-Fa-f]{2}/g,function(M){return String.fromCharCode(parseInt(M.slice(1),16))});return bn(F.join(`\r
`))}function Mi(C,F,I){for(var D="",N="",M="",ae,pe=0;pe<10;++pe){var re=F[pe];if(!re||re.match(/^\s*$/))break;var se=re.match(/^(.*?):\s*([^\s].*)$/);if(se)switch(se[1].toLowerCase()){case"content-location":D=se[2].trim();break;case"content-type":M=se[2].trim();break;case"content-transfer-encoding":N=se[2].trim();break}}switch(++pe,N.toLowerCase()){case"base64":ae=bn(Tn(F.slice(pe).join("")));break;case"quoted-printable":ae=Ac(F.slice(pe));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+N)}var ie=ba(C,D.slice(I.length),ae,{unsafe:!0});M&&(ie.ctype=M)}function Pc(C,F){if(K(C.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var I=F&&F.root||"",D=(st&&Buffer.isBuffer(C)?C.toString("binary"):K(C)).split(`\r
`),N=0,M="";for(N=0;N<D.length;++N)if(M=D[N],!!/^Content-Location:/i.test(M)&&(M=M.slice(M.indexOf("file")),I||(I=M.slice(0,M.lastIndexOf("/")+1)),M.slice(0,I.length)!=I))for(;I.length>0&&(I=I.slice(0,I.length-1),I=I.slice(0,I.lastIndexOf("/")+1),M.slice(0,I.length)!=I););var ae=(D[1]||"").match(/boundary="(.*?)"/);if(!ae)throw new Error("MAD cannot find boundary");var pe="--"+(ae[1]||""),re=[],se=[],ie={FileIndex:re,FullPaths:se};P(ie);var be,Fe=0;for(N=0;N<D.length;++N){var Ne=D[N];Ne!==pe&&Ne!==pe+"--"||(Fe++&&Mi(ie,D.slice(be,N),I),be=N)}return ie}function Ds(C,F){var I=F||{},D=I.boundary||"SheetJS";D="------="+D;for(var N=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+D.slice(2)+'"',"","",""],M=C.FullPaths[0],ae=M,pe=C.FileIndex[0],re=1;re<C.FullPaths.length;++re)if(ae=C.FullPaths[re].slice(M.length),pe=C.FileIndex[re],!(!pe.size||!pe.content||ae=="Sh33tJ5")){ae=ae.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(et){return"_x"+et.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(et){return"_u"+et.charCodeAt(0).toString(16)+"_"});for(var se=pe.content,ie=st&&Buffer.isBuffer(se)?se.toString("binary"):K(se),be=0,Fe=Math.min(1024,ie.length),Ne=0,Ae=0;Ae<=Fe;++Ae)(Ne=ie.charCodeAt(Ae))>=32&&Ne<128&&++be;var Ce=be>=Fe*4/5;N.push(D),N.push("Content-Location: "+(I.root||"file:///C:/SheetJS/")+ae),N.push("Content-Transfer-Encoding: "+(Ce?"quoted-printable":"base64")),N.push("Content-Type: "+kc(pe,ae)),N.push(""),N.push(Ce?Cc(ie):Tc(ie))}return N.push(D+`--\r
`),N.join(`\r
`)}function Bi(C){var F={};return P(F,C),F}function ba(C,F,I,D){var N=D&&D.unsafe;N||P(C);var M=!N&&Ve.find(C,F);if(!M){var ae=C.FullPaths[0];F.slice(0,ae.length)==ae?ae=F:(ae.slice(-1)!="/"&&(ae+="/"),ae=(ae+F).replace("//","/")),M={name:a(F),type:2},C.FileIndex.push(M),C.FullPaths.push(ae),N||Ve.utils.cfb_gc(C)}return M.content=I,M.size=I?I.length:0,D&&(D.CLSID&&(M.clsid=D.CLSID),D.mt&&(M.mt=D.mt),D.ct&&(M.ct=D.ct)),M}function Gf(C,F){P(C);var I=Ve.find(C,F);if(I){for(var D=0;D<C.FileIndex.length;++D)if(C.FileIndex[D]==I)return C.FileIndex.splice(D,1),C.FullPaths.splice(D,1),!0}return!1}function Fs(C,F,I){P(C);var D=Ve.find(C,F);if(D){for(var N=0;N<C.FileIndex.length;++N)if(C.FileIndex[N]==D)return C.FileIndex[N].name=a(I),C.FullPaths[N]=I,!0}return!1}function Ao(C){V(C,!0)}return t.find=ee,t.read=L,t.parse=h,t.write=fe,t.writeFile=ge,t.utils={cfb_new:Bi,cfb_add:ba,cfb_del:Gf,cfb_mov:Fs,cfb_gc:Ao,ReadShift:Dl,CheckField:M_,prep_blob:Ar,bconcat:Er,use_zlib:A,_deflateRaw:tt,_inflateRaw:ko,consts:oe},t})();function kI(e){return typeof e=="string"?Mf(e):Array.isArray(e)?YP(e):e}function mc(e,t,r){if(typeof Deno<"u"){if(r&&typeof t=="string")switch(r){case"utf8":t=new TextEncoder(r).encode(t);break;case"binary":t=Mf(t);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(e,t)}var n=r=="utf8"?xa(t):t;if(typeof IE_SaveFile<"u")return IE_SaveFile(n,e);if(typeof Blob<"u"){var a=new Blob([kI(n)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(a,e);if(typeof saveAs<"u")return saveAs(a,e);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var s=URL.createObjectURL(a);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),chrome.downloads.download({url:s,filename:e,saveAs:!0});var i=document.createElement("a");if(i.download!=null)return i.download=e,i.href=s,document.body.appendChild(i),i.click(),document.body.removeChild(i),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),s}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var c=File(e);return c.open("w"),c.encoding="binary",Array.isArray(t)&&(t=As(t)),c.write(t),c.close(),t}catch(u){if(!u.message||!u.message.match(/onstruct/))throw u}throw new Error("cannot save file "+e)}function TI(e){if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var t=File(e);t.open("r"),t.encoding="binary";var r=t.read();return t.close(),r}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+e)}function Xt(e){for(var t=Object.keys(e),r=[],n=0;n<t.length;++n)Object.prototype.hasOwnProperty.call(e,t[n])&&r.push(t[n]);return r}function Kv(e,t){for(var r=[],n=Xt(e),a=0;a!==n.length;++a)r[e[n[a]][t]]==null&&(r[e[n[a]][t]]=n[a]);return r}function jf(e){for(var t=[],r=Xt(e),n=0;n!==r.length;++n)t[e[r[n]]]=r[n];return t}function $f(e){for(var t=[],r=Xt(e),n=0;n!==r.length;++n)t[e[r[n]]]=parseInt(r[n],10);return t}function CI(e){for(var t=[],r=Xt(e),n=0;n!==r.length;++n)t[e[r[n]]]==null&&(t[e[r[n]]]=[]),t[e[r[n]]].push(r[n]);return t}var xf=new Date(1899,11,30,0,0,0);function pr(e,t){var r=e.getTime(),n=xf.getTime()+(e.getTimezoneOffset()-xf.getTimezoneOffset())*6e4;return(r-n)/(1440*60*1e3)}var m_=new Date,AI=xf.getTime()+(m_.getTimezoneOffset()-xf.getTimezoneOffset())*6e4,Xv=m_.getTimezoneOffset();function Uf(e){var t=new Date;return t.setTime(e*24*60*60*1e3+AI),t.getTimezoneOffset()!==Xv&&t.setTime(t.getTime()+(t.getTimezoneOffset()-Xv)*6e4),t}function PI(e){var t=0,r=0,n=!1,a=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!a)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var s=1;s!=a.length;++s)if(a[s]){switch(r=1,s>3&&(n=!0),a[s].slice(a[s].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+a[s].slice(a[s].length-1));case"D":r*=24;case"H":r*=60;case"M":if(n)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}t+=r*parseInt(a[s],10)}return t}var Jv=new Date("2017-02-19T19:06:09.000Z"),v_=isNaN(Jv.getFullYear())?new Date("2/19/17"):Jv,II=v_.getFullYear()==2017;function Rt(e,t){var r=new Date(e);if(II)return t>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):t<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(e instanceof Date)return e;if(v_.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return e.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var a=e.match(/\d+/g)||["2017","2","19","0","0","0"],s=new Date(+a[0],+a[1]-1,+a[2],+a[3]||0,+a[4]||0,+a[5]||0);return e.indexOf("Z")>-1&&(s=new Date(s.getTime()-s.getTimezoneOffset()*60*1e3)),s}function uo(e,t){if(st&&Buffer.isBuffer(e)){if(t){if(e[0]==255&&e[1]==254)return xa(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return xa(a_(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(t){if(e[0]==255&&e[1]==254)return xa(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return xa(new TextDecoder("utf-16be").decode(e.slice(2)))}var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[]/g,function(s){return r[s]||s})}catch{}for(var n=[],a=0;a!=e.length;++a)n.push(String.fromCharCode(e[a]));return n.join("")}function Lt(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=Lt(e[r]));return t}function qt(e,t){for(var r="";r.length<t;)r+=e;return r}function oa(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,n=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(t=Number(n))||(n=n.replace(/[(](.*)[)]/,function(a,s){return r=-r,s}),!isNaN(t=Number(n)))?t/r:t}var OI=["january","february","march","april","may","june","july","august","september","october","november","december"];function _i(e){var t=new Date(e),r=new Date(NaN),n=t.getYear(),a=t.getMonth(),s=t.getDate();if(isNaN(s))return r;var i=e.toLowerCase();if(i.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(i=i.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),i.length>3&&OI.indexOf(i)==-1)return r}else if(i.match(/[a-z]/))return r;return n<0||n>8099?r:(a>0||s>1)&&n!=101?t:e.match(/[^-0-9:,\/\\]/)?r:t}var DI=(function(){var e="abacaba".split(/(:?b)/i).length==5;return function(r,n,a){if(e||typeof n=="string")return r.split(n);for(var s=r.split(n),i=[s[0]],c=1;c<s.length;++c)i.push(a),i.push(s[c]);return i}})();function x_(e){return e?e.content&&e.type?uo(e.content,!0):e.data?Tl(e.data):e.asNodeBuffer&&st?Tl(e.asNodeBuffer().toString("binary")):e.asBinary?Tl(e.asBinary()):e._data&&e._data.getContent?Tl(uo(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function y_(e){if(!e)return null;if(e.data)return Bv(e.data);if(e.asNodeBuffer&&st)return e.asNodeBuffer();if(e._data&&e._data.getContent){var t=e._data.getContent();return typeof t=="string"?Bv(t):Array.prototype.slice.call(t)}return e.content&&e.type?e.content:null}function FI(e){return e&&e.name.slice(-4)===".bin"?y_(e):x_(e)}function Bn(e,t){for(var r=e.FullPaths||Xt(e.files),n=t.toLowerCase().replace(/[\/]/g,"\\"),a=n.replace(/\\/g,"/"),s=0;s<r.length;++s){var i=r[s].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==i||a==i)return e.files?e.files[r[s]]:e.FileIndex[s]}return null}function Tg(e,t){var r=Bn(e,t);if(r==null)throw new Error("Cannot find file "+t+" in zip");return r}function lr(e,t,r){if(!r)return FI(Tg(e,t));if(!t)return null;try{return lr(e,t)}catch{return null}}function kn(e,t,r){if(!r)return x_(Tg(e,t));if(!t)return null;try{return kn(e,t)}catch{return null}}function RI(e,t,r){return y_(Tg(e,t))}function Yv(e){for(var t=e.FullPaths||Xt(e.files),r=[],n=0;n<t.length;++n)t[n].slice(-1)!="/"&&r.push(t[n].replace(/^Root Entry[\/]/,""));return r.sort()}function nt(e,t,r){if(e.FullPaths){if(typeof r=="string"){var n;return st?n=Wa(r):n=QP(r),Ve.utils.cfb_add(e,t,n)}Ve.utils.cfb_add(e,t,r)}else e.file(t,r)}function Cg(){return Ve.utils.cfb_new()}function w_(e,t){switch(t.type){case"base64":return Ve.read(e,{type:"base64"});case"binary":return Ve.read(e,{type:"binary"});case"buffer":case"array":return Ve.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+t.type)}function Al(e,t){if(e.charAt(0)=="/")return e.slice(1);var r=t.split("/");t.slice(-1)!="/"&&r.pop();for(var n=e.split("/");n.length!==0;){var a=n.shift();a===".."?r.pop():a!=="."&&r.push(a)}return r.join("/")}var ar=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,LI=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,Qv=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,NI=/<[^>]*>/g,Kr=ar.match(Qv)?Qv:NI,MI=/<\w*:/,BI=/<(\/?)\w+:/;function Je(e,t,r){for(var n={},a=0,s=0;a!==e.length&&!((s=e.charCodeAt(a))===32||s===10||s===13);++a);if(t||(n[0]=e.slice(0,a)),a===e.length)return n;var i=e.match(LI),c=0,u="",f=0,h="",p="",m=1;if(i)for(f=0;f!=i.length;++f){for(p=i[f],s=0;s!=p.length&&p.charCodeAt(s)!==61;++s);for(h=p.slice(0,s).trim();p.charCodeAt(s+1)==32;)++s;for(m=(a=p.charCodeAt(s+1))==34||a==39?1:0,u=p.slice(s+1+m,p.length-m),c=0;c!=h.length&&h.charCodeAt(c)!==58;++c);if(c===h.length)h.indexOf("_")>0&&(h=h.slice(0,h.indexOf("_"))),n[h]=u,n[h.toLowerCase()]=u;else{var y=(c===5&&h.slice(0,5)==="xmlns"?"xmlns":"")+h.slice(c+1);if(n[y]&&h.slice(c-3,c)=="ext")continue;n[y]=u,n[y.toLowerCase()]=u}}return n}function wa(e){return e.replace(BI,"<$1")}var __={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},Ag=jf(__),pt=(function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,t=/_x([\da-fA-F]{4})_/ig;return function r(n){var a=n+"",s=a.indexOf("<![CDATA[");if(s==-1)return a.replace(e,function(c,u){return __[c]||String.fromCharCode(parseInt(u,c.indexOf("x")>-1?16:10))||c}).replace(t,function(c,u){return String.fromCharCode(parseInt(u,16))});var i=a.indexOf("]]>");return r(a.slice(0,s))+a.slice(s+9,i)+r(a.slice(i+3))}})(),Pg=/[&<>'"]/g,jI=/[\u0000-\u0008\u000b-\u001f]/g;function bt(e){var t=e+"";return t.replace(Pg,function(r){return Ag[r]}).replace(jI,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function Zv(e){return bt(e).replace(/ /g,"_x0020_")}var S_=/[\u0000-\u001f]/g;function Ig(e){var t=e+"";return t.replace(Pg,function(r){return Ag[r]}).replace(/\n/g,"<br/>").replace(S_,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function $I(e){var t=e+"";return t.replace(Pg,function(r){return Ag[r]}).replace(S_,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}var ex=(function(){var e=/&#(\d+);/g;function t(r,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(e,t)}})();function UI(e){return e.replace(/(\r\n|[\r\n])/g,"&#10;")}function Ft(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function Yd(e){for(var t="",r=0,n=0,a=0,s=0,i=0,c=0;r<e.length;){if(n=e.charCodeAt(r++),n<128){t+=String.fromCharCode(n);continue}if(a=e.charCodeAt(r++),n>191&&n<224){i=(n&31)<<6,i|=a&63,t+=String.fromCharCode(i);continue}if(s=e.charCodeAt(r++),n<240){t+=String.fromCharCode((n&15)<<12|(a&63)<<6|s&63);continue}i=e.charCodeAt(r++),c=((n&7)<<18|(a&63)<<12|(s&63)<<6|i&63)-65536,t+=String.fromCharCode(55296+(c>>>10&1023)),t+=String.fromCharCode(56320+(c&1023))}return t}function tx(e){var t=Ss(2*e.length),r,n,a=1,s=0,i=0,c;for(n=0;n<e.length;n+=a)a=1,(c=e.charCodeAt(n))<128?r=c:c<224?(r=(c&31)*64+(e.charCodeAt(n+1)&63),a=2):c<240?(r=(c&15)*4096+(e.charCodeAt(n+1)&63)*64+(e.charCodeAt(n+2)&63),a=3):(a=4,r=(c&7)*262144+(e.charCodeAt(n+1)&63)*4096+(e.charCodeAt(n+2)&63)*64+(e.charCodeAt(n+3)&63),r-=65536,i=55296+(r>>>10&1023),r=56320+(r&1023)),i!==0&&(t[s++]=i&255,t[s++]=i>>>8,i=0),t[s++]=r%256,t[s++]=r>>>8;return t.slice(0,s).toString("ucs2")}function rx(e){return Wa(e,"binary").toString("utf8")}var Ku="foo bar baz",kt=st&&(rx(Ku)==Yd(Ku)&&rx||tx(Ku)==Yd(Ku)&&tx)||Yd,xa=st?function(e){return Wa(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,n=0,a=0;r<e.length;)switch(n=e.charCodeAt(r++),!0){case n<128:t.push(String.fromCharCode(n));break;case n<2048:t.push(String.fromCharCode(192+(n>>6))),t.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,a=e.charCodeAt(r++)-56320+(n<<10),t.push(String.fromCharCode(240+(a>>18&7))),t.push(String.fromCharCode(144+(a>>12&63))),t.push(String.fromCharCode(128+(a>>6&63))),t.push(String.fromCharCode(128+(a&63)));break;default:t.push(String.fromCharCode(224+(n>>12))),t.push(String.fromCharCode(128+(n>>6&63))),t.push(String.fromCharCode(128+(n&63)))}return t.join("")},Ql=(function(){var e={};return function(r,n){var a=r+"|"+(n||"");return e[a]?e[a]:e[a]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",n||"")}})(),E_=(function(){var e=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),a=0;a<e.length;++a)n=n.replace(e[a][0],e[a][1]);return n}})(),zI=(function(){var e={};return function(r){return e[r]!==void 0?e[r]:e[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}})(),VI=/<\/?(?:vt:)?variant>/g,WI=/<(?:vt:)([^>]*)>([\s\S]*)</;function nx(e,t){var r=Je(e),n=e.match(zI(r.baseType))||[],a=[];if(n.length!=r.size){if(t.WTF)throw new Error("unexpected vector length "+n.length+" != "+r.size);return a}return n.forEach(function(s){var i=s.replace(VI,"").match(WI);i&&a.push({v:kt(i[2]),t:i[1]})}),a}var b_=/(^\s|\s$|\n)/;function Pr(e,t){return"<"+e+(t.match(b_)?' xml:space="preserve"':"")+">"+t+"</"+e+">"}function Zl(e){return Xt(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function Oe(e,t,r){return"<"+e+(r!=null?Zl(r):"")+(t!=null?(t.match(b_)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function $h(e,t){try{return e.toISOString().replace(/\.\d*/,"")}catch(r){if(t)throw r}return""}function HI(e,t){switch(typeof e){case"string":var r=Oe("vt:lpwstr",bt(e));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return Oe((e|0)==e?"vt:i4":"vt:r8",bt(String(e)));case"boolean":return Oe("vt:bool",e?"true":"false")}if(e instanceof Date)return Oe("vt:filetime",$h(e));throw new Error("Unable to serialize "+e)}function Og(e){if(st&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return kt(As(Eg(e)));throw new Error("Bad input format: expected Buffer or string")}var ec=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,gr={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},yo=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],yn={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function GI(e,t){for(var r=1-2*(e[t+7]>>>7),n=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),a=e[t+6]&15,s=5;s>=0;--s)a=a*256+e[t+s];return n==2047?a==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,a+=Math.pow(2,52)),r*Math.pow(2,n-52)*a)}function qI(e,t,r){var n=(t<0||1/t==-1/0?1:0)<<7,a=0,s=0,i=n?-t:t;isFinite(i)?i==0?a=s=0:(a=Math.floor(Math.log(i)/Math.LN2),s=i*Math.pow(2,52-a),a<=-1023&&(!isFinite(s)||s<Math.pow(2,52))?a=-1022:(s-=Math.pow(2,52),a+=1023)):(a=2047,s=isNaN(t)?26985:0);for(var c=0;c<=5;++c,s/=256)e[r+c]=s&255;e[r+6]=(a&15)<<4|s&15,e[r+7]=a>>4|n}var ax=function(e){for(var t=[],r=10240,n=0;n<e[0].length;++n)if(e[0][n])for(var a=0,s=e[0][n].length;a<s;a+=r)t.push.apply(t,e[0][n].slice(a,a+r));return t},sx=st?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:Wa(t)})):ax(e)}:ax,ox=function(e,t,r){for(var n=[],a=t;a<r;a+=2)n.push(String.fromCharCode(La(e,a)));return n.join("").replace(en,"")},Dg=st?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(en,""):ox(e,t,r)}:ox,ix=function(e,t,r){for(var n=[],a=t;a<t+r;++a)n.push(("0"+e[a].toString(16)).slice(-2));return n.join("")},k_=st?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):ix(e,t,r)}:ix,lx=function(e,t,r){for(var n=[],a=t;a<r;a++)n.push(String.fromCharCode(li(e,a)));return n.join("")},vc=st?function(t,r,n){return Buffer.isBuffer(t)?t.toString("utf8",r,n):lx(t,r,n)}:lx,T_=function(e,t){var r=wn(e,t);return r>0?vc(e,t+4,t+4+r-1):""},C_=T_,A_=function(e,t){var r=wn(e,t);return r>0?vc(e,t+4,t+4+r-1):""},P_=A_,I_=function(e,t){var r=2*wn(e,t);return r>0?vc(e,t+4,t+4+r-1):""},O_=I_,D_=function(t,r){var n=wn(t,r);return n>0?Dg(t,r+4,r+4+n):""},F_=D_,R_=function(e,t){var r=wn(e,t);return r>0?vc(e,t+4,t+4+r):""},L_=R_,N_=function(e,t){return GI(e,t)},yf=N_,Fg=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};st&&(C_=function(t,r){if(!Buffer.isBuffer(t))return T_(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},P_=function(t,r){if(!Buffer.isBuffer(t))return A_(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},O_=function(t,r){if(!Buffer.isBuffer(t))return I_(t,r);var n=2*t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n-1)},F_=function(t,r){if(!Buffer.isBuffer(t))return D_(t,r);var n=t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n)},L_=function(t,r){if(!Buffer.isBuffer(t))return R_(t,r);var n=t.readUInt32LE(r);return t.toString("utf8",r+4,r+4+n)},yf=function(t,r){return Buffer.isBuffer(t)?t.readDoubleLE(r):N_(t,r)},Fg=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var li=function(e,t){return e[t]},La=function(e,t){return e[t+1]*256+e[t]},KI=function(e,t){var r=e[t+1]*256+e[t];return r<32768?r:(65535-r+1)*-1},wn=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},Zs=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},XI=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function Dl(e,t){var r="",n,a,s=[],i,c,u,f;switch(t){case"dbcs":if(f=this.l,st&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*e).toString("utf16le");else for(u=0;u<e;++u)r+=String.fromCharCode(La(this,f)),f+=2;e*=2;break;case"utf8":r=vc(this,this.l,this.l+e);break;case"utf16le":e*=2,r=Dg(this,this.l,this.l+e);break;case"wstr":return Dl.call(this,e,"dbcs");case"lpstr-ansi":r=C_(this,this.l),e=4+wn(this,this.l);break;case"lpstr-cp":r=P_(this,this.l),e=4+wn(this,this.l);break;case"lpwstr":r=O_(this,this.l),e=4+2*wn(this,this.l);break;case"lpp4":e=4+wn(this,this.l),r=F_(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+wn(this,this.l),r=L_(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,r="";(i=li(this,this.l+e++))!==0;)s.push(qu(i));r=s.join("");break;case"_wstr":for(e=0,r="";(i=La(this,this.l+e))!==0;)s.push(qu(i)),e+=2;e+=2,r=s.join("");break;case"dbcs-cont":for(r="",f=this.l,u=0;u<e;++u){if(this.lens&&this.lens.indexOf(f)!==-1)return i=li(this,f),this.l=f+1,c=Dl.call(this,e-u,i?"dbcs-cont":"sbcs-cont"),s.join("")+c;s.push(qu(La(this,f))),f+=2}r=s.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(r="",f=this.l,u=0;u!=e;++u){if(this.lens&&this.lens.indexOf(f)!==-1)return i=li(this,f),this.l=f+1,c=Dl.call(this,e-u,i?"dbcs-cont":"sbcs-cont"),s.join("")+c;s.push(qu(li(this,f))),f+=1}r=s.join("");break;default:switch(e){case 1:return n=li(this,this.l),this.l++,n;case 2:return n=(t==="i"?KI:La)(this,this.l),this.l+=2,n;case 4:case-4:return t==="i"||(this[this.l+3]&128)===0?(n=(e>0?Zs:XI)(this,this.l),this.l+=4,n):(a=wn(this,this.l),this.l+=4,a);case 8:case-8:if(t==="f")return e==8?a=yf(this,this.l):a=yf([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,a;e=8;case 16:r=k_(this,this.l,e);break}}return this.l+=e,r}var JI=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},YI=function(e,t,r){e[r]=t&255,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},QI=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255};function ZI(e,t,r){var n=0,a=0;if(r==="dbcs"){for(a=0;a!=t.length;++a)QI(this,t.charCodeAt(a),this.l+2*a);n=2*t.length}else if(r==="sbcs"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),a=0;a!=t.length;++a)this[this.l+a]=t.charCodeAt(a)&255;n=t.length}else if(r==="hex"){for(;a<e;++a)this[this.l++]=parseInt(t.slice(2*a,2*a+2),16)||0;return this}else if(r==="utf16le"){var s=Math.min(this.l+e,this.length);for(a=0;a<Math.min(t.length,e);++a){var i=t.charCodeAt(a);this[this.l++]=i&255,this[this.l++]=i>>8}for(;this.l<s;)this[this.l++]=0;return this}else switch(e){case 1:n=1,this[this.l]=t&255;break;case 2:n=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:n=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:n=4,JI(this,t,this.l);break;case 8:if(n=8,r==="f"){qI(this,t,this.l);break}case 16:break;case-4:n=4,YI(this,t,this.l);break}return this.l+=n,this}function M_(e,t){var r=k_(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function Ar(e,t){e.l=t,e.read_shift=Dl,e.chk=M_,e.write_shift=ZI}function Gr(e,t){e.l+=t}function de(e){var t=Ss(e);return Ar(t,0),t}function Ha(e,t,r){if(e){var n,a,s;Ar(e,e.l||0);for(var i=e.length,c=0,u=0;e.l<i;){c=e.read_shift(1),c&128&&(c=(c&127)+((e.read_shift(1)&127)<<7));var f=oc[c]||oc[65535];for(n=e.read_shift(1),s=n&127,a=1;a<4&&n&128;++a)s+=((n=e.read_shift(1))&127)<<7*a;u=e.l+s;var h=f.f&&f.f(e,s,r);if(e.l=u,t(h,f,c))return}}}function un(){var e=[],t=st?256:2048,r=function(f){var h=de(f);return Ar(h,0),h},n=r(t),a=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&e.push(n),n=null)},s=function(f){return n&&f<n.length-n.l?n:(a(),n=r(Math.max(f+1,t)))},i=function(){return a(),Er(e)},c=function(f){a(),n=f,n.l==null&&(n.l=n.length),s(t)};return{next:s,push:c,end:i,_bufs:e}}function we(e,t,r,n){var a=+t,s;if(!isNaN(a)){n||(n=oc[a].p||(r||[]).length||0),s=1+(a>=128?1:0)+1,n>=128&&++s,n>=16384&&++s,n>=2097152&&++s;var i=e.next(s);a<=127?i.write_shift(1,a):(i.write_shift(1,(a&127)+128),i.write_shift(1,a>>7));for(var c=0;c!=4;++c)if(n>=128)i.write_shift(1,(n&127)+128),n>>=7;else{i.write_shift(1,n);break}n>0&&Fg(r)&&e.push(r)}}function Fl(e,t,r){var n=Lt(e);if(t.s?(n.cRel&&(n.c+=t.s.c),n.rRel&&(n.r+=t.s.r)):(n.cRel&&(n.c+=t.c),n.rRel&&(n.r+=t.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function cx(e,t,r){var n=Lt(e);return n.s=Fl(n.s,t.s,r),n.e=Fl(n.e,t.s,r),n}function Rl(e,t){if(e.cRel&&e.c<0)for(e=Lt(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=Lt(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=qe(e);return!e.cRel&&e.cRel!=null&&(r=r3(r)),!e.rRel&&e.rRel!=null&&(r=e3(r)),r}function Qd(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+zt(e.s.c)+":"+(e.e.cRel?"":"$")+zt(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+rr(e.s.r)+":"+(e.e.rRel?"":"$")+rr(e.e.r):Rl(e.s,t.biff)+":"+Rl(e.e,t.biff)}function Rg(e){return parseInt(t3(e),10)-1}function rr(e){return""+(e+1)}function e3(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function t3(e){return e.replace(/\$(\d+)$/,"$1")}function Lg(e){for(var t=n3(e),r=0,n=0;n!==t.length;++n)r=26*r+t.charCodeAt(n)-64;return r-1}function zt(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function r3(e){return e.replace(/^([A-Z])/,"$$$1")}function n3(e){return e.replace(/^\$([A-Z])/,"$1")}function a3(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Vt(e){for(var t=0,r=0,n=0;n<e.length;++n){var a=e.charCodeAt(n);a>=48&&a<=57?t=10*t+(a-48):a>=65&&a<=90&&(r=26*r+(a-64))}return{c:r-1,r:t-1}}function qe(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function fn(e){var t=e.indexOf(":");return t==-1?{s:Vt(e),e:Vt(e)}:{s:Vt(e.slice(0,t)),e:Vt(e.slice(t+1))}}function rt(e,t){return typeof t>"u"||typeof t=="number"?rt(e.s,e.e):(typeof e!="string"&&(e=qe(e)),typeof t!="string"&&(t=qe(t)),e==t?e:e+":"+t)}function mt(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,a=0,s=e.length;for(r=0;n<s&&!((a=e.charCodeAt(n)-64)<1||a>26);++n)r=26*r+a;for(t.s.c=--r,r=0;n<s&&!((a=e.charCodeAt(n)-48)<0||a>9);++n)r=10*r+a;if(t.s.r=--r,n===s||a!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++n,r=0;n!=s&&!((a=e.charCodeAt(n)-64)<1||a>26);++n)r=26*r+a;for(t.e.c=--r,r=0;n!=s&&!((a=e.charCodeAt(n)-48)<0||a>9);++n)r=10*r+a;return t.e.r=--r,t}function ux(e,t){var r=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=Un(e.z,r?pr(t):t)}catch{}try{return e.w=Un((e.XF||{}).numFmtId||(r?14:0),r?pr(t):t)}catch{return""+t}}function $a(e,t,r){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),e.t=="e"?Ga[e.v]||e.v:t==null?ux(e,e.v):ux(e,t))}function Ps(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",n={};return n[r]=e,{SheetNames:[r],Sheets:n}}function B_(e,t,r){var n=r||{},a=e?Array.isArray(e):n.dense,s=e||(a?[]:{}),i=0,c=0;if(s&&n.origin!=null){if(typeof n.origin=="number")i=n.origin;else{var u=typeof n.origin=="string"?Vt(n.origin):n.origin;i=u.r,c=u.c}s["!ref"]||(s["!ref"]="A1:A1")}var f={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(s["!ref"]){var h=mt(s["!ref"]);f.s.c=h.s.c,f.s.r=h.s.r,f.e.c=Math.max(f.e.c,h.e.c),f.e.r=Math.max(f.e.r,h.e.r),i==-1&&(f.e.r=i=h.e.r+1)}for(var p=0;p!=t.length;++p)if(t[p]){if(!Array.isArray(t[p]))throw new Error("aoa_to_sheet expects an array of arrays");for(var m=0;m!=t[p].length;++m)if(!(typeof t[p][m]>"u")){var y={v:t[p][m]},w=i+p,x=c+m;if(f.s.r>w&&(f.s.r=w),f.s.c>x&&(f.s.c=x),f.e.r<w&&(f.e.r=w),f.e.c<x&&(f.e.c=x),t[p][m]&&typeof t[p][m]=="object"&&!Array.isArray(t[p][m])&&!(t[p][m]instanceof Date))y=t[p][m];else if(Array.isArray(y.v)&&(y.f=t[p][m][1],y.v=y.v[0]),y.v===null)if(y.f)y.t="n";else if(n.nullError)y.t="e",y.v=0;else if(n.sheetStubs)y.t="z";else continue;else typeof y.v=="number"?y.t="n":typeof y.v=="boolean"?y.t="b":y.v instanceof Date?(y.z=n.dateNF||Ge[14],n.cellDates?(y.t="d",y.w=Un(y.z,pr(y.v))):(y.t="n",y.v=pr(y.v),y.w=Un(y.z,y.v))):y.t="s";if(a)s[w]||(s[w]=[]),s[w][x]&&s[w][x].z&&(y.z=s[w][x].z),s[w][x]=y;else{var _=qe({c:x,r:w});s[_]&&s[_].z&&(y.z=s[_].z),s[_]=y}}}return f.s.c<1e7&&(s["!ref"]=rt(f)),s}function Fi(e,t){return B_(null,e,t)}function s3(e){return e.read_shift(4,"i")}function ia(e,t){return t||(t=de(4)),t.write_shift(4,e),t}function Hr(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function br(e,t){var r=!1;return t==null&&(r=!0,t=de(4+2*e.length)),t.write_shift(4,e.length),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}function o3(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function i3(e,t){return t||(t=de(4)),t.write_shift(2,0),t.write_shift(2,0),t}function Ng(e,t){var r=e.l,n=e.read_shift(1),a=Hr(e),s=[],i={t:a,h:a};if((n&1)!==0){for(var c=e.read_shift(4),u=0;u!=c;++u)s.push(o3(e));i.r=s}else i.r=[{ich:0,ifnt:0}];return e.l=r+t,i}function l3(e,t){var r=!1;return t==null&&(r=!0,t=de(15+4*e.t.length)),t.write_shift(1,0),br(e.t,t),r?t.slice(0,t.l):t}var c3=Ng;function u3(e,t){var r=!1;return t==null&&(r=!0,t=de(23+4*e.t.length)),t.write_shift(1,1),br(e.t,t),t.write_shift(4,1),i3({},t),r?t.slice(0,t.l):t}function zn(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function wo(e,t){return t==null&&(t=de(8)),t.write_shift(-4,e.c),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}function _o(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}function So(e,t){return t==null&&(t=de(4)),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}var f3=Hr,j_=br;function Mg(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}function wf(e,t){var r=!1;return t==null&&(r=!0,t=de(127)),t.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}var d3=Hr,Uh=Mg,Bg=wf;function jg(e){var t=e.slice(e.l,e.l+4),r=t[0]&1,n=t[0]&2;e.l+=4;var a=n===0?yf([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):Zs(t,0)>>2;return r?a/100:a}function $_(e,t){t==null&&(t=de(4));var r=0,n=0,a=e*100;if(e==(e|0)&&e>=-536870912&&e<1<<29?n=1:a==(a|0)&&a>=-536870912&&a<1<<29&&(n=1,r=1),n)t.write_shift(-4,((r?a:e)<<2)+(r+2));else throw new Error("unsupported RkNumber "+e)}function U_(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}function h3(e,t){return t||(t=de(16)),t.write_shift(4,e.s.r),t.write_shift(4,e.e.r),t.write_shift(4,e.s.c),t.write_shift(4,e.e.c),t}var Eo=U_,Ri=h3;function Wr(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function fo(e,t){return(t||de(8)).write_shift(8,e,"f")}function g3(e){var t={},r=e.read_shift(1),n=r>>>1,a=e.read_shift(1),s=e.read_shift(2,"i"),i=e.read_shift(1),c=e.read_shift(1),u=e.read_shift(1);switch(e.l++,n){case 0:t.auto=1;break;case 1:t.index=a;var f=ao[a];f&&(t.rgb=rc(f));break;case 2:t.rgb=rc([i,c,u]);break;case 3:t.theme=a;break}return s!=0&&(t.tint=s>0?s/32767:s/32768),t}function _f(e,t){if(t||(t=de(8)),!e||e.auto)return t.write_shift(4,0),t.write_shift(4,0),t;e.index!=null?(t.write_shift(1,2),t.write_shift(1,e.index)):e.theme!=null?(t.write_shift(1,6),t.write_shift(1,e.theme)):(t.write_shift(1,5),t.write_shift(1,0));var r=e.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),t.write_shift(2,r),!e.rgb||e.theme!=null)t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);else{var n=e.rgb||"FFFFFF";typeof n=="number"&&(n=("000000"+n.toString(16)).slice(-6)),t.write_shift(1,parseInt(n.slice(0,2),16)),t.write_shift(1,parseInt(n.slice(2,4),16)),t.write_shift(1,parseInt(n.slice(4,6),16)),t.write_shift(1,255)}return t}function p3(e){var t=e.read_shift(1);e.l++;var r={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return r}function m3(e,t){t||(t=de(2));var r=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);return t.write_shift(1,r),t.write_shift(1,0),t}function z_(e,t){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=e.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return r[e.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return e.l-=4,e.read_shift(0,t==1?"lpstr":"lpwstr")}function v3(e){return z_(e,1)}function x3(e){return z_(e,2)}var $g=2,cn=3,Xu=11,fx=12,Sf=19,Ju=64,y3=65,w3=71,_3=4108,S3=4126,_r=80,V_=81,E3=[_r,V_],zh={1:{n:"CodePage",t:$g},2:{n:"Category",t:_r},3:{n:"PresentationFormat",t:_r},4:{n:"ByteCount",t:cn},5:{n:"LineCount",t:cn},6:{n:"ParagraphCount",t:cn},7:{n:"SlideCount",t:cn},8:{n:"NoteCount",t:cn},9:{n:"HiddenCount",t:cn},10:{n:"MultimediaClipCount",t:cn},11:{n:"ScaleCrop",t:Xu},12:{n:"HeadingPairs",t:_3},13:{n:"TitlesOfParts",t:S3},14:{n:"Manager",t:_r},15:{n:"Company",t:_r},16:{n:"LinksUpToDate",t:Xu},17:{n:"CharacterCount",t:cn},19:{n:"SharedDoc",t:Xu},22:{n:"HyperlinksChanged",t:Xu},23:{n:"AppVersion",t:cn,p:"version"},24:{n:"DigSig",t:y3},26:{n:"ContentType",t:_r},27:{n:"ContentStatus",t:_r},28:{n:"Language",t:_r},29:{n:"Version",t:_r},255:{},2147483648:{n:"Locale",t:Sf},2147483651:{n:"Behavior",t:Sf},1919054434:{}},Vh={1:{n:"CodePage",t:$g},2:{n:"Title",t:_r},3:{n:"Subject",t:_r},4:{n:"Author",t:_r},5:{n:"Keywords",t:_r},6:{n:"Comments",t:_r},7:{n:"Template",t:_r},8:{n:"LastAuthor",t:_r},9:{n:"RevNumber",t:_r},10:{n:"EditTime",t:Ju},11:{n:"LastPrinted",t:Ju},12:{n:"CreatedDate",t:Ju},13:{n:"ModifiedDate",t:Ju},14:{n:"PageCount",t:cn},15:{n:"WordCount",t:cn},16:{n:"CharCount",t:cn},17:{n:"Thumbnail",t:w3},18:{n:"Application",t:_r},19:{n:"DocSecurity",t:cn},255:{},2147483648:{n:"Locale",t:Sf},2147483651:{n:"Behavior",t:Sf},1919054434:{}},dx={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},b3=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function k3(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var T3=k3([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),ao=Lt(T3),Ga={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},W_={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},Wh={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},Yu={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function Ug(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function C3(e){var t=Ug();if(!e||!e.match)return t;var r={};if((e.match(Kr)||[]).forEach(function(n){var a=Je(n);switch(a[0].replace(MI,"<")){case"<?xml":break;case"<Types":t.xmlns=a["xmlns"+(a[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[a.Extension]=a.ContentType;break;case"<Override":t[Wh[a.ContentType]]!==void 0&&t[Wh[a.ContentType]].push(a.PartName);break}}),t.xmlns!==gr.CT)throw new Error("Unknown Namespace: "+t.xmlns);return t.calcchain=t.calcchains.length>0?t.calcchains[0]:"",t.sst=t.strs.length>0?t.strs[0]:"",t.style=t.styles.length>0?t.styles[0]:"",t.defaults=r,delete t.calcchains,t}function H_(e,t){var r=CI(Wh),n=[],a;n[n.length]=ar,n[n.length]=Oe("Types",null,{xmlns:gr.CT,"xmlns:xsd":gr.xsd,"xmlns:xsi":gr.xsi}),n=n.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(u){return Oe("Default",null,{Extension:u[0],ContentType:u[1]})}));var s=function(u){e[u]&&e[u].length>0&&(a=e[u][0],n[n.length]=Oe("Override",null,{PartName:(a[0]=="/"?"":"/")+a,ContentType:Yu[u][t.bookType]||Yu[u].xlsx}))},i=function(u){(e[u]||[]).forEach(function(f){n[n.length]=Oe("Override",null,{PartName:(f[0]=="/"?"":"/")+f,ContentType:Yu[u][t.bookType]||Yu[u].xlsx})})},c=function(u){(e[u]||[]).forEach(function(f){n[n.length]=Oe("Override",null,{PartName:(f[0]=="/"?"":"/")+f,ContentType:r[u][0]})})};return s("workbooks"),i("sheets"),i("charts"),c("themes"),["strs","styles"].forEach(s),["coreprops","extprops","custprops"].forEach(c),c("vba"),c("comments"),c("threadedcomments"),c("drawings"),i("metadata"),c("people"),n.length>2&&(n[n.length]="</Types>",n[1]=n[1].replace("/>",">")),n.join("")}var ct={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function tc(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function Ll(e,t){var r={"!id":{}};if(!e)return r;t.charAt(0)!=="/"&&(t="/"+t);var n={};return(e.match(Kr)||[]).forEach(function(a){var s=Je(a);if(s[0]==="<Relationship"){var i={};i.Type=s.Type,i.Target=s.Target,i.Id=s.Id,s.TargetMode&&(i.TargetMode=s.TargetMode);var c=s.TargetMode==="External"?s.Target:Al(s.Target,t);r[c]=i,n[s.Id]=i}}),r["!id"]=n,r}function gi(e){var t=[ar,Oe("Relationships",null,{xmlns:gr.RELS})];return Xt(e["!id"]).forEach(function(r){t[t.length]=Oe("Relationship",null,e["!id"][r])}),t.length>2&&(t[t.length]="</Relationships>",t[1]=t[1].replace("/>",">")),t.join("")}function Et(e,t,r,n,a,s){if(a||(a={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),t<0)for(t=e["!idx"];e["!id"]["rId"+t];++t);if(e["!idx"]=t+1,a.Id="rId"+t,a.Type=n,a.Target=r,[ct.HLINK,ct.XPATH,ct.XMISS].indexOf(a.Type)>-1&&(a.TargetMode="External"),e["!id"][a.Id])throw new Error("Cannot rewrite rId "+t);return e["!id"][a.Id]=a,e[("/"+a.Target).replace("//","/")]=a,t}var A3="application/vnd.oasis.opendocument.spreadsheet";function P3(e,t){for(var r=Og(e),n,a;n=ec.exec(r);)switch(n[3]){case"manifest":break;case"file-entry":if(a=Je(n[0],!1),a.path=="/"&&a.type!==A3)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(t&&t.WTF)throw n}}function I3(e){var t=[ar];t.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),t.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<e.length;++r)t.push('  <manifest:file-entry manifest:full-path="'+e[r][0]+'" manifest:media-type="'+e[r][1]+`"/>
`);return t.push("</manifest:manifest>"),t.join("")}function hx(e,t,r){return['  <rdf:Description rdf:about="'+e+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+t+`"/>
`,`  </rdf:Description>
`].join("")}function O3(e,t){return['  <rdf:Description rdf:about="'+e+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+t+`"/>
`,`  </rdf:Description>
`].join("")}function D3(e){var t=[ar];t.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=e.length;++r)t.push(hx(e[r][0],e[r][1])),t.push(O3("",e[r][0]));return t.push(hx("","Document","pkg")),t.push("</rdf:RDF>"),t.join("")}function G_(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+gf.version+"</meta:generator></office:meta></office:document-meta>"}var $n=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],F3=(function(){for(var e=new Array($n.length),t=0;t<$n.length;++t){var r=$n[t],n="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);e[t]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return e})();function q_(e){var t={};e=kt(e);for(var r=0;r<$n.length;++r){var n=$n[r],a=e.match(F3[r]);a!=null&&a.length>0&&(t[n[1]]=pt(a[1])),n[2]==="date"&&t[n[1]]&&(t[n[1]]=Rt(t[n[1]]))}return t}function Zd(e,t,r,n,a){a[e]!=null||t==null||t===""||(a[e]=t,t=bt(t),n[n.length]=r?Oe(e,t,r):Pr(e,t))}function K_(e,t){var r=t||{},n=[ar,Oe("cp:coreProperties",null,{"xmlns:cp":gr.CORE_PROPS,"xmlns:dc":gr.dc,"xmlns:dcterms":gr.dcterms,"xmlns:dcmitype":gr.dcmitype,"xmlns:xsi":gr.xsi})],a={};if(!e&&!r.Props)return n.join("");e&&(e.CreatedDate!=null&&Zd("dcterms:created",typeof e.CreatedDate=="string"?e.CreatedDate:$h(e.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,a),e.ModifiedDate!=null&&Zd("dcterms:modified",typeof e.ModifiedDate=="string"?e.ModifiedDate:$h(e.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,a));for(var s=0;s!=$n.length;++s){var i=$n[s],c=r.Props&&r.Props[i[1]]!=null?r.Props[i[1]]:e?e[i[1]]:null;c===!0?c="1":c===!1?c="0":typeof c=="number"&&(c=String(c)),c!=null&&Zd(i[0],c,null,n,a)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var so=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],X_=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function J_(e,t,r,n){var a=[];if(typeof e=="string")a=nx(e,n);else for(var s=0;s<e.length;++s)a=a.concat(e[s].map(function(h){return{v:h}}));var i=typeof t=="string"?nx(t,n).map(function(h){return h.v}):t,c=0,u=0;if(i.length>0)for(var f=0;f!==a.length;f+=2){switch(u=+a[f+1].v,a[f].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":r.Worksheets=u,r.SheetNames=i.slice(c,c+u);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":r.NamedRanges=u,r.DefinedNames=i.slice(c,c+u);break;case"Charts":case"Diagramme":r.Chartsheets=u,r.ChartNames=i.slice(c,c+u);break}c+=u}}function R3(e,t,r){var n={};return t||(t={}),e=kt(e),so.forEach(function(a){var s=(e.match(Ql(a[0]))||[])[1];switch(a[2]){case"string":s&&(t[a[1]]=pt(s));break;case"bool":t[a[1]]=s==="true";break;case"raw":var i=e.match(new RegExp("<"+a[0]+"[^>]*>([\\s\\S]*?)</"+a[0]+">"));i&&i.length>0&&(n[a[1]]=i[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&J_(n.HeadingPairs,n.TitlesOfParts,t,r),t}function Y_(e){var t=[],r=Oe;return e||(e={}),e.Application="SheetJS",t[t.length]=ar,t[t.length]=Oe("Properties",null,{xmlns:gr.EXT_PROPS,"xmlns:vt":gr.vt}),so.forEach(function(n){if(e[n[1]]!==void 0){var a;switch(n[2]){case"string":a=bt(String(e[n[1]]));break;case"bool":a=e[n[1]]?"true":"false";break}a!==void 0&&(t[t.length]=r(n[0],a))}}),t[t.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),t[t.length]=r("TitlesOfParts",r("vt:vector",e.SheetNames.map(function(n){return"<vt:lpstr>"+bt(n)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var L3=/<[^>]+>[^<]*/g;function N3(e,t){var r={},n="",a=e.match(L3);if(a)for(var s=0;s!=a.length;++s){var i=a[s],c=Je(i);switch(c[0]){case"<?xml":break;case"<Properties":break;case"<property":n=pt(c.name);break;case"</property>":n=null;break;default:if(i.indexOf("<vt:")===0){var u=i.split(">"),f=u[0].slice(4),h=u[1];switch(f){case"lpstr":case"bstr":case"lpwstr":r[n]=pt(h);break;case"bool":r[n]=Ft(h);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[n]=parseInt(h,10);break;case"r4":case"r8":case"decimal":r[n]=parseFloat(h);break;case"filetime":case"date":r[n]=Rt(h);break;case"cy":case"error":r[n]=pt(h);break;default:if(f.slice(-1)=="/")break;t.WTF&&typeof console<"u"&&console.warn("Unexpected",i,f,u)}}else if(i.slice(0,2)!=="</"){if(t.WTF)throw new Error(i)}}}return r}function Q_(e){var t=[ar,Oe("Properties",null,{xmlns:gr.CUST_PROPS,"xmlns:vt":gr.vt})];if(!e)return t.join("");var r=1;return Xt(e).forEach(function(a){++r,t[t.length]=Oe("property",HI(e[a]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:bt(a)})}),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var Hh={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},eh;function M3(e,t,r){eh||(eh=jf(Hh)),t=eh[t]||t,e[t]=r}function B3(e,t){var r=[];return Xt(Hh).map(function(n){for(var a=0;a<$n.length;++a)if($n[a][1]==n)return $n[a];for(a=0;a<so.length;++a)if(so[a][1]==n)return so[a];throw n}).forEach(function(n){if(e[n[1]]!=null){var a=t&&t.Props&&t.Props[n[1]]!=null?t.Props[n[1]]:e[n[1]];switch(n[2]){case"date":a=new Date(a).toISOString().replace(/\.\d*Z/,"Z");break}typeof a=="number"?a=String(a):a===!0||a===!1?a=a?"1":"0":a instanceof Date&&(a=new Date(a).toISOString().replace(/\.\d*Z/,"")),r.push(Pr(Hh[n[1]]||n[1],a))}}),Oe("DocumentProperties",r.join(""),{xmlns:yn.o})}function j3(e,t){var r=["Worksheets","SheetNames"],n="CustomDocumentProperties",a=[];return e&&Xt(e).forEach(function(s){if(Object.prototype.hasOwnProperty.call(e,s)){for(var i=0;i<$n.length;++i)if(s==$n[i][1])return;for(i=0;i<so.length;++i)if(s==so[i][1])return;for(i=0;i<r.length;++i)if(s==r[i])return;var c=e[s],u="string";typeof c=="number"?(u="float",c=String(c)):c===!0||c===!1?(u="boolean",c=c?"1":"0"):c=String(c),a.push(Oe(Zv(s),c,{"dt:dt":u}))}}),t&&Xt(t).forEach(function(s){if(Object.prototype.hasOwnProperty.call(t,s)&&!(e&&Object.prototype.hasOwnProperty.call(e,s))){var i=t[s],c="string";typeof i=="number"?(c="float",i=String(i)):i===!0||i===!1?(c="boolean",i=i?"1":"0"):i instanceof Date?(c="dateTime.tz",i=i.toISOString()):i=String(i),a.push(Oe(Zv(s),i,{"dt:dt":c}))}}),"<"+n+' xmlns="'+yn.o+'">'+a.join("")+"</"+n+">"}function zg(e){var t=e.read_shift(4),r=e.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+t/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function $3(e){var t=typeof e=="string"?new Date(Date.parse(e)):e,r=t.getTime()/1e3+11644473600,n=r%Math.pow(2,32),a=(r-n)/Math.pow(2,32);n*=1e7,a*=1e7;var s=n/Math.pow(2,32)|0;s>0&&(n=n%Math.pow(2,32),a+=s);var i=de(8);return i.write_shift(4,n),i.write_shift(4,a),i}function Z_(e,t,r){var n=e.l,a=e.read_shift(0,"lpstr-cp");if(r)for(;e.l-n&3;)++e.l;return a}function eS(e,t,r){var n=e.read_shift(0,"lpwstr");return n}function tS(e,t,r){return t===31?eS(e):Z_(e,t,r)}function Gh(e,t,r){return tS(e,t,r===!1?0:4)}function U3(e,t){if(!t)throw new Error("VtUnalignedString must have positive length");return tS(e,t,0)}function z3(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n){var a=e.l;r[n]=e.read_shift(0,"lpwstr").replace(en,""),e.l-a&2&&(e.l+=2)}return r}function V3(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n)r[n]=e.read_shift(0,"lpstr-cp").replace(en,"");return r}function W3(e){var t=e.l,r=Ef(e,V_);e[e.l]==0&&e[e.l+1]==0&&e.l-t&2&&(e.l+=2);var n=Ef(e,cn);return[r,n]}function H3(e){for(var t=e.read_shift(4),r=[],n=0;n<t/2;++n)r.push(W3(e));return r}function gx(e,t){for(var r=e.read_shift(4),n={},a=0;a!=r;++a){var s=e.read_shift(4),i=e.read_shift(4);n[s]=e.read_shift(i,t===1200?"utf16le":"utf8").replace(en,"").replace(Cl,"!"),t===1200&&i%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>3<<2),n}function rS(e){var t=e.read_shift(4),r=e.slice(e.l,e.l+t);return e.l+=t,(t&3)>0&&(e.l+=4-(t&3)&3),r}function G3(e){var t={};return t.Size=e.read_shift(4),e.l+=t.Size+3-(t.Size-1)%4,t}function Ef(e,t,r){var n=e.read_shift(2),a,s=r||{};if(e.l+=2,t!==fx&&n!==t&&E3.indexOf(t)===-1&&!((t&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+t+" saw "+n);switch(t===fx?n:t){case 2:return a=e.read_shift(2,"i"),s.raw||(e.l+=2),a;case 3:return a=e.read_shift(4,"i"),a;case 11:return e.read_shift(4)!==0;case 19:return a=e.read_shift(4),a;case 30:return Z_(e,n,4).replace(en,"");case 31:return eS(e);case 64:return zg(e);case 65:return rS(e);case 71:return G3(e);case 80:return Gh(e,n,!s.raw).replace(en,"");case 81:return U3(e,n).replace(en,"");case 4108:return H3(e);case 4126:case 4127:return n==4127?z3(e):V3(e);default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+n)}}function px(e,t){var r=de(4),n=de(4);switch(r.write_shift(4,e==80?31:e),e){case 3:n.write_shift(-4,t);break;case 5:n=de(8),n.write_shift(8,t,"f");break;case 11:n.write_shift(4,t?1:0);break;case 64:n=$3(t);break;case 31:case 80:for(n=de(4+2*(t.length+1)+(t.length%2?0:2)),n.write_shift(4,t.length+1),n.write_shift(0,t,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+t)}return Er([r,n])}function mx(e,t){var r=e.l,n=e.read_shift(4),a=e.read_shift(4),s=[],i=0,c=0,u=-1,f={};for(i=0;i!=a;++i){var h=e.read_shift(4),p=e.read_shift(4);s[i]=[h,p+r]}s.sort(function(k,b){return k[1]-b[1]});var m={};for(i=0;i!=a;++i){if(e.l!==s[i][1]){var y=!0;if(i>0&&t)switch(t[s[i-1][0]].t){case 2:e.l+2===s[i][1]&&(e.l+=2,y=!1);break;case 80:e.l<=s[i][1]&&(e.l=s[i][1],y=!1);break;case 4108:e.l<=s[i][1]&&(e.l=s[i][1],y=!1);break}if((!t||i==0)&&e.l<=s[i][1]&&(y=!1,e.l=s[i][1]),y)throw new Error("Read Error: Expected address "+s[i][1]+" at "+e.l+" :"+i)}if(t){var w=t[s[i][0]];if(m[w.n]=Ef(e,w.t,{raw:!0}),w.p==="version"&&(m[w.n]=String(m[w.n]>>16)+"."+("0000"+String(m[w.n]&65535)).slice(-4)),w.n=="CodePage")switch(m[w.n]){case 0:m[w.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:na(c=m[w.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+m[w.n])}}else if(s[i][0]===1){if(c=m.CodePage=Ef(e,$g),na(c),u!==-1){var x=e.l;e.l=s[u][1],f=gx(e,c),e.l=x}}else if(s[i][0]===0){if(c===0){u=i,e.l=s[i+1][1];continue}f=gx(e,c)}else{var _=f[s[i][0]],E;switch(e[e.l]){case 65:e.l+=4,E=rS(e);break;case 30:e.l+=4,E=Gh(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,E=Gh(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,E=e.read_shift(4,"i");break;case 19:e.l+=4,E=e.read_shift(4);break;case 5:e.l+=4,E=e.read_shift(8,"f");break;case 11:e.l+=4,E=Zt(e,4);break;case 64:e.l+=4,E=Rt(zg(e));break;default:throw new Error("unparsed value: "+e[e.l])}m[_]=E}}return e.l=r+n,m}var nS=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function q3(e){switch(typeof e){case"boolean":return 11;case"number":return(e|0)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64;break}return-1}function vx(e,t,r){var n=de(8),a=[],s=[],i=8,c=0,u=de(8),f=de(8);if(u.write_shift(4,2),u.write_shift(4,1200),f.write_shift(4,1),s.push(u),a.push(f),i+=8+u.length,!t){f=de(8),f.write_shift(4,0),a.unshift(f);var h=[de(4)];for(h[0].write_shift(4,e.length),c=0;c<e.length;++c){var p=e[c][0];for(u=de(8+2*(p.length+1)+(p.length%2?0:2)),u.write_shift(4,c+2),u.write_shift(4,p.length+1),u.write_shift(0,p,"dbcs");u.l!=u.length;)u.write_shift(1,0);h.push(u)}u=Er(h),s.unshift(u),i+=8+u.length}for(c=0;c<e.length;++c)if(!(t&&!t[e[c][0]])&&!(nS.indexOf(e[c][0])>-1||X_.indexOf(e[c][0])>-1)&&e[c][1]!=null){var m=e[c][1],y=0;if(t){y=+t[e[c][0]];var w=r[y];if(w.p=="version"&&typeof m=="string"){var x=m.split(".");m=(+x[0]<<16)+(+x[1]||0)}u=px(w.t,m)}else{var _=q3(m);_==-1&&(_=31,m=String(m)),u=px(_,m)}s.push(u),f=de(8),f.write_shift(4,t?y:2+c),a.push(f),i+=8+u.length}var E=8*(s.length+1);for(c=0;c<s.length;++c)a[c].write_shift(4,E),E+=s[c].length;return n.write_shift(4,i),n.write_shift(4,s.length),Er([n].concat(a).concat(s))}function xx(e,t,r){var n=e.content;if(!n)return{};Ar(n,0);var a,s,i,c,u=0;n.chk("feff","Byte Order: "),n.read_shift(2);var f=n.read_shift(4),h=n.read_shift(16);if(h!==Ve.utils.consts.HEADER_CLSID&&h!==r)throw new Error("Bad PropertySet CLSID "+h);if(a=n.read_shift(4),a!==1&&a!==2)throw new Error("Unrecognized #Sets: "+a);if(s=n.read_shift(16),c=n.read_shift(4),a===1&&c!==n.l)throw new Error("Length mismatch: "+c+" !== "+n.l);a===2&&(i=n.read_shift(16),u=n.read_shift(4));var p=mx(n,t),m={SystemIdentifier:f};for(var y in p)m[y]=p[y];if(m.FMTID=s,a===1)return m;if(u-n.l==2&&(n.l+=2),n.l!==u)throw new Error("Length mismatch 2: "+n.l+" !== "+u);var w;try{w=mx(n,null)}catch{}for(y in w)m[y]=w[y];return m.FMTID=[s,i],m}function yx(e,t,r,n,a,s){var i=de(a?68:48),c=[i];i.write_shift(2,65534),i.write_shift(2,0),i.write_shift(4,842412599),i.write_shift(16,Ve.utils.consts.HEADER_CLSID,"hex"),i.write_shift(4,a?2:1),i.write_shift(16,t,"hex"),i.write_shift(4,a?68:48);var u=vx(e,r,n);if(c.push(u),a){var f=vx(a,null,null);i.write_shift(16,s,"hex"),i.write_shift(4,68+u.length),c.push(f)}return Er(c)}function ms(e,t){return e.read_shift(t),null}function K3(e,t){t||(t=de(e));for(var r=0;r<e;++r)t.write_shift(1,0);return t}function X3(e,t,r){for(var n=[],a=e.l+t;e.l<a;)n.push(r(e,a-e.l));if(a!==e.l)throw new Error("Slurp error");return n}function Zt(e,t){return e.read_shift(t)===1}function Zr(e,t){return t||(t=de(2)),t.write_shift(2,+!!e),t}function cr(e){return e.read_shift(2,"u")}function jn(e,t){return t||(t=de(2)),t.write_shift(2,e),t}function aS(e,t){return X3(e,t,cr)}function J3(e){var t=e.read_shift(1),r=e.read_shift(1);return r===1?t:t===1}function sS(e,t,r){return r||(r=de(2)),r.write_shift(1,t=="e"?+e:+!!e),r.write_shift(1,t=="e"?1:0),r}function xc(e,t,r){var n=e.read_shift(r&&r.biff>=12?2:1),a="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var s=e.read_shift(1);s&&(a="dbcs-cont")}else r.biff==12&&(a="wstr");r.biff>=2&&r.biff<=5&&(a="cpstr");var i=n?e.read_shift(n,a):"";return i}function Y3(e){var t=e.read_shift(2),r=e.read_shift(1),n=r&4,a=r&8,s=1+(r&1),i=0,c,u={};a&&(i=e.read_shift(2)),n&&(c=e.read_shift(4));var f=s==2?"dbcs-cont":"sbcs-cont",h=t===0?"":e.read_shift(t,f);return a&&(e.l+=4*i),n&&(e.l+=c),u.t=h,a||(u.raw="<t>"+u.t+"</t>",u.r=u.t),u}function Q3(e){var t=e.t||"",r=de(3);r.write_shift(2,t.length),r.write_shift(1,1);var n=de(2*t.length);n.write_shift(2*t.length,t,"utf16le");var a=[r,n];return Er(a)}function ho(e,t,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}var a=e.read_shift(1);return a===0?n=e.read_shift(t,"sbcs-cont"):n=e.read_shift(t,"dbcs-cont"),n}function yc(e,t,r){var n=e.read_shift(r&&r.biff==2?1:2);return n===0?(e.l++,""):ho(e,n,r)}function bo(e,t,r){if(r.biff>5)return yc(e,t,r);var n=e.read_shift(1);return n===0?(e.l++,""):e.read_shift(n,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function oS(e,t,r){return r||(r=de(3+2*e.length)),r.write_shift(2,e.length),r.write_shift(1,1),r.write_shift(31,e,"utf16le"),r}function Z3(e){var t=e.read_shift(1);e.l++;var r=e.read_shift(2);return e.l+=2,[t,r]}function eO(e){var t=e.read_shift(4),r=e.l,n=!1;t>24&&(e.l+=t-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),e.l=r);var a=e.read_shift((n?t-24:t)>>1,"utf16le").replace(en,"");return n&&(e.l+=24),a}function tO(e){for(var t=e.read_shift(2),r="";t-- >0;)r+="../";var n=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var a=e.read_shift(4);if(a===0)return r+n.replace(/\\/g,"/");var s=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var i=e.read_shift(s>>1,"utf16le").replace(en,"");return r+i}function rO(e,t){var r=e.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return eO(e);case"0303000000000000c000000000000046":return tO(e);default:throw new Error("Unsupported Moniker "+r)}}function Qu(e){var t=e.read_shift(4),r=t>0?e.read_shift(t,"utf16le").replace(en,""):"";return r}function wx(e,t){t||(t=de(6+e.length*2)),t.write_shift(4,1+e.length);for(var r=0;r<e.length;++r)t.write_shift(2,e.charCodeAt(r));return t.write_shift(2,0),t}function nO(e,t){var r=e.l+t,n=e.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var a=e.read_shift(2);e.l+=2;var s,i,c,u,f="",h,p;a&16&&(s=Qu(e,r-e.l)),a&128&&(i=Qu(e,r-e.l)),(a&257)===257&&(c=Qu(e,r-e.l)),(a&257)===1&&(u=rO(e,r-e.l)),a&8&&(f=Qu(e,r-e.l)),a&32&&(h=e.read_shift(16)),a&64&&(p=zg(e)),e.l=r;var m=i||c||u||"";m&&f&&(m+="#"+f),m||(m="#"+f),a&2&&m.charAt(0)=="/"&&m.charAt(1)!="/"&&(m="file://"+m);var y={Target:m};return h&&(y.guid=h),p&&(y.time=p),s&&(y.Tooltip=s),y}function aO(e){var t=de(512),r=0,n=e.Target;n.slice(0,7)=="file://"&&(n=n.slice(7));var a=n.indexOf("#"),s=a>-1?31:23;switch(n.charAt(0)){case"#":s=28;break;case".":s&=-3;break}t.write_shift(4,2),t.write_shift(4,s);var i=[8,6815827,6619237,4849780,83];for(r=0;r<i.length;++r)t.write_shift(4,i[r]);if(s==28)n=n.slice(1),wx(n,t);else if(s&2){for(i="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<i.length;++r)t.write_shift(1,parseInt(i[r],16));var c=a>-1?n.slice(0,a):n;for(t.write_shift(4,2*(c.length+1)),r=0;r<c.length;++r)t.write_shift(2,c.charCodeAt(r));t.write_shift(2,0),s&8&&wx(a>-1?n.slice(a+1):"",t)}else{for(i="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<i.length;++r)t.write_shift(1,parseInt(i[r],16));for(var u=0;n.slice(u*3,u*3+3)=="../"||n.slice(u*3,u*3+3)=="..\\";)++u;for(t.write_shift(2,u),t.write_shift(4,n.length-3*u+1),r=0;r<n.length-3*u;++r)t.write_shift(1,n.charCodeAt(r+3*u)&255);for(t.write_shift(1,0),t.write_shift(2,65535),t.write_shift(2,57005),r=0;r<6;++r)t.write_shift(4,0)}return t.slice(0,t.l)}function iS(e){var t=e.read_shift(1),r=e.read_shift(1),n=e.read_shift(1),a=e.read_shift(1);return[t,r,n,a]}function lS(e,t){var r=iS(e);return r[3]=0,r}function _a(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return{r:t,c:r,ixfe:n}}function go(e,t,r,n){return n||(n=de(6)),n.write_shift(2,e),n.write_shift(2,t),n.write_shift(2,r||0),n}function sO(e){var t=e.read_shift(2),r=e.read_shift(2);return e.l+=8,{type:t,flags:r}}function oO(e,t,r){return t===0?"":bo(e,t,r)}function iO(e,t,r){var n=r.biff>8?4:2,a=e.read_shift(n),s=e.read_shift(n,"i"),i=e.read_shift(n,"i");return[a,s,i]}function cS(e){var t=e.read_shift(2),r=jg(e);return[t,r]}function lO(e,t,r){e.l+=4,t-=4;var n=e.l+t,a=xc(e,t,r),s=e.read_shift(2);if(n-=e.l,s!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+s);return e.l+=s,a}function zf(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),a=e.read_shift(2);return{s:{c:n,r:t},e:{c:a,r}}}function uS(e,t){return t||(t=de(8)),t.write_shift(2,e.s.r),t.write_shift(2,e.e.r),t.write_shift(2,e.s.c),t.write_shift(2,e.e.c),t}function fS(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(1),a=e.read_shift(1);return{s:{c:n,r:t},e:{c:a,r}}}var cO=fS;function dS(e){e.l+=4;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return e.l+=12,[r,t,n]}function uO(e){var t={};return e.l+=4,e.l+=16,t.fSharedNote=e.read_shift(2),e.l+=4,t}function fO(e){var t={};return e.l+=4,e.cf=e.read_shift(2),t}function jr(e){e.l+=2,e.l+=e.read_shift(2)}var dO={0:jr,4:jr,5:jr,6:jr,7:fO,8:jr,9:jr,10:jr,11:jr,12:jr,13:uO,14:jr,15:jr,16:jr,17:jr,18:jr,19:jr,20:jr,21:dS};function hO(e,t){for(var r=e.l+t,n=[];e.l<r;){var a=e.read_shift(2);e.l-=2;try{n.push(dO[a](e,r-e.l))}catch{return e.l=r,n}}return e.l!=r&&(e.l=r),n}function Zu(e,t){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=e.read_shift(2),t-=2,t>=2&&(r.dt=e.read_shift(2),e.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(t>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return e.read_shift(t),r}function Vg(e,t,r){var n=1536,a=16;switch(r.bookType){case"biff8":break;case"biff5":n=1280,a=8;break;case"biff4":n=4,a=6;break;case"biff3":n=3,a=6;break;case"biff2":n=2,a=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var s=de(a);return s.write_shift(2,n),s.write_shift(2,t),a>4&&s.write_shift(2,29282),a>6&&s.write_shift(2,1997),a>8&&(s.write_shift(2,49161),s.write_shift(2,1),s.write_shift(2,1798),s.write_shift(2,0)),s}function gO(e,t){return t===0||e.read_shift(2),1200}function pO(e,t,r){if(r.enc)return e.l+=t,"";var n=e.l,a=bo(e,0,r);return e.read_shift(t+n-e.l),a}function mO(e,t){var r=!t||t.biff==8,n=de(r?112:54);for(n.write_shift(t.biff==8?2:1,7),r&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(r?0:536870912));n.l<n.length;)n.write_shift(1,r?0:32);return n}function vO(e,t,r){var n=r&&r.biff==8||t==2?e.read_shift(2):(e.l+=t,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function xO(e,t,r){var n=e.read_shift(4),a=e.read_shift(1)&3,s=e.read_shift(1);switch(s){case 0:s="Worksheet";break;case 1:s="Macrosheet";break;case 2:s="Chartsheet";break;case 6:s="VBAModule";break}var i=xc(e,0,r);return i.length===0&&(i="Sheet1"),{pos:n,hs:a,dt:s,name:i}}function yO(e,t){var r=!t||t.biff>=8?2:1,n=de(8+r*e.name.length);n.write_shift(4,e.pos),n.write_shift(1,e.hs||0),n.write_shift(1,e.dt),n.write_shift(1,e.name.length),t.biff>=8&&n.write_shift(1,1),n.write_shift(r*e.name.length,e.name,t.biff<8?"sbcs":"utf16le");var a=n.slice(0,n.l);return a.l=n.l,a}function wO(e,t){for(var r=e.l+t,n=e.read_shift(4),a=e.read_shift(4),s=[],i=0;i!=a&&e.l<r;++i)s.push(Y3(e));return s.Count=n,s.Unique=a,s}function _O(e,t){var r=de(8);r.write_shift(4,e.Count),r.write_shift(4,e.Unique);for(var n=[],a=0;a<e.length;++a)n[a]=Q3(e[a]);var s=Er([r].concat(n));return s.parts=[r.length].concat(n.map(function(i){return i.length})),s}function SO(e,t){var r={};return r.dsst=e.read_shift(2),e.l+=t-2,r}function EO(e){var t={};t.r=e.read_shift(2),t.c=e.read_shift(2),t.cnt=e.read_shift(2)-t.c;var r=e.read_shift(2);e.l+=4;var n=e.read_shift(1);return e.l+=3,n&7&&(t.level=n&7),n&32&&(t.hidden=!0),n&64&&(t.hpt=r/20),t}function bO(e){var t=sO(e);if(t.type!=2211)throw new Error("Invalid Future Record "+t.type);var r=e.read_shift(4);return r!==0}function kO(e){return e.read_shift(2),e.read_shift(4)}function _x(e,t,r){var n=0;r&&r.biff==2||(n=e.read_shift(2));var a=e.read_shift(2);r&&r.biff==2&&(n=1-(a>>15),a&=32767);var s={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[s,a]}function TO(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),a=e.read_shift(2),s=e.read_shift(2),i=e.read_shift(2),c=e.read_shift(2),u=e.read_shift(2),f=e.read_shift(2);return{Pos:[t,r],Dim:[n,a],Flags:s,CurTab:i,FirstTab:c,Selected:u,TabRatio:f}}function CO(){var e=de(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}function AO(e,t,r){if(r&&r.biff>=2&&r.biff<5)return{};var n=e.read_shift(2);return{RTL:n&64}}function PO(e){var t=de(18),r=1718;return e&&e.RTL&&(r|=64),t.write_shift(2,r),t.write_shift(4,0),t.write_shift(4,64),t.write_shift(4,0),t.write_shift(4,0),t}function IO(){}function OO(e,t,r){var n={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return n.name=xc(e,0,r),n}function DO(e,t){var r=e.name||"Arial",n=t&&t.biff==5,a=n?15+r.length:16+2*r.length,s=de(a);return s.write_shift(2,e.sz*20),s.write_shift(4,0),s.write_shift(2,400),s.write_shift(4,0),s.write_shift(2,0),s.write_shift(1,r.length),n||s.write_shift(1,1),s.write_shift((n?1:2)*r.length,r,n?"sbcs":"utf16le"),s}function FO(e){var t=_a(e);return t.isst=e.read_shift(4),t}function RO(e,t,r,n){var a=de(10);return go(e,t,n,a),a.write_shift(4,r),a}function LO(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=e.l+t,a=_a(e);r.biff==2&&e.l++;var s=yc(e,n-e.l,r);return a.val=s,a}function NO(e,t,r,n,a){var s=!a||a.biff==8,i=de(8+ +s+(1+s)*r.length);return go(e,t,n,i),i.write_shift(2,r.length),s&&i.write_shift(1,1),i.write_shift((1+s)*r.length,r,s?"utf16le":"sbcs"),i}function MO(e,t,r){var n=e.read_shift(2),a=bo(e,0,r);return[n,a]}function BO(e,t,r,n){var a=r&&r.biff==5;n||(n=de(a?3+t.length:5+2*t.length)),n.write_shift(2,e),n.write_shift(a?1:2,t.length),a||n.write_shift(1,1),n.write_shift((a?1:2)*t.length,t,a?"sbcs":"utf16le");var s=n.length>n.l?n.slice(0,n.l):n;return s.l==null&&(s.l=s.length),s}var jO=bo;function Sx(e,t,r){var n=e.l+t,a=r.biff==8||!r.biff?4:2,s=e.read_shift(a),i=e.read_shift(a),c=e.read_shift(2),u=e.read_shift(2);return e.l=n,{s:{r:s,c},e:{r:i,c:u}}}function $O(e,t){var r=t.biff==8||!t.biff?4:2,n=de(2*r+6);return n.write_shift(r,e.s.r),n.write_shift(r,e.e.r+1),n.write_shift(2,e.s.c),n.write_shift(2,e.e.c+1),n.write_shift(2,0),n}function UO(e){var t=e.read_shift(2),r=e.read_shift(2),n=cS(e);return{r:t,c:r,ixfe:n[0],rknum:n[1]}}function zO(e,t){for(var r=e.l+t-2,n=e.read_shift(2),a=e.read_shift(2),s=[];e.l<r;)s.push(cS(e));if(e.l!==r)throw new Error("MulRK read error");var i=e.read_shift(2);if(s.length!=i-a+1)throw new Error("MulRK length mismatch");return{r:n,c:a,C:i,rkrec:s}}function VO(e,t){for(var r=e.l+t-2,n=e.read_shift(2),a=e.read_shift(2),s=[];e.l<r;)s.push(e.read_shift(2));if(e.l!==r)throw new Error("MulBlank read error");var i=e.read_shift(2);if(s.length!=i-a+1)throw new Error("MulBlank length mismatch");return{r:n,c:a,C:i,ixfe:s}}function WO(e,t,r,n){var a={},s=e.read_shift(4),i=e.read_shift(4),c=e.read_shift(4),u=e.read_shift(2);return a.patternType=b3[c>>26],n.cellStyles&&(a.alc=s&7,a.fWrap=s>>3&1,a.alcV=s>>4&7,a.fJustLast=s>>7&1,a.trot=s>>8&255,a.cIndent=s>>16&15,a.fShrinkToFit=s>>20&1,a.iReadOrder=s>>22&2,a.fAtrNum=s>>26&1,a.fAtrFnt=s>>27&1,a.fAtrAlc=s>>28&1,a.fAtrBdr=s>>29&1,a.fAtrPat=s>>30&1,a.fAtrProt=s>>31&1,a.dgLeft=i&15,a.dgRight=i>>4&15,a.dgTop=i>>8&15,a.dgBottom=i>>12&15,a.icvLeft=i>>16&127,a.icvRight=i>>23&127,a.grbitDiag=i>>30&3,a.icvTop=c&127,a.icvBottom=c>>7&127,a.icvDiag=c>>14&127,a.dgDiag=c>>21&15,a.icvFore=u&127,a.icvBack=u>>7&127,a.fsxButton=u>>14&1),a}function HO(e,t,r){var n={};return n.ifnt=e.read_shift(2),n.numFmtId=e.read_shift(2),n.flags=e.read_shift(2),n.fStyle=n.flags>>2&1,t-=6,n.data=WO(e,t,n.fStyle,r),n}function Ex(e,t,r,n){var a=r&&r.biff==5;n||(n=de(a?16:20)),n.write_shift(2,0),e.style?(n.write_shift(2,e.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,e.numFmtId||0),n.write_shift(2,t<<4));var s=0;return e.numFmtId>0&&a&&(s|=1024),n.write_shift(4,s),n.write_shift(4,0),a||n.write_shift(4,0),n.write_shift(2,0),n}function GO(e){e.l+=4;var t=[e.read_shift(2),e.read_shift(2)];if(t[0]!==0&&t[0]--,t[1]!==0&&t[1]--,t[0]>7||t[1]>7)throw new Error("Bad Gutters: "+t.join("|"));return t}function qO(e){var t=de(8);return t.write_shift(4,0),t.write_shift(2,0),t.write_shift(2,0),t}function bx(e,t,r){var n=_a(e);(r.biff==2||t==9)&&++e.l;var a=J3(e);return n.val=a,n.t=a===!0||a===!1?"b":"e",n}function KO(e,t,r,n,a,s){var i=de(8);return go(e,t,n,i),sS(r,s,i),i}function XO(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=_a(e),a=Wr(e);return n.val=a,n}function JO(e,t,r,n){var a=de(14);return go(e,t,n,a),fo(r,a),a}var kx=oO;function YO(e,t,r){var n=e.l+t,a=e.read_shift(2),s=e.read_shift(2);if(r.sbcch=s,s==1025||s==14849)return[s,a];if(s<1||s>255)throw new Error("Unexpected SupBook type: "+s);for(var i=ho(e,s),c=[];n>e.l;)c.push(yc(e));return[s,a,i,c]}function Tx(e,t,r){var n=e.read_shift(2),a,s={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return r.sbcch===14849&&(a=lO(e,t-2,r)),s.body=a||e.read_shift(t-2),typeof a=="string"&&(s.Name=a),s}var QO=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function Cx(e,t,r){var n=e.l+t,a=e.read_shift(2),s=e.read_shift(1),i=e.read_shift(1),c=e.read_shift(r&&r.biff==2?1:2),u=0;(!r||r.biff>=5)&&(r.biff!=5&&(e.l+=2),u=e.read_shift(2),r.biff==5&&(e.l+=2),e.l+=4);var f=ho(e,i,r);a&32&&(f=QO[f.charCodeAt(0)]);var h=n-e.l;r&&r.biff==2&&--h;var p=n==e.l||c===0||!(h>0)?[]:hL(e,h,r,c);return{chKey:s,Name:f,itab:u,rgce:p}}function hS(e,t,r){if(r.biff<8)return ZO(e,t,r);for(var n=[],a=e.l+t,s=e.read_shift(r.biff>8?4:2);s--!==0;)n.push(iO(e,r.biff>8?12:6,r));if(e.l!=a)throw new Error("Bad ExternSheet: "+e.l+" != "+a);return n}function ZO(e,t,r){e[e.l+1]==3&&e[e.l]++;var n=xc(e,t,r);return n.charCodeAt(0)==3?n.slice(1):n}function eD(e,t,r){if(r.biff<8){e.l+=t;return}var n=e.read_shift(2),a=e.read_shift(2),s=ho(e,n,r),i=ho(e,a,r);return[s,i]}function tD(e,t,r){var n=fS(e);e.l++;var a=e.read_shift(1);return t-=8,[gL(e,t,r),a,n]}function Ax(e,t,r){var n=cO(e);switch(r.biff){case 2:e.l++,t-=7;break;case 3:case 4:e.l+=2,t-=8;break;default:e.l+=6,t-=12}return[n,fL(e,t,r)]}function rD(e){var t=e.read_shift(4)!==0,r=e.read_shift(4)!==0,n=e.read_shift(4);return[t,r,n]}function nD(e,t,r){if(!(r.biff<8)){var n=e.read_shift(2),a=e.read_shift(2),s=e.read_shift(2),i=e.read_shift(2),c=bo(e,0,r);return r.biff<8&&e.read_shift(1),[{r:n,c:a},c,i,s]}}function aD(e,t,r){return nD(e,t,r)}function sD(e,t){for(var r=[],n=e.read_shift(2);n--;)r.push(zf(e));return r}function oD(e){var t=de(2+e.length*8);t.write_shift(2,e.length);for(var r=0;r<e.length;++r)uS(e[r],t);return t}function iD(e,t,r){if(r&&r.biff<8)return cD(e,t,r);var n=dS(e),a=hO(e,t-22,n[1]);return{cmo:n,ft:a}}var lD={8:function(e,t){var r=e.l+t;e.l+=10;var n=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var a=e.read_shift(1);return e.l+=a,e.l=r,{fmt:n}}};function cD(e,t,r){e.l+=4;var n=e.read_shift(2),a=e.read_shift(2),s=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,t-=36;var i=[];return i.push((lD[n]||Gr)(e,t,r)),{cmo:[a,n,s],ft:i}}function uD(e,t,r){var n=e.l,a="";try{e.l+=4;var s=(r.lastobj||{cmo:[0,0]}).cmo[1],i;[0,5,7,11,12,14].indexOf(s)==-1?e.l+=6:i=Z3(e,6,r);var c=e.read_shift(2);e.read_shift(2),cr(e,2);var u=e.read_shift(2);e.l+=u;for(var f=1;f<e.lens.length-1;++f){if(e.l-n!=e.lens[f])throw new Error("TxO: bad continue record");var h=e[e.l],p=ho(e,e.lens[f+1]-e.lens[f]-1);if(a+=p,a.length>=(h?c:2*c))break}if(a.length!==c&&a.length!==c*2)throw new Error("cchText: "+c+" != "+a.length);return e.l=n+t,{t:a}}catch{return e.l=n+t,{t:a}}}function fD(e,t){var r=zf(e);e.l+=16;var n=nO(e,t-24);return[r,n]}function dD(e){var t=de(24),r=Vt(e[0]);t.write_shift(2,r.r),t.write_shift(2,r.r),t.write_shift(2,r.c),t.write_shift(2,r.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),a=0;a<16;++a)t.write_shift(1,parseInt(n[a],16));return Er([t,aO(e[1])])}function hD(e,t){e.read_shift(2);var r=zf(e),n=e.read_shift((t-10)/2,"dbcs-cont");return n=n.replace(en,""),[r,n]}function gD(e){var t=e[1].Tooltip,r=de(10+2*(t.length+1));r.write_shift(2,2048);var n=Vt(e[0]);r.write_shift(2,n.r),r.write_shift(2,n.r),r.write_shift(2,n.c),r.write_shift(2,n.c);for(var a=0;a<t.length;++a)r.write_shift(2,t.charCodeAt(a));return r.write_shift(2,0),r}function pD(e){var t=[0,0],r;return r=e.read_shift(2),t[0]=dx[r]||r,r=e.read_shift(2),t[1]=dx[r]||r,t}function mD(e){return e||(e=de(4)),e.write_shift(2,1),e.write_shift(2,1),e}function vD(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(lS(e));return r}function xD(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(lS(e));return r}function yD(e){e.l+=2;var t={cxfs:0,crc:0};return t.cxfs=e.read_shift(2),t.crc=e.read_shift(4),t}function gS(e,t,r){if(!r.cellStyles)return Gr(e,t);var n=r&&r.biff>=12?4:2,a=e.read_shift(n),s=e.read_shift(n),i=e.read_shift(n),c=e.read_shift(n),u=e.read_shift(2);n==2&&(e.l+=2);var f={s:a,e:s,w:i,ixfe:c,flags:u};return(r.biff>=5||!r.biff)&&(f.level=u>>8&7),f}function wD(e,t){var r=de(12);r.write_shift(2,t),r.write_shift(2,t),r.write_shift(2,e.width*256),r.write_shift(2,0);var n=0;return e.hidden&&(n|=1),r.write_shift(1,n),n=e.level||0,r.write_shift(1,n),r.write_shift(2,0),r}function _D(e,t){var r={};return t<32||(e.l+=16,r.header=Wr(e),r.footer=Wr(e),e.l+=2),r}function SD(e,t,r){var n={area:!1};if(r.biff!=5)return e.l+=t,n;var a=e.read_shift(1);return e.l+=3,a&16&&(n.area=!0),n}function ED(e){for(var t=de(2*e),r=0;r<e;++r)t.write_shift(2,r+1);return t}var bD=_a,kD=aS,TD=yc;function CD(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),a={fmt:t,env:r,len:n,data:e.slice(e.l,e.l+n)};return e.l+=n,a}function AD(e,t,r){r.biffguess&&r.biff==5&&(r.biff=2);var n=_a(e);++e.l;var a=bo(e,t-7,r);return n.t="str",n.val=a,n}function PD(e){var t=_a(e);++e.l;var r=Wr(e);return t.t="n",t.val=r,t}function ID(e,t,r){var n=de(15);return Ec(n,e,t),n.write_shift(8,r,"f"),n}function OD(e){var t=_a(e);++e.l;var r=e.read_shift(2);return t.t="n",t.val=r,t}function DD(e,t,r){var n=de(9);return Ec(n,e,t),n.write_shift(2,r),n}function FD(e){var t=e.read_shift(1);return t===0?(e.l++,""):e.read_shift(t,"sbcs-cont")}function RD(e,t){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=t-13}function LD(e,t,r){var n=e.l+t,a=_a(e),s=e.read_shift(2),i=ho(e,s,r);return e.l=n,a.t="str",a.val=i,a}var ND=[2,3,48,49,131,139,140,245],qh=(function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=jf({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(c,u){var f=[],h=Ss(1);switch(u.type){case"base64":h=bn(Tn(c));break;case"binary":h=bn(c);break;case"buffer":case"array":h=c;break}Ar(h,0);var p=h.read_shift(1),m=!!(p&136),y=!1,w=!1;switch(p){case 2:break;case 3:break;case 48:y=!0,m=!0;break;case 49:y=!0,m=!0;break;case 131:break;case 139:break;case 140:w=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+p.toString(16))}var x=0,_=521;p==2&&(x=h.read_shift(2)),h.l+=3,p!=2&&(x=h.read_shift(4)),x>1048576&&(x=1e6),p!=2&&(_=h.read_shift(2));var E=h.read_shift(2),k=u.codepage||1252;p!=2&&(h.l+=16,h.read_shift(1),h[h.l]!==0&&(k=e[h[h.l]]),h.l+=1,h.l+=2),w&&(h.l+=36);for(var b=[],O={},z=Math.min(h.length,p==2?521:_-10-(y?264:0)),L=w?32:11;h.l<z&&h[h.l]!=13;)switch(O={},O.name=Xl.utils.decode(k,h.slice(h.l,h.l+L)).replace(/[\u0000\r\n].*$/g,""),h.l+=L,O.type=String.fromCharCode(h.read_shift(1)),p!=2&&!w&&(O.offset=h.read_shift(4)),O.len=h.read_shift(1),p==2&&(O.offset=h.read_shift(2)),O.dec=h.read_shift(1),O.name.length&&b.push(O),p!=2&&(h.l+=w?13:14),O.type){case"B":(!y||O.len!=8)&&u.WTF&&console.log("Skipping "+O.name+":"+O.type);break;case"G":case"P":u.WTF&&console.log("Skipping "+O.name+":"+O.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+O.type)}if(h[h.l]!==13&&(h.l=_-1),h.read_shift(1)!==13)throw new Error("DBF Terminator not found "+h.l+" "+h[h.l]);h.l=_;var P=0,J=0;for(f[0]=[],J=0;J!=b.length;++J)f[0][J]=b[J].name;for(;x-- >0;){if(h[h.l]===42){h.l+=E;continue}for(++h.l,f[++P]=[],J=0,J=0;J!=b.length;++J){var V=h.slice(h.l,h.l+b[J].len);h.l+=b[J].len,Ar(V,0);var le=Xl.utils.decode(k,V);switch(b[J].type){case"C":le.trim().length&&(f[P][J]=le.replace(/\s+$/,""));break;case"D":le.length===8?f[P][J]=new Date(+le.slice(0,4),+le.slice(4,6)-1,+le.slice(6,8)):f[P][J]=le;break;case"F":f[P][J]=parseFloat(le.trim());break;case"+":case"I":f[P][J]=w?V.read_shift(-4,"i")^2147483648:V.read_shift(4,"i");break;case"L":switch(le.trim().toUpperCase()){case"Y":case"T":f[P][J]=!0;break;case"N":case"F":f[P][J]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+le+"|")}break;case"M":if(!m)throw new Error("DBF Unexpected MEMO for type "+p.toString(16));f[P][J]="##MEMO##"+(w?parseInt(le.trim(),10):V.read_shift(4));break;case"N":le=le.replace(/\u0000/g,"").trim(),le&&le!="."&&(f[P][J]=+le||0);break;case"@":f[P][J]=new Date(V.read_shift(-8,"f")-621356832e5);break;case"T":f[P][J]=new Date((V.read_shift(4)-2440588)*864e5+V.read_shift(4));break;case"Y":f[P][J]=V.read_shift(4,"i")/1e4+V.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":f[P][J]=-V.read_shift(-8,"f");break;case"B":if(y&&b[J].len==8){f[P][J]=V.read_shift(8,"f");break}case"G":case"P":V.l+=b[J].len;break;case"0":if(b[J].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+b[J].type)}}}if(p!=2&&h.l<h.length&&h[h.l++]!=26)throw new Error("DBF EOF Marker missing "+(h.l-1)+" of "+h.length+" "+h[h.l-1].toString(16));return u&&u.sheetRows&&(f=f.slice(0,u.sheetRows)),u.DBF=b,f}function n(c,u){var f=u||{};f.dateNF||(f.dateNF="yyyymmdd");var h=Fi(r(c,f),f);return h["!cols"]=f.DBF.map(function(p){return{wch:p.len,DBF:p}}),delete f.DBF,h}function a(c,u){try{return Ps(n(c,u),u)}catch(f){if(u&&u.WTF)throw f}return{SheetNames:[],Sheets:{}}}var s={B:8,C:250,L:1,D:8,"?":0,"":0};function i(c,u){var f=u||{};if(+f.codepage>=0&&na(+f.codepage),f.type=="string")throw new Error("Cannot write DBF to JS string");var h=un(),p=Tf(c,{header:1,raw:!0,cellDates:!0}),m=p[0],y=p.slice(1),w=c["!cols"]||[],x=0,_=0,E=0,k=1;for(x=0;x<m.length;++x){if(((w[x]||{}).DBF||{}).name){m[x]=w[x].DBF.name,++E;continue}if(m[x]!=null){if(++E,typeof m[x]=="number"&&(m[x]=m[x].toString(10)),typeof m[x]!="string")throw new Error("DBF Invalid column name "+m[x]+" |"+typeof m[x]+"|");if(m.indexOf(m[x])!==x){for(_=0;_<1024;++_)if(m.indexOf(m[x]+"_"+_)==-1){m[x]+="_"+_;break}}}}var b=mt(c["!ref"]),O=[],z=[],L=[];for(x=0;x<=b.e.c-b.s.c;++x){var P="",J="",V=0,le=[];for(_=0;_<y.length;++_)y[_][x]!=null&&le.push(y[_][x]);if(le.length==0||m[x]==null){O[x]="?";continue}for(_=0;_<le.length;++_){switch(typeof le[_]){case"number":J="B";break;case"string":J="C";break;case"boolean":J="L";break;case"object":J=le[_]instanceof Date?"D":"C";break;default:J="C"}V=Math.max(V,String(le[_]).length),P=P&&P!=J?"C":J}V>250&&(V=250),J=((w[x]||{}).DBF||{}).type,J=="C"&&w[x].DBF.len>V&&(V=w[x].DBF.len),P=="B"&&J=="N"&&(P="N",L[x]=w[x].DBF.dec,V=w[x].DBF.len),z[x]=P=="C"||J=="N"?V:s[P]||0,k+=z[x],O[x]=P}var ee=h.next(32);for(ee.write_shift(4,318902576),ee.write_shift(4,y.length),ee.write_shift(2,296+32*E),ee.write_shift(2,k),x=0;x<4;++x)ee.write_shift(4,0);for(ee.write_shift(4,0|(+t[n_]||3)<<8),x=0,_=0;x<m.length;++x)if(m[x]!=null){var X=h.next(32),he=(m[x].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);X.write_shift(1,he,"sbcs"),X.write_shift(1,O[x]=="?"?"C":O[x],"sbcs"),X.write_shift(4,_),X.write_shift(1,z[x]||s[O[x]]||0),X.write_shift(1,L[x]||0),X.write_shift(1,2),X.write_shift(4,0),X.write_shift(1,0),X.write_shift(4,0),X.write_shift(4,0),_+=z[x]||s[O[x]]||0}var Ie=h.next(264);for(Ie.write_shift(4,13),x=0;x<65;++x)Ie.write_shift(4,0);for(x=0;x<y.length;++x){var Ee=h.next(k);for(Ee.write_shift(1,0),_=0;_<m.length;++_)if(m[_]!=null)switch(O[_]){case"L":Ee.write_shift(1,y[x][_]==null?63:y[x][_]?84:70);break;case"B":Ee.write_shift(8,y[x][_]||0,"f");break;case"N":var Te="0";for(typeof y[x][_]=="number"&&(Te=y[x][_].toFixed(L[_]||0)),E=0;E<z[_]-Te.length;++E)Ee.write_shift(1,32);Ee.write_shift(1,Te,"sbcs");break;case"D":y[x][_]?(Ee.write_shift(4,("0000"+y[x][_].getFullYear()).slice(-4),"sbcs"),Ee.write_shift(2,("00"+(y[x][_].getMonth()+1)).slice(-2),"sbcs"),Ee.write_shift(2,("00"+y[x][_].getDate()).slice(-2),"sbcs")):Ee.write_shift(8,"00000000","sbcs");break;case"C":var oe=String(y[x][_]!=null?y[x][_]:"").slice(0,z[_]);for(Ee.write_shift(1,oe,"sbcs"),E=0;E<z[_]-oe.length;++E)Ee.write_shift(1,32);break}}return h.next(1).write_shift(1,26),h.end()}return{to_workbook:a,to_sheet:n,from_sheet:i}})(),pS=(function(){var e={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+Xt(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(m,y){var w=e[y];return typeof w=="number"?jv(w):w},n=function(m,y,w){var x=y.charCodeAt(0)-32<<4|w.charCodeAt(0)-48;return x==59?m:jv(x)};e["|"]=254;function a(m,y){switch(y.type){case"base64":return s(Tn(m),y);case"binary":return s(m,y);case"buffer":return s(st&&Buffer.isBuffer(m)?m.toString("binary"):As(m),y);case"array":return s(uo(m),y)}throw new Error("Unrecognized type "+y.type)}function s(m,y){var w=m.split(/[\n\r]+/),x=-1,_=-1,E=0,k=0,b=[],O=[],z=null,L={},P=[],J=[],V=[],le=0,ee;for(+y.codepage>=0&&na(+y.codepage);E!==w.length;++E){le=0;var X=w[E].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(t,r),he=X.replace(/;;/g,"\0").split(";").map(function(W){return W.replace(/\u0000/g,";")}),Ie=he[0],Ee;if(X.length>0)switch(Ie){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":he[1].charAt(0)=="P"&&O.push(X.slice(3).replace(/;;/g,";"));break;case"C":var Te=!1,oe=!1,ge=!1,K=!1,fe=-1,H=-1;for(k=1;k<he.length;++k)switch(he[k].charAt(0)){case"A":break;case"X":_=parseInt(he[k].slice(1))-1,oe=!0;break;case"Y":for(x=parseInt(he[k].slice(1))-1,oe||(_=0),ee=b.length;ee<=x;++ee)b[ee]=[];break;case"K":Ee=he[k].slice(1),Ee.charAt(0)==='"'?Ee=Ee.slice(1,Ee.length-1):Ee==="TRUE"?Ee=!0:Ee==="FALSE"?Ee=!1:isNaN(oa(Ee))?isNaN(_i(Ee).getDate())||(Ee=Rt(Ee)):(Ee=oa(Ee),z!==null&&Oi(z)&&(Ee=Uf(Ee))),Te=!0;break;case"E":K=!0;var A=pi(he[k].slice(1),{r:x,c:_});b[x][_]=[b[x][_],A];break;case"S":ge=!0,b[x][_]=[b[x][_],"S5S"];break;case"G":break;case"R":fe=parseInt(he[k].slice(1))-1;break;case"C":H=parseInt(he[k].slice(1))-1;break;default:if(y&&y.WTF)throw new Error("SYLK bad record "+X)}if(Te&&(b[x][_]&&b[x][_].length==2?b[x][_][0]=Ee:b[x][_]=Ee,z=null),ge){if(K)throw new Error("SYLK shared formula cannot have own formula");var G=fe>-1&&b[fe][H];if(!G||!G[1])throw new Error("SYLK shared formula cannot find base");b[x][_][1]=FS(G[1],{r:x-fe,c:_-H})}break;case"F":var U=0;for(k=1;k<he.length;++k)switch(he[k].charAt(0)){case"X":_=parseInt(he[k].slice(1))-1,++U;break;case"Y":for(x=parseInt(he[k].slice(1))-1,ee=b.length;ee<=x;++ee)b[ee]=[];break;case"M":le=parseInt(he[k].slice(1))/20;break;case"F":break;case"G":break;case"P":z=O[parseInt(he[k].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(V=he[k].slice(1).split(" "),ee=parseInt(V[0],10);ee<=parseInt(V[1],10);++ee)le=parseInt(V[2],10),J[ee-1]=le===0?{hidden:!0}:{wch:le},Es(J[ee-1]);break;case"C":_=parseInt(he[k].slice(1))-1,J[_]||(J[_]={});break;case"R":x=parseInt(he[k].slice(1))-1,P[x]||(P[x]={}),le>0?(P[x].hpt=le,P[x].hpx=Ei(le)):le===0&&(P[x].hidden=!0);break;default:if(y&&y.WTF)throw new Error("SYLK bad record "+X)}U<1&&(z=null);break;default:if(y&&y.WTF)throw new Error("SYLK bad record "+X)}}return P.length>0&&(L["!rows"]=P),J.length>0&&(L["!cols"]=J),y&&y.sheetRows&&(b=b.slice(0,y.sheetRows)),[b,L]}function i(m,y){var w=a(m,y),x=w[0],_=w[1],E=Fi(x,y);return Xt(_).forEach(function(k){E[k]=_[k]}),E}function c(m,y){return Ps(i(m,y),y)}function u(m,y,w,x){var _="C;Y"+(w+1)+";X"+(x+1)+";K";switch(m.t){case"n":_+=m.v||0,m.f&&!m.F&&(_+=";E"+Xg(m.f,{r:w,c:x}));break;case"b":_+=m.v?"TRUE":"FALSE";break;case"e":_+=m.w||m.v;break;case"d":_+='"'+(m.w||m.v)+'"';break;case"s":_+='"'+m.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return _}function f(m,y){y.forEach(function(w,x){var _="F;W"+(x+1)+" "+(x+1)+" ";w.hidden?_+="0":(typeof w.width=="number"&&!w.wpx&&(w.wpx=nc(w.width)),typeof w.wpx=="number"&&!w.wch&&(w.wch=ac(w.wpx)),typeof w.wch=="number"&&(_+=Math.round(w.wch))),_.charAt(_.length-1)!=" "&&m.push(_)})}function h(m,y){y.forEach(function(w,x){var _="F;";w.hidden?_+="M0;":w.hpt?_+="M"+20*w.hpt+";":w.hpx&&(_+="M"+20*sc(w.hpx)+";"),_.length>2&&m.push(_+"R"+(x+1))})}function p(m,y){var w=["ID;PWXL;N;E"],x=[],_=mt(m["!ref"]),E,k=Array.isArray(m),b=`\r
`;w.push("P;PGeneral"),w.push("F;P0;DG0G8;M255"),m["!cols"]&&f(w,m["!cols"]),m["!rows"]&&h(w,m["!rows"]),w.push("B;Y"+(_.e.r-_.s.r+1)+";X"+(_.e.c-_.s.c+1)+";D"+[_.s.c,_.s.r,_.e.c,_.e.r].join(" "));for(var O=_.s.r;O<=_.e.r;++O)for(var z=_.s.c;z<=_.e.c;++z){var L=qe({r:O,c:z});E=k?(m[O]||[])[z]:m[L],!(!E||E.v==null&&(!E.f||E.F))&&x.push(u(E,m,O,z))}return w.join(b)+b+x.join(b)+b+"E"+b}return{to_workbook:c,to_sheet:i,from_sheet:p}})(),mS=(function(){function e(s,i){switch(i.type){case"base64":return t(Tn(s),i);case"binary":return t(s,i);case"buffer":return t(st&&Buffer.isBuffer(s)?s.toString("binary"):As(s),i);case"array":return t(uo(s),i)}throw new Error("Unrecognized type "+i.type)}function t(s,i){for(var c=s.split(`
`),u=-1,f=-1,h=0,p=[];h!==c.length;++h){if(c[h].trim()==="BOT"){p[++u]=[],f=0;continue}if(!(u<0)){var m=c[h].trim().split(","),y=m[0],w=m[1];++h;for(var x=c[h]||"";(x.match(/["]/g)||[]).length&1&&h<c.length-1;)x+=`
`+c[++h];switch(x=x.trim(),+y){case-1:if(x==="BOT"){p[++u]=[],f=0;continue}else if(x!=="EOD")throw new Error("Unrecognized DIF special command "+x);break;case 0:x==="TRUE"?p[u][f]=!0:x==="FALSE"?p[u][f]=!1:isNaN(oa(w))?isNaN(_i(w).getDate())?p[u][f]=w:p[u][f]=Rt(w):p[u][f]=oa(w),++f;break;case 1:x=x.slice(1,x.length-1),x=x.replace(/""/g,'"'),x&&x.match(/^=".*"$/)&&(x=x.slice(2,-1)),p[u][f++]=x!==""?x:null;break}if(x==="EOD")break}}return i&&i.sheetRows&&(p=p.slice(0,i.sheetRows)),p}function r(s,i){return Fi(e(s,i),i)}function n(s,i){return Ps(r(s,i),i)}var a=(function(){var s=function(u,f,h,p,m){u.push(f),u.push(h+","+p),u.push('"'+m.replace(/"/g,'""')+'"')},i=function(u,f,h,p){u.push(f+","+h),u.push(f==1?'"'+p.replace(/"/g,'""')+'"':p)};return function(u){var f=[],h=mt(u["!ref"]),p,m=Array.isArray(u);s(f,"TABLE",0,1,"sheetjs"),s(f,"VECTORS",0,h.e.r-h.s.r+1,""),s(f,"TUPLES",0,h.e.c-h.s.c+1,""),s(f,"DATA",0,0,"");for(var y=h.s.r;y<=h.e.r;++y){i(f,-1,0,"BOT");for(var w=h.s.c;w<=h.e.c;++w){var x=qe({r:y,c:w});if(p=m?(u[y]||[])[w]:u[x],!p){i(f,1,0,"");continue}switch(p.t){case"n":var _=p.w;!_&&p.v!=null&&(_=p.v),_==null?p.f&&!p.F?i(f,1,0,"="+p.f):i(f,1,0,""):i(f,0,_,"V");break;case"b":i(f,0,p.v?1:0,p.v?"TRUE":"FALSE");break;case"s":i(f,1,0,isNaN(p.v)?p.v:'="'+p.v+'"');break;case"d":p.w||(p.w=Un(p.z||Ge[14],pr(Rt(p.v)))),i(f,0,p.w,"V");break;default:i(f,1,0,"")}}}i(f,-1,0,"EOD");var E=`\r
`,k=f.join(E);return k}})();return{to_workbook:n,to_sheet:r,from_sheet:a}})(),vS=(function(){function e(p){return p.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(p){return p.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(p,m){for(var y=p.split(`
`),w=-1,x=-1,_=0,E=[];_!==y.length;++_){var k=y[_].trim().split(":");if(k[0]==="cell"){var b=Vt(k[1]);if(E.length<=b.r)for(w=E.length;w<=b.r;++w)E[w]||(E[w]=[]);switch(w=b.r,x=b.c,k[2]){case"t":E[w][x]=e(k[3]);break;case"v":E[w][x]=+k[3];break;case"vtf":var O=k[k.length-1];case"vtc":switch(k[3]){case"nl":E[w][x]=!!+k[4];break;default:E[w][x]=+k[4];break}k[2]=="vtf"&&(E[w][x]=[E[w][x],O])}}}return m&&m.sheetRows&&(E=E.slice(0,m.sheetRows)),E}function n(p,m){return Fi(r(p,m),m)}function a(p,m){return Ps(n(p,m),m)}var s=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),i=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,c=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),u="--SocialCalcSpreadsheetControlSave--";function f(p){if(!p||!p["!ref"])return"";for(var m=[],y=[],w,x="",_=fn(p["!ref"]),E=Array.isArray(p),k=_.s.r;k<=_.e.r;++k)for(var b=_.s.c;b<=_.e.c;++b)if(x=qe({r:k,c:b}),w=E?(p[k]||[])[b]:p[x],!(!w||w.v==null||w.t==="z")){switch(y=["cell",x,"t"],w.t){case"s":case"str":y.push(t(w.v));break;case"n":w.f?(y[2]="vtf",y[3]="n",y[4]=w.v,y[5]=t(w.f)):(y[2]="v",y[3]=w.v);break;case"b":y[2]="vt"+(w.f?"f":"c"),y[3]="nl",y[4]=w.v?"1":"0",y[5]=t(w.f||(w.v?"TRUE":"FALSE"));break;case"d":var O=pr(Rt(w.v));y[2]="vtc",y[3]="nd",y[4]=""+O,y[5]=w.w||Un(w.z||Ge[14],O);break;case"e":continue}m.push(y.join(":"))}return m.push("sheet:c:"+(_.e.c-_.s.c+1)+":r:"+(_.e.r-_.s.r+1)+":tvf:1"),m.push("valueformat:1:text-wiki"),m.join(`
`)}function h(p){return[s,i,c,i,f(p),u].join(`
`)}return{to_workbook:a,to_sheet:n,from_sheet:h}})(),Si=(function(){function e(h,p,m,y,w){w.raw?p[m][y]=h:h===""||(h==="TRUE"?p[m][y]=!0:h==="FALSE"?p[m][y]=!1:isNaN(oa(h))?isNaN(_i(h).getDate())?p[m][y]=h:p[m][y]=Rt(h):p[m][y]=oa(h))}function t(h,p){var m=p||{},y=[];if(!h||h.length===0)return y;for(var w=h.split(/[\r\n]/),x=w.length-1;x>=0&&w[x].length===0;)--x;for(var _=10,E=0,k=0;k<=x;++k)E=w[k].indexOf(" "),E==-1?E=w[k].length:E++,_=Math.max(_,E);for(k=0;k<=x;++k){y[k]=[];var b=0;for(e(w[k].slice(0,_).trim(),y,k,b,m),b=1;b<=(w[k].length-_)/10+1;++b)e(w[k].slice(_+(b-1)*10,_+b*10).trim(),y,k,b,m)}return m.sheetRows&&(y=y.slice(0,m.sheetRows)),y}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function a(h){for(var p={},m=!1,y=0,w=0;y<h.length;++y)(w=h.charCodeAt(y))==34?m=!m:!m&&w in r&&(p[w]=(p[w]||0)+1);w=[];for(y in p)Object.prototype.hasOwnProperty.call(p,y)&&w.push([p[y],y]);if(!w.length){p=n;for(y in p)Object.prototype.hasOwnProperty.call(p,y)&&w.push([p[y],y])}return w.sort(function(x,_){return x[0]-_[0]||n[x[1]]-n[_[1]]}),r[w.pop()[1]]||44}function s(h,p){var m=p||{},y="",w=m.dense?[]:{},x={s:{c:0,r:0},e:{c:0,r:0}};h.slice(0,4)=="sep="?h.charCodeAt(5)==13&&h.charCodeAt(6)==10?(y=h.charAt(4),h=h.slice(7)):h.charCodeAt(5)==13||h.charCodeAt(5)==10?(y=h.charAt(4),h=h.slice(6)):y=a(h.slice(0,1024)):m&&m.FS?y=m.FS:y=a(h.slice(0,1024));var _=0,E=0,k=0,b=0,O=0,z=y.charCodeAt(0),L=!1,P=0,J=h.charCodeAt(0);h=h.replace(/\r\n/mg,`
`);var V=m.dateNF!=null?SI(m.dateNF):null;function le(){var ee=h.slice(b,O),X={};if(ee.charAt(0)=='"'&&ee.charAt(ee.length-1)=='"'&&(ee=ee.slice(1,-1).replace(/""/g,'"')),ee.length===0)X.t="z";else if(m.raw)X.t="s",X.v=ee;else if(ee.trim().length===0)X.t="s",X.v=ee;else if(ee.charCodeAt(0)==61)ee.charCodeAt(1)==34&&ee.charCodeAt(ee.length-1)==34?(X.t="s",X.v=ee.slice(2,-1).replace(/""/g,'"')):YR(ee)?(X.t="n",X.f=ee.slice(1)):(X.t="s",X.v=ee);else if(ee=="TRUE")X.t="b",X.v=!0;else if(ee=="FALSE")X.t="b",X.v=!1;else if(!isNaN(k=oa(ee)))X.t="n",m.cellText!==!1&&(X.w=ee),X.v=k;else if(!isNaN(_i(ee).getDate())||V&&ee.match(V)){X.z=m.dateNF||Ge[14];var he=0;V&&ee.match(V)&&(ee=EI(ee,m.dateNF,ee.match(V)||[]),he=1),m.cellDates?(X.t="d",X.v=Rt(ee,he)):(X.t="n",X.v=pr(Rt(ee,he))),m.cellText!==!1&&(X.w=Un(X.z,X.v instanceof Date?pr(X.v):X.v)),m.cellNF||delete X.z}else X.t="s",X.v=ee;if(X.t=="z"||(m.dense?(w[_]||(w[_]=[]),w[_][E]=X):w[qe({c:E,r:_})]=X),b=O+1,J=h.charCodeAt(b),x.e.c<E&&(x.e.c=E),x.e.r<_&&(x.e.r=_),P==z)++E;else if(E=0,++_,m.sheetRows&&m.sheetRows<=_)return!0}e:for(;O<h.length;++O)switch(P=h.charCodeAt(O)){case 34:J===34&&(L=!L);break;case z:case 10:case 13:if(!L&&le())break e;break}return O-b>0&&le(),w["!ref"]=rt(x),w}function i(h,p){return!(p&&p.PRN)||p.FS||h.slice(0,4)=="sep="||h.indexOf("	")>=0||h.indexOf(",")>=0||h.indexOf(";")>=0?s(h,p):Fi(t(h,p),p)}function c(h,p){var m="",y=p.type=="string"?[0,0,0,0]:np(h,p);switch(p.type){case"base64":m=Tn(h);break;case"binary":m=h;break;case"buffer":p.codepage==65001?m=h.toString("utf8"):p.codepage&&typeof Xl<"u"||(m=st&&Buffer.isBuffer(h)?h.toString("binary"):As(h));break;case"array":m=uo(h);break;case"string":m=h;break;default:throw new Error("Unrecognized type "+p.type)}return y[0]==239&&y[1]==187&&y[2]==191?m=kt(m.slice(3)):p.type!="string"&&p.type!="buffer"&&p.codepage==65001?m=kt(m):p.type=="binary"&&typeof Xl<"u",m.slice(0,19)=="socialcalc:version:"?vS.to_sheet(p.type=="string"?m:kt(m),p):i(m,p)}function u(h,p){return Ps(c(h,p),p)}function f(h){for(var p=[],m=mt(h["!ref"]),y,w=Array.isArray(h),x=m.s.r;x<=m.e.r;++x){for(var _=[],E=m.s.c;E<=m.e.c;++E){var k=qe({r:x,c:E});if(y=w?(h[x]||[])[E]:h[k],!y||y.v==null){_.push("          ");continue}for(var b=(y.w||($a(y),y.w)||"").slice(0,10);b.length<10;)b+=" ";_.push(b+(E===0?" ":""))}p.push(_.join(""))}return p.join(`
`)}return{to_workbook:u,to_sheet:c,from_sheet:f}})();function MD(e,t){var r=t||{},n=!!r.WTF;r.WTF=!0;try{var a=pS.to_workbook(e,r);return r.WTF=n,a}catch(s){if(r.WTF=n,!s.message.match(/SYLK bad record ID/)&&n)throw s;return Si.to_workbook(e,t)}}var oo=(function(){function e(A,G,U){if(A){Ar(A,A.l||0);for(var W=U.Enum||fe;A.l<A.length;){var ne=A.read_shift(2),xe=W[ne]||W[65535],ve=A.read_shift(2),me=A.l+ve,ye=xe.f&&xe.f(A,ve,U);if(A.l=me,G(ye,xe,ne))return}}}function t(A,G){switch(G.type){case"base64":return r(bn(Tn(A)),G);case"binary":return r(bn(A),G);case"buffer":case"array":return r(A,G)}throw"Unsupported type "+G.type}function r(A,G){if(!A)return A;var U=G||{},W=U.dense?[]:{},ne="Sheet1",xe="",ve=0,me={},ye=[],Ze=[],j={s:{r:0,c:0},e:{r:0,c:0}},yt=U.sheetRows||0;if(A[2]==0&&(A[3]==8||A[3]==9)&&A.length>=16&&A[14]==5&&A[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(A[2]==2)U.Enum=fe,e(A,function(Re,Nt,Ir){switch(Ir){case 0:U.vers=Re,Re>=4096&&(U.qpro=!0);break;case 6:j=Re;break;case 204:Re&&(xe=Re);break;case 222:xe=Re;break;case 15:case 51:U.qpro||(Re[1].v=Re[1].v.slice(1));case 13:case 14:case 16:Ir==14&&(Re[2]&112)==112&&(Re[2]&15)>1&&(Re[2]&15)<15&&(Re[1].z=U.dateNF||Ge[14],U.cellDates&&(Re[1].t="d",Re[1].v=Uf(Re[1].v))),U.qpro&&Re[3]>ve&&(W["!ref"]=rt(j),me[ne]=W,ye.push(ne),W=U.dense?[]:{},j={s:{r:0,c:0},e:{r:0,c:0}},ve=Re[3],ne=xe||"Sheet"+(ve+1),xe="");var Or=U.dense?(W[Re[0].r]||[])[Re[0].c]:W[qe(Re[0])];if(Or){Or.t=Re[1].t,Or.v=Re[1].v,Re[1].z!=null&&(Or.z=Re[1].z),Re[1].f!=null&&(Or.f=Re[1].f);break}U.dense?(W[Re[0].r]||(W[Re[0].r]=[]),W[Re[0].r][Re[0].c]=Re[1]):W[qe(Re[0])]=Re[1];break}},U);else if(A[2]==26||A[2]==14)U.Enum=H,A[2]==14&&(U.qpro=!0,A.l=0),e(A,function(Re,Nt,Ir){switch(Ir){case 204:ne=Re;break;case 22:Re[1].v=Re[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(Re[3]>ve&&(W["!ref"]=rt(j),me[ne]=W,ye.push(ne),W=U.dense?[]:{},j={s:{r:0,c:0},e:{r:0,c:0}},ve=Re[3],ne="Sheet"+(ve+1)),yt>0&&Re[0].r>=yt)break;U.dense?(W[Re[0].r]||(W[Re[0].r]=[]),W[Re[0].r][Re[0].c]=Re[1]):W[qe(Re[0])]=Re[1],j.e.c<Re[0].c&&(j.e.c=Re[0].c),j.e.r<Re[0].r&&(j.e.r=Re[0].r);break;case 27:Re[14e3]&&(Ze[Re[14e3][0]]=Re[14e3][1]);break;case 1537:Ze[Re[0]]=Re[1],Re[0]==ve&&(ne=Re[1]);break}},U);else throw new Error("Unrecognized LOTUS BOF "+A[2]);if(W["!ref"]=rt(j),me[xe||ne]=W,ye.push(xe||ne),!Ze.length)return{SheetNames:ye,Sheets:me};for(var ot={},wt=[],at=0;at<Ze.length;++at)me[ye[at]]?(wt.push(Ze[at]||ye[at]),ot[Ze[at]]=me[Ze[at]]||me[ye[at]]):(wt.push(Ze[at]),ot[Ze[at]]={"!ref":"A1"});return{SheetNames:wt,Sheets:ot}}function n(A,G){var U=G||{};if(+U.codepage>=0&&na(+U.codepage),U.type=="string")throw new Error("Cannot write WK1 to JS string");var W=un(),ne=mt(A["!ref"]),xe=Array.isArray(A),ve=[];De(W,0,s(1030)),De(W,6,u(ne));for(var me=Math.min(ne.e.r,8191),ye=ne.s.r;ye<=me;++ye)for(var Ze=rr(ye),j=ne.s.c;j<=ne.e.c;++j){ye===ne.s.r&&(ve[j]=zt(j));var yt=ve[j]+Ze,ot=xe?(A[ye]||[])[j]:A[yt];if(!(!ot||ot.t=="z"))if(ot.t=="n")(ot.v|0)==ot.v&&ot.v>=-32768&&ot.v<=32767?De(W,13,y(ye,j,ot.v)):De(W,14,x(ye,j,ot.v));else{var wt=$a(ot);De(W,15,p(ye,j,wt.slice(0,239)))}}return De(W,1),W.end()}function a(A,G){var U=G||{};if(+U.codepage>=0&&na(+U.codepage),U.type=="string")throw new Error("Cannot write WK3 to JS string");var W=un();De(W,0,i(A));for(var ne=0,xe=0;ne<A.SheetNames.length;++ne)(A.Sheets[A.SheetNames[ne]]||{})["!ref"]&&De(W,27,K(A.SheetNames[ne],xe++));var ve=0;for(ne=0;ne<A.SheetNames.length;++ne){var me=A.Sheets[A.SheetNames[ne]];if(!(!me||!me["!ref"])){for(var ye=mt(me["!ref"]),Ze=Array.isArray(me),j=[],yt=Math.min(ye.e.r,8191),ot=ye.s.r;ot<=yt;++ot)for(var wt=rr(ot),at=ye.s.c;at<=ye.e.c;++at){ot===ye.s.r&&(j[at]=zt(at));var Re=j[at]+wt,Nt=Ze?(me[ot]||[])[at]:me[Re];if(!(!Nt||Nt.t=="z"))if(Nt.t=="n")De(W,23,le(ot,at,ve,Nt.v));else{var Ir=$a(Nt);De(W,22,P(ot,at,ve,Ir.slice(0,239)))}}++ve}}return De(W,1),W.end()}function s(A){var G=de(2);return G.write_shift(2,A),G}function i(A){var G=de(26);G.write_shift(2,4096),G.write_shift(2,4),G.write_shift(4,0);for(var U=0,W=0,ne=0,xe=0;xe<A.SheetNames.length;++xe){var ve=A.SheetNames[xe],me=A.Sheets[ve];if(!(!me||!me["!ref"])){++ne;var ye=fn(me["!ref"]);U<ye.e.r&&(U=ye.e.r),W<ye.e.c&&(W=ye.e.c)}}return U>8191&&(U=8191),G.write_shift(2,U),G.write_shift(1,ne),G.write_shift(1,W),G.write_shift(2,0),G.write_shift(2,0),G.write_shift(1,1),G.write_shift(1,2),G.write_shift(4,0),G.write_shift(4,0),G}function c(A,G,U){var W={s:{c:0,r:0},e:{c:0,r:0}};return G==8&&U.qpro?(W.s.c=A.read_shift(1),A.l++,W.s.r=A.read_shift(2),W.e.c=A.read_shift(1),A.l++,W.e.r=A.read_shift(2),W):(W.s.c=A.read_shift(2),W.s.r=A.read_shift(2),G==12&&U.qpro&&(A.l+=2),W.e.c=A.read_shift(2),W.e.r=A.read_shift(2),G==12&&U.qpro&&(A.l+=2),W.s.c==65535&&(W.s.c=W.e.c=W.s.r=W.e.r=0),W)}function u(A){var G=de(8);return G.write_shift(2,A.s.c),G.write_shift(2,A.s.r),G.write_shift(2,A.e.c),G.write_shift(2,A.e.r),G}function f(A,G,U){var W=[{c:0,r:0},{t:"n",v:0},0,0];return U.qpro&&U.vers!=20768?(W[0].c=A.read_shift(1),W[3]=A.read_shift(1),W[0].r=A.read_shift(2),A.l+=2):(W[2]=A.read_shift(1),W[0].c=A.read_shift(2),W[0].r=A.read_shift(2)),W}function h(A,G,U){var W=A.l+G,ne=f(A,G,U);if(ne[1].t="s",U.vers==20768){A.l++;var xe=A.read_shift(1);return ne[1].v=A.read_shift(xe,"utf8"),ne}return U.qpro&&A.l++,ne[1].v=A.read_shift(W-A.l,"cstr"),ne}function p(A,G,U){var W=de(7+U.length);W.write_shift(1,255),W.write_shift(2,G),W.write_shift(2,A),W.write_shift(1,39);for(var ne=0;ne<W.length;++ne){var xe=U.charCodeAt(ne);W.write_shift(1,xe>=128?95:xe)}return W.write_shift(1,0),W}function m(A,G,U){var W=f(A,G,U);return W[1].v=A.read_shift(2,"i"),W}function y(A,G,U){var W=de(7);return W.write_shift(1,255),W.write_shift(2,G),W.write_shift(2,A),W.write_shift(2,U,"i"),W}function w(A,G,U){var W=f(A,G,U);return W[1].v=A.read_shift(8,"f"),W}function x(A,G,U){var W=de(13);return W.write_shift(1,255),W.write_shift(2,G),W.write_shift(2,A),W.write_shift(8,U,"f"),W}function _(A,G,U){var W=A.l+G,ne=f(A,G,U);if(ne[1].v=A.read_shift(8,"f"),U.qpro)A.l=W;else{var xe=A.read_shift(2);O(A.slice(A.l,A.l+xe),ne),A.l+=xe}return ne}function E(A,G,U){var W=G&32768;return G&=-32769,G=(W?A:0)+(G>=8192?G-16384:G),(W?"":"$")+(U?zt(G):rr(G))}var k={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},b=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function O(A,G){Ar(A,0);for(var U=[],W=0,ne="",xe="",ve="",me="";A.l<A.length;){var ye=A[A.l++];switch(ye){case 0:U.push(A.read_shift(8,"f"));break;case 1:xe=E(G[0].c,A.read_shift(2),!0),ne=E(G[0].r,A.read_shift(2),!1),U.push(xe+ne);break;case 2:{var Ze=E(G[0].c,A.read_shift(2),!0),j=E(G[0].r,A.read_shift(2),!1);xe=E(G[0].c,A.read_shift(2),!0),ne=E(G[0].r,A.read_shift(2),!1),U.push(Ze+j+":"+xe+ne)}break;case 3:if(A.l<A.length){console.error("WK1 premature formula end");return}break;case 4:U.push("("+U.pop()+")");break;case 5:U.push(A.read_shift(2));break;case 6:{for(var yt="";ye=A[A.l++];)yt+=String.fromCharCode(ye);U.push('"'+yt.replace(/"/g,'""')+'"')}break;case 8:U.push("-"+U.pop());break;case 23:U.push("+"+U.pop());break;case 22:U.push("NOT("+U.pop()+")");break;case 20:case 21:me=U.pop(),ve=U.pop(),U.push(["AND","OR"][ye-20]+"("+ve+","+me+")");break;default:if(ye<32&&b[ye])me=U.pop(),ve=U.pop(),U.push(ve+b[ye]+me);else if(k[ye]){if(W=k[ye][1],W==69&&(W=A[A.l++]),W>U.length){console.error("WK1 bad formula parse 0x"+ye.toString(16)+":|"+U.join("|")+"|");return}var ot=U.slice(-W);U.length-=W,U.push(k[ye][0]+"("+ot.join(",")+")")}else return ye<=7?console.error("WK1 invalid opcode "+ye.toString(16)):ye<=24?console.error("WK1 unsupported op "+ye.toString(16)):ye<=30?console.error("WK1 invalid opcode "+ye.toString(16)):ye<=115?console.error("WK1 unsupported function opcode "+ye.toString(16)):console.error("WK1 unrecognized opcode "+ye.toString(16))}}U.length==1?G[1].f=""+U[0]:console.error("WK1 bad formula parse |"+U.join("|")+"|")}function z(A){var G=[{c:0,r:0},{t:"n",v:0},0];return G[0].r=A.read_shift(2),G[3]=A[A.l++],G[0].c=A[A.l++],G}function L(A,G){var U=z(A);return U[1].t="s",U[1].v=A.read_shift(G-4,"cstr"),U}function P(A,G,U,W){var ne=de(6+W.length);ne.write_shift(2,A),ne.write_shift(1,U),ne.write_shift(1,G),ne.write_shift(1,39);for(var xe=0;xe<W.length;++xe){var ve=W.charCodeAt(xe);ne.write_shift(1,ve>=128?95:ve)}return ne.write_shift(1,0),ne}function J(A,G){var U=z(A);U[1].v=A.read_shift(2);var W=U[1].v>>1;if(U[1].v&1)switch(W&7){case 0:W=(W>>3)*5e3;break;case 1:W=(W>>3)*500;break;case 2:W=(W>>3)/20;break;case 3:W=(W>>3)/200;break;case 4:W=(W>>3)/2e3;break;case 5:W=(W>>3)/2e4;break;case 6:W=(W>>3)/16;break;case 7:W=(W>>3)/64;break}return U[1].v=W,U}function V(A,G){var U=z(A),W=A.read_shift(4),ne=A.read_shift(4),xe=A.read_shift(2);if(xe==65535)return W===0&&ne===3221225472?(U[1].t="e",U[1].v=15):W===0&&ne===3489660928?(U[1].t="e",U[1].v=42):U[1].v=0,U;var ve=xe&32768;return xe=(xe&32767)-16446,U[1].v=(1-ve*2)*(ne*Math.pow(2,xe+32)+W*Math.pow(2,xe)),U}function le(A,G,U,W){var ne=de(14);if(ne.write_shift(2,A),ne.write_shift(1,U),ne.write_shift(1,G),W==0)return ne.write_shift(4,0),ne.write_shift(4,0),ne.write_shift(2,65535),ne;var xe=0,ve=0,me=0,ye=0;return W<0&&(xe=1,W=-W),ve=Math.log2(W)|0,W/=Math.pow(2,ve-31),ye=W>>>0,(ye&2147483648)==0&&(W/=2,++ve,ye=W>>>0),W-=ye,ye|=2147483648,ye>>>=0,W*=Math.pow(2,32),me=W>>>0,ne.write_shift(4,me),ne.write_shift(4,ye),ve+=16383+(xe?32768:0),ne.write_shift(2,ve),ne}function ee(A,G){var U=V(A);return A.l+=G-14,U}function X(A,G){var U=z(A),W=A.read_shift(4);return U[1].v=W>>6,U}function he(A,G){var U=z(A),W=A.read_shift(8,"f");return U[1].v=W,U}function Ie(A,G){var U=he(A);return A.l+=G-10,U}function Ee(A,G){return A[A.l+G-1]==0?A.read_shift(G,"cstr"):""}function Te(A,G){var U=A[A.l++];U>G-1&&(U=G-1);for(var W="";W.length<U;)W+=String.fromCharCode(A[A.l++]);return W}function oe(A,G,U){if(!(!U.qpro||G<21)){var W=A.read_shift(1);A.l+=17,A.l+=1,A.l+=2;var ne=A.read_shift(G-21,"cstr");return[W,ne]}}function ge(A,G){for(var U={},W=A.l+G;A.l<W;){var ne=A.read_shift(2);if(ne==14e3){for(U[ne]=[0,""],U[ne][0]=A.read_shift(2);A[A.l];)U[ne][1]+=String.fromCharCode(A[A.l]),A.l++;A.l++}}return U}function K(A,G){var U=de(5+A.length);U.write_shift(2,14e3),U.write_shift(2,G);for(var W=0;W<A.length;++W){var ne=A.charCodeAt(W);U[U.l++]=ne>127?95:ne}return U[U.l++]=0,U}var fe={0:{n:"BOF",f:cr},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:c},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:m},14:{n:"NUMBER",f:w},15:{n:"LABEL",f:h},16:{n:"FORMULA",f:_},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:h},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:Ee},222:{n:"SHEETNAMELP",f:Te},65535:{n:""}},H={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:L},23:{n:"NUMBER17",f:V},24:{n:"NUMBER18",f:J},25:{n:"FORMULA19",f:ee},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:ge},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:X},38:{n:"??"},39:{n:"NUMBER27",f:he},40:{n:"FORMULA28",f:Ie},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:Ee},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:oe},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:a,to_workbook:t}})();function BD(e){var t={},r=e.match(Kr),n=0,a=!1;if(r)for(;n!=r.length;++n){var s=Je(r[n]);switch(s[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!s.val)break;case"<shadow>":case"<shadow/>":t.shadow=1;break;case"</shadow>":break;case"<charset":if(s.val=="1")break;t.cp=wg[parseInt(s.val,10)];break;case"<outline":if(!s.val)break;case"<outline>":case"<outline/>":t.outline=1;break;case"</outline>":break;case"<rFont":t.name=s.val;break;case"<sz":t.sz=s.val;break;case"<strike":if(!s.val)break;case"<strike>":case"<strike/>":t.strike=1;break;case"</strike>":break;case"<u":if(!s.val)break;switch(s.val){case"double":t.uval="double";break;case"singleAccounting":t.uval="single-accounting";break;case"doubleAccounting":t.uval="double-accounting";break}case"<u>":case"<u/>":t.u=1;break;case"</u>":break;case"<b":if(s.val=="0")break;case"<b>":case"<b/>":t.b=1;break;case"</b>":break;case"<i":if(s.val=="0")break;case"<i>":case"<i/>":t.i=1;break;case"</i>":break;case"<color":s.rgb&&(t.color=s.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":t.family=s.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":t.valign=s.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(s[0].charCodeAt(1)!==47&&!a)throw new Error("Unrecognized rich format "+s[0])}}return t}var jD=(function(){var e=Ql("t"),t=Ql("rPr");function r(s){var i=s.match(e);if(!i)return{t:"s",v:""};var c={t:"s",v:pt(i[1])},u=s.match(t);return u&&(c.s=BD(u[1])),c}var n=/<(?:\w+:)?r>/g,a=/<\/(?:\w+:)?r>/;return function(i){return i.replace(n,"").split(a).map(r).filter(function(c){return c.v})}})(),$D=(function(){var t=/(\r\n|\n)/g;function r(a,s,i){var c=[];a.u&&c.push("text-decoration: underline;"),a.uval&&c.push("text-underline-style:"+a.uval+";"),a.sz&&c.push("font-size:"+a.sz+"pt;"),a.outline&&c.push("text-effect: outline;"),a.shadow&&c.push("text-shadow: auto;"),s.push('<span style="'+c.join("")+'">'),a.b&&(s.push("<b>"),i.push("</b>")),a.i&&(s.push("<i>"),i.push("</i>")),a.strike&&(s.push("<s>"),i.push("</s>"));var u=a.valign||"";return u=="superscript"||u=="super"?u="sup":u=="subscript"&&(u="sub"),u!=""&&(s.push("<"+u+">"),i.push("</"+u+">")),i.push("</span>"),a}function n(a){var s=[[],a.v,[]];return a.v?(a.s&&r(a.s,s[0],s[2]),s[0].join("")+s[1].replace(t,"<br/>")+s[2].join("")):""}return function(s){return s.map(n).join("")}})(),UD=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,zD=/<(?:\w+:)?r>/,VD=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function Wg(e,t){var r=t?t.cellHTML:!0,n={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=pt(kt(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=kt(e),r&&(n.h=Ig(n.t))):e.match(zD)&&(n.r=kt(e),n.t=pt(kt((e.replace(VD,"").match(UD)||[]).join("").replace(Kr,""))),r&&(n.h=$D(jD(n.r)))),n):{t:""}}var WD=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,HD=/<(?:\w+:)?(?:si|sstItem)>/g,GD=/<\/(?:\w+:)?(?:si|sstItem)>/;function qD(e,t){var r=[],n="";if(!e)return r;var a=e.match(WD);if(a){n=a[2].replace(HD,"").split(GD);for(var s=0;s!=n.length;++s){var i=Wg(n[s].trim(),t);i!=null&&(r[r.length]=i)}a=Je(a[1]),r.Count=a.count,r.Unique=a.uniqueCount}return r}var KD=/^\s|\s$|[\t\n\r]/;function xS(e,t){if(!t.bookSST)return"";var r=[ar];r[r.length]=Oe("sst",null,{xmlns:yo[0],count:e.Count,uniqueCount:e.Unique});for(var n=0;n!=e.length;++n)if(e[n]!=null){var a=e[n],s="<si>";a.r?s+=a.r:(s+="<t",a.t||(a.t=""),a.t.match(KD)&&(s+=' xml:space="preserve"'),s+=">"+bt(a.t)+"</t>"),s+="</si>",r[r.length]=s}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function XD(e){return[e.read_shift(4),e.read_shift(4)]}function JD(e,t){var r=[],n=!1;return Ha(e,function(s,i,c){switch(c){case 159:r.Count=s[0],r.Unique=s[1];break;case 19:r.push(s);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(i.T,!n||t.WTF)throw new Error("Unexpected record 0x"+c.toString(16))}}),r}function YD(e,t){return t||(t=de(8)),t.write_shift(4,e.Count),t.write_shift(4,e.Unique),t}var QD=l3;function ZD(e){var t=un();we(t,159,YD(e));for(var r=0;r<e.length;++r)we(t,19,QD(e[r]));return we(t,160),t.end()}function yS(e){for(var t=[],r=e.split(""),n=0;n<r.length;++n)t[n]=r[n].charCodeAt(0);return t}function Ba(e,t){var r={};return r.Major=e.read_shift(2),r.Minor=e.read_shift(2),t>=4&&(e.l+=t-4),r}function eF(e){var t={};return t.id=e.read_shift(0,"lpp4"),t.R=Ba(e,4),t.U=Ba(e,4),t.W=Ba(e,4),t}function tF(e){for(var t=e.read_shift(4),r=e.l+t-4,n={},a=e.read_shift(4),s=[];a-- >0;)s.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(n.name=e.read_shift(0,"lpp4"),n.comps=s,e.l!=r)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+r);return n}function rF(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(tF(e));return t}function nF(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(e.read_shift(0,"lpp4"));return t}function aF(e){var t={};return e.read_shift(4),e.l+=4,t.id=e.read_shift(0,"lpp4"),t.name=e.read_shift(0,"lpp4"),t.R=Ba(e,4),t.U=Ba(e,4),t.W=Ba(e,4),t}function sF(e){var t=aF(e);if(t.ename=e.read_shift(0,"8lpp4"),t.blksz=e.read_shift(4),t.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return t}function wS(e,t){var r=e.l+t,n={};n.Flags=e.read_shift(4)&63,e.l+=4,n.AlgID=e.read_shift(4);var a=!1;switch(n.AlgID){case 26126:case 26127:case 26128:a=n.Flags==36;break;case 26625:a=n.Flags==4;break;case 0:a=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!a)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=e.read_shift(4),n.KeySize=e.read_shift(4),n.ProviderType=e.read_shift(4),e.l+=8,n.CSPName=e.read_shift(r-e.l>>1,"utf16le"),e.l=r,n}function _S(e,t){var r={},n=e.l+t;return e.l+=4,r.Salt=e.slice(e.l,e.l+16),e.l+=16,r.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),r.VerifierHash=e.slice(e.l,n),e.l=n,r}function oF(e){var t=Ba(e);switch(t.Minor){case 2:return[t.Minor,iF(e)];case 3:return[t.Minor,lF()];case 4:return[t.Minor,cF(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+t.Minor)}function iF(e){var t=e.read_shift(4);if((t&63)!=36)throw new Error("EncryptionInfo mismatch");var r=e.read_shift(4),n=wS(e,r),a=_S(e,e.length-e.l);return{t:"Std",h:n,v:a}}function lF(){throw new Error("File is password-protected: ECMA-376 Extensible")}function cF(e){var t=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var r=e.read_shift(e.length-e.l,"utf8"),n={};return r.replace(Kr,function(s){var i=Je(s);switch(wa(i[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":t.forEach(function(c){n[c]=i[c]});break;case"<dataIntegrity":n.encryptedHmacKey=i.encryptedHmacKey,n.encryptedHmacValue=i.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=i.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(i);break;default:throw i[0]}}),n}function uF(e,t){var r={},n=r.EncryptionVersionInfo=Ba(e,4);if(t-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);r.Flags=e.read_shift(4),t-=4;var a=e.read_shift(4);return t-=4,r.EncryptionHeader=wS(e,a),t-=a,r.EncryptionVerifier=_S(e,t),r}function fF(e){var t={},r=t.EncryptionVersionInfo=Ba(e,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return t.Salt=e.read_shift(16),t.EncryptedVerifier=e.read_shift(16),t.EncryptedVerifierHash=e.read_shift(16),t}function Hg(e){var t=0,r,n=yS(e),a=n.length+1,s,i,c,u,f;for(r=Ss(a),r[0]=n.length,s=1;s!=a;++s)r[s]=n[s-1];for(s=a-1;s>=0;--s)i=r[s],c=(t&16384)===0?0:1,u=t<<1&32767,f=c|u,t=f^i;return t^52811}var SS=(function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],t=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(i){return(i/2|i*128)&255},a=function(i,c){return n(i^c)},s=function(i){for(var c=t[i.length-1],u=104,f=i.length-1;f>=0;--f)for(var h=i[f],p=0;p!=7;++p)h&64&&(c^=r[u]),h*=2,--u;return c};return function(i){for(var c=yS(i),u=s(c),f=c.length,h=Ss(16),p=0;p!=16;++p)h[p]=0;var m,y,w;for((f&1)===1&&(m=u>>8,h[f]=a(e[0],m),--f,m=u&255,y=c[c.length-1],h[f]=a(y,m));f>0;)--f,m=u>>8,h[f]=a(c[f],m),--f,m=u&255,h[f]=a(c[f],m);for(f=15,w=15-c.length;w>0;)m=u>>8,h[f]=a(e[w],m),--f,--w,m=u&255,h[f]=a(c[f],m),--f,--w;return h}})(),dF=function(e,t,r,n,a){a||(a=t),n||(n=SS(e));var s,i;for(s=0;s!=t.length;++s)i=t[s],i^=n[r],i=(i>>5|i<<3)&255,a[s]=i,++r;return[a,r,n]},hF=function(e){var t=0,r=SS(e);return function(n){var a=dF("",n,t,r);return t=a[1],a[0]}};function gF(e,t,r,n){var a={key:cr(e),verificationBytes:cr(e)};return r.password&&(a.verifier=Hg(r.password)),n.valid=a.verificationBytes===a.verifier,n.valid&&(n.insitu=hF(r.password)),a}function pF(e,t,r){var n=r||{};return n.Info=e.read_shift(2),e.l-=2,n.Info===1?n.Data=fF(e):n.Data=uF(e,t),n}function mF(e,t,r){var n={Type:r.biff>=8?e.read_shift(2):0};return n.Type?pF(e,t-2,n):gF(e,r.biff>=8?t:t-2,r,n),n}var ES=(function(){function e(a,s){switch(s.type){case"base64":return t(Tn(a),s);case"binary":return t(a,s);case"buffer":return t(st&&Buffer.isBuffer(a)?a.toString("binary"):As(a),s);case"array":return t(uo(a),s)}throw new Error("Unrecognized type "+s.type)}function t(a,s){var i=s||{},c=i.dense?[]:{},u=a.match(/\\trowd.*?\\row\b/g);if(!u.length)throw new Error("RTF missing table");var f={s:{c:0,r:0},e:{c:0,r:u.length-1}};return u.forEach(function(h,p){Array.isArray(c)&&(c[p]=[]);for(var m=/\\\w+\b/g,y=0,w,x=-1;w=m.exec(h);){switch(w[0]){case"\\cell":var _=h.slice(y,m.lastIndex-w[0].length);if(_[0]==" "&&(_=_.slice(1)),++x,_.length){var E={v:_,t:"s"};Array.isArray(c)?c[p][x]=E:c[qe({r:p,c:x})]=E}break}y=m.lastIndex}x>f.e.c&&(f.e.c=x)}),c["!ref"]=rt(f),c}function r(a,s){return Ps(e(a,s),s)}function n(a){for(var s=["{\\rtf1\\ansi"],i=mt(a["!ref"]),c,u=Array.isArray(a),f=i.s.r;f<=i.e.r;++f){s.push("\\trowd\\trautofit1");for(var h=i.s.c;h<=i.e.c;++h)s.push("\\cellx"+(h+1));for(s.push("\\pard\\intbl"),h=i.s.c;h<=i.e.c;++h){var p=qe({r:f,c:h});c=u?(a[f]||[])[h]:a[p],!(!c||c.v==null&&(!c.f||c.F))&&(s.push(" "+(c.w||($a(c),c.w))),s.push("\\cell"))}s.push("\\pard\\intbl\\row")}return s.join("")+"}"}return{to_workbook:r,to_sheet:e,from_sheet:n}})();function vF(e){var t=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(t.slice(0,2),16),parseInt(t.slice(2,4),16),parseInt(t.slice(4,6),16)]}function rc(e){for(var t=0,r=1;t!=3;++t)r=r*256+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}function xF(e){var t=e[0]/255,r=e[1]/255,n=e[2]/255,a=Math.max(t,r,n),s=Math.min(t,r,n),i=a-s;if(i===0)return[0,0,t];var c=0,u=0,f=a+s;switch(u=i/(f>1?2-f:f),a){case t:c=((r-n)/i+6)%6;break;case r:c=(n-t)/i+2;break;case n:c=(t-r)/i+4;break}return[c/6,u,f/2]}function yF(e){var t=e[0],r=e[1],n=e[2],a=r*2*(n<.5?n:1-n),s=n-a/2,i=[s,s,s],c=6*t,u;if(r!==0)switch(c|0){case 0:case 6:u=a*c,i[0]+=a,i[1]+=u;break;case 1:u=a*(2-c),i[0]+=u,i[1]+=a;break;case 2:u=a*(c-2),i[1]+=a,i[2]+=u;break;case 3:u=a*(4-c),i[1]+=u,i[2]+=a;break;case 4:u=a*(c-4),i[2]+=a,i[0]+=u;break;case 5:u=a*(6-c),i[2]+=u,i[0]+=a;break}for(var f=0;f!=3;++f)i[f]=Math.round(i[f]*255);return i}function bf(e,t){if(t===0)return e;var r=xF(vF(e));return t<0?r[2]=r[2]*(1+t):r[2]=1-(1-r[2])*(1-t),rc(yF(r))}var bS=6,wF=15,_F=1,Vr=bS;function nc(e){return Math.floor((e+Math.round(128/Vr)/256)*Vr)}function ac(e){return Math.floor((e-5)/Vr*100+.5)/100}function kf(e){return Math.round((e*Vr+5)/Vr*256)/256}function th(e){return kf(ac(nc(e)))}function Gg(e){var t=Math.abs(e-th(e)),r=Vr;if(t>.005)for(Vr=_F;Vr<wF;++Vr)Math.abs(e-th(e))<=t&&(t=Math.abs(e-th(e)),r=Vr);Vr=r}function Es(e){e.width?(e.wpx=nc(e.width),e.wch=ac(e.wpx),e.MDW=Vr):e.wpx?(e.wch=ac(e.wpx),e.width=kf(e.wch),e.MDW=Vr):typeof e.wch=="number"&&(e.width=kf(e.wch),e.wpx=nc(e.width),e.MDW=Vr),e.customWidth&&delete e.customWidth}var SF=96,kS=SF;function sc(e){return e*96/kS}function Ei(e){return e*kS/96}var EF={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function bF(e,t,r,n){t.Borders=[];var a={},s=!1;(e[0].match(Kr)||[]).forEach(function(i){var c=Je(i);switch(wa(c[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":a={},c.diagonalUp&&(a.diagonalUp=Ft(c.diagonalUp)),c.diagonalDown&&(a.diagonalDown=Ft(c.diagonalDown)),t.Borders.push(a);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+c[0]+" in borders")}})}function kF(e,t,r,n){t.Fills=[];var a={},s=!1;(e[0].match(Kr)||[]).forEach(function(i){var c=Je(i);switch(wa(c[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":a={},t.Fills.push(a);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":t.Fills.push(a),a={};break;case"<patternFill":case"<patternFill>":c.patternType&&(a.patternType=c.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":a.bgColor||(a.bgColor={}),c.indexed&&(a.bgColor.indexed=parseInt(c.indexed,10)),c.theme&&(a.bgColor.theme=parseInt(c.theme,10)),c.tint&&(a.bgColor.tint=parseFloat(c.tint)),c.rgb&&(a.bgColor.rgb=c.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":a.fgColor||(a.fgColor={}),c.theme&&(a.fgColor.theme=parseInt(c.theme,10)),c.tint&&(a.fgColor.tint=parseFloat(c.tint)),c.rgb!=null&&(a.fgColor.rgb=c.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+c[0]+" in fills")}})}function TF(e,t,r,n){t.Fonts=[];var a={},s=!1;(e[0].match(Kr)||[]).forEach(function(i){var c=Je(i);switch(wa(c[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":t.Fonts.push(a),a={};break;case"<name":c.val&&(a.name=kt(c.val));break;case"<name/>":case"</name>":break;case"<b":a.bold=c.val?Ft(c.val):1;break;case"<b/>":a.bold=1;break;case"<i":a.italic=c.val?Ft(c.val):1;break;case"<i/>":a.italic=1;break;case"<u":switch(c.val){case"none":a.underline=0;break;case"single":a.underline=1;break;case"double":a.underline=2;break;case"singleAccounting":a.underline=33;break;case"doubleAccounting":a.underline=34;break}break;case"<u/>":a.underline=1;break;case"<strike":a.strike=c.val?Ft(c.val):1;break;case"<strike/>":a.strike=1;break;case"<outline":a.outline=c.val?Ft(c.val):1;break;case"<outline/>":a.outline=1;break;case"<shadow":a.shadow=c.val?Ft(c.val):1;break;case"<shadow/>":a.shadow=1;break;case"<condense":a.condense=c.val?Ft(c.val):1;break;case"<condense/>":a.condense=1;break;case"<extend":a.extend=c.val?Ft(c.val):1;break;case"<extend/>":a.extend=1;break;case"<sz":c.val&&(a.sz=+c.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":c.val&&(a.vertAlign=c.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":c.val&&(a.family=parseInt(c.val,10));break;case"<family/>":case"</family>":break;case"<scheme":c.val&&(a.scheme=c.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(c.val=="1")break;c.codepage=wg[parseInt(c.val,10)];break;case"<color":if(a.color||(a.color={}),c.auto&&(a.color.auto=Ft(c.auto)),c.rgb)a.color.rgb=c.rgb.slice(-6);else if(c.indexed){a.color.index=parseInt(c.indexed,10);var u=ao[a.color.index];a.color.index==81&&(u=ao[1]),u||(u=ao[1]),a.color.rgb=u[0].toString(16)+u[1].toString(16)+u[2].toString(16)}else c.theme&&(a.color.theme=parseInt(c.theme,10),c.tint&&(a.color.tint=parseFloat(c.tint)),c.theme&&r.themeElements&&r.themeElements.clrScheme&&(a.color.rgb=bf(r.themeElements.clrScheme[a.color.theme].rgb,a.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":s=!0;break;case"</AlternateContent>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+c[0]+" in fonts")}})}function CF(e,t,r){t.NumberFmt=[];for(var n=Xt(Ge),a=0;a<n.length;++a)t.NumberFmt[n[a]]=Ge[n[a]];var s=e[0].match(Kr);if(s)for(a=0;a<s.length;++a){var i=Je(s[a]);switch(wa(i[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var c=pt(kt(i.formatCode)),u=parseInt(i.numFmtId,10);if(t.NumberFmt[u]=c,u>0){if(u>392){for(u=392;u>60&&t.NumberFmt[u]!=null;--u);t.NumberFmt[u]=c}Ma(c,u)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+i[0]+" in numFmts")}}}function AF(e){var t=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var n=r[0];n<=r[1];++n)e[n]!=null&&(t[t.length]=Oe("numFmt",null,{numFmtId:n,formatCode:bt(e[n])}))}),t.length===1?"":(t[t.length]="</numFmts>",t[0]=Oe("numFmts",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var ef=["numFmtId","fillId","fontId","borderId","xfId"],tf=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function PF(e,t,r){t.CellXf=[];var n,a=!1;(e[0].match(Kr)||[]).forEach(function(s){var i=Je(s),c=0;switch(wa(i[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=i,delete n[0],c=0;c<ef.length;++c)n[ef[c]]&&(n[ef[c]]=parseInt(n[ef[c]],10));for(c=0;c<tf.length;++c)n[tf[c]]&&(n[tf[c]]=Ft(n[tf[c]]));if(t.NumberFmt&&n.numFmtId>392){for(c=392;c>60;--c)if(t.NumberFmt[n.numFmtId]==t.NumberFmt[c]){n.numFmtId=c;break}}t.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var u={};i.vertical&&(u.vertical=i.vertical),i.horizontal&&(u.horizontal=i.horizontal),i.textRotation!=null&&(u.textRotation=i.textRotation),i.indent&&(u.indent=i.indent),i.wrapText&&(u.wrapText=Ft(i.wrapText)),n.alignment=u;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":a=!0;break;case"</AlternateContent>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(r&&r.WTF&&!a)throw new Error("unrecognized "+i[0]+" in cellXfs")}})}function IF(e){var t=[];return t[t.length]=Oe("cellXfs",null),e.forEach(function(r){t[t.length]=Oe("xf",null,r)}),t[t.length]="</cellXfs>",t.length===2?"":(t[0]=Oe("cellXfs",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var OF=(function(){var t=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,a=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,s=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(c,u,f){var h={};if(!c)return h;c=c.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var p;return(p=c.match(t))&&CF(p,h,f),(p=c.match(a))&&TF(p,h,u,f),(p=c.match(n))&&kF(p,h,u,f),(p=c.match(s))&&bF(p,h,u,f),(p=c.match(r))&&PF(p,h,f),h}})();function TS(e,t){var r=[ar,Oe("styleSheet",null,{xmlns:yo[0],"xmlns:vt":gr.vt})],n;return e.SSF&&(n=AF(e.SSF))!=null&&(r[r.length]=n),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=IF(t.cellXfs))&&(r[r.length]=n),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function DF(e,t){var r=e.read_shift(2),n=Hr(e);return[r,n]}function FF(e,t,r){r||(r=de(6+4*t.length)),r.write_shift(2,e),br(t,r);var n=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),n}function RF(e,t,r){var n={};n.sz=e.read_shift(2)/20;var a=p3(e);a.fItalic&&(n.italic=1),a.fCondense&&(n.condense=1),a.fExtend&&(n.extend=1),a.fShadow&&(n.shadow=1),a.fOutline&&(n.outline=1),a.fStrikeout&&(n.strike=1);var s=e.read_shift(2);switch(s===700&&(n.bold=1),e.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var i=e.read_shift(1);i!=0&&(n.underline=i);var c=e.read_shift(1);c>0&&(n.family=c);var u=e.read_shift(1);switch(u>0&&(n.charset=u),e.l++,n.color=g3(e),e.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=Hr(e),n}function LF(e,t){t||(t=de(153)),t.write_shift(2,e.sz*20),m3(e,t),t.write_shift(2,e.bold?700:400);var r=0;e.vertAlign=="superscript"?r=1:e.vertAlign=="subscript"&&(r=2),t.write_shift(2,r),t.write_shift(1,e.underline||0),t.write_shift(1,e.family||0),t.write_shift(1,e.charset||0),t.write_shift(1,0),_f(e.color,t);var n=0;return n=2,t.write_shift(1,n),br(e.name,t),t.length>t.l?t.slice(0,t.l):t}var NF=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],rh,MF=Gr;function Px(e,t){t||(t=de(84)),rh||(rh=jf(NF));var r=rh[e.patternType];r==null&&(r=40),t.write_shift(4,r);var n=0;if(r!=40)for(_f({auto:1},t),_f({auto:1},t);n<12;++n)t.write_shift(4,0);else{for(;n<4;++n)t.write_shift(4,0);for(;n<12;++n)t.write_shift(4,0)}return t.length>t.l?t.slice(0,t.l):t}function BF(e,t){var r=e.l+t,n=e.read_shift(2),a=e.read_shift(2);return e.l=r,{ixfe:n,numFmtId:a}}function CS(e,t,r){r||(r=de(16)),r.write_shift(2,t||0),r.write_shift(2,e.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var n=0;return r.write_shift(1,n),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function El(e,t){return t||(t=de(10)),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(4,0),t}var jF=Gr;function $F(e,t){return t||(t=de(51)),t.write_shift(1,0),El(null,t),El(null,t),El(null,t),El(null,t),El(null,t),t.length>t.l?t.slice(0,t.l):t}function UF(e,t){return t||(t=de(52)),t.write_shift(4,e.xfId),t.write_shift(2,1),t.write_shift(1,0),t.write_shift(1,0),wf(e.name||"",t),t.length>t.l?t.slice(0,t.l):t}function zF(e,t,r){var n=de(2052);return n.write_shift(4,e),wf(t,n),wf(r,n),n.length>n.l?n.slice(0,n.l):n}function VF(e,t,r){var n={};n.NumberFmt=[];for(var a in Ge)n.NumberFmt[a]=Ge[a];n.CellXf=[],n.Fonts=[];var s=[],i=!1;return Ha(e,function(u,f,h){switch(h){case 44:n.NumberFmt[u[0]]=u[1],Ma(u[1],u[0]);break;case 43:n.Fonts.push(u),u.color.theme!=null&&t&&t.themeElements&&t.themeElements.clrScheme&&(u.color.rgb=bf(t.themeElements.clrScheme[u.color.theme].rgb,u.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:s[s.length-1]==617&&n.CellXf.push(u);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:s.push(h),i=!0;break;case 38:s.pop(),i=!1;break;default:if(f.T>0)s.push(h);else if(f.T<0)s.pop();else if(!i||r.WTF&&s[s.length-1]!=37)throw new Error("Unexpected record 0x"+h.toString(16))}}),n}function WF(e,t){if(t){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)t[a]!=null&&++r}),r!=0&&(we(e,615,ia(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)t[a]!=null&&we(e,44,FF(a,t[a]))}),we(e,616))}}function HF(e){var t=1;we(e,611,ia(t)),we(e,43,LF({sz:12,color:{theme:1},name:"Calibri",family:2})),we(e,612)}function GF(e){var t=2;we(e,603,ia(t)),we(e,45,Px({patternType:"none"})),we(e,45,Px({patternType:"gray125"})),we(e,604)}function qF(e){var t=1;we(e,613,ia(t)),we(e,46,$F()),we(e,614)}function KF(e){var t=1;we(e,626,ia(t)),we(e,47,CS({numFmtId:0},65535)),we(e,627)}function XF(e,t){we(e,617,ia(t.length)),t.forEach(function(r){we(e,47,CS(r,0))}),we(e,618)}function JF(e){var t=1;we(e,619,ia(t)),we(e,48,UF({xfId:0,name:"Normal"})),we(e,620)}function YF(e){var t=0;we(e,505,ia(t)),we(e,506)}function QF(e){var t=0;we(e,508,zF(t,"TableStyleMedium9","PivotStyleMedium4")),we(e,509)}function ZF(e,t){var r=un();return we(r,278),WF(r,e.SSF),HF(r),GF(r),qF(r),KF(r),XF(r,t.cellXfs),JF(r),YF(r),QF(r),we(r,279),r.end()}var eR=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function tR(e,t,r){t.themeElements.clrScheme=[];var n={};(e[0].match(Kr)||[]).forEach(function(a){var s=Je(a);switch(s[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=s.val;break;case"<a:sysClr":n.rgb=s.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":s[0].charAt(1)==="/"?(t.themeElements.clrScheme[eR.indexOf(s[0])]=n,n={}):n.name=s[0].slice(3,s[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+s[0]+" in clrScheme")}})}function rR(){}function nR(){}var aR=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,sR=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,oR=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function iR(e,t,r){t.themeElements={};var n;[["clrScheme",aR,tR],["fontScheme",sR,rR],["fmtScheme",oR,nR]].forEach(function(a){if(!(n=e.match(a[1])))throw new Error(a[0]+" not found in themeElements");a[2](n,t,r)})}var lR=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function AS(e,t){(!e||e.length===0)&&(e=qg());var r,n={};if(!(r=e.match(lR)))throw new Error("themeElements not found in theme");return iR(r[0],n,t),n.raw=e,n}function qg(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var r=[ar];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function cR(e,t,r){var n=e.l+t,a=e.read_shift(4);if(a!==124226){if(!r.cellStyles){e.l=n;return}var s=e.slice(e.l);e.l=n;var i;try{i=w_(s,{type:"array"})}catch{return}var c=kn(i,"theme/theme/theme1.xml",!0);if(c)return AS(c,r)}}function uR(e){return e.read_shift(4)}function fR(e){var t={};switch(t.xclrType=e.read_shift(2),t.nTintShade=e.read_shift(2),t.xclrType){case 0:e.l+=4;break;case 1:t.xclrValue=dR(e,4);break;case 2:t.xclrValue=iS(e);break;case 3:t.xclrValue=uR(e);break;case 4:e.l+=4;break}return e.l+=8,t}function dR(e,t){return Gr(e,t)}function hR(e,t){return Gr(e,t)}function gR(e){var t=e.read_shift(2),r=e.read_shift(2)-4,n=[t];switch(t){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=fR(e);break;case 6:n[1]=hR(e,r);break;case 14:case 15:n[1]=e.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+t+" "+r)}return n}function pR(e,t){var r=e.l+t;e.l+=2;var n=e.read_shift(2);e.l+=2;for(var a=e.read_shift(2),s=[];a-- >0;)s.push(gR(e,r-e.l));return{ixfe:n,ext:s}}function mR(e,t){t.forEach(function(r){r[0]})}function vR(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:Hr(e)}}function xR(e){var t=de(12+2*e.name.length);return t.write_shift(4,e.flags),t.write_shift(4,e.version),br(e.name,t),t.slice(0,t.l)}function yR(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function wR(e){var t=de(4+8*e.length);t.write_shift(4,e.length);for(var r=0;r<e.length;++r)t.write_shift(4,e[r][0]),t.write_shift(4,e[r][1]);return t}function _R(e,t){var r=de(8+2*t.length);return r.write_shift(4,e),br(t,r),r.slice(0,r.l)}function SR(e){return e.l+=4,e.read_shift(4)!=0}function ER(e,t){var r=de(8);return r.write_shift(4,e),r.write_shift(4,1),r}function bR(e,t,r){var n={Types:[],Cell:[],Value:[]},a=r||{},s=[],i=!1,c=2;return Ha(e,function(u,f,h){switch(h){case 335:n.Types.push({name:u.name});break;case 51:u.forEach(function(p){c==1?n.Cell.push({type:n.Types[p[0]-1].name,index:p[1]}):c==0&&n.Value.push({type:n.Types[p[0]-1].name,index:p[1]})});break;case 337:c=u?1:0;break;case 338:c=2;break;case 35:s.push(h),i=!0;break;case 36:s.pop(),i=!1;break;default:if(!f.T){if(!i||a.WTF&&s[s.length-1]!=35)throw new Error("Unexpected record 0x"+h.toString(16))}}}),n}function kR(){var e=un();return we(e,332),we(e,334,ia(1)),we(e,335,xR({name:"XLDAPR",version:12e4,flags:3496657072})),we(e,336),we(e,339,_R(1,"XLDAPR")),we(e,52),we(e,35,ia(514)),we(e,4096,ia(0)),we(e,4097,jn(1)),we(e,36),we(e,53),we(e,340),we(e,337,ER(1)),we(e,51,wR([[1,0]])),we(e,338),we(e,333),e.end()}function TR(e,t,r){var n={Types:[],Cell:[],Value:[]};if(!e)return n;var a=!1,s=2,i;return e.replace(Kr,function(c){var u=Je(c);switch(wa(u[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:u.name});break;case"</metadataType>":break;case"<futureMetadata":for(var f=0;f<n.Types.length;++f)n.Types[f].name==u.name&&(i=n.Types[f]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":s==1?n.Cell.push({type:n.Types[u.t-1].name,index:+u.v}):s==0&&n.Value.push({type:n.Types[u.t-1].name,index:+u.v});break;case"</rc>":break;case"<cellMetadata":s=1;break;case"</cellMetadata>":s=2;break;case"<valueMetadata":s=0;break;case"</valueMetadata>":s=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;case"<rvb":if(!i)break;i.offsets||(i.offsets=[]),i.offsets.push(+u.i);break;default:if(!a&&r.WTF)throw new Error("unrecognized "+u[0]+" in metadata")}return c}),n}function PS(){var e=[ar];return e.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),e.join("")}function CR(e){var t=[];if(!e)return t;var r=1;return(e.match(Kr)||[]).forEach(function(n){var a=Je(n);switch(a[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete a[0],a.i?r=a.i:a.i=r,t.push(a);break}}),t}function AR(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=qe(r);var n=e.read_shift(1);return n&2&&(t.l="1"),n&8&&(t.a="1"),t}function PR(e,t,r){var n=[];return Ha(e,function(s,i,c){switch(c){case 63:n.push(s);break;default:if(!i.T)throw new Error("Unexpected record 0x"+c.toString(16))}}),n}function IR(e,t,r,n){if(!e)return e;var a=n||{},s=!1;Ha(e,function(c,u,f){switch(f){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:s=!0;break;case 36:s=!1;break;default:if(!u.T){if(!s||a.WTF)throw new Error("Unexpected record 0x"+f.toString(16))}}},a)}function OR(e,t){if(!e)return"??";var r=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return t["!id"][r].Target}var ci=1024;function IS(e,t){for(var r=[21600,21600],n=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),a=[Oe("xml",null,{"xmlns:v":yn.v,"xmlns:o":yn.o,"xmlns:x":yn.x,"xmlns:mv":yn.mv}).replace(/\/>/,">"),Oe("o:shapelayout",Oe("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),Oe("v:shapetype",[Oe("v:stroke",null,{joinstyle:"miter"}),Oe("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:n})];ci<e*1e3;)ci+=1e3;return t.forEach(function(s){var i=Vt(s[0]),c={color2:"#BEFF82",type:"gradient"};c.type=="gradient"&&(c.angle="-180");var u=c.type=="gradient"?Oe("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,f=Oe("v:fill",u,c),h={on:"t",obscured:"t"};++ci,a=a.concat(["<v:shape"+Zl({id:"_x0000_s"+ci,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(s[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",f,Oe("v:shadow",null,h),Oe("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",Pr("x:Anchor",[i.c+1,0,i.r+1,0,i.c+3,20,i.r+5,20].join(",")),Pr("x:AutoFill","False"),Pr("x:Row",String(i.r)),Pr("x:Column",String(i.c)),s[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),a.push("</xml>"),a.join("")}function Ix(e,t,r,n){var a=Array.isArray(e),s;t.forEach(function(i){var c=Vt(i.ref);if(a?(e[c.r]||(e[c.r]=[]),s=e[c.r][c.c]):s=e[i.ref],!s){s={t:"z"},a?e[c.r][c.c]=s:e[i.ref]=s;var u=mt(e["!ref"]||"BDWGO1000001:A1");u.s.r>c.r&&(u.s.r=c.r),u.e.r<c.r&&(u.e.r=c.r),u.s.c>c.c&&(u.s.c=c.c),u.e.c<c.c&&(u.e.c=c.c);var f=rt(u);f!==e["!ref"]&&(e["!ref"]=f)}s.c||(s.c=[]);var h={a:i.author,t:i.t,r:i.r,T:r};i.h&&(h.h=i.h);for(var p=s.c.length-1;p>=0;--p){if(!r&&s.c[p].T)return;r&&!s.c[p].T&&s.c.splice(p,1)}if(r&&n){for(p=0;p<n.length;++p)if(h.a==n[p].id){h.a=n[p].name||h.a;break}}s.c.push(h)})}function DR(e,t){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],n=[],a=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);a&&a[1]&&a[1].split(/<\/\w*:?author>/).forEach(function(i){if(!(i===""||i.trim()==="")){var c=i.match(/<(?:\w+:)?author[^>]*>(.*)/);c&&r.push(c[1])}});var s=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return s&&s[1]&&s[1].split(/<\/\w*:?comment>/).forEach(function(i){if(!(i===""||i.trim()==="")){var c=i.match(/<(?:\w+:)?comment[^>]*>/);if(c){var u=Je(c[0]),f={author:u.authorId&&r[u.authorId]||"sheetjsghost",ref:u.ref,guid:u.guid},h=Vt(u.ref);if(!(t.sheetRows&&t.sheetRows<=h.r)){var p=i.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),m=!!p&&!!p[1]&&Wg(p[1])||{r:"",t:"",h:""};f.r=m.r,m.r=="<t></t>"&&(m.t=m.h=""),f.t=(m.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.cellHTML&&(f.h=m.h),n.push(f)}}}}),n}function OS(e){var t=[ar,Oe("comments",null,{xmlns:yo[0]})],r=[];return t.push("<authors>"),e.forEach(function(n){n[1].forEach(function(a){var s=bt(a.a);r.indexOf(s)==-1&&(r.push(s),t.push("<author>"+s+"</author>")),a.T&&a.ID&&r.indexOf("tc="+a.ID)==-1&&(r.push("tc="+a.ID),t.push("<author>tc="+a.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),t.push("<author>SheetJ5</author>")),t.push("</authors>"),t.push("<commentList>"),e.forEach(function(n){var a=0,s=[];if(n[1][0]&&n[1][0].T&&n[1][0].ID?a=r.indexOf("tc="+n[1][0].ID):n[1].forEach(function(u){u.a&&(a=r.indexOf(bt(u.a))),s.push(u.t||"")}),t.push('<comment ref="'+n[0]+'" authorId="'+a+'"><text>'),s.length<=1)t.push(Pr("t",bt(s[0]||"")));else{for(var i=`Comment:
    `+s[0]+`
`,c=1;c<s.length;++c)i+=`Reply:
    `+s[c]+`
`;t.push(Pr("t",bt(i)))}t.push("</text></comment>")}),t.push("</commentList>"),t.length>2&&(t[t.length]="</comments>",t[1]=t[1].replace("/>",">")),t.join("")}function FR(e,t){var r=[],n=!1,a={},s=0;return e.replace(Kr,function(c,u){var f=Je(c);switch(wa(f[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":a={author:f.personId,guid:f.id,ref:f.ref,T:1};break;case"</threadedComment>":a.t!=null&&r.push(a);break;case"<text>":case"<text":s=u+c.length;break;case"</text>":a.t=e.slice(s,u).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+f[0]+" in threaded comments")}return c}),r}function RR(e,t,r){var n=[ar,Oe("ThreadedComments",null,{xmlns:gr.TCMNT}).replace(/[\/]>/,">")];return e.forEach(function(a){var s="";(a[1]||[]).forEach(function(i,c){if(!i.T){delete i.ID;return}i.a&&t.indexOf(i.a)==-1&&t.push(i.a);var u={ref:a[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};c==0?s=u.id:u.parentId=s,i.ID=u.id,i.a&&(u.personId="{54EE7950-7262-4200-6969-"+("000000000000"+t.indexOf(i.a)).slice(-12)+"}"),n.push(Oe("threadedComment",Pr("text",i.t||""),u))})}),n.push("</ThreadedComments>"),n.join("")}function LR(e,t){var r=[],n=!1;return e.replace(Kr,function(s){var i=Je(s);switch(wa(i[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:i.displayname,id:i.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+i[0]+" in threaded comments")}return s}),r}function NR(e){var t=[ar,Oe("personList",null,{xmlns:gr.TCMNT,"xmlns:x":yo[0]}).replace(/[\/]>/,">")];return e.forEach(function(r,n){t.push(Oe("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:r,providerId:"None"}))}),t.push("</personList>"),t.join("")}function MR(e){var t={};t.iauthor=e.read_shift(4);var r=Eo(e);return t.rfx=r.s,t.ref=qe(r.s),e.l+=16,t}function BR(e,t){return t==null&&(t=de(36)),t.write_shift(4,e[1].iauthor),Ri(e[0],t),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t}var jR=Hr;function $R(e){return br(e.slice(0,54))}function UR(e,t){var r=[],n=[],a={},s=!1;return Ha(e,function(c,u,f){switch(f){case 632:n.push(c);break;case 635:a=c;break;case 637:a.t=c.t,a.h=c.h,a.r=c.r;break;case 636:if(a.author=n[a.iauthor],delete a.iauthor,t.sheetRows&&a.rfx&&t.sheetRows<=a.rfx.r)break;a.t||(a.t=""),delete a.rfx,r.push(a);break;case 3072:break;case 35:s=!0;break;case 36:s=!1;break;case 37:break;case 38:break;default:if(!u.T){if(!s||t.WTF)throw new Error("Unexpected record 0x"+f.toString(16))}}}),r}function zR(e){var t=un(),r=[];return we(t,628),we(t,630),e.forEach(function(n){n[1].forEach(function(a){r.indexOf(a.a)>-1||(r.push(a.a.slice(0,54)),we(t,632,$R(a.a)))})}),we(t,631),we(t,633),e.forEach(function(n){n[1].forEach(function(a){a.iauthor=r.indexOf(a.a);var s={s:Vt(n[0]),e:Vt(n[0])};we(t,635,BR([s,a])),a.t&&a.t.length>0&&we(t,637,u3(a)),we(t,636),delete a.iauthor})}),we(t,634),we(t,629),t.end()}var VR="application/vnd.ms-office.vbaProject";function WR(e){var t=Ve.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(r,n){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var a=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");Ve.utils.cfb_add(t,a,e.FileIndex[n].content)}}),Ve.write(t)}function HR(e,t){t.FullPaths.forEach(function(r,n){if(n!=0){var a=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");a.slice(-1)!=="/"&&Ve.utils.cfb_add(e,a,t.FileIndex[n].content)}})}var DS=["xlsb","xlsm","xlam","biff8","xla"];function GR(){return{"!type":"dialog"}}function qR(){return{"!type":"dialog"}}function KR(){return{"!type":"macro"}}function XR(){return{"!type":"macro"}}var pi=(function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(n,a,s,i){var c=!1,u=!1;s.length==0?u=!0:s.charAt(0)=="["&&(u=!0,s=s.slice(1,-1)),i.length==0?c=!0:i.charAt(0)=="["&&(c=!0,i=i.slice(1,-1));var f=s.length>0?parseInt(s,10)|0:0,h=i.length>0?parseInt(i,10)|0:0;return c?h+=t.c:--h,u?f+=t.r:--f,a+(c?"":"$")+zt(h)+(u?"":"$")+rr(f)}return function(a,s){return t=s,a.replace(e,r)}})(),Kg=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,Xg=(function(){return function(t,r){return t.replace(Kg,function(n,a,s,i,c,u){var f=Lg(i)-(s?0:r.c),h=Rg(u)-(c?0:r.r),p=h==0?"":c?h+1:"["+h+"]",m=f==0?"":s?f+1:"["+f+"]";return a+"R"+p+"C"+m})}})();function FS(e,t){return e.replace(Kg,function(r,n,a,s,i,c){return n+(a=="$"?a+s:zt(Lg(s)+t.c))+(i=="$"?i+c:rr(Rg(c)+t.r))})}function JR(e,t,r){var n=fn(t),a=n.s,s=Vt(r),i={r:s.r-a.r,c:s.c-a.c};return FS(e,i)}function YR(e){return e.length!=1}function Ox(e){return e.replace(/_xlfn\./g,"")}function ir(e){e.l+=1}function bs(e,t){var r=e.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function RS(e,t,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return LS(e);r.biff==12&&(n=4)}var a=e.read_shift(n),s=e.read_shift(n),i=bs(e),c=bs(e);return{s:{r:a,c:i[0],cRel:i[1],rRel:i[2]},e:{r:s,c:c[0],cRel:c[1],rRel:c[2]}}}function LS(e){var t=bs(e),r=bs(e),n=e.read_shift(1),a=e.read_shift(1);return{s:{r:t[0],c:n,cRel:t[1],rRel:t[2]},e:{r:r[0],c:a,cRel:r[1],rRel:r[2]}}}function QR(e,t,r){if(r.biff<8)return LS(e);var n=e.read_shift(r.biff==12?4:2),a=e.read_shift(r.biff==12?4:2),s=bs(e),i=bs(e);return{s:{r:n,c:s[0],cRel:s[1],rRel:s[2]},e:{r:a,c:i[0],cRel:i[1],rRel:i[2]}}}function NS(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return ZR(e);var n=e.read_shift(r&&r.biff==12?4:2),a=bs(e);return{r:n,c:a[0],cRel:a[1],rRel:a[2]}}function ZR(e){var t=bs(e),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function e8(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function t8(e,t,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return r8(e);var a=e.read_shift(n>=12?4:2),s=e.read_shift(2),i=(s&16384)>>14,c=(s&32768)>>15;if(s&=16383,c==1)for(;a>524287;)a-=1048576;if(i==1)for(;s>8191;)s=s-16384;return{r:a,c:s,cRel:i,rRel:c}}function r8(e){var t=e.read_shift(2),r=e.read_shift(1),n=(t&32768)>>15,a=(t&16384)>>14;return t&=16383,n==1&&t>=8192&&(t=t-16384),a==1&&r>=128&&(r=r-256),{r:t,c:r,cRel:a,rRel:n}}function n8(e,t,r){var n=(e[e.l++]&96)>>5,a=RS(e,r.biff>=2&&r.biff<=5?6:8,r);return[n,a]}function a8(e,t,r){var n=(e[e.l++]&96)>>5,a=e.read_shift(2,"i"),s=8;if(r)switch(r.biff){case 5:e.l+=12,s=6;break;case 12:s=12;break}var i=RS(e,s,r);return[n,a,i]}function s8(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function o8(e,t,r){var n=(e[e.l++]&96)>>5,a=e.read_shift(2),s=8;if(r)switch(r.biff){case 5:e.l+=12,s=6;break;case 12:s=12;break}return e.l+=s,[n,a]}function i8(e,t,r){var n=(e[e.l++]&96)>>5,a=QR(e,t-1,r);return[n,a]}function l8(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r.biff==2?6:r.biff==12?14:7,[n]}function Dx(e){var t=e[e.l+1]&1,r=1;return e.l+=4,[t,r]}function c8(e,t,r){e.l+=2;for(var n=e.read_shift(r&&r.biff==2?1:2),a=[],s=0;s<=n;++s)a.push(e.read_shift(r&&r.biff==2?1:2));return a}function u8(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function f8(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function d8(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function h8(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=r&&r.biff==2?3:4,[n]}function MS(e){var t=e.read_shift(1),r=e.read_shift(1);return[t,r]}function g8(e){return e.read_shift(2),MS(e)}function p8(e){return e.read_shift(2),MS(e)}function m8(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=NS(e,0,r);return[n,a]}function v8(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=t8(e,0,r);return[n,a]}function x8(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=e.read_shift(2);r&&r.biff==5&&(e.l+=12);var s=NS(e,0,r);return[n,a,s]}function y8(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=e.read_shift(r&&r.biff<=3?1:2);return[SL[a],$S[a],n]}function w8(e,t,r){var n=e[e.l++],a=e.read_shift(1),s=r&&r.biff<=3?[n==88?-1:0,e.read_shift(1)]:_8(e);return[a,(s[0]===0?$S:_L)[s[1]]]}function _8(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function S8(e,t,r){e.l+=r&&r.biff==2?3:4}function E8(e,t,r){if(e.l++,r&&r.biff==12)return[e.read_shift(4,"i"),0];var n=e.read_shift(2),a=e.read_shift(r&&r.biff==2?1:2);return[n,a]}function b8(e){return e.l++,Ga[e.read_shift(1)]}function k8(e){return e.l++,e.read_shift(2)}function T8(e){return e.l++,e.read_shift(1)!==0}function C8(e){return e.l++,Wr(e)}function A8(e,t,r){return e.l++,xc(e,t-1,r)}function P8(e,t){var r=[e.read_shift(1)];if(t==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=Zt(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:r[1]=Ga[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:r[1]=Wr(e);break;case 2:r[1]=bo(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function I8(e,t,r){for(var n=e.read_shift(r.biff==12?4:2),a=[],s=0;s!=n;++s)a.push((r.biff==12?Eo:zf)(e));return a}function O8(e,t,r){var n=0,a=0;r.biff==12?(n=e.read_shift(4),a=e.read_shift(4)):(a=1+e.read_shift(1),n=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--a==0&&(a=256));for(var s=0,i=[];s!=n&&(i[s]=[]);++s)for(var c=0;c!=a;++c)i[s][c]=P8(e,r.biff);return i}function D8(e,t,r){var n=e.read_shift(1)>>>5&3,a=!r||r.biff>=8?4:2,s=e.read_shift(a);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[n,0,s]}function F8(e,t,r){if(r.biff==5)return R8(e);var n=e.read_shift(1)>>>5&3,a=e.read_shift(2),s=e.read_shift(4);return[n,a,s]}function R8(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var n=e.read_shift(2);return e.l+=12,[t,r,n]}function L8(e,t,r){var n=e.read_shift(1)>>>5&3;e.l+=r&&r.biff==2?3:4;var a=e.read_shift(r&&r.biff==2?1:2);return[n,a]}function N8(e,t,r){var n=e.read_shift(1)>>>5&3,a=e.read_shift(r&&r.biff==2?1:2);return[n,a]}function M8(e,t,r){var n=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,r.biff==12&&(e.l+=2),[n]}function B8(e,t,r){var n=(e[e.l++]&96)>>5,a=e.read_shift(2),s=4;if(r)switch(r.biff){case 5:s=15;break;case 12:s=6;break}return e.l+=s,[n,a]}var j8=Gr,$8=Gr,U8=Gr;function wc(e,t,r){return e.l+=2,[e8(e)]}function Jg(e){return e.l+=6,[]}var z8=wc,V8=Jg,W8=Jg,H8=wc;function BS(e){return e.l+=2,[cr(e),e.read_shift(2)&1]}var G8=wc,q8=BS,K8=Jg,X8=wc,J8=wc,Y8=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function Q8(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),a=e.read_shift(2),s=e.read_shift(2),i=Y8[r>>2&31];return{ixti:t,coltype:r&3,rt:i,idx:n,c:a,C:s}}function Z8(e){return e.l+=2,[e.read_shift(4)]}function eL(e,t,r){return e.l+=5,e.l+=2,e.l+=r.biff==2?1:4,["PTGSHEET"]}function tL(e,t,r){return e.l+=r.biff==2?4:5,["PTGENDSHEET"]}function rL(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function nL(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function aL(e){return e.l+=4,[0,0]}var Fx={1:{n:"PtgExp",f:E8},2:{n:"PtgTbl",f:U8},3:{n:"PtgAdd",f:ir},4:{n:"PtgSub",f:ir},5:{n:"PtgMul",f:ir},6:{n:"PtgDiv",f:ir},7:{n:"PtgPower",f:ir},8:{n:"PtgConcat",f:ir},9:{n:"PtgLt",f:ir},10:{n:"PtgLe",f:ir},11:{n:"PtgEq",f:ir},12:{n:"PtgGe",f:ir},13:{n:"PtgGt",f:ir},14:{n:"PtgNe",f:ir},15:{n:"PtgIsect",f:ir},16:{n:"PtgUnion",f:ir},17:{n:"PtgRange",f:ir},18:{n:"PtgUplus",f:ir},19:{n:"PtgUminus",f:ir},20:{n:"PtgPercent",f:ir},21:{n:"PtgParen",f:ir},22:{n:"PtgMissArg",f:ir},23:{n:"PtgStr",f:A8},26:{n:"PtgSheet",f:eL},27:{n:"PtgEndSheet",f:tL},28:{n:"PtgErr",f:b8},29:{n:"PtgBool",f:T8},30:{n:"PtgInt",f:k8},31:{n:"PtgNum",f:C8},32:{n:"PtgArray",f:l8},33:{n:"PtgFunc",f:y8},34:{n:"PtgFuncVar",f:w8},35:{n:"PtgName",f:D8},36:{n:"PtgRef",f:m8},37:{n:"PtgArea",f:n8},38:{n:"PtgMemArea",f:L8},39:{n:"PtgMemErr",f:j8},40:{n:"PtgMemNoMem",f:$8},41:{n:"PtgMemFunc",f:N8},42:{n:"PtgRefErr",f:M8},43:{n:"PtgAreaErr",f:s8},44:{n:"PtgRefN",f:v8},45:{n:"PtgAreaN",f:i8},46:{n:"PtgMemAreaN",f:rL},47:{n:"PtgMemNoMemN",f:nL},57:{n:"PtgNameX",f:F8},58:{n:"PtgRef3d",f:x8},59:{n:"PtgArea3d",f:a8},60:{n:"PtgRefErr3d",f:B8},61:{n:"PtgAreaErr3d",f:o8},255:{}},sL={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},oL={1:{n:"PtgElfLel",f:BS},2:{n:"PtgElfRw",f:X8},3:{n:"PtgElfCol",f:z8},6:{n:"PtgElfRwV",f:J8},7:{n:"PtgElfColV",f:H8},10:{n:"PtgElfRadical",f:G8},11:{n:"PtgElfRadicalS",f:K8},13:{n:"PtgElfColS",f:V8},15:{n:"PtgElfColSV",f:W8},16:{n:"PtgElfRadicalLel",f:q8},25:{n:"PtgList",f:Q8},29:{n:"PtgSxName",f:Z8},255:{}},iL={0:{n:"PtgAttrNoop",f:aL},1:{n:"PtgAttrSemi",f:h8},2:{n:"PtgAttrIf",f:f8},4:{n:"PtgAttrChoose",f:c8},8:{n:"PtgAttrGoto",f:u8},16:{n:"PtgAttrSum",f:S8},32:{n:"PtgAttrBaxcel",f:Dx},33:{n:"PtgAttrBaxcel",f:Dx},64:{n:"PtgAttrSpace",f:g8},65:{n:"PtgAttrSpaceSemi",f:p8},128:{n:"PtgAttrIfError",f:d8},255:{}};function _c(e,t,r,n){if(n.biff<8)return Gr(e,t);for(var a=e.l+t,s=[],i=0;i!==r.length;++i)switch(r[i][0]){case"PtgArray":r[i][1]=O8(e,0,n),s.push(r[i][1]);break;case"PtgMemArea":r[i][2]=I8(e,r[i][1],n),s.push(r[i][2]);break;case"PtgExp":n&&n.biff==12&&(r[i][1][1]=e.read_shift(4),s.push(r[i][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[i][0]}return t=a-e.l,t!==0&&s.push(Gr(e,t)),s}function Sc(e,t,r){for(var n=e.l+t,a,s,i=[];n!=e.l;)t=n-e.l,s=e[e.l],a=Fx[s]||Fx[sL[s]],(s===24||s===25)&&(a=(s===24?oL:iL)[e[e.l+1]]),!a||!a.f?Gr(e,t):i.push([a.n,a.f(e,t,r)]);return i}function lL(e){for(var t=[],r=0;r<e.length;++r){for(var n=e[r],a=[],s=0;s<n.length;++s){var i=n[s];if(i)switch(i[0]){case 2:a.push('"'+i[1].replace(/"/g,'""')+'"');break;default:a.push(i[1])}else a.push("")}t.push(a.join(","))}return t.join(";")}var cL={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function uL(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function jS(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var n=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!n)return"SH33TJSERR1";var a="";if(r.biff>8)switch(e[n[0]][0]){case 357:return a=n[1]==-1?"#REF":e.SheetNames[n[1]],n[1]==n[2]?a:a+":"+e.SheetNames[n[2]];case 358:return r.SID!=null?e.SheetNames[r.SID]:"SH33TJSSAME"+e[n[0]][0];case 355:default:return"SH33TJSSRC"+e[n[0]][0]}switch(e[n[0]][0][0]){case 1025:return a=n[1]==-1?"#REF":e.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?a:a+":"+e.SheetNames[n[2]];case 14849:return e[n[0]].slice(1).map(function(s){return s.Name}).join(";;");default:return e[n[0]][0][3]?(a=n[1]==-1?"#REF":e[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?a:a+":"+e[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function Rx(e,t,r){var n=jS(e,t,r);return n=="#REF"?n:uL(n,r)}function zr(e,t,r,n,a){var s=a&&a.biff||8,i={s:{c:0,r:0}},c=[],u,f,h,p=0,m=0,y,w="";if(!e[0]||!e[0][0])return"";for(var x=-1,_="",E=0,k=e[0].length;E<k;++E){var b=e[0][E];switch(b[0]){case"PtgUminus":c.push("-"+c.pop());break;case"PtgUplus":c.push("+"+c.pop());break;case"PtgPercent":c.push(c.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(u=c.pop(),f=c.pop(),x>=0){switch(e[0][x][1][0]){case 0:_=qt(" ",e[0][x][1][1]);break;case 1:_=qt("\r",e[0][x][1][1]);break;default:if(_="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][x][1][0])}f=f+_,x=-1}c.push(f+cL[b[0]]+u);break;case"PtgIsect":u=c.pop(),f=c.pop(),c.push(f+" "+u);break;case"PtgUnion":u=c.pop(),f=c.pop(),c.push(f+","+u);break;case"PtgRange":u=c.pop(),f=c.pop(),c.push(f+":"+u);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":h=Fl(b[1][1],i,a),c.push(Rl(h,s));break;case"PtgRefN":h=r?Fl(b[1][1],r,a):b[1][1],c.push(Rl(h,s));break;case"PtgRef3d":p=b[1][1],h=Fl(b[1][2],i,a),w=Rx(n,p,a),c.push(w+"!"+Rl(h,s));break;case"PtgFunc":case"PtgFuncVar":var O=b[1][0],z=b[1][1];O||(O=0),O&=127;var L=O==0?[]:c.slice(-O);c.length-=O,z==="User"&&(z=L.shift()),c.push(z+"("+L.join(",")+")");break;case"PtgBool":c.push(b[1]?"TRUE":"FALSE");break;case"PtgInt":c.push(b[1]);break;case"PtgNum":c.push(String(b[1]));break;case"PtgStr":c.push('"'+b[1].replace(/"/g,'""')+'"');break;case"PtgErr":c.push(b[1]);break;case"PtgAreaN":y=cx(b[1][1],r?{s:r}:i,a),c.push(Qd(y,a));break;case"PtgArea":y=cx(b[1][1],i,a),c.push(Qd(y,a));break;case"PtgArea3d":p=b[1][1],y=b[1][2],w=Rx(n,p,a),c.push(w+"!"+Qd(y,a));break;case"PtgAttrSum":c.push("SUM("+c.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":m=b[1][2];var P=(n.names||[])[m-1]||(n[0]||[])[m],J=P?P.Name:"SH33TJSNAME"+String(m);J&&J.slice(0,6)=="_xlfn."&&!a.xlfn&&(J=J.slice(6)),c.push(J);break;case"PtgNameX":var V=b[1][1];m=b[1][2];var le;if(a.biff<=5)V<0&&(V=-V),n[V]&&(le=n[V][m]);else{var ee="";if(((n[V]||[])[0]||[])[0]==14849||(((n[V]||[])[0]||[])[0]==1025?n[V][m]&&n[V][m].itab>0&&(ee=n.SheetNames[n[V][m].itab-1]+"!"):ee=n.SheetNames[m-1]+"!"),n[V]&&n[V][m])ee+=n[V][m].Name;else if(n[0]&&n[0][m])ee+=n[0][m].Name;else{var X=(jS(n,V,a)||"").split(";;");X[m-1]?ee=X[m-1]:ee+="SH33TJSERRX"}c.push(ee);break}le||(le={Name:"SH33TJSERRY"}),c.push(le.Name);break;case"PtgParen":var he="(",Ie=")";if(x>=0){switch(_="",e[0][x][1][0]){case 2:he=qt(" ",e[0][x][1][1])+he;break;case 3:he=qt("\r",e[0][x][1][1])+he;break;case 4:Ie=qt(" ",e[0][x][1][1])+Ie;break;case 5:Ie=qt("\r",e[0][x][1][1])+Ie;break;default:if(a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][x][1][0])}x=-1}c.push(he+c.pop()+Ie);break;case"PtgRefErr":c.push("#REF!");break;case"PtgRefErr3d":c.push("#REF!");break;case"PtgExp":h={c:b[1][1],r:b[1][0]};var Ee={c:r.c,r:r.r};if(n.sharedf[qe(h)]){var Te=n.sharedf[qe(h)];c.push(zr(Te,i,Ee,n,a))}else{var oe=!1;for(u=0;u!=n.arrayf.length;++u)if(f=n.arrayf[u],!(h.c<f[0].s.c||h.c>f[0].e.c)&&!(h.r<f[0].s.r||h.r>f[0].e.r)){c.push(zr(f[1],i,Ee,n,a)),oe=!0;break}oe||c.push(b[1])}break;case"PtgArray":c.push("{"+lL(b[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":x=E;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":c.push("");break;case"PtgAreaErr":c.push("#REF!");break;case"PtgAreaErr3d":c.push("#REF!");break;case"PtgList":c.push("Table"+b[1].idx+"[#"+b[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(b));default:throw new Error("Unrecognized Formula Token: "+String(b))}var ge=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(a.biff!=3&&x>=0&&ge.indexOf(e[0][E][0])==-1){b=e[0][x];var K=!0;switch(b[1][0]){case 4:K=!1;case 0:_=qt(" ",b[1][1]);break;case 5:K=!1;case 1:_=qt("\r",b[1][1]);break;default:if(_="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+b[1][0])}c.push((K?_:"")+c.pop()+(K?"":_)),x=-1}}if(c.length>1&&a.WTF)throw new Error("bad formula stack");return c[0]}function fL(e,t,r){var n=e.l+t,a=r.biff==2?1:2,s,i=e.read_shift(a);if(i==65535)return[[],Gr(e,t-2)];var c=Sc(e,i,r);return t!==i+a&&(s=_c(e,t-i-a,c,r)),e.l=n,[c,s]}function dL(e,t,r){var n=e.l+t,a=r.biff==2?1:2,s,i=e.read_shift(a);if(i==65535)return[[],Gr(e,t-2)];var c=Sc(e,i,r);return t!==i+a&&(s=_c(e,t-i-a,c,r)),e.l=n,[c,s]}function hL(e,t,r,n){var a=e.l+t,s=Sc(e,n,r),i;return a!==e.l&&(i=_c(e,a-e.l,s,r)),[s,i]}function gL(e,t,r){var n=e.l+t,a,s=e.read_shift(2),i=Sc(e,s,r);return s==65535?[[],Gr(e,t-2)]:(t!==s+2&&(a=_c(e,n-s-2,i,r)),[i,a])}function pL(e){var t;if(La(e,e.l+6)!==65535)return[Wr(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return t=e[e.l+2]===1,e.l+=8,[t,"b"];case 2:return t=e[e.l+2],e.l+=8,[t,"e"];case 3:return e.l+=8,["","s"]}return[]}function mL(e){if(e==null){var t=de(8);return t.write_shift(1,3),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,65535),t}else if(typeof e=="number")return fo(e);return fo(0)}function nh(e,t,r){var n=e.l+t,a=_a(e);r.biff==2&&++e.l;var s=pL(e),i=e.read_shift(1);r.biff!=2&&(e.read_shift(1),r.biff>=5&&e.read_shift(4));var c=dL(e,n-e.l,r);return{cell:a,val:s[0],formula:c,shared:i>>3&1,tt:s[1]}}function vL(e,t,r,n,a){var s=go(t,r,a),i=mL(e.v),c=de(6),u=33;c.write_shift(2,u),c.write_shift(4,0);for(var f=de(e.bf.length),h=0;h<e.bf.length;++h)f[h]=e.bf[h];var p=Er([s,i,c,f]);return p}function Vf(e,t,r){var n=e.read_shift(4),a=Sc(e,n,r),s=e.read_shift(4),i=s>0?_c(e,s,a,r):null;return[a,i]}var xL=Vf,Wf=Vf,yL=Vf,wL=Vf,_L={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},$S={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},SL={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function Lx(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(t,r){return r.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function EL(e){var t="of:="+e.replace(Kg,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return t.replace(/;/g,"|").replace(/,/g,";")}function ah(e){var t=e.split(":"),r=t[0].split(".")[0];return[r,t[0].split(".")[1]+(t.length>1?":"+(t[1].split(".")[1]||t[1].split(".")[0]):"")]}function bL(e){return e.replace(/\./,"!")}var Nl={},mi={},Ml=typeof Map<"u";function Yg(e,t,r){var n=0,a=e.length;if(r){if(Ml?r.has(t):Object.prototype.hasOwnProperty.call(r,t)){for(var s=Ml?r.get(t):r[t];n<s.length;++n)if(e[s[n]].t===t)return e.Count++,s[n]}}else for(;n<a;++n)if(e[n].t===t)return e.Count++,n;return e[a]={t},e.Count++,e.Unique++,r&&(Ml?(r.has(t)||r.set(t,[]),r.get(t).push(a)):(Object.prototype.hasOwnProperty.call(r,t)||(r[t]=[]),r[t].push(a))),a}function Hf(e,t){var r={min:e+1,max:e+1},n=-1;return t.MDW&&(Vr=t.MDW),t.width!=null?r.customWidth=1:t.wpx!=null?n=ac(t.wpx):t.wch!=null&&(n=t.wch),n>-1?(r.width=kf(n),r.customWidth=1):t.width!=null&&(r.width=t.width),t.hidden&&(r.hidden=!0),t.level!=null&&(r.outlineLevel=r.level=t.level),r}function io(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];t=="xlml"&&(r=[1,1,1,1,.5,.5]),e.left==null&&(e.left=r[0]),e.right==null&&(e.right=r[1]),e.top==null&&(e.top=r[2]),e.bottom==null&&(e.bottom=r[3]),e.header==null&&(e.header=r[4]),e.footer==null&&(e.footer=r[5])}}function Is(e,t,r){var n=r.revssf[t.z!=null?t.z:"General"],a=60,s=e.length;if(n==null&&r.ssf){for(;a<392;++a)if(r.ssf[a]==null){Ma(t.z,a),r.ssf[a]=t.z,r.revssf[t.z]=n=a;break}}for(a=0;a!=s;++a)if(e[a].numFmtId===n)return a;return e[s]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},s}function US(e,t,r,n,a,s){try{n.cellNF&&(e.z=Ge[t])}catch(c){if(n.WTF)throw c}if(!(e.t==="z"&&!n.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=Rt(e.v)),(!n||n.cellText!==!1)&&e.t!=="z")try{if(Ge[t]==null&&Ma(_I[t]||"General",t),e.t==="e")e.w=e.w||Ga[e.v];else if(t===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Yl(e.v);else if(e.t==="d"){var i=pr(e.v);(i|0)===i?e.w=i.toString(10):e.w=Yl(i)}else{if(e.v===void 0)return"";e.w=co(e.v,mi)}else e.t==="d"?e.w=Un(t,pr(e.v),mi):e.w=Un(t,e.v,mi)}catch(c){if(n.WTF)throw c}if(n.cellStyles&&r!=null)try{e.s=s.Fills[r],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=bf(a.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),n.WTF&&(e.s.fgColor.raw_rgb=a.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=bf(a.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),n.WTF&&(e.s.bgColor.raw_rgb=a.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(c){if(n.WTF&&s.Fills)throw c}}}function kL(e,t,r){if(e&&e["!ref"]){var n=mt(e["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+r+"): "+e["!ref"])}}function TL(e,t){var r=mt(t);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(e["!ref"]=rt(r))}var CL=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,AL=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,PL=/<(?:\w:)?hyperlink [^>]*>/mg,IL=/"(\w*:\w*)"/,OL=/<(?:\w:)?col\b[^>]*[\/]?>/g,DL=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,FL=/<(?:\w:)?pageMargins[^>]*\/>/g,zS=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,RL=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,LL=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function NL(e,t,r,n,a,s,i){if(!e)return e;n||(n={"!id":{}});var c=t.dense?[]:{},u={s:{r:2e6,c:2e6},e:{r:0,c:0}},f="",h="",p=e.match(AL);p?(f=e.slice(0,p.index),h=e.slice(p.index+p[0].length)):f=h=e;var m=f.match(zS);m?Qg(m[0],c,a,r):(m=f.match(RL))&&BL(m[0],m[1]||"",c,a,r);var y=(f.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(y>0){var w=f.slice(y,y+50).match(IL);w&&TL(c,w[1])}var x=f.match(LL);x&&x[1]&&YL(x[1],a);var _=[];if(t.cellStyles){var E=f.match(OL);E&&GL(_,E)}p&&eN(p[1],c,t,u,s,i);var k=h.match(DL);k&&(c["!autofilter"]=KL(k[0]));var b=[],O=h.match(CL);if(O)for(y=0;y!=O.length;++y)b[y]=mt(O[y].slice(O[y].indexOf('"')+1));var z=h.match(PL);z&&VL(c,z,n);var L=h.match(FL);if(L&&(c["!margins"]=WL(Je(L[0]))),!c["!ref"]&&u.e.c>=u.s.c&&u.e.r>=u.s.r&&(c["!ref"]=rt(u)),t.sheetRows>0&&c["!ref"]){var P=mt(c["!ref"]);t.sheetRows<=+P.e.r&&(P.e.r=t.sheetRows-1,P.e.r>u.e.r&&(P.e.r=u.e.r),P.e.r<P.s.r&&(P.s.r=P.e.r),P.e.c>u.e.c&&(P.e.c=u.e.c),P.e.c<P.s.c&&(P.s.c=P.e.c),c["!fullref"]=c["!ref"],c["!ref"]=rt(P))}return _.length>0&&(c["!cols"]=_),b.length>0&&(c["!merges"]=b),c}function ML(e){if(e.length===0)return"";for(var t='<mergeCells count="'+e.length+'">',r=0;r!=e.length;++r)t+='<mergeCell ref="'+rt(e[r])+'"/>';return t+"</mergeCells>"}function Qg(e,t,r,n){var a=Je(e);r.Sheets[n]||(r.Sheets[n]={}),a.codeName&&(r.Sheets[n].CodeName=pt(kt(a.codeName)))}function BL(e,t,r,n,a){Qg(e.slice(0,e.indexOf(">")),r,n,a)}function jL(e,t,r,n,a){var s=!1,i={},c=null;if(n.bookType!=="xlsx"&&t.vbaraw){var u=t.SheetNames[r];try{t.Workbook&&(u=t.Workbook.Sheets[r].CodeName||u)}catch{}s=!0,i.codeName=xa(bt(u))}if(e&&e["!outline"]){var f={summaryBelow:1,summaryRight:1};e["!outline"].above&&(f.summaryBelow=0),e["!outline"].left&&(f.summaryRight=0),c=(c||"")+Oe("outlinePr",null,f)}!s&&!c||(a[a.length]=Oe("sheetPr",c,i))}var $L=["objects","scenarios","selectLockedCells","selectUnlockedCells"],UL=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function zL(e){var t={sheet:1};return $L.forEach(function(r){e[r]!=null&&e[r]&&(t[r]="1")}),UL.forEach(function(r){e[r]!=null&&!e[r]&&(t[r]="0")}),e.password&&(t.password=Hg(e.password).toString(16).toUpperCase()),Oe("sheetProtection",null,t)}function VL(e,t,r){for(var n=Array.isArray(e),a=0;a!=t.length;++a){var s=Je(kt(t[a]),!0);if(!s.ref)return;var i=((r||{})["!id"]||[])[s.id];i?(s.Target=i.Target,s.location&&(s.Target+="#"+pt(s.location))):(s.Target="#"+pt(s.location),i={Target:s.Target,TargetMode:"Internal"}),s.Rel=i,s.tooltip&&(s.Tooltip=s.tooltip,delete s.tooltip);for(var c=mt(s.ref),u=c.s.r;u<=c.e.r;++u)for(var f=c.s.c;f<=c.e.c;++f){var h=qe({c:f,r:u});n?(e[u]||(e[u]=[]),e[u][f]||(e[u][f]={t:"z",v:void 0}),e[u][f].l=s):(e[h]||(e[h]={t:"z",v:void 0}),e[h].l=s)}}}function WL(e){var t={};return["left","right","top","bottom","header","footer"].forEach(function(r){e[r]&&(t[r]=parseFloat(e[r]))}),t}function HL(e){return io(e),Oe("pageMargins",null,e)}function GL(e,t){for(var r=!1,n=0;n!=t.length;++n){var a=Je(t[n],!0);a.hidden&&(a.hidden=Ft(a.hidden));var s=parseInt(a.min,10)-1,i=parseInt(a.max,10)-1;for(a.outlineLevel&&(a.level=+a.outlineLevel||0),delete a.min,delete a.max,a.width=+a.width,!r&&a.width&&(r=!0,Gg(a.width)),Es(a);s<=i;)e[s++]=Lt(a)}}function qL(e,t){for(var r=["<cols>"],n,a=0;a!=t.length;++a)(n=t[a])&&(r[r.length]=Oe("col",null,Hf(a,n)));return r[r.length]="</cols>",r.join("")}function KL(e){var t={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return t}function XL(e,t,r,n){var a=typeof e.ref=="string"?e.ref:rt(e.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var s=r.Workbook.Names,i=fn(a);i.s.r==i.e.r&&(i.e.r=fn(t["!ref"]).e.r,a=rt(i));for(var c=0;c<s.length;++c){var u=s[c];if(u.Name=="_xlnm._FilterDatabase"&&u.Sheet==n){u.Ref="'"+r.SheetNames[n]+"'!"+a;break}}return c==s.length&&s.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+a}),Oe("autoFilter",null,{ref:a})}var JL=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function YL(e,t){t.Views||(t.Views=[{}]),(e.match(JL)||[]).forEach(function(r,n){var a=Je(r);t.Views[n]||(t.Views[n]={}),+a.zoomScale&&(t.Views[n].zoom=+a.zoomScale),Ft(a.rightToLeft)&&(t.Views[n].RTL=!0)})}function QL(e,t,r,n){var a={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(a.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),Oe("sheetViews",Oe("sheetView",null,a),{})}function ZL(e,t,r,n){if(e.c&&r["!comments"].push([t,e.c]),e.v===void 0&&typeof e.f!="string"||e.t==="z"&&!e.f)return"";var a="",s=e.t,i=e.v;if(e.t!=="z")switch(e.t){case"b":a=e.v?"1":"0";break;case"n":a=""+e.v;break;case"e":a=Ga[e.v];break;case"d":n&&n.cellDates?a=Rt(e.v,-1).toISOString():(e=Lt(e),e.t="n",a=""+(e.v=pr(Rt(e.v)))),typeof e.z>"u"&&(e.z=Ge[14]);break;default:a=e.v;break}var c=Pr("v",bt(a)),u={r:t},f=Is(n.cellXfs,e,n);switch(f!==0&&(u.s=f),e.t){case"n":break;case"d":u.t="d";break;case"b":u.t="b";break;case"e":u.t="e";break;case"z":break;default:if(e.v==null){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){c=Pr("v",""+Yg(n.Strings,e.v,n.revStrings)),u.t="s";break}u.t="str";break}if(e.t!=s&&(e.t=s,e.v=i),typeof e.f=="string"&&e.f){var h=e.F&&e.F.slice(0,t.length)==t?{t:"array",ref:e.F}:null;c=Oe("f",bt(e.f),h)+(e.v!=null?c:"")}return e.l&&r["!links"].push([t,e.l]),e.D&&(u.cm=1),Oe("c",c,u)}var eN=(function(){var e=/<(?:\w+:)?c[ \/>]/,t=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,a=/ref=["']([^"']*)["']/,s=Ql("v"),i=Ql("f");return function(u,f,h,p,m,y){for(var w=0,x="",_=[],E=[],k=0,b=0,O=0,z="",L,P,J=0,V=0,le,ee,X=0,he=0,Ie=Array.isArray(y.CellXf),Ee,Te=[],oe=[],ge=Array.isArray(f),K=[],fe={},H=!1,A=!!h.sheetStubs,G=u.split(t),U=0,W=G.length;U!=W;++U){x=G[U].trim();var ne=x.length;if(ne!==0){var xe=0;e:for(w=0;w<ne;++w)switch(x[w]){case">":if(x[w-1]!="/"){++w;break e}if(h&&h.cellStyles){if(P=Je(x.slice(xe,w),!0),J=P.r!=null?parseInt(P.r,10):J+1,V=-1,h.sheetRows&&h.sheetRows<J)continue;fe={},H=!1,P.ht&&(H=!0,fe.hpt=parseFloat(P.ht),fe.hpx=Ei(fe.hpt)),P.hidden=="1"&&(H=!0,fe.hidden=!0),P.outlineLevel!=null&&(H=!0,fe.level=+P.outlineLevel),H&&(K[J-1]=fe)}break;case"<":xe=w;break}if(xe>=w)break;if(P=Je(x.slice(xe,w),!0),J=P.r!=null?parseInt(P.r,10):J+1,V=-1,!(h.sheetRows&&h.sheetRows<J)){p.s.r>J-1&&(p.s.r=J-1),p.e.r<J-1&&(p.e.r=J-1),h&&h.cellStyles&&(fe={},H=!1,P.ht&&(H=!0,fe.hpt=parseFloat(P.ht),fe.hpx=Ei(fe.hpt)),P.hidden=="1"&&(H=!0,fe.hidden=!0),P.outlineLevel!=null&&(H=!0,fe.level=+P.outlineLevel),H&&(K[J-1]=fe)),_=x.slice(w).split(e);for(var ve=0;ve!=_.length&&_[ve].trim().charAt(0)=="<";++ve);for(_=_.slice(ve),w=0;w!=_.length;++w)if(x=_[w].trim(),x.length!==0){if(E=x.match(r),k=w,b=0,O=0,x="<c "+(x.slice(0,1)=="<"?">":"")+x,E!=null&&E.length===2){for(k=0,z=E[1],b=0;b!=z.length&&!((O=z.charCodeAt(b)-64)<1||O>26);++b)k=26*k+O;--k,V=k}else++V;for(b=0;b!=x.length&&x.charCodeAt(b)!==62;++b);if(++b,P=Je(x.slice(0,b),!0),P.r||(P.r=qe({r:J-1,c:V})),z=x.slice(b),L={t:""},(E=z.match(s))!=null&&E[1]!==""&&(L.v=pt(E[1])),h.cellFormula){if((E=z.match(i))!=null&&E[1]!==""){if(L.f=pt(kt(E[1])).replace(/\r\n/g,`
`),h.xlfn||(L.f=Ox(L.f)),E[0].indexOf('t="array"')>-1)L.F=(z.match(a)||[])[1],L.F.indexOf(":")>-1&&Te.push([mt(L.F),L.F]);else if(E[0].indexOf('t="shared"')>-1){ee=Je(E[0]);var me=pt(kt(E[1]));h.xlfn||(me=Ox(me)),oe[parseInt(ee.si,10)]=[ee,me,P.r]}}else(E=z.match(/<f[^>]*\/>/))&&(ee=Je(E[0]),oe[ee.si]&&(L.f=JR(oe[ee.si][1],oe[ee.si][2],P.r)));var ye=Vt(P.r);for(b=0;b<Te.length;++b)ye.r>=Te[b][0].s.r&&ye.r<=Te[b][0].e.r&&ye.c>=Te[b][0].s.c&&ye.c<=Te[b][0].e.c&&(L.F=Te[b][1])}if(P.t==null&&L.v===void 0)if(L.f||L.F)L.v=0,L.t="n";else if(A)L.t="z";else continue;else L.t=P.t||"n";switch(p.s.c>V&&(p.s.c=V),p.e.c<V&&(p.e.c=V),L.t){case"n":if(L.v==""||L.v==null){if(!A)continue;L.t="z"}else L.v=parseFloat(L.v);break;case"s":if(typeof L.v>"u"){if(!A)continue;L.t="z"}else le=Nl[parseInt(L.v,10)],L.v=le.t,L.r=le.r,h.cellHTML&&(L.h=le.h);break;case"str":L.t="s",L.v=L.v!=null?kt(L.v):"",h.cellHTML&&(L.h=Ig(L.v));break;case"inlineStr":E=z.match(n),L.t="s",E!=null&&(le=Wg(E[1]))?(L.v=le.t,h.cellHTML&&(L.h=le.h)):L.v="";break;case"b":L.v=Ft(L.v);break;case"d":h.cellDates?L.v=Rt(L.v,1):(L.v=pr(Rt(L.v,1)),L.t="n");break;case"e":(!h||h.cellText!==!1)&&(L.w=L.v),L.v=W_[L.v];break}if(X=he=0,Ee=null,Ie&&P.s!==void 0&&(Ee=y.CellXf[P.s],Ee!=null&&(Ee.numFmtId!=null&&(X=Ee.numFmtId),h.cellStyles&&Ee.fillId!=null&&(he=Ee.fillId))),US(L,X,he,h,m,y),h.cellDates&&Ie&&L.t=="n"&&Oi(Ge[X])&&(L.t="d",L.v=Uf(L.v)),P.cm&&h.xlmeta){var Ze=(h.xlmeta.Cell||[])[+P.cm-1];Ze&&Ze.type=="XLDAPR"&&(L.D=!0)}if(ge){var j=Vt(P.r);f[j.r]||(f[j.r]=[]),f[j.r][j.c]=L}else f[P.r]=L}}}}K.length>0&&(f["!rows"]=K)}})();function tN(e,t,r,n){var a=[],s=[],i=mt(e["!ref"]),c="",u,f="",h=[],p=0,m=0,y=e["!rows"],w=Array.isArray(e),x={r:f},_,E=-1;for(m=i.s.c;m<=i.e.c;++m)h[m]=zt(m);for(p=i.s.r;p<=i.e.r;++p){for(s=[],f=rr(p),m=i.s.c;m<=i.e.c;++m){u=h[m]+f;var k=w?(e[p]||[])[m]:e[u];k!==void 0&&(c=ZL(k,u,e,t))!=null&&s.push(c)}(s.length>0||y&&y[p])&&(x={r:f},y&&y[p]&&(_=y[p],_.hidden&&(x.hidden=1),E=-1,_.hpx?E=sc(_.hpx):_.hpt&&(E=_.hpt),E>-1&&(x.ht=E,x.customHeight=1),_.level&&(x.outlineLevel=_.level)),a[a.length]=Oe("row",s.join(""),x))}if(y)for(;p<y.length;++p)y&&y[p]&&(x={r:p+1},_=y[p],_.hidden&&(x.hidden=1),E=-1,_.hpx?E=sc(_.hpx):_.hpt&&(E=_.hpt),E>-1&&(x.ht=E,x.customHeight=1),_.level&&(x.outlineLevel=_.level),a[a.length]=Oe("row","",x));return a.join("")}function VS(e,t,r,n){var a=[ar,Oe("worksheet",null,{xmlns:yo[0],"xmlns:r":gr.r})],s=r.SheetNames[e],i=0,c="",u=r.Sheets[s];u==null&&(u={});var f=u["!ref"]||"A1",h=mt(f);if(h.e.c>16383||h.e.r>1048575){if(t.WTF)throw new Error("Range "+f+" exceeds format limit A1:XFD1048576");h.e.c=Math.min(h.e.c,16383),h.e.r=Math.min(h.e.c,1048575),f=rt(h)}n||(n={}),u["!comments"]=[];var p=[];jL(u,r,e,t,a),a[a.length]=Oe("dimension",null,{ref:f}),a[a.length]=QL(u,t,e,r),t.sheetFormat&&(a[a.length]=Oe("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),u["!cols"]!=null&&u["!cols"].length>0&&(a[a.length]=qL(u,u["!cols"])),a[i=a.length]="<sheetData/>",u["!links"]=[],u["!ref"]!=null&&(c=tN(u,t),c.length>0&&(a[a.length]=c)),a.length>i+1&&(a[a.length]="</sheetData>",a[i]=a[i].replace("/>",">")),u["!protect"]&&(a[a.length]=zL(u["!protect"])),u["!autofilter"]!=null&&(a[a.length]=XL(u["!autofilter"],u,r,e)),u["!merges"]!=null&&u["!merges"].length>0&&(a[a.length]=ML(u["!merges"]));var m=-1,y,w=-1;return u["!links"].length>0&&(a[a.length]="<hyperlinks>",u["!links"].forEach(function(x){x[1].Target&&(y={ref:x[0]},x[1].Target.charAt(0)!="#"&&(w=Et(n,-1,bt(x[1].Target).replace(/#.*$/,""),ct.HLINK),y["r:id"]="rId"+w),(m=x[1].Target.indexOf("#"))>-1&&(y.location=bt(x[1].Target.slice(m+1))),x[1].Tooltip&&(y.tooltip=bt(x[1].Tooltip)),a[a.length]=Oe("hyperlink",null,y))}),a[a.length]="</hyperlinks>"),delete u["!links"],u["!margins"]!=null&&(a[a.length]=HL(u["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&(a[a.length]=Pr("ignoredErrors",Oe("ignoredError",null,{numberStoredAsText:1,sqref:f}))),p.length>0&&(w=Et(n,-1,"../drawings/drawing"+(e+1)+".xml",ct.DRAW),a[a.length]=Oe("drawing",null,{"r:id":"rId"+w}),u["!drawing"]=p),u["!comments"].length>0&&(w=Et(n,-1,"../drawings/vmlDrawing"+(e+1)+".vml",ct.VML),a[a.length]=Oe("legacyDrawing",null,{"r:id":"rId"+w}),u["!legacy"]=w),a.length>1&&(a[a.length]="</worksheet>",a[1]=a[1].replace("/>",">")),a.join("")}function rN(e,t){var r={},n=e.l+t;r.r=e.read_shift(4),e.l+=4;var a=e.read_shift(2);e.l+=1;var s=e.read_shift(1);return e.l=n,s&7&&(r.level=s&7),s&16&&(r.hidden=!0),s&32&&(r.hpt=a/20),r}function nN(e,t,r){var n=de(145),a=(r["!rows"]||[])[e]||{};n.write_shift(4,e),n.write_shift(4,0);var s=320;a.hpx?s=sc(a.hpx)*20:a.hpt&&(s=a.hpt*20),n.write_shift(2,s),n.write_shift(1,0);var i=0;a.level&&(i|=a.level),a.hidden&&(i|=16),(a.hpx||a.hpt)&&(i|=32),n.write_shift(1,i),n.write_shift(1,0);var c=0,u=n.l;n.l+=4;for(var f={r:e,c:0},h=0;h<16;++h)if(!(t.s.c>h+1<<10||t.e.c<h<<10)){for(var p=-1,m=-1,y=h<<10;y<h+1<<10;++y){f.c=y;var w=Array.isArray(r)?(r[f.r]||[])[f.c]:r[qe(f)];w&&(p<0&&(p=y),m=y)}p<0||(++c,n.write_shift(4,p),n.write_shift(4,m))}var x=n.l;return n.l=u,n.write_shift(4,c),n.l=x,n.length>n.l?n.slice(0,n.l):n}function aN(e,t,r,n){var a=nN(n,r,t);(a.length>17||(t["!rows"]||[])[n])&&we(e,0,a)}var sN=Eo,oN=Ri;function iN(){}function lN(e,t){var r={},n=e[e.l];return++e.l,r.above=!(n&64),r.left=!(n&128),e.l+=18,r.name=f3(e),r}function cN(e,t,r){r==null&&(r=de(84+4*e.length));var n=192;t&&(t.above&&(n&=-65),t.left&&(n&=-129)),r.write_shift(1,n);for(var a=1;a<3;++a)r.write_shift(1,0);return _f({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),j_(e,r),r.slice(0,r.l)}function uN(e){var t=zn(e);return[t]}function fN(e,t,r){return r==null&&(r=de(8)),wo(t,r)}function dN(e){var t=_o(e);return[t]}function hN(e,t,r){return r==null&&(r=de(4)),So(t,r)}function gN(e){var t=zn(e),r=e.read_shift(1);return[t,r,"b"]}function pN(e,t,r){return r==null&&(r=de(9)),wo(t,r),r.write_shift(1,e.v?1:0),r}function mN(e){var t=_o(e),r=e.read_shift(1);return[t,r,"b"]}function vN(e,t,r){return r==null&&(r=de(5)),So(t,r),r.write_shift(1,e.v?1:0),r}function xN(e){var t=zn(e),r=e.read_shift(1);return[t,r,"e"]}function yN(e,t,r){return r==null&&(r=de(9)),wo(t,r),r.write_shift(1,e.v),r}function wN(e){var t=_o(e),r=e.read_shift(1);return[t,r,"e"]}function _N(e,t,r){return r==null&&(r=de(8)),So(t,r),r.write_shift(1,e.v),r.write_shift(2,0),r.write_shift(1,0),r}function SN(e){var t=zn(e),r=e.read_shift(4);return[t,r,"s"]}function EN(e,t,r){return r==null&&(r=de(12)),wo(t,r),r.write_shift(4,t.v),r}function bN(e){var t=_o(e),r=e.read_shift(4);return[t,r,"s"]}function kN(e,t,r){return r==null&&(r=de(8)),So(t,r),r.write_shift(4,t.v),r}function TN(e){var t=zn(e),r=Wr(e);return[t,r,"n"]}function CN(e,t,r){return r==null&&(r=de(16)),wo(t,r),fo(e.v,r),r}function WS(e){var t=_o(e),r=Wr(e);return[t,r,"n"]}function AN(e,t,r){return r==null&&(r=de(12)),So(t,r),fo(e.v,r),r}function PN(e){var t=zn(e),r=jg(e);return[t,r,"n"]}function IN(e,t,r){return r==null&&(r=de(12)),wo(t,r),$_(e.v,r),r}function ON(e){var t=_o(e),r=jg(e);return[t,r,"n"]}function DN(e,t,r){return r==null&&(r=de(8)),So(t,r),$_(e.v,r),r}function FN(e){var t=zn(e),r=Ng(e);return[t,r,"is"]}function RN(e){var t=zn(e),r=Hr(e);return[t,r,"str"]}function LN(e,t,r){return r==null&&(r=de(12+4*e.v.length)),wo(t,r),br(e.v,r),r.length>r.l?r.slice(0,r.l):r}function NN(e){var t=_o(e),r=Hr(e);return[t,r,"str"]}function MN(e,t,r){return r==null&&(r=de(8+4*e.v.length)),So(t,r),br(e.v,r),r.length>r.l?r.slice(0,r.l):r}function BN(e,t,r){var n=e.l+t,a=zn(e);a.r=r["!row"];var s=e.read_shift(1),i=[a,s,"b"];if(r.cellFormula){e.l+=2;var c=Wf(e,n-e.l,r);i[3]=zr(c,null,a,r.supbooks,r)}else e.l=n;return i}function jN(e,t,r){var n=e.l+t,a=zn(e);a.r=r["!row"];var s=e.read_shift(1),i=[a,s,"e"];if(r.cellFormula){e.l+=2;var c=Wf(e,n-e.l,r);i[3]=zr(c,null,a,r.supbooks,r)}else e.l=n;return i}function $N(e,t,r){var n=e.l+t,a=zn(e);a.r=r["!row"];var s=Wr(e),i=[a,s,"n"];if(r.cellFormula){e.l+=2;var c=Wf(e,n-e.l,r);i[3]=zr(c,null,a,r.supbooks,r)}else e.l=n;return i}function UN(e,t,r){var n=e.l+t,a=zn(e);a.r=r["!row"];var s=Hr(e),i=[a,s,"str"];if(r.cellFormula){e.l+=2;var c=Wf(e,n-e.l,r);i[3]=zr(c,null,a,r.supbooks,r)}else e.l=n;return i}var zN=Eo,VN=Ri;function WN(e,t){return t==null&&(t=de(4)),t.write_shift(4,e),t}function HN(e,t){var r=e.l+t,n=Eo(e),a=Mg(e),s=Hr(e),i=Hr(e),c=Hr(e);e.l=r;var u={rfx:n,relId:a,loc:s,display:c};return i&&(u.Tooltip=i),u}function GN(e,t){var r=de(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));Ri({s:Vt(e[0]),e:Vt(e[0])},r),Bg("rId"+t,r);var n=e[1].Target.indexOf("#"),a=n==-1?"":e[1].Target.slice(n+1);return br(a||"",r),br(e[1].Tooltip||"",r),br("",r),r.slice(0,r.l)}function qN(){}function KN(e,t,r){var n=e.l+t,a=U_(e),s=e.read_shift(1),i=[a];if(i[2]=s,r.cellFormula){var c=xL(e,n-e.l,r);i[1]=c}else e.l=n;return i}function XN(e,t,r){var n=e.l+t,a=Eo(e),s=[a];if(r.cellFormula){var i=wL(e,n-e.l,r);s[1]=i,e.l=n}else e.l=n;return s}function JN(e,t,r){r==null&&(r=de(18));var n=Hf(e,t);r.write_shift(-4,e),r.write_shift(-4,e),r.write_shift(4,(n.width||10)*256),r.write_shift(4,0);var a=0;return t.hidden&&(a|=1),typeof n.width=="number"&&(a|=2),t.level&&(a|=t.level<<8),r.write_shift(2,a),r}var HS=["left","right","top","bottom","header","footer"];function YN(e){var t={};return HS.forEach(function(r){t[r]=Wr(e)}),t}function QN(e,t){return t==null&&(t=de(48)),io(e),HS.forEach(function(r){fo(e[r],t)}),t}function ZN(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function e6(e,t,r){r==null&&(r=de(30));var n=924;return(((t||{}).Views||[])[0]||{}).RTL&&(n|=32),r.write_shift(2,n),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function t6(e){var t=de(24);return t.write_shift(4,4),t.write_shift(4,1),Ri(e,t),t}function r6(e,t){return t==null&&(t=de(66)),t.write_shift(2,e.password?Hg(e.password):0),t.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?t.write_shift(4,e[r[0]]!=null&&!e[r[0]]?1:0):t.write_shift(4,e[r[0]]!=null&&e[r[0]]?0:1)}),t}function n6(){}function a6(){}function s6(e,t,r,n,a,s,i){if(!e)return e;var c=t||{};n||(n={"!id":{}});var u=c.dense?[]:{},f,h={s:{r:2e6,c:2e6},e:{r:0,c:0}},p=!1,m=!1,y,w,x,_,E,k,b,O,z,L=[];c.biff=12,c["!row"]=0;var P=0,J=!1,V=[],le={},ee=c.supbooks||a.supbooks||[[]];if(ee.sharedf=le,ee.arrayf=V,ee.SheetNames=a.SheetNames||a.Sheets.map(function(ge){return ge.name}),!c.supbooks&&(c.supbooks=ee,a.Names))for(var X=0;X<a.Names.length;++X)ee[0][X+1]=a.Names[X];var he=[],Ie=[],Ee=!1;oc[16]={n:"BrtShortReal",f:WS};var Te;if(Ha(e,function(K,fe,H){if(!m)switch(H){case 148:f=K;break;case 0:y=K,c.sheetRows&&c.sheetRows<=y.r&&(m=!0),O=rr(_=y.r),c["!row"]=y.r,(K.hidden||K.hpt||K.level!=null)&&(K.hpt&&(K.hpx=Ei(K.hpt)),Ie[K.r]=K);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(w={t:K[2]},K[2]){case"n":w.v=K[1];break;case"s":b=Nl[K[1]],w.v=b.t,w.r=b.r;break;case"b":w.v=!!K[1];break;case"e":w.v=K[1],c.cellText!==!1&&(w.w=Ga[w.v]);break;case"str":w.t="s",w.v=K[1];break;case"is":w.t="s",w.v=K[1].t;break}if((x=i.CellXf[K[0].iStyleRef])&&US(w,x.numFmtId,null,c,s,i),E=K[0].c==-1?E+1:K[0].c,c.dense?(u[_]||(u[_]=[]),u[_][E]=w):u[zt(E)+O]=w,c.cellFormula){for(J=!1,P=0;P<V.length;++P){var A=V[P];y.r>=A[0].s.r&&y.r<=A[0].e.r&&E>=A[0].s.c&&E<=A[0].e.c&&(w.F=rt(A[0]),J=!0)}!J&&K.length>3&&(w.f=K[3])}if(h.s.r>y.r&&(h.s.r=y.r),h.s.c>E&&(h.s.c=E),h.e.r<y.r&&(h.e.r=y.r),h.e.c<E&&(h.e.c=E),c.cellDates&&x&&w.t=="n"&&Oi(Ge[x.numFmtId])){var G=to(w.v);G&&(w.t="d",w.v=new Date(G.y,G.m-1,G.d,G.H,G.M,G.S,G.u))}Te&&(Te.type=="XLDAPR"&&(w.D=!0),Te=void 0);break;case 1:case 12:if(!c.sheetStubs||p)break;w={t:"z",v:void 0},E=K[0].c==-1?E+1:K[0].c,c.dense?(u[_]||(u[_]=[]),u[_][E]=w):u[zt(E)+O]=w,h.s.r>y.r&&(h.s.r=y.r),h.s.c>E&&(h.s.c=E),h.e.r<y.r&&(h.e.r=y.r),h.e.c<E&&(h.e.c=E),Te&&(Te.type=="XLDAPR"&&(w.D=!0),Te=void 0);break;case 176:L.push(K);break;case 49:Te=((c.xlmeta||{}).Cell||[])[K-1];break;case 494:var U=n["!id"][K.relId];for(U?(K.Target=U.Target,K.loc&&(K.Target+="#"+K.loc),K.Rel=U):K.relId==""&&(K.Target="#"+K.loc),_=K.rfx.s.r;_<=K.rfx.e.r;++_)for(E=K.rfx.s.c;E<=K.rfx.e.c;++E)c.dense?(u[_]||(u[_]=[]),u[_][E]||(u[_][E]={t:"z",v:void 0}),u[_][E].l=K):(k=qe({c:E,r:_}),u[k]||(u[k]={t:"z",v:void 0}),u[k].l=K);break;case 426:if(!c.cellFormula)break;V.push(K),z=c.dense?u[_][E]:u[zt(E)+O],z.f=zr(K[1],h,{r:y.r,c:E},ee,c),z.F=rt(K[0]);break;case 427:if(!c.cellFormula)break;le[qe(K[0].s)]=K[1],z=c.dense?u[_][E]:u[zt(E)+O],z.f=zr(K[1],h,{r:y.r,c:E},ee,c);break;case 60:if(!c.cellStyles)break;for(;K.e>=K.s;)he[K.e--]={width:K.w/256,hidden:!!(K.flags&1),level:K.level},Ee||(Ee=!0,Gg(K.w/256)),Es(he[K.e+1]);break;case 161:u["!autofilter"]={ref:rt(K)};break;case 476:u["!margins"]=K;break;case 147:a.Sheets[r]||(a.Sheets[r]={}),K.name&&(a.Sheets[r].CodeName=K.name),(K.above||K.left)&&(u["!outline"]={above:K.above,left:K.left});break;case 137:a.Views||(a.Views=[{}]),a.Views[0]||(a.Views[0]={}),K.RTL&&(a.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:p=!0;break;case 36:p=!1;break;case 37:p=!0;break;case 38:p=!1;break;default:if(!fe.T){if(!p||c.WTF)throw new Error("Unexpected record 0x"+H.toString(16))}}},c),delete c.supbooks,delete c["!row"],!u["!ref"]&&(h.s.r<2e6||f&&(f.e.r>0||f.e.c>0||f.s.r>0||f.s.c>0))&&(u["!ref"]=rt(f||h)),c.sheetRows&&u["!ref"]){var oe=mt(u["!ref"]);c.sheetRows<=+oe.e.r&&(oe.e.r=c.sheetRows-1,oe.e.r>h.e.r&&(oe.e.r=h.e.r),oe.e.r<oe.s.r&&(oe.s.r=oe.e.r),oe.e.c>h.e.c&&(oe.e.c=h.e.c),oe.e.c<oe.s.c&&(oe.s.c=oe.e.c),u["!fullref"]=u["!ref"],u["!ref"]=rt(oe))}return L.length>0&&(u["!merges"]=L),he.length>0&&(u["!cols"]=he),Ie.length>0&&(u["!rows"]=Ie),u}function o6(e,t,r,n,a,s,i){if(t.v===void 0)return!1;var c="";switch(t.t){case"b":c=t.v?"1":"0";break;case"d":t=Lt(t),t.z=t.z||Ge[14],t.v=pr(Rt(t.v)),t.t="n";break;case"n":case"e":c=""+t.v;break;default:c=t.v;break}var u={r,c:n};switch(u.s=Is(a.cellXfs,t,a),t.l&&s["!links"].push([qe(u),t.l]),t.c&&s["!comments"].push([qe(u),t.c]),t.t){case"s":case"str":return a.bookSST?(c=Yg(a.Strings,t.v,a.revStrings),u.t="s",u.v=c,i?we(e,18,kN(t,u)):we(e,7,EN(t,u))):(u.t="str",i?we(e,17,MN(t,u)):we(e,6,LN(t,u))),!0;case"n":return t.v==(t.v|0)&&t.v>-1e3&&t.v<1e3?i?we(e,13,DN(t,u)):we(e,2,IN(t,u)):i?we(e,16,AN(t,u)):we(e,5,CN(t,u)),!0;case"b":return u.t="b",i?we(e,15,vN(t,u)):we(e,4,pN(t,u)),!0;case"e":return u.t="e",i?we(e,14,_N(t,u)):we(e,3,yN(t,u)),!0}return i?we(e,12,hN(t,u)):we(e,1,fN(t,u)),!0}function i6(e,t,r,n){var a=mt(t["!ref"]||"A1"),s,i="",c=[];we(e,145);var u=Array.isArray(t),f=a.e.r;t["!rows"]&&(f=Math.max(a.e.r,t["!rows"].length-1));for(var h=a.s.r;h<=f;++h){i=rr(h),aN(e,t,a,h);var p=!1;if(h<=a.e.r)for(var m=a.s.c;m<=a.e.c;++m){h===a.s.r&&(c[m]=zt(m)),s=c[m]+i;var y=u?(t[h]||[])[m]:t[s];if(!y){p=!1;continue}p=o6(e,y,h,m,n,t,p)}}we(e,146)}function l6(e,t){!t||!t["!merges"]||(we(e,177,WN(t["!merges"].length)),t["!merges"].forEach(function(r){we(e,176,VN(r))}),we(e,178))}function c6(e,t){!t||!t["!cols"]||(we(e,390),t["!cols"].forEach(function(r,n){r&&we(e,60,JN(n,r))}),we(e,391))}function u6(e,t){!t||!t["!ref"]||(we(e,648),we(e,649,t6(mt(t["!ref"]))),we(e,650))}function f6(e,t,r){t["!links"].forEach(function(n){if(n[1].Target){var a=Et(r,-1,n[1].Target.replace(/#.*$/,""),ct.HLINK);we(e,494,GN(n,a))}}),delete t["!links"]}function d6(e,t,r,n){if(t["!comments"].length>0){var a=Et(n,-1,"../drawings/vmlDrawing"+(r+1)+".vml",ct.VML);we(e,551,Bg("rId"+a)),t["!legacy"]=a}}function h6(e,t,r,n){if(t["!autofilter"]){var a=t["!autofilter"],s=typeof a.ref=="string"?a.ref:rt(a.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var i=r.Workbook.Names,c=fn(s);c.s.r==c.e.r&&(c.e.r=fn(t["!ref"]).e.r,s=rt(c));for(var u=0;u<i.length;++u){var f=i[u];if(f.Name=="_xlnm._FilterDatabase"&&f.Sheet==n){f.Ref="'"+r.SheetNames[n]+"'!"+s;break}}u==i.length&&i.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+s}),we(e,161,Ri(mt(s))),we(e,162)}}function g6(e,t,r){we(e,133),we(e,137,e6(t,r)),we(e,138),we(e,134)}function p6(e,t){t["!protect"]&&we(e,535,r6(t["!protect"]))}function m6(e,t,r,n){var a=un(),s=r.SheetNames[e],i=r.Sheets[s]||{},c=s;try{r&&r.Workbook&&(c=r.Workbook.Sheets[e].CodeName||c)}catch{}var u=mt(i["!ref"]||"A1");if(u.e.c>16383||u.e.r>1048575){if(t.WTF)throw new Error("Range "+(i["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");u.e.c=Math.min(u.e.c,16383),u.e.r=Math.min(u.e.c,1048575)}return i["!links"]=[],i["!comments"]=[],we(a,129),(r.vbaraw||i["!outline"])&&we(a,147,cN(c,i["!outline"])),we(a,148,oN(u)),g6(a,i,r.Workbook),c6(a,i),i6(a,i,e,t),p6(a,i),h6(a,i,r,e),l6(a,i),f6(a,i,n),i["!margins"]&&we(a,476,QN(i["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&u6(a,i),d6(a,i,e,n),we(a,130),a.end()}function v6(e){var t=[],r=e.match(/^<c:numCache>/),n;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(s){var i=s.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);i&&(t[+i[1]]=r?+i[2]:i[2])});var a=pt((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(s){n=s.replace(/<.*?>/g,"")}),[t,a,n]}function x6(e,t,r,n,a,s){var i=s||{"!type":"chart"};if(!e)return s;var c=0,u=0,f="A",h={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(p){var m=v6(p);h.s.r=h.s.c=0,h.e.c=c,f=zt(c),m[0].forEach(function(y,w){i[f+rr(w)]={t:"n",v:y,z:m[1]},u=w}),h.e.r<u&&(h.e.r=u),++c}),c>0&&(i["!ref"]=rt(h)),i}function y6(e,t,r,n,a){if(!e)return e;n||(n={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},i,c=e.match(zS);return c&&Qg(c[0],s,a,r),(i=e.match(/drawing r:id="(.*?)"/))&&(s["!rel"]=i[1]),n["!id"][s["!rel"]]&&(s["!drawel"]=n["!id"][s["!rel"]]),s}function w6(e,t){e.l+=10;var r=Hr(e);return{name:r}}function _6(e,t,r,n,a){if(!e)return e;n||(n={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},i=!1;return Ha(e,function(u,f,h){switch(h){case 550:s["!rel"]=u;break;case 651:a.Sheets[r]||(a.Sheets[r]={}),u.name&&(a.Sheets[r].CodeName=u.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:break;case 38:break;default:if(!(f.T>0)){if(!(f.T<0)){if(!i||t.WTF)throw new Error("Unexpected record 0x"+h.toString(16))}}}},t),n["!id"][s["!rel"]]&&(s["!drawel"]=n["!id"][s["!rel"]]),s}var Zg=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],S6=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],E6=[],b6=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function Nx(e,t){for(var r=0;r!=e.length;++r)for(var n=e[r],a=0;a!=t.length;++a){var s=t[a];if(n[s[0]]==null)n[s[0]]=s[1];else switch(s[2]){case"bool":typeof n[s[0]]=="string"&&(n[s[0]]=Ft(n[s[0]]));break;case"int":typeof n[s[0]]=="string"&&(n[s[0]]=parseInt(n[s[0]],10));break}}}function Mx(e,t){for(var r=0;r!=t.length;++r){var n=t[r];if(e[n[0]]==null)e[n[0]]=n[1];else switch(n[2]){case"bool":typeof e[n[0]]=="string"&&(e[n[0]]=Ft(e[n[0]]));break;case"int":typeof e[n[0]]=="string"&&(e[n[0]]=parseInt(e[n[0]],10));break}}}function GS(e){Mx(e.WBProps,Zg),Mx(e.CalcPr,b6),Nx(e.WBView,S6),Nx(e.Sheets,E6),mi.date1904=Ft(e.WBProps.date1904)}function k6(e){return!e.Workbook||!e.Workbook.WBProps?"false":Ft(e.Workbook.WBProps.date1904)?"true":"false"}var T6="][*?/\\".split("");function qS(e,t){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return T6.forEach(function(n){if(e.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}function C6(e,t,r){e.forEach(function(n,a){qS(n);for(var s=0;s<a;++s)if(n==e[s])throw new Error("Duplicate Sheet Name: "+n);if(r){var i=t&&t[a]&&t[a].CodeName||n;if(i.charCodeAt(0)==95&&i.length>22)throw new Error("Bad Code Name: Worksheet"+i)}})}function A6(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var t=e.Workbook&&e.Workbook.Sheets||[];C6(e.SheetNames,t,!!e.vbaraw);for(var r=0;r<e.SheetNames.length;++r)kL(e.Sheets[e.SheetNames[r]],e.SheetNames[r],r)}var P6=/<\w+:workbook/;function I6(e,t){if(!e)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,a="xmlns",s={},i=0;if(e.replace(Kr,function(u,f){var h=Je(u);switch(wa(h[0])){case"<?xml":break;case"<workbook":u.match(P6)&&(a="xmlns"+u.match(/<(\w+):/)[1]),r.xmlns=h[a];break;case"</workbook>":break;case"<fileVersion":delete h[0],r.AppVersion=h;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":Zg.forEach(function(p){if(h[p[0]]!=null)switch(p[2]){case"bool":r.WBProps[p[0]]=Ft(h[p[0]]);break;case"int":r.WBProps[p[0]]=parseInt(h[p[0]],10);break;default:r.WBProps[p[0]]=h[p[0]]}}),h.codeName&&(r.WBProps.CodeName=kt(h.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete h[0],r.WBView.push(h);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(h.state){case"hidden":h.Hidden=1;break;case"veryHidden":h.Hidden=2;break;default:h.Hidden=0}delete h.state,h.name=pt(kt(h.name)),delete h[0],r.Sheets.push(h);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":s={},s.Name=kt(h.name),h.comment&&(s.Comment=h.comment),h.localSheetId&&(s.Sheet=+h.localSheetId),Ft(h.hidden||"0")&&(s.Hidden=!0),i=f+u.length;break;case"</definedName>":s.Ref=pt(kt(e.slice(i,f))),r.Names.push(s);break;case"<definedName/>":break;case"<calcPr":delete h[0],r.CalcPr=h;break;case"<calcPr/>":delete h[0],r.CalcPr=h;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&t.WTF)throw new Error("unrecognized "+h[0]+" in workbook")}return u}),yo.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return GS(r),r}function KS(e){var t=[ar];t[t.length]=Oe("workbook",null,{xmlns:yo[0],"xmlns:r":gr.r});var r=e.Workbook&&(e.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(Zg.forEach(function(c){e.Workbook.WBProps[c[0]]!=null&&e.Workbook.WBProps[c[0]]!=c[1]&&(n[c[0]]=e.Workbook.WBProps[c[0]])}),e.Workbook.WBProps.CodeName&&(n.codeName=e.Workbook.WBProps.CodeName,delete n.CodeName)),t[t.length]=Oe("workbookPr",null,n);var a=e.Workbook&&e.Workbook.Sheets||[],s=0;if(a&&a[0]&&a[0].Hidden){for(t[t.length]="<bookViews>",s=0;s!=e.SheetNames.length&&!(!a[s]||!a[s].Hidden);++s);s==e.SheetNames.length&&(s=0),t[t.length]='<workbookView firstSheet="'+s+'" activeTab="'+s+'"/>',t[t.length]="</bookViews>"}for(t[t.length]="<sheets>",s=0;s!=e.SheetNames.length;++s){var i={name:bt(e.SheetNames[s].slice(0,31))};if(i.sheetId=""+(s+1),i["r:id"]="rId"+(s+1),a[s])switch(a[s].Hidden){case 1:i.state="hidden";break;case 2:i.state="veryHidden";break}t[t.length]=Oe("sheet",null,i)}return t[t.length]="</sheets>",r&&(t[t.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(c){var u={name:c.Name};c.Comment&&(u.comment=c.Comment),c.Sheet!=null&&(u.localSheetId=""+c.Sheet),c.Hidden&&(u.hidden="1"),c.Ref&&(t[t.length]=Oe("definedName",bt(c.Ref),u))}),t[t.length]="</definedNames>"),t.length>2&&(t[t.length]="</workbook>",t[1]=t[1].replace("/>",">")),t.join("")}function O6(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=Uh(e),r.name=Hr(e),r}function D6(e,t){return t||(t=de(127)),t.write_shift(4,e.Hidden),t.write_shift(4,e.iTabID),Bg(e.strRelID,t),br(e.name.slice(0,31),t),t.length>t.l?t.slice(0,t.l):t}function F6(e,t){var r={},n=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var a=t>8?Hr(e):"";return a.length>0&&(r.CodeName=a),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function R6(e,t){t||(t=de(72));var r=0;return e&&e.filterPrivacy&&(r|=8),t.write_shift(4,r),t.write_shift(4,0),j_(e&&e.CodeName||"ThisWorkbook",t),t.slice(0,t.l)}function L6(e,t){var r={};return e.read_shift(4),r.ArchID=e.read_shift(4),e.l+=t-8,r}function N6(e,t,r){var n=e.l+t;e.l+=4,e.l+=1;var a=e.read_shift(4),s=d3(e),i=yL(e,0,r),c=Mg(e);e.l=n;var u={Name:s,Ptg:i};return a<268435455&&(u.Sheet=a),c&&(u.Comment=c),u}function M6(e,t){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],a=!1;t||(t={}),t.biff=12;var s=[],i=[[]];return i.SheetNames=[],i.XTI=[],oc[16]={n:"BrtFRTArchID$",f:L6},Ha(e,function(u,f,h){switch(h){case 156:i.SheetNames.push(u.name),r.Sheets.push(u);break;case 153:r.WBProps=u;break;case 39:u.Sheet!=null&&(t.SID=u.Sheet),u.Ref=zr(u.Ptg,null,null,i,t),delete t.SID,delete u.Ptg,s.push(u);break;case 1036:break;case 357:case 358:case 355:case 667:i[0].length?i.push([h,u]):i[0]=[h,u],i[i.length-1].XTI=[];break;case 362:i.length===0&&(i[0]=[],i[0].XTI=[]),i[i.length-1].XTI=i[i.length-1].XTI.concat(u),i.XTI=i.XTI.concat(u);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(h),a=!0;break;case 36:n.pop(),a=!1;break;case 37:n.push(h),a=!0;break;case 38:n.pop(),a=!1;break;case 16:break;default:if(!f.T){if(!a||t.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+h.toString(16))}}},t),GS(r),r.Names=s,r.supbooks=i,r}function B6(e,t){we(e,143);for(var r=0;r!=t.SheetNames.length;++r){var n=t.Workbook&&t.Workbook.Sheets&&t.Workbook.Sheets[r]&&t.Workbook.Sheets[r].Hidden||0,a={Hidden:n,iTabID:r+1,strRelID:"rId"+(r+1),name:t.SheetNames[r]};we(e,156,D6(a))}we(e,144)}function j6(e,t){t||(t=de(127));for(var r=0;r!=4;++r)t.write_shift(4,0);return br("SheetJS",t),br(gf.version,t),br(gf.version,t),br("7262",t),t.length>t.l?t.slice(0,t.l):t}function $6(e,t){t||(t=de(29)),t.write_shift(-4,0),t.write_shift(-4,460),t.write_shift(4,28800),t.write_shift(4,17600),t.write_shift(4,500),t.write_shift(4,e),t.write_shift(4,e);var r=120;return t.write_shift(1,r),t.length>t.l?t.slice(0,t.l):t}function U6(e,t){if(!(!t.Workbook||!t.Workbook.Sheets)){for(var r=t.Workbook.Sheets,n=0,a=-1,s=-1;n<r.length;++n)!r[n]||!r[n].Hidden&&a==-1?a=n:r[n].Hidden==1&&s==-1&&(s=n);s>a||(we(e,135),we(e,158,$6(a)),we(e,136))}}function z6(e,t){var r=un();return we(r,131),we(r,128,j6()),we(r,153,R6(e.Workbook&&e.Workbook.WBProps||null)),U6(r,e),B6(r,e),we(r,132),r.end()}function V6(e,t,r){return t.slice(-4)===".bin"?M6(e,r):I6(e,r)}function W6(e,t,r,n,a,s,i,c){return t.slice(-4)===".bin"?s6(e,n,r,a,s,i,c):NL(e,n,r,a,s,i,c)}function H6(e,t,r,n,a,s,i,c){return t.slice(-4)===".bin"?_6(e,n,r,a,s):y6(e,n,r,a,s)}function G6(e,t,r,n,a,s,i,c){return t.slice(-4)===".bin"?KR():XR()}function q6(e,t,r,n,a,s,i,c){return t.slice(-4)===".bin"?GR():qR()}function K6(e,t,r,n){return t.slice(-4)===".bin"?VF(e,r,n):OF(e,r,n)}function X6(e,t,r){return AS(e,r)}function J6(e,t,r){return t.slice(-4)===".bin"?JD(e,r):qD(e,r)}function Y6(e,t,r){return t.slice(-4)===".bin"?UR(e,r):DR(e,r)}function Q6(e,t,r){return t.slice(-4)===".bin"?PR(e):CR(e)}function Z6(e,t,r,n){return r.slice(-4)===".bin"?IR(e,t,r,n):void 0}function e5(e,t,r){return t.slice(-4)===".bin"?bR(e,t,r):TR(e,t,r)}function t5(e,t,r){return(t.slice(-4)===".bin"?z6:KS)(e)}function r5(e,t,r,n,a){return(t.slice(-4)===".bin"?m6:VS)(e,r,n,a)}function n5(e,t,r){return(t.slice(-4)===".bin"?ZF:TS)(e,r)}function a5(e,t,r){return(t.slice(-4)===".bin"?ZD:xS)(e,r)}function s5(e,t,r){return(t.slice(-4)===".bin"?zR:OS)(e)}function o5(e){return(e.slice(-4)===".bin"?kR:PS)()}var XS=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,JS=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function Yn(e,t){var r=e.split(/\s+/),n=[];if(n[0]=r[0],r.length===1)return n;var a=e.match(XS),s,i,c,u;if(a)for(u=0;u!=a.length;++u)s=a[u].match(JS),(i=s[1].indexOf(":"))===-1?n[s[1]]=s[2].slice(1,s[2].length-1):(s[1].slice(0,6)==="xmlns:"?c="xmlns"+s[1].slice(6):c=s[1].slice(i+1),n[c]=s[2].slice(1,s[2].length-1));return n}function i5(e){var t=e.split(/\s+/),r={};if(t.length===1)return r;var n=e.match(XS),a,s,i,c;if(n)for(c=0;c!=n.length;++c)a=n[c].match(JS),(s=a[1].indexOf(":"))===-1?r[a[1]]=a[2].slice(1,a[2].length-1):(a[1].slice(0,6)==="xmlns:"?i="xmlns"+a[1].slice(6):i=a[1].slice(s+1),r[i]=a[2].slice(1,a[2].length-1));return r}var Bl;function l5(e,t){var r=Bl[e]||pt(e);return r==="General"?co(t):Un(r,t)}function c5(e,t,r,n){var a=n;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":a=Ft(n);break;case"i2":case"int":a=parseInt(n,10);break;case"r4":case"float":a=parseFloat(n);break;case"date":case"dateTime.tz":a=Rt(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}e[pt(t)]=a}function u5(e,t,r){if(e.t!=="z"){if(!r||r.cellText!==!1)try{e.t==="e"?e.w=e.w||Ga[e.v]:t==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Yl(e.v):e.w=co(e.v):e.w=l5(t||"General",e.v)}catch(s){if(r.WTF)throw s}try{var n=Bl[t]||t||"General";if(r.cellNF&&(e.z=n),r.cellDates&&e.t=="n"&&Oi(n)){var a=to(e.v);a&&(e.t="d",e.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}catch(s){if(r.WTF)throw s}}}function f5(e,t,r){if(r.cellStyles&&t.Interior){var n=t.Interior;n.Pattern&&(n.patternType=EF[n.Pattern]||n.Pattern)}e[t.ID]=t}function d5(e,t,r,n,a,s,i,c,u,f){var h="General",p=n.StyleID,m={};f=f||{};var y=[],w=0;for(p===void 0&&c&&(p=c.StyleID),p===void 0&&i&&(p=i.StyleID);s[p]!==void 0&&(s[p].nf&&(h=s[p].nf),s[p].Interior&&y.push(s[p].Interior),!!s[p].Parent);)p=s[p].Parent;switch(r.Type){case"Boolean":n.t="b",n.v=Ft(e);break;case"String":n.t="s",n.r=ex(pt(e)),n.v=e.indexOf("<")>-1?pt(t||e).replace(/<.*?>/g,""):n.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),n.v=(Rt(e)-new Date(Date.UTC(1899,11,30)))/(1440*60*1e3),n.v!==n.v?n.v=pt(e):n.v<60&&(n.v=n.v-1),(!h||h=="General")&&(h="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+e),n.t||(n.t="n");break;case"Error":n.t="e",n.v=W_[e],f.cellText!==!1&&(n.w=e);break;default:e==""&&t==""?n.t="z":(n.t="s",n.v=ex(t||e));break}if(u5(n,h,f),f.cellFormula!==!1)if(n.Formula){var x=pt(n.Formula);x.charCodeAt(0)==61&&(x=x.slice(1)),n.f=pi(x,a),delete n.Formula,n.ArrayRange=="RC"?n.F=pi("RC:RC",a):n.ArrayRange&&(n.F=pi(n.ArrayRange,a),u.push([mt(n.F),n.F]))}else for(w=0;w<u.length;++w)a.r>=u[w][0].s.r&&a.r<=u[w][0].e.r&&a.c>=u[w][0].s.c&&a.c<=u[w][0].e.c&&(n.F=u[w][1]);f.cellStyles&&(y.forEach(function(_){!m.patternType&&_.patternType&&(m.patternType=_.patternType)}),n.s=m),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function h5(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function sh(e,t){var r=t||{};Di();var n=Tl(Og(e));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(n=kt(n));var a=n.slice(0,1024).toLowerCase(),s=!1;if(a=a.replace(/".*?"/g,""),(a.indexOf(">")&1023)>Math.min(a.indexOf(",")&1023,a.indexOf(";")&1023)){var i=Lt(r);return i.type="string",Si.to_workbook(n,i)}if(a.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(Nt){a.indexOf("<"+Nt)>=0&&(s=!0)}),s)return Q5(n,r);Bl={"General Number":"General","General Date":Ge[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":Ge[15],"Short Date":Ge[14],"Long Time":Ge[19],"Medium Time":Ge[18],"Short Time":Ge[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:Ge[2],Standard:Ge[4],Percent:Ge[10],Scientific:Ge[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var c,u=[],f,h={},p=[],m=r.dense?[]:{},y="",w={},x={},_=Yn('<Data ss:Type="String">'),E=0,k=0,b=0,O={s:{r:2e6,c:2e6},e:{r:0,c:0}},z={},L={},P="",J=0,V=[],le={},ee={},X=0,he=[],Ie=[],Ee={},Te=[],oe,ge=!1,K=[],fe=[],H={},A=0,G=0,U={Sheets:[],WBProps:{date1904:!1}},W={};ec.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var ne="";c=ec.exec(n);)switch(c[3]=(ne=c[3]).toLowerCase()){case"data":if(ne=="data"){if(c[1]==="/"){if((f=u.pop())[0]!==c[3])throw new Error("Bad state: "+f.join("|"))}else c[0].charAt(c[0].length-2)!=="/"&&u.push([c[3],!0]);break}if(u[u.length-1][1])break;c[1]==="/"?d5(n.slice(E,c.index),P,_,u[u.length-1][0]=="comment"?Ee:w,{c:k,r:b},z,Te[k],x,K,r):(P="",_=Yn(c[0]),E=c.index+c[0].length);break;case"cell":if(c[1]==="/")if(Ie.length>0&&(w.c=Ie),(!r.sheetRows||r.sheetRows>b)&&w.v!==void 0&&(r.dense?(m[b]||(m[b]=[]),m[b][k]=w):m[zt(k)+rr(b)]=w),w.HRef&&(w.l={Target:pt(w.HRef)},w.HRefScreenTip&&(w.l.Tooltip=w.HRefScreenTip),delete w.HRef,delete w.HRefScreenTip),(w.MergeAcross||w.MergeDown)&&(A=k+(parseInt(w.MergeAcross,10)|0),G=b+(parseInt(w.MergeDown,10)|0),V.push({s:{c:k,r:b},e:{c:A,r:G}})),!r.sheetStubs)w.MergeAcross?k=A+1:++k;else if(w.MergeAcross||w.MergeDown){for(var xe=k;xe<=A;++xe)for(var ve=b;ve<=G;++ve)(xe>k||ve>b)&&(r.dense?(m[ve]||(m[ve]=[]),m[ve][xe]={t:"z"}):m[zt(xe)+rr(ve)]={t:"z"});k=A+1}else++k;else w=i5(c[0]),w.Index&&(k=+w.Index-1),k<O.s.c&&(O.s.c=k),k>O.e.c&&(O.e.c=k),c[0].slice(-2)==="/>"&&++k,Ie=[];break;case"row":c[1]==="/"||c[0].slice(-2)==="/>"?(b<O.s.r&&(O.s.r=b),b>O.e.r&&(O.e.r=b),c[0].slice(-2)==="/>"&&(x=Yn(c[0]),x.Index&&(b=+x.Index-1)),k=0,++b):(x=Yn(c[0]),x.Index&&(b=+x.Index-1),H={},(x.AutoFitHeight=="0"||x.Height)&&(H.hpx=parseInt(x.Height,10),H.hpt=sc(H.hpx),fe[b]=H),x.Hidden=="1"&&(H.hidden=!0,fe[b]=H));break;case"worksheet":if(c[1]==="/"){if((f=u.pop())[0]!==c[3])throw new Error("Bad state: "+f.join("|"));p.push(y),O.s.r<=O.e.r&&O.s.c<=O.e.c&&(m["!ref"]=rt(O),r.sheetRows&&r.sheetRows<=O.e.r&&(m["!fullref"]=m["!ref"],O.e.r=r.sheetRows-1,m["!ref"]=rt(O))),V.length&&(m["!merges"]=V),Te.length>0&&(m["!cols"]=Te),fe.length>0&&(m["!rows"]=fe),h[y]=m}else O={s:{r:2e6,c:2e6},e:{r:0,c:0}},b=k=0,u.push([c[3],!1]),f=Yn(c[0]),y=pt(f.Name),m=r.dense?[]:{},V=[],K=[],fe=[],W={name:y,Hidden:0},U.Sheets.push(W);break;case"table":if(c[1]==="/"){if((f=u.pop())[0]!==c[3])throw new Error("Bad state: "+f.join("|"))}else{if(c[0].slice(-2)=="/>")break;u.push([c[3],!1]),Te=[],ge=!1}break;case"style":c[1]==="/"?f5(z,L,r):L=Yn(c[0]);break;case"numberformat":L.nf=pt(Yn(c[0]).Format||"General"),Bl[L.nf]&&(L.nf=Bl[L.nf]);for(var me=0;me!=392&&Ge[me]!=L.nf;++me);if(me==392){for(me=57;me!=392;++me)if(Ge[me]==null){Ma(L.nf,me);break}}break;case"column":if(u[u.length-1][0]!=="table")break;if(oe=Yn(c[0]),oe.Hidden&&(oe.hidden=!0,delete oe.Hidden),oe.Width&&(oe.wpx=parseInt(oe.Width,10)),!ge&&oe.wpx>10){ge=!0,Vr=bS;for(var ye=0;ye<Te.length;++ye)Te[ye]&&Es(Te[ye])}ge&&Es(oe),Te[oe.Index-1||Te.length]=oe;for(var Ze=0;Ze<+oe.Span;++Ze)Te[Te.length]=Lt(oe);break;case"namedrange":if(c[1]==="/")break;U.Names||(U.Names=[]);var j=Je(c[0]),yt={Name:j.Name,Ref:pi(j.RefersTo.slice(1),{r:0,c:0})};U.Sheets.length>0&&(yt.Sheet=U.Sheets.length-1),U.Names.push(yt);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(c[0].slice(-2)==="/>")break;c[1]==="/"?P+=n.slice(J,c.index):J=c.index+c[0].length;break;case"interior":if(!r.cellStyles)break;L.Interior=Yn(c[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(c[0].slice(-2)==="/>")break;c[1]==="/"?M3(le,ne,n.slice(X,c.index)):X=c.index+c[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(c[1]==="/"){if((f=u.pop())[0]!==c[3])throw new Error("Bad state: "+f.join("|"))}else u.push([c[3],!1]);break;case"comment":if(c[1]==="/"){if((f=u.pop())[0]!==c[3])throw new Error("Bad state: "+f.join("|"));h5(Ee),Ie.push(Ee)}else u.push([c[3],!1]),f=Yn(c[0]),Ee={a:f.Author};break;case"autofilter":if(c[1]==="/"){if((f=u.pop())[0]!==c[3])throw new Error("Bad state: "+f.join("|"))}else if(c[0].charAt(c[0].length-2)!=="/"){var ot=Yn(c[0]);m["!autofilter"]={ref:pi(ot.Range).replace(/\$/g,"")},u.push([c[3],!0])}break;case"name":break;case"datavalidation":if(c[1]==="/"){if((f=u.pop())[0]!==c[3])throw new Error("Bad state: "+f.join("|"))}else c[0].charAt(c[0].length-2)!=="/"&&u.push([c[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(c[1]==="/"){if((f=u.pop())[0]!==c[3])throw new Error("Bad state: "+f.join("|"))}else c[0].charAt(c[0].length-2)!=="/"&&u.push([c[3],!0]);break;case"null":break;default:if(u.length==0&&c[3]=="document"||u.length==0&&c[3]=="uof")return zx(n,r);var wt=!0;switch(u[u.length-1][0]){case"officedocumentsettings":switch(c[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:wt=!1}break;case"componentoptions":switch(c[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:wt=!1}break;case"excelworkbook":switch(c[3]){case"date1904":U.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:wt=!1}break;case"workbookoptions":switch(c[3]){case"owcversion":break;case"height":break;case"width":break;default:wt=!1}break;case"worksheetoptions":switch(c[3]){case"visible":if(c[0].slice(-2)!=="/>")if(c[1]==="/")switch(n.slice(X,c.index)){case"SheetHidden":W.Hidden=1;break;case"SheetVeryHidden":W.Hidden=2;break}else X=c.index+c[0].length;break;case"header":m["!margins"]||io(m["!margins"]={},"xlml"),isNaN(+Je(c[0]).Margin)||(m["!margins"].header=+Je(c[0]).Margin);break;case"footer":m["!margins"]||io(m["!margins"]={},"xlml"),isNaN(+Je(c[0]).Margin)||(m["!margins"].footer=+Je(c[0]).Margin);break;case"pagemargins":var at=Je(c[0]);m["!margins"]||io(m["!margins"]={},"xlml"),isNaN(+at.Top)||(m["!margins"].top=+at.Top),isNaN(+at.Left)||(m["!margins"].left=+at.Left),isNaN(+at.Right)||(m["!margins"].right=+at.Right),isNaN(+at.Bottom)||(m["!margins"].bottom=+at.Bottom);break;case"displayrighttoleft":U.Views||(U.Views=[]),U.Views[0]||(U.Views[0]={}),U.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":m["!outline"]||(m["!outline"]={}),m["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":m["!outline"]||(m["!outline"]={}),m["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:wt=!1}break;case"pivottable":case"pivotcache":switch(c[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:wt=!1}break;case"pagebreaks":switch(c[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:wt=!1}break;case"autofilter":switch(c[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:wt=!1}break;case"querytable":switch(c[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:wt=!1}break;case"datavalidation":switch(c[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:wt=!1}break;case"sorting":case"conditionalformatting":switch(c[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:wt=!1}break;case"mapinfo":case"schema":case"data":switch(c[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:wt=!1}break;case"smarttags":break;default:wt=!1;break}if(wt||c[3].match(/!\[CDATA/))break;if(!u[u.length-1][1])throw"Unrecognized tag: "+c[3]+"|"+u.join("|");if(u[u.length-1][0]==="customdocumentproperties"){if(c[0].slice(-2)==="/>")break;c[1]==="/"?c5(ee,ne,he,n.slice(X,c.index)):(he=c,X=c.index+c[0].length);break}if(r.WTF)throw"Unrecognized tag: "+c[3]+"|"+u.join("|")}var Re={};return!r.bookSheets&&!r.bookProps&&(Re.Sheets=h),Re.SheetNames=p,Re.Workbook=U,Re.SSF=Lt(Ge),Re.Props=le,Re.Custprops=ee,Re}function Kh(e,t){switch(tp(t=t||{}),t.type||"base64"){case"base64":return sh(Tn(e),t);case"binary":case"buffer":case"file":return sh(e,t);case"array":return sh(As(e),t)}}function g5(e,t){var r=[];return e.Props&&r.push(B3(e.Props,t)),e.Custprops&&r.push(j3(e.Props,e.Custprops)),r.join("")}function p5(){return""}function m5(e,t){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return t.cellXfs.forEach(function(n,a){var s=[];s.push(Oe("NumberFormat",null,{"ss:Format":bt(Ge[n.numFmtId])}));var i={"ss:ID":"s"+(21+a)};r.push(Oe("Style",s.join(""),i))}),Oe("Styles",r.join(""))}function YS(e){return Oe("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+Xg(e.Ref,{r:0,c:0})})}function v5(e){if(!((e||{}).Workbook||{}).Names)return"";for(var t=e.Workbook.Names,r=[],n=0;n<t.length;++n){var a=t[n];a.Sheet==null&&(a.Name.match(/^_xlfn\./)||r.push(YS(a)))}return Oe("Names",r.join(""))}function x5(e,t,r,n){if(!e||!((n||{}).Workbook||{}).Names)return"";for(var a=n.Workbook.Names,s=[],i=0;i<a.length;++i){var c=a[i];c.Sheet==r&&(c.Name.match(/^_xlfn\./)||s.push(YS(c)))}return s.join("")}function y5(e,t,r,n){if(!e)return"";var a=[];if(e["!margins"]&&(a.push("<PageSetup>"),e["!margins"].header&&a.push(Oe("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&a.push(Oe("Footer",null,{"x:Margin":e["!margins"].footer})),a.push(Oe("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),a.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[r])if(n.Workbook.Sheets[r].Hidden)a.push(Oe("Visible",n.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var s=0;s<r&&!(n.Workbook.Sheets[s]&&!n.Workbook.Sheets[s].Hidden);++s);s==r&&a.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&a.push("<DisplayRightToLeft/>"),e["!protect"]&&(a.push(Pr("ProtectContents","True")),e["!protect"].objects&&a.push(Pr("ProtectObjects","True")),e["!protect"].scenarios&&a.push(Pr("ProtectScenarios","True")),e["!protect"].selectLockedCells!=null&&!e["!protect"].selectLockedCells?a.push(Pr("EnableSelection","NoSelection")):e["!protect"].selectUnlockedCells!=null&&!e["!protect"].selectUnlockedCells&&a.push(Pr("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(i){e["!protect"][i[0]]&&a.push("<"+i[1]+"/>")})),a.length==0?"":Oe("WorksheetOptions",a.join(""),{xmlns:yn.x})}function w5(e){return e.map(function(t){var r=UI(t.t||""),n=Oe("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return Oe("Comment",n,{"ss:Author":t.a})}).join("")}function _5(e,t,r,n,a,s,i){if(!e||e.v==null&&e.f==null)return"";var c={};if(e.f&&(c["ss:Formula"]="="+bt(Xg(e.f,i))),e.F&&e.F.slice(0,t.length)==t){var u=Vt(e.F.slice(t.length+1));c["ss:ArrayRange"]="RC:R"+(u.r==i.r?"":"["+(u.r-i.r)+"]")+"C"+(u.c==i.c?"":"["+(u.c-i.c)+"]")}if(e.l&&e.l.Target&&(c["ss:HRef"]=bt(e.l.Target),e.l.Tooltip&&(c["x:HRefScreenTip"]=bt(e.l.Tooltip))),r["!merges"])for(var f=r["!merges"],h=0;h!=f.length;++h)f[h].s.c!=i.c||f[h].s.r!=i.r||(f[h].e.c>f[h].s.c&&(c["ss:MergeAcross"]=f[h].e.c-f[h].s.c),f[h].e.r>f[h].s.r&&(c["ss:MergeDown"]=f[h].e.r-f[h].s.r));var p="",m="";switch(e.t){case"z":if(!n.sheetStubs)return"";break;case"n":p="Number",m=String(e.v);break;case"b":p="Boolean",m=e.v?"1":"0";break;case"e":p="Error",m=Ga[e.v];break;case"d":p="DateTime",m=new Date(e.v).toISOString(),e.z==null&&(e.z=e.z||Ge[14]);break;case"s":p="String",m=$I(e.v||"");break}var y=Is(n.cellXfs,e,n);c["ss:StyleID"]="s"+(21+y),c["ss:Index"]=i.c+1;var w=e.v!=null?m:"",x=e.t=="z"?"":'<Data ss:Type="'+p+'">'+w+"</Data>";return(e.c||[]).length>0&&(x+=w5(e.c)),Oe("Cell",x,c)}function S5(e,t){var r='<Row ss:Index="'+(e+1)+'"';return t&&(t.hpt&&!t.hpx&&(t.hpx=Ei(t.hpt)),t.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+t.hpx+'"'),t.hidden&&(r+=' ss:Hidden="1"')),r+">"}function E5(e,t,r,n){if(!e["!ref"])return"";var a=mt(e["!ref"]),s=e["!merges"]||[],i=0,c=[];e["!cols"]&&e["!cols"].forEach(function(_,E){Es(_);var k=!!_.width,b=Hf(E,_),O={"ss:Index":E+1};k&&(O["ss:Width"]=nc(b.width)),_.hidden&&(O["ss:Hidden"]="1"),c.push(Oe("Column",null,O))});for(var u=Array.isArray(e),f=a.s.r;f<=a.e.r;++f){for(var h=[S5(f,(e["!rows"]||[])[f])],p=a.s.c;p<=a.e.c;++p){var m=!1;for(i=0;i!=s.length;++i)if(!(s[i].s.c>p)&&!(s[i].s.r>f)&&!(s[i].e.c<p)&&!(s[i].e.r<f)){(s[i].s.c!=p||s[i].s.r!=f)&&(m=!0);break}if(!m){var y={r:f,c:p},w=qe(y),x=u?(e[f]||[])[p]:e[w];h.push(_5(x,w,e,t,r,n,y))}}h.push("</Row>"),h.length>2&&c.push(h.join(""))}return c.join("")}function b5(e,t,r){var n=[],a=r.SheetNames[e],s=r.Sheets[a],i=s?x5(s,t,e,r):"";return i.length>0&&n.push("<Names>"+i+"</Names>"),i=s?E5(s,t,e,r):"",i.length>0&&n.push("<Table>"+i+"</Table>"),n.push(y5(s,t,e,r)),n.join("")}function k5(e,t){t||(t={}),e.SSF||(e.SSF=Lt(Ge)),e.SSF&&(Di(),Bf(e.SSF),t.revssf=$f(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF,t.cellXfs=[],Is(t.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(g5(e,t)),r.push(p5()),r.push(""),r.push("");for(var n=0;n<e.SheetNames.length;++n)r.push(Oe("Worksheet",b5(n,t,e),{"ss:Name":bt(e.SheetNames[n])}));return r[2]=m5(e,t),r[3]=v5(e),ar+Oe("Workbook",r.join(""),{xmlns:yn.ss,"xmlns:o":yn.o,"xmlns:x":yn.x,"xmlns:ss":yn.ss,"xmlns:dt":yn.dt,"xmlns:html":yn.html})}function T5(e){var t={},r=e.content;if(r.l=28,t.AnsiUserType=r.read_shift(0,"lpstr-ansi"),t.AnsiClipboardFormat=v3(r),r.length-r.l<=4)return t;var n=r.read_shift(4);if(n==0||n>40||(r.l-=4,t.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(n=r.read_shift(4),n!==1907505652)||(t.UnicodeClipboardFormat=x3(r),n=r.read_shift(4),n==0||n>40))return t;r.l-=4,t.Reserved2=r.read_shift(0,"lpwstr")}var C5=[60,1084,2066,2165,2175];function A5(e,t,r,n,a){var s=n,i=[],c=r.slice(r.l,r.l+s);if(a&&a.enc&&a.enc.insitu&&c.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:a.enc.insitu(c)}i.push(c),r.l+=s;for(var u=La(r,r.l),f=Xh[u],h=0;f!=null&&C5.indexOf(u)>-1;)s=La(r,r.l+2),h=r.l+4,u==2066?h+=4:(u==2165||u==2175)&&(h+=12),c=r.slice(h,r.l+4+s),i.push(c),r.l+=4+s,f=Xh[u=La(r,r.l)];var p=Er(i);Ar(p,0);var m=0;p.lens=[];for(var y=0;y<i.length;++y)p.lens.push(m),m+=i[y].length;if(p.length<n)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+p.length+" < "+n;return t.f(p,p.length,a)}function ga(e,t,r){if(e.t!=="z"&&e.XF){var n=0;try{n=e.z||e.XF.numFmtId||0,t.cellNF&&(e.z=Ge[n])}catch(s){if(t.WTF)throw s}if(!t||t.cellText!==!1)try{e.t==="e"?e.w=e.w||Ga[e.v]:n===0||n=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Yl(e.v):e.w=co(e.v):e.w=Un(n,e.v,{date1904:!!r,dateNF:t&&t.dateNF})}catch(s){if(t.WTF)throw s}if(t.cellDates&&n&&e.t=="n"&&Oi(Ge[n]||String(n))){var a=to(e.v);a&&(e.t="d",e.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}}function rf(e,t,r){return{v:e,ixfe:t,t:r}}function P5(e,t){var r={opts:{}},n={},a=t.dense?[]:{},s={},i={},c=null,u=[],f="",h={},p,m="",y,w,x,_,E={},k=[],b,O,z=[],L=[],P={Sheets:[],WBProps:{date1904:!1},Views:[{}]},J={},V=function(tt){return tt<8?ao[tt]:tt<64&&L[tt-8]||ao[tt]},le=function(tt,Tt,tn){var Ht=Tt.XF.data;if(!(!Ht||!Ht.patternType||!tn||!tn.cellStyles)){Tt.s={},Tt.s.patternType=Ht.patternType;var la;(la=rc(V(Ht.icvFore)))&&(Tt.s.fgColor={rgb:la}),(la=rc(V(Ht.icvBack)))&&(Tt.s.bgColor={rgb:la})}},ee=function(tt,Tt,tn){if(!(H>1)&&!(tn.sheetRows&&tt.r>=tn.sheetRows)){if(tn.cellStyles&&Tt.XF&&Tt.XF.data&&le(tt,Tt,tn),delete Tt.ixfe,delete Tt.XF,p=tt,m=qe(tt),(!i||!i.s||!i.e)&&(i={s:{r:0,c:0},e:{r:0,c:0}}),tt.r<i.s.r&&(i.s.r=tt.r),tt.c<i.s.c&&(i.s.c=tt.c),tt.r+1>i.e.r&&(i.e.r=tt.r+1),tt.c+1>i.e.c&&(i.e.c=tt.c+1),tn.cellFormula&&Tt.f){for(var Ht=0;Ht<k.length;++Ht)if(!(k[Ht][0].s.c>tt.c||k[Ht][0].s.r>tt.r)&&!(k[Ht][0].e.c<tt.c||k[Ht][0].e.r<tt.r)){Tt.F=rt(k[Ht][0]),(k[Ht][0].s.c!=tt.c||k[Ht][0].s.r!=tt.r)&&delete Tt.f,Tt.f&&(Tt.f=""+zr(k[Ht][1],i,tt,K,X));break}}tn.dense?(a[tt.r]||(a[tt.r]=[]),a[tt.r][tt.c]=Tt):a[m]=Tt}},X={enc:!1,sbcch:0,snames:[],sharedf:E,arrayf:k,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!t&&!!t.cellStyles,WTF:!!t&&!!t.wtf};t.password&&(X.password=t.password);var he,Ie=[],Ee=[],Te=[],oe=[],ge=!1,K=[];K.SheetNames=X.snames,K.sharedf=X.sharedf,K.arrayf=X.arrayf,K.names=[],K.XTI=[];var fe=0,H=0,A=0,G=[],U=[],W;X.codepage=1200,na(1200);for(var ne=!1;e.l<e.length-1;){var xe=e.l,ve=e.read_shift(2);if(ve===0&&fe===10)break;var me=e.l===e.length?0:e.read_shift(2),ye=Xh[ve];if(ye&&ye.f){if(t.bookSheets&&fe===133&&ve!==133)break;if(fe=ve,ye.r===2||ye.r==12){var Ze=e.read_shift(2);if(me-=2,!X.enc&&Ze!==ve&&((Ze&255)<<8|Ze>>8)!==ve)throw new Error("rt mismatch: "+Ze+"!="+ve);ye.r==12&&(e.l+=10,me-=10)}var j={};if(ve===10?j=ye.f(e,me,X):j=A5(ve,ye,e,me,X),H==0&&[9,521,1033,2057].indexOf(fe)===-1)continue;switch(ve){case 34:r.opts.Date1904=P.WBProps.date1904=j;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(X.enc||(e.l=0),X.enc=j,!t.password)throw new Error("File is password-protected");if(j.valid==null)throw new Error("Encryption scheme unsupported");if(!j.valid)throw new Error("Password is incorrect");break;case 92:X.lastuser=j;break;case 66:var yt=Number(j);switch(yt){case 21010:yt=1200;break;case 32768:yt=1e4;break;case 32769:yt=1252;break}na(X.codepage=yt),ne=!0;break;case 317:X.rrtabid=j;break;case 25:X.winlocked=j;break;case 439:r.opts.RefreshAll=j;break;case 12:r.opts.CalcCount=j;break;case 16:r.opts.CalcDelta=j;break;case 17:r.opts.CalcIter=j;break;case 13:r.opts.CalcMode=j;break;case 14:r.opts.CalcPrecision=j;break;case 95:r.opts.CalcSaveRecalc=j;break;case 15:X.CalcRefMode=j;break;case 2211:r.opts.FullCalc=j;break;case 129:j.fDialog&&(a["!type"]="dialog"),j.fBelow||((a["!outline"]||(a["!outline"]={})).above=!0),j.fRight||((a["!outline"]||(a["!outline"]={})).left=!0);break;case 224:z.push(j);break;case 430:K.push([j]),K[K.length-1].XTI=[];break;case 35:case 547:K[K.length-1].push(j);break;case 24:case 536:W={Name:j.Name,Ref:zr(j.rgce,i,null,K,X)},j.itab>0&&(W.Sheet=j.itab-1),K.names.push(W),K[0]||(K[0]=[],K[0].XTI=[]),K[K.length-1].push(j),j.Name=="_xlnm._FilterDatabase"&&j.itab>0&&j.rgce&&j.rgce[0]&&j.rgce[0][0]&&j.rgce[0][0][0]=="PtgArea3d"&&(U[j.itab-1]={ref:rt(j.rgce[0][0][1][2])});break;case 22:X.ExternCount=j;break;case 23:K.length==0&&(K[0]=[],K[0].XTI=[]),K[K.length-1].XTI=K[K.length-1].XTI.concat(j),K.XTI=K.XTI.concat(j);break;case 2196:if(X.biff<8)break;W!=null&&(W.Comment=j[1]);break;case 18:a["!protect"]=j;break;case 19:j!==0&&X.WTF&&console.error("Password verifier: "+j);break;case 133:s[j.pos]=j,X.snames.push(j.name);break;case 10:{if(--H)break;if(i.e){if(i.e.r>0&&i.e.c>0){if(i.e.r--,i.e.c--,a["!ref"]=rt(i),t.sheetRows&&t.sheetRows<=i.e.r){var ot=i.e.r;i.e.r=t.sheetRows-1,a["!fullref"]=a["!ref"],a["!ref"]=rt(i),i.e.r=ot}i.e.r++,i.e.c++}Ie.length>0&&(a["!merges"]=Ie),Ee.length>0&&(a["!objects"]=Ee),Te.length>0&&(a["!cols"]=Te),oe.length>0&&(a["!rows"]=oe),P.Sheets.push(J)}f===""?h=a:n[f]=a,a=t.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(X.biff===8&&(X.biff={9:2,521:3,1033:4}[ve]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[j.BIFFVer]||8),X.biffguess=j.BIFFVer==0,j.BIFFVer==0&&j.dt==4096&&(X.biff=5,ne=!0,na(X.codepage=28591)),X.biff==8&&j.BIFFVer==0&&j.dt==16&&(X.biff=2),H++)break;if(a=t.dense?[]:{},X.biff<8&&!ne&&(ne=!0,na(X.codepage=t.codepage||1252)),X.biff<5||j.BIFFVer==0&&j.dt==4096){f===""&&(f="Sheet1"),i={s:{r:0,c:0},e:{r:0,c:0}};var wt={pos:e.l-me,name:f};s[wt.pos]=wt,X.snames.push(f)}else f=(s[xe]||{name:""}).name;j.dt==32&&(a["!type"]="chart"),j.dt==64&&(a["!type"]="macro"),Ie=[],Ee=[],X.arrayf=k=[],Te=[],oe=[],ge=!1,J={Hidden:(s[xe]||{hs:0}).hs,name:f}}break;case 515:case 3:case 2:a["!type"]=="chart"&&(t.dense?(a[j.r]||[])[j.c]:a[qe({c:j.c,r:j.r})])&&++j.c,b={ixfe:j.ixfe,XF:z[j.ixfe]||{},v:j.val,t:"n"},A>0&&(b.z=G[b.ixfe>>8&63]),ga(b,t,r.opts.Date1904),ee({c:j.c,r:j.r},b,t);break;case 5:case 517:b={ixfe:j.ixfe,XF:z[j.ixfe],v:j.val,t:j.t},A>0&&(b.z=G[b.ixfe>>8&63]),ga(b,t,r.opts.Date1904),ee({c:j.c,r:j.r},b,t);break;case 638:b={ixfe:j.ixfe,XF:z[j.ixfe],v:j.rknum,t:"n"},A>0&&(b.z=G[b.ixfe>>8&63]),ga(b,t,r.opts.Date1904),ee({c:j.c,r:j.r},b,t);break;case 189:for(var at=j.c;at<=j.C;++at){var Re=j.rkrec[at-j.c][0];b={ixfe:Re,XF:z[Re],v:j.rkrec[at-j.c][1],t:"n"},A>0&&(b.z=G[b.ixfe>>8&63]),ga(b,t,r.opts.Date1904),ee({c:at,r:j.r},b,t)}break;case 6:case 518:case 1030:{if(j.val=="String"){c=j;break}if(b=rf(j.val,j.cell.ixfe,j.tt),b.XF=z[b.ixfe],t.cellFormula){var Nt=j.formula;if(Nt&&Nt[0]&&Nt[0][0]&&Nt[0][0][0]=="PtgExp"){var Ir=Nt[0][0][1][0],Or=Nt[0][0][1][1],Dr=qe({r:Ir,c:Or});E[Dr]?b.f=""+zr(j.formula,i,j.cell,K,X):b.F=((t.dense?(a[Ir]||[])[Or]:a[Dr])||{}).F}else b.f=""+zr(j.formula,i,j.cell,K,X)}A>0&&(b.z=G[b.ixfe>>8&63]),ga(b,t,r.opts.Date1904),ee(j.cell,b,t),c=j}break;case 7:case 519:if(c)c.val=j,b=rf(j,c.cell.ixfe,"s"),b.XF=z[b.ixfe],t.cellFormula&&(b.f=""+zr(c.formula,i,c.cell,K,X)),A>0&&(b.z=G[b.ixfe>>8&63]),ga(b,t,r.opts.Date1904),ee(c.cell,b,t),c=null;else throw new Error("String record expects Formula");break;case 33:case 545:{k.push(j);var Sa=qe(j[0].s);if(y=t.dense?(a[j[0].s.r]||[])[j[0].s.c]:a[Sa],t.cellFormula&&y){if(!c||!Sa||!y)break;y.f=""+zr(j[1],i,j[0],K,X),y.F=rt(j[0])}}break;case 1212:{if(!t.cellFormula)break;if(m){if(!c)break;E[qe(c.cell)]=j[0],y=t.dense?(a[c.cell.r]||[])[c.cell.c]:a[qe(c.cell)],(y||{}).f=""+zr(j[0],i,p,K,X)}}break;case 253:b=rf(u[j.isst].t,j.ixfe,"s"),u[j.isst].h&&(b.h=u[j.isst].h),b.XF=z[b.ixfe],A>0&&(b.z=G[b.ixfe>>8&63]),ga(b,t,r.opts.Date1904),ee({c:j.c,r:j.r},b,t);break;case 513:t.sheetStubs&&(b={ixfe:j.ixfe,XF:z[j.ixfe],t:"z"},A>0&&(b.z=G[b.ixfe>>8&63]),ga(b,t,r.opts.Date1904),ee({c:j.c,r:j.r},b,t));break;case 190:if(t.sheetStubs)for(var Vn=j.c;Vn<=j.C;++Vn){var Fr=j.ixfe[Vn-j.c];b={ixfe:Fr,XF:z[Fr],t:"z"},A>0&&(b.z=G[b.ixfe>>8&63]),ga(b,t,r.opts.Date1904),ee({c:Vn,r:j.r},b,t)}break;case 214:case 516:case 4:b=rf(j.val,j.ixfe,"s"),b.XF=z[b.ixfe],A>0&&(b.z=G[b.ixfe>>8&63]),ga(b,t,r.opts.Date1904),ee({c:j.c,r:j.r},b,t);break;case 0:case 512:H===1&&(i=j);break;case 252:u=j;break;case 1054:if(X.biff==4){G[A++]=j[1];for(var Cn=0;Cn<A+163&&Ge[Cn]!=j[1];++Cn);Cn>=163&&Ma(j[1],A+163)}else Ma(j[1],j[0]);break;case 30:{G[A++]=j;for(var Wn=0;Wn<A+163&&Ge[Wn]!=j;++Wn);Wn>=163&&Ma(j,A+163)}break;case 229:Ie=Ie.concat(j);break;case 93:Ee[j.cmo[0]]=X.lastobj=j;break;case 438:X.lastobj.TxO=j;break;case 127:X.lastobj.ImData=j;break;case 440:for(_=j[0].s.r;_<=j[0].e.r;++_)for(x=j[0].s.c;x<=j[0].e.c;++x)y=t.dense?(a[_]||[])[x]:a[qe({c:x,r:_})],y&&(y.l=j[1]);break;case 2048:for(_=j[0].s.r;_<=j[0].e.r;++_)for(x=j[0].s.c;x<=j[0].e.c;++x)y=t.dense?(a[_]||[])[x]:a[qe({c:x,r:_})],y&&y.l&&(y.l.Tooltip=j[1]);break;case 28:{if(X.biff<=5&&X.biff>=2)break;y=t.dense?(a[j[0].r]||[])[j[0].c]:a[qe(j[0])];var Ea=Ee[j[2]];y||(t.dense?(a[j[0].r]||(a[j[0].r]=[]),y=a[j[0].r][j[0].c]={t:"z"}):y=a[qe(j[0])]={t:"z"},i.e.r=Math.max(i.e.r,j[0].r),i.s.r=Math.min(i.s.r,j[0].r),i.e.c=Math.max(i.e.c,j[0].c),i.s.c=Math.min(i.s.c,j[0].c)),y.c||(y.c=[]),w={a:j[1],t:Ea.TxO.t},y.c.push(w)}break;case 2173:mR(z[j.ixfe],j.ext);break;case 125:{if(!X.cellStyles)break;for(;j.e>=j.s;)Te[j.e--]={width:j.w/256,level:j.level||0,hidden:!!(j.flags&1)},ge||(ge=!0,Gg(j.w/256)),Es(Te[j.e+1])}break;case 520:{var sr={};j.level!=null&&(oe[j.r]=sr,sr.level=j.level),j.hidden&&(oe[j.r]=sr,sr.hidden=!0),j.hpt&&(oe[j.r]=sr,sr.hpt=j.hpt,sr.hpx=Ei(j.hpt))}break;case 38:case 39:case 40:case 41:a["!margins"]||io(a["!margins"]={}),a["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[ve]]=j;break;case 161:a["!margins"]||io(a["!margins"]={}),a["!margins"].header=j.header,a["!margins"].footer=j.footer;break;case 574:j.RTL&&(P.Views[0].RTL=!0);break;case 146:L=j;break;case 2198:he=j;break;case 140:O=j;break;case 442:f?J.CodeName=j||J.name:P.WBProps.CodeName=j||"ThisWorkbook";break}}else ye||console.error("Missing Info for XLS Record 0x"+ve.toString(16)),e.l+=me}return r.SheetNames=Xt(s).sort(function(dn,tt){return Number(dn)-Number(tt)}).map(function(dn){return s[dn].name}),t.bookSheets||(r.Sheets=n),!r.SheetNames.length&&h["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=h)):r.Preamble=h,r.Sheets&&U.forEach(function(dn,tt){r.Sheets[r.SheetNames[tt]]["!autofilter"]=dn}),r.Strings=u,r.SSF=Lt(Ge),X.enc&&(r.Encryption=X.enc),he&&(r.Themes=he),r.Metadata={},O!==void 0&&(r.Metadata.Country=O),K.names.length>0&&(P.Names=K.names),r.Workbook=P,r}var jl={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function I5(e,t,r){var n=Ve.find(e,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var a=xx(n,zh,jl.DSI);for(var s in a)t[s]=a[s]}catch(f){if(r.WTF)throw f}var i=Ve.find(e,"/!SummaryInformation");if(i&&i.size>0)try{var c=xx(i,Vh,jl.SI);for(var u in c)t[u]==null&&(t[u]=c[u])}catch(f){if(r.WTF)throw f}t.HeadingPairs&&t.TitlesOfParts&&(J_(t.HeadingPairs,t.TitlesOfParts,t,r),delete t.HeadingPairs,delete t.TitlesOfParts)}function O5(e,t){var r=[],n=[],a=[],s=0,i,c=Kv(zh,"n"),u=Kv(Vh,"n");if(e.Props)for(i=Xt(e.Props),s=0;s<i.length;++s)(Object.prototype.hasOwnProperty.call(c,i[s])?r:Object.prototype.hasOwnProperty.call(u,i[s])?n:a).push([i[s],e.Props[i[s]]]);if(e.Custprops)for(i=Xt(e.Custprops),s=0;s<i.length;++s)Object.prototype.hasOwnProperty.call(e.Props||{},i[s])||(Object.prototype.hasOwnProperty.call(c,i[s])?r:Object.prototype.hasOwnProperty.call(u,i[s])?n:a).push([i[s],e.Custprops[i[s]]]);var f=[];for(s=0;s<a.length;++s)nS.indexOf(a[s][0])>-1||X_.indexOf(a[s][0])>-1||a[s][1]!=null&&f.push(a[s]);n.length&&Ve.utils.cfb_add(t,"/SummaryInformation",yx(n,jl.SI,u,Vh)),(r.length||f.length)&&Ve.utils.cfb_add(t,"/DocumentSummaryInformation",yx(r,jl.DSI,c,zh,f.length?f:null,jl.UDI))}function QS(e,t){t||(t={}),tp(t),Sg(),t.codepage&&_g(t.codepage);var r,n;if(e.FullPaths){if(Ve.find(e,"/encryption"))throw new Error("File is password-protected");r=Ve.find(e,"!CompObj"),n=Ve.find(e,"/Workbook")||Ve.find(e,"/Book")}else{switch(t.type){case"base64":e=bn(Tn(e));break;case"binary":e=bn(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}Ar(e,0),n={content:e}}var a,s;if(r&&T5(r),t.bookProps&&!t.bookSheets)a={};else{var i=st?"buffer":"array";if(n&&n.content)a=P5(n.content,t);else if((s=Ve.find(e,"PerfectOffice_MAIN"))&&s.content)a=oo.to_workbook(s.content,(t.type=i,t));else if((s=Ve.find(e,"NativeContent_MAIN"))&&s.content)a=oo.to_workbook(s.content,(t.type=i,t));else throw(s=Ve.find(e,"MN0"))&&s.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");t.bookVBA&&e.FullPaths&&Ve.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(a.vbaraw=WR(e))}var c={};return e.FullPaths&&I5(e,c,t),a.Props=a.Custprops=c,t.bookFiles&&(a.cfb=e),a}function D5(e,t){var r=t||{},n=Ve.utils.cfb_new({root:"R"}),a="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":a="/Workbook",r.biff=8;break;case"biff5":a="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return Ve.utils.cfb_add(n,a,ZS(e,r)),r.biff==8&&(e.Props||e.Custprops)&&O5(e,n),r.biff==8&&e.vbaraw&&HR(n,Ve.read(e.vbaraw,{type:typeof e.vbaraw=="string"?"binary":"buffer"})),n}var oc={0:{f:rN},1:{f:uN},2:{f:PN},3:{f:xN},4:{f:gN},5:{f:TN},6:{f:RN},7:{f:SN},8:{f:UN},9:{f:$N},10:{f:BN},11:{f:jN},12:{f:dN},13:{f:ON},14:{f:wN},15:{f:mN},16:{f:WS},17:{f:NN},18:{f:bN},19:{f:Ng},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:N6},40:{},42:{},43:{f:RF},44:{f:DF},45:{f:MF},46:{f:jF},47:{f:BF},48:{},49:{f:s3},50:{},51:{f:yR},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:gS},62:{f:FN},63:{f:AR},64:{f:n6},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Gr,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:ZN},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:lN},148:{f:sN,p:16},151:{f:qN},152:{},153:{f:F6},154:{},155:{},156:{f:O6},157:{},158:{},159:{T:1,f:XD},160:{T:-1},161:{T:1,f:Eo},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:zN},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:vR},336:{T:-1},337:{f:SR,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:Uh},357:{},358:{},359:{},360:{T:1},361:{},362:{f:hS},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:KN},427:{f:XN},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:YN},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:iN},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:HN},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:Uh},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:jR},633:{T:1},634:{T:-1},635:{T:1,f:MR},636:{T:-1},637:{f:c3},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:w6},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:a6},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},Xh={6:{f:nh},10:{f:ms},12:{f:cr},13:{f:cr},14:{f:Zt},15:{f:Zt},16:{f:Wr},17:{f:Zt},18:{f:Zt},19:{f:cr},20:{f:kx},21:{f:kx},23:{f:hS},24:{f:Cx},25:{f:Zt},26:{},27:{},28:{f:aD},29:{},34:{f:Zt},35:{f:Tx},38:{f:Wr},39:{f:Wr},40:{f:Wr},41:{f:Wr},42:{f:Zt},43:{f:Zt},47:{f:mF},49:{f:OO},51:{f:cr},60:{},61:{f:TO},64:{f:Zt},65:{f:IO},66:{f:cr},77:{},80:{},81:{},82:{},85:{f:cr},89:{},90:{},91:{},92:{f:pO},93:{f:iD},94:{},95:{f:Zt},96:{},97:{},99:{f:Zt},125:{f:gS},128:{f:GO},129:{f:vO},130:{f:cr},131:{f:Zt},132:{f:Zt},133:{f:xO},134:{},140:{f:pD},141:{f:cr},144:{},146:{f:xD},151:{},152:{},153:{},154:{},155:{},156:{f:cr},157:{},158:{},160:{f:kD},161:{f:_D},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:zO},190:{f:VO},193:{f:ms},197:{},198:{},199:{},200:{},201:{},202:{f:Zt},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:cr},220:{},221:{f:Zt},222:{},224:{f:HO},225:{f:gO},226:{f:ms},227:{},229:{f:sD},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:wO},253:{f:FO},255:{f:SO},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:aS},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:Zt},353:{f:ms},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:YO},431:{f:Zt},432:{},433:{},434:{},437:{},438:{f:uD},439:{f:Zt},440:{f:fD},441:{},442:{f:yc},443:{},444:{f:cr},445:{},446:{},448:{f:ms},449:{f:kO,r:2},450:{f:ms},512:{f:Sx},513:{f:bD},515:{f:XO},516:{f:LO},517:{f:bx},519:{f:TD},520:{f:EO},523:{},545:{f:Ax},549:{f:_x},566:{},574:{f:AO},638:{f:UO},659:{},1048:{},1054:{f:MO},1084:{},1212:{f:tD},2048:{f:hD},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:Zu},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:ms},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:yD,r:12},2173:{f:pR,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:Zt,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:eD,r:12},2197:{},2198:{f:cR,r:12},2199:{},2200:{},2201:{},2202:{f:rD,r:12},2203:{f:ms},2204:{},2205:{},2206:{},2207:{},2211:{f:bO},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:cr},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:SD},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:vD},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:Sx},1:{},2:{f:OD},3:{f:PD},4:{f:AD},5:{f:bx},7:{f:FD},8:{},9:{f:Zu},11:{},22:{f:cr},30:{f:jO},31:{},32:{},33:{f:Ax},36:{},37:{f:_x},50:{f:RD},62:{},52:{},67:{},68:{f:cr},69:{},86:{},126:{},127:{f:CD},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:LD},223:{},234:{},354:{},421:{},518:{f:nh},521:{f:Zu},536:{f:Cx},547:{f:Tx},561:{},579:{},1030:{f:nh},1033:{f:Zu},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function De(e,t,r,n){var a=t;if(!isNaN(a)){var s=n||(r||[]).length||0,i=e.next(4);i.write_shift(2,a),i.write_shift(2,s),s>0&&Fg(r)&&e.push(r)}}function F5(e,t,r,n){var a=(r||[]).length||0;if(a<=8224)return De(e,t,r,a);var s=t;if(!isNaN(s)){for(var i=r.parts||[],c=0,u=0,f=0;f+(i[c]||8224)<=8224;)f+=i[c]||8224,c++;var h=e.next(4);for(h.write_shift(2,s),h.write_shift(2,f),e.push(r.slice(u,u+f)),u+=f;u<a;){for(h=e.next(4),h.write_shift(2,60),f=0;f+(i[c]||8224)<=8224;)f+=i[c]||8224,c++;h.write_shift(2,f),e.push(r.slice(u,u+f)),u+=f}}}function Ec(e,t,r){return e||(e=de(7)),e.write_shift(2,t),e.write_shift(2,r),e.write_shift(2,0),e.write_shift(1,0),e}function R5(e,t,r,n){var a=de(9);return Ec(a,e,t),sS(r,n||"b",a),a}function L5(e,t,r){var n=de(8+2*r.length);return Ec(n,e,t),n.write_shift(1,r.length),n.write_shift(r.length,r,"sbcs"),n.l<n.length?n.slice(0,n.l):n}function N5(e,t,r,n){if(t.v!=null)switch(t.t){case"d":case"n":var a=t.t=="d"?pr(Rt(t.v)):t.v;a==(a|0)&&a>=0&&a<65536?De(e,2,DD(r,n,a)):De(e,3,ID(r,n,a));return;case"b":case"e":De(e,5,R5(r,n,t.v,t.t));return;case"s":case"str":De(e,4,L5(r,n,(t.v||"").slice(0,255)));return}De(e,1,Ec(null,r,n))}function M5(e,t,r,n){var a=Array.isArray(t),s=mt(t["!ref"]||"A1"),i,c="",u=[];if(s.e.c>255||s.e.r>16383){if(n.WTF)throw new Error("Range "+(t["!ref"]||"A1")+" exceeds format limit A1:IV16384");s.e.c=Math.min(s.e.c,255),s.e.r=Math.min(s.e.c,16383),i=rt(s)}for(var f=s.s.r;f<=s.e.r;++f){c=rr(f);for(var h=s.s.c;h<=s.e.c;++h){f===s.s.r&&(u[h]=zt(h)),i=u[h]+c;var p=a?(t[f]||[])[h]:t[i];p&&N5(e,p,f,h)}}}function B5(e,t){for(var r=t||{},n=un(),a=0,s=0;s<e.SheetNames.length;++s)e.SheetNames[s]==r.sheet&&(a=s);if(a==0&&r.sheet&&e.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return De(n,r.biff==4?1033:r.biff==3?521:9,Vg(e,16,r)),M5(n,e.Sheets[e.SheetNames[a]],a,r),De(n,10),n.end()}function j5(e,t,r){De(e,49,DO({sz:12,name:"Arial"},r))}function $5(e,t,r){t&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)t[a]!=null&&De(e,1054,BO(a,t[a],r))})}function U5(e,t){var r=de(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),De(e,2151,r),r=de(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),uS(mt(t["!ref"]||"A1"),r),r.write_shift(4,4),De(e,2152,r)}function z5(e,t){for(var r=0;r<16;++r)De(e,224,Ex({numFmtId:0,style:!0},0,t));t.cellXfs.forEach(function(n){De(e,224,Ex(n,0,t))})}function V5(e,t){for(var r=0;r<t["!links"].length;++r){var n=t["!links"][r];De(e,440,dD(n)),n[1].Tooltip&&De(e,2048,gD(n))}delete t["!links"]}function W5(e,t){if(t){var r=0;t.forEach(function(n,a){++r<=256&&n&&De(e,125,wD(Hf(a,n),a))})}}function H5(e,t,r,n,a){var s=16+Is(a.cellXfs,t,a);if(t.v==null&&!t.bf){De(e,513,go(r,n,s));return}if(t.bf)De(e,6,vL(t,r,n,a,s));else switch(t.t){case"d":case"n":var i=t.t=="d"?pr(Rt(t.v)):t.v;De(e,515,JO(r,n,i,s));break;case"b":case"e":De(e,517,KO(r,n,t.v,s,a,t.t));break;case"s":case"str":if(a.bookSST){var c=Yg(a.Strings,t.v,a.revStrings);De(e,253,RO(r,n,c,s))}else De(e,516,NO(r,n,(t.v||"").slice(0,255),s,a));break;default:De(e,513,go(r,n,s))}}function G5(e,t,r){var n=un(),a=r.SheetNames[e],s=r.Sheets[a]||{},i=(r||{}).Workbook||{},c=(i.Sheets||[])[e]||{},u=Array.isArray(s),f=t.biff==8,h,p="",m=[],y=mt(s["!ref"]||"A1"),w=f?65536:16384;if(y.e.c>255||y.e.r>=w){if(t.WTF)throw new Error("Range "+(s["!ref"]||"A1")+" exceeds format limit A1:IV16384");y.e.c=Math.min(y.e.c,255),y.e.r=Math.min(y.e.c,w-1)}De(n,2057,Vg(r,16,t)),De(n,13,jn(1)),De(n,12,jn(100)),De(n,15,Zr(!0)),De(n,17,Zr(!1)),De(n,16,fo(.001)),De(n,95,Zr(!0)),De(n,42,Zr(!1)),De(n,43,Zr(!1)),De(n,130,jn(1)),De(n,128,qO()),De(n,131,Zr(!1)),De(n,132,Zr(!1)),f&&W5(n,s["!cols"]),De(n,512,$O(y,t)),f&&(s["!links"]=[]);for(var x=y.s.r;x<=y.e.r;++x){p=rr(x);for(var _=y.s.c;_<=y.e.c;++_){x===y.s.r&&(m[_]=zt(_)),h=m[_]+p;var E=u?(s[x]||[])[_]:s[h];E&&(H5(n,E,x,_,t),f&&E.l&&s["!links"].push([h,E.l]))}}var k=c.CodeName||c.name||a;return f&&De(n,574,PO((i.Views||[])[0])),f&&(s["!merges"]||[]).length&&De(n,229,oD(s["!merges"])),f&&V5(n,s),De(n,442,oS(k)),f&&U5(n,s),De(n,10),n.end()}function q5(e,t,r){var n=un(),a=(e||{}).Workbook||{},s=a.Sheets||[],i=a.WBProps||{},c=r.biff==8,u=r.biff==5;if(De(n,2057,Vg(e,5,r)),r.bookType=="xla"&&De(n,135),De(n,225,c?jn(1200):null),De(n,193,K3(2)),u&&De(n,191),u&&De(n,192),De(n,226),De(n,92,mO("SheetJS",r)),De(n,66,jn(c?1200:1252)),c&&De(n,353,jn(0)),c&&De(n,448),De(n,317,ED(e.SheetNames.length)),c&&e.vbaraw&&De(n,211),c&&e.vbaraw){var f=i.CodeName||"ThisWorkbook";De(n,442,oS(f))}De(n,156,jn(17)),De(n,25,Zr(!1)),De(n,18,Zr(!1)),De(n,19,jn(0)),c&&De(n,431,Zr(!1)),c&&De(n,444,jn(0)),De(n,61,CO()),De(n,64,Zr(!1)),De(n,141,jn(0)),De(n,34,Zr(k6(e)=="true")),De(n,14,Zr(!0)),c&&De(n,439,Zr(!1)),De(n,218,jn(0)),j5(n,e,r),$5(n,e.SSF,r),z5(n,r),c&&De(n,352,Zr(!1));var h=n.end(),p=un();c&&De(p,140,mD()),c&&r.Strings&&F5(p,252,_O(r.Strings)),De(p,10);var m=p.end(),y=un(),w=0,x=0;for(x=0;x<e.SheetNames.length;++x)w+=(c?12:11)+(c?2:1)*e.SheetNames[x].length;var _=h.length+w+m.length;for(x=0;x<e.SheetNames.length;++x){var E=s[x]||{};De(y,133,yO({pos:_,hs:E.Hidden||0,dt:0,name:e.SheetNames[x]},r)),_+=t[x].length}var k=y.end();if(w!=k.length)throw new Error("BS8 "+w+" != "+k.length);var b=[];return h.length&&b.push(h),k.length&&b.push(k),m.length&&b.push(m),Er(b)}function K5(e,t){var r=t||{},n=[];e&&!e.SSF&&(e.SSF=Lt(Ge)),e&&e.SSF&&(Di(),Bf(e.SSF),r.revssf=$f(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,rp(r),r.cellXfs=[],Is(r.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var a=0;a<e.SheetNames.length;++a)n[n.length]=G5(a,r,e);return n.unshift(q5(e,n,r)),Er(n)}function ZS(e,t){for(var r=0;r<=e.SheetNames.length;++r){var n=e.Sheets[e.SheetNames[r]];if(!(!n||!n["!ref"])){var a=fn(n["!ref"]);a.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+e.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var s=t||{};switch(s.biff||2){case 8:case 5:return K5(e,t);case 4:case 3:case 2:return B5(e,t)}throw new Error("invalid type "+s.bookType+" for BIFF")}function Bx(e,t){var r=t||{},n=r.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var a=e.match(/<table/i);if(!a)throw new Error("Invalid HTML: could not find <table>");var s=e.match(/<\/table/i),i=a.index,c=s&&s.index||e.length,u=DI(e.slice(i,c),/(:?<tr[^>]*>)/i,"<tr>"),f=-1,h=0,p=0,m=0,y={s:{r:1e7,c:1e7},e:{r:0,c:0}},w=[];for(i=0;i<u.length;++i){var x=u[i].trim(),_=x.slice(0,3).toLowerCase();if(_=="<tr"){if(++f,r.sheetRows&&r.sheetRows<=f){--f;break}h=0;continue}if(!(_!="<td"&&_!="<th")){var E=x.split(/<\/t[dh]>/i);for(c=0;c<E.length;++c){var k=E[c].trim();if(k.match(/<t[dh]/i)){for(var b=k,O=0;b.charAt(0)=="<"&&(O=b.indexOf(">"))>-1;)b=b.slice(O+1);for(var z=0;z<w.length;++z){var L=w[z];L.s.c==h&&L.s.r<f&&f<=L.e.r&&(h=L.e.c+1,z=-1)}var P=Je(k.slice(0,k.indexOf(">")));m=P.colspan?+P.colspan:1,((p=+P.rowspan)>1||m>1)&&w.push({s:{r:f,c:h},e:{r:f+(p||1)-1,c:h+m-1}});var J=P.t||P["data-t"]||"";if(!b.length){h+=m;continue}if(b=E_(b),y.s.r>f&&(y.s.r=f),y.e.r<f&&(y.e.r=f),y.s.c>h&&(y.s.c=h),y.e.c<h&&(y.e.c=h),!b.length){h+=m;continue}var V={t:"s",v:b};r.raw||!b.trim().length||J=="s"||(b==="TRUE"?V={t:"b",v:!0}:b==="FALSE"?V={t:"b",v:!1}:isNaN(oa(b))?isNaN(_i(b).getDate())||(V={t:"d",v:Rt(b)},r.cellDates||(V={t:"n",v:pr(V.v)}),V.z=r.dateNF||Ge[14]):V={t:"n",v:oa(b)}),r.dense?(n[f]||(n[f]=[]),n[f][h]=V):n[qe({r:f,c:h})]=V,h+=m}}}}return n["!ref"]=rt(y),w.length&&(n["!merges"]=w),n}function X5(e,t,r,n){for(var a=e["!merges"]||[],s=[],i=t.s.c;i<=t.e.c;++i){for(var c=0,u=0,f=0;f<a.length;++f)if(!(a[f].s.r>r||a[f].s.c>i)&&!(a[f].e.r<r||a[f].e.c<i)){if(a[f].s.r<r||a[f].s.c<i){c=-1;break}c=a[f].e.r-a[f].s.r+1,u=a[f].e.c-a[f].s.c+1;break}if(!(c<0)){var h=qe({r,c:i}),p=n.dense?(e[r]||[])[i]:e[h],m=p&&p.v!=null&&(p.h||Ig(p.w||($a(p),p.w)||""))||"",y={};c>1&&(y.rowspan=c),u>1&&(y.colspan=u),n.editable?m='<span contenteditable="true">'+m+"</span>":p&&(y["data-t"]=p&&p.t||"z",p.v!=null&&(y["data-v"]=p.v),p.z!=null&&(y["data-z"]=p.z),p.l&&(p.l.Target||"#").charAt(0)!="#"&&(m='<a href="'+p.l.Target+'">'+m+"</a>")),y.id=(n.id||"sjs")+"-"+h,s.push(Oe("td",m,y))}}var w="<tr>";return w+s.join("")+"</tr>"}var J5='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',Y5="</body></html>";function Q5(e,t){var r=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return Ps(Bx(r[0],t),t);var n=sp();return r.forEach(function(a,s){op(n,Bx(a,t),"Sheet"+(s+1))}),n}function Z5(e,t,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function e2(e,t){var r=t||{},n=r.header!=null?r.header:J5,a=r.footer!=null?r.footer:Y5,s=[n],i=fn(e["!ref"]);r.dense=Array.isArray(e),s.push(Z5(e,i,r));for(var c=i.s.r;c<=i.e.r;++c)s.push(X5(e,i,c,r));return s.push("</table>"+a),s.join("")}function t2(e,t,r){var n=r||{},a=0,s=0;if(n.origin!=null)if(typeof n.origin=="number")a=n.origin;else{var i=typeof n.origin=="string"?Vt(n.origin):n.origin;a=i.r,s=i.c}var c=t.getElementsByTagName("tr"),u=Math.min(n.sheetRows||1e7,c.length),f={s:{r:0,c:0},e:{r:a,c:s}};if(e["!ref"]){var h=fn(e["!ref"]);f.s.r=Math.min(f.s.r,h.s.r),f.s.c=Math.min(f.s.c,h.s.c),f.e.r=Math.max(f.e.r,h.e.r),f.e.c=Math.max(f.e.c,h.e.c),a==-1&&(f.e.r=a=h.e.r+1)}var p=[],m=0,y=e["!rows"]||(e["!rows"]=[]),w=0,x=0,_=0,E=0,k=0,b=0;for(e["!cols"]||(e["!cols"]=[]);w<c.length&&x<u;++w){var O=c[w];if(jx(O)){if(n.display)continue;y[x]={hidden:!0}}var z=O.children;for(_=E=0;_<z.length;++_){var L=z[_];if(!(n.display&&jx(L))){var P=L.hasAttribute("data-v")?L.getAttribute("data-v"):L.hasAttribute("v")?L.getAttribute("v"):E_(L.innerHTML),J=L.getAttribute("data-z")||L.getAttribute("z");for(m=0;m<p.length;++m){var V=p[m];V.s.c==E+s&&V.s.r<x+a&&x+a<=V.e.r&&(E=V.e.c+1-s,m=-1)}b=+L.getAttribute("colspan")||1,((k=+L.getAttribute("rowspan")||1)>1||b>1)&&p.push({s:{r:x+a,c:E+s},e:{r:x+a+(k||1)-1,c:E+s+(b||1)-1}});var le={t:"s",v:P},ee=L.getAttribute("data-t")||L.getAttribute("t")||"";P!=null&&(P.length==0?le.t=ee||"z":n.raw||P.trim().length==0||ee=="s"||(P==="TRUE"?le={t:"b",v:!0}:P==="FALSE"?le={t:"b",v:!1}:isNaN(oa(P))?isNaN(_i(P).getDate())||(le={t:"d",v:Rt(P)},n.cellDates||(le={t:"n",v:pr(le.v)}),le.z=n.dateNF||Ge[14]):le={t:"n",v:oa(P)})),le.z===void 0&&J!=null&&(le.z=J);var X="",he=L.getElementsByTagName("A");if(he&&he.length)for(var Ie=0;Ie<he.length&&!(he[Ie].hasAttribute("href")&&(X=he[Ie].getAttribute("href"),X.charAt(0)!="#"));++Ie);X&&X.charAt(0)!="#"&&(le.l={Target:X}),n.dense?(e[x+a]||(e[x+a]=[]),e[x+a][E+s]=le):e[qe({c:E+s,r:x+a})]=le,f.e.c<E+s&&(f.e.c=E+s),E+=b}}++x}return p.length&&(e["!merges"]=(e["!merges"]||[]).concat(p)),f.e.r=Math.max(f.e.r,x-1+a),e["!ref"]=rt(f),x>=u&&(e["!fullref"]=rt((f.e.r=c.length-w+x-1+a,f))),e}function r2(e,t){var r=t||{},n=r.dense?[]:{};return t2(n,e,t)}function eM(e,t){return Ps(r2(e,t),t)}function jx(e){var t="",r=tM(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function tM(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function rM(e){var t=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,a){return Array(parseInt(a,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=pt(t.replace(/<[^>]*>/g,""));return[r]}var $x={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function n2(e,t){var r=t||{},n=Og(e),a=[],s,i,c={name:""},u="",f=0,h,p,m={},y=[],w=r.dense?[]:{},x,_,E={value:""},k="",b=0,O=[],z=-1,L=-1,P={s:{r:1e6,c:1e7},e:{r:0,c:0}},J=0,V={},le=[],ee={},X=0,he=0,Ie=[],Ee=1,Te=1,oe=[],ge={Names:[]},K={},fe=["",""],H=[],A={},G="",U=0,W=!1,ne=!1,xe=0;for(ec.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");x=ec.exec(n);)switch(x[3]=x[3].replace(/_.*$/,"")){case"table":case"":x[1]==="/"?(P.e.c>=P.s.c&&P.e.r>=P.s.r?w["!ref"]=rt(P):w["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=P.e.r&&(w["!fullref"]=w["!ref"],P.e.r=r.sheetRows-1,w["!ref"]=rt(P)),le.length&&(w["!merges"]=le),Ie.length&&(w["!rows"]=Ie),h.name=h.||h.name,typeof JSON<"u"&&JSON.stringify(h),y.push(h.name),m[h.name]=w,ne=!1):x[0].charAt(x[0].length-2)!=="/"&&(h=Je(x[0],!1),z=L=-1,P.s.r=P.s.c=1e7,P.e.r=P.e.c=0,w=r.dense?[]:{},le=[],Ie=[],ne=!0);break;case"table-row-group":x[1]==="/"?--J:++J;break;case"table-row":case"":if(x[1]==="/"){z+=Ee,Ee=1;break}if(p=Je(x[0],!1),p.?z=p.-1:z==-1&&(z=0),Ee=+p["number-rows-repeated"]||1,Ee<10)for(xe=0;xe<Ee;++xe)J>0&&(Ie[z+xe]={level:J});L=-1;break;case"covered-table-cell":x[1]!=="/"&&++L,r.sheetStubs&&(r.dense?(w[z]||(w[z]=[]),w[z][L]={t:"z"}):w[qe({r:z,c:L})]={t:"z"}),k="",O=[];break;case"table-cell":case"":if(x[0].charAt(x[0].length-2)==="/")++L,E=Je(x[0],!1),Te=parseInt(E["number-columns-repeated"]||"1",10),_={t:"z",v:null},E.formula&&r.cellFormula!=!1&&(_.f=Lx(pt(E.formula))),(E.||E["value-type"])=="string"&&(_.t="s",_.v=pt(E["string-value"]||""),r.dense?(w[z]||(w[z]=[]),w[z][L]=_):w[qe({r:z,c:L})]=_),L+=Te-1;else if(x[1]!=="/"){++L,k="",b=0,O=[],Te=1;var ve=Ee?z+Ee-1:z;if(L>P.e.c&&(P.e.c=L),L<P.s.c&&(P.s.c=L),z<P.s.r&&(P.s.r=z),ve>P.e.r&&(P.e.r=ve),E=Je(x[0],!1),H=[],A={},_={t:E.||E["value-type"],v:null},r.cellFormula)if(E.formula&&(E.formula=pt(E.formula)),E["number-matrix-columns-spanned"]&&E["number-matrix-rows-spanned"]&&(X=parseInt(E["number-matrix-rows-spanned"],10)||0,he=parseInt(E["number-matrix-columns-spanned"],10)||0,ee={s:{r:z,c:L},e:{r:z+X-1,c:L+he-1}},_.F=rt(ee),oe.push([ee,_.F])),E.formula)_.f=Lx(E.formula);else for(xe=0;xe<oe.length;++xe)z>=oe[xe][0].s.r&&z<=oe[xe][0].e.r&&L>=oe[xe][0].s.c&&L<=oe[xe][0].e.c&&(_.F=oe[xe][1]);switch((E["number-columns-spanned"]||E["number-rows-spanned"])&&(X=parseInt(E["number-rows-spanned"],10)||0,he=parseInt(E["number-columns-spanned"],10)||0,ee={s:{r:z,c:L},e:{r:z+X-1,c:L+he-1}},le.push(ee)),E["number-columns-repeated"]&&(Te=parseInt(E["number-columns-repeated"],10)),_.t){case"boolean":_.t="b",_.v=Ft(E["boolean-value"]);break;case"float":_.t="n",_.v=parseFloat(E.value);break;case"percentage":_.t="n",_.v=parseFloat(E.value);break;case"currency":_.t="n",_.v=parseFloat(E.value);break;case"date":_.t="d",_.v=Rt(E["date-value"]),r.cellDates||(_.t="n",_.v=pr(_.v)),_.z="m/d/yy";break;case"time":_.t="n",_.v=PI(E["time-value"])/86400,r.cellDates&&(_.t="d",_.v=Uf(_.v)),_.z="HH:MM:SS";break;case"number":_.t="n",_.v=parseFloat(E.);break;default:if(_.t==="string"||_.t==="text"||!_.t)_.t="s",E["string-value"]!=null&&(k=pt(E["string-value"]),O=[]);else throw new Error("Unsupported value type "+_.t)}}else{if(W=!1,_.t==="s"&&(_.v=k||"",O.length&&(_.R=O),W=b==0),K.Target&&(_.l=K),H.length>0&&(_.c=H,H=[]),k&&r.cellText!==!1&&(_.w=k),W&&(_.t="z",delete _.v),(!W||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=z))for(var me=0;me<Ee;++me){if(Te=parseInt(E["number-columns-repeated"]||"1",10),r.dense)for(w[z+me]||(w[z+me]=[]),w[z+me][L]=me==0?_:Lt(_);--Te>0;)w[z+me][L+Te]=Lt(_);else for(w[qe({r:z+me,c:L})]=_;--Te>0;)w[qe({r:z+me,c:L+Te})]=Lt(_);P.e.c<=L&&(P.e.c=L)}Te=parseInt(E["number-columns-repeated"]||"1",10),L+=Te-1,Te=0,_={},k="",O=[]}K={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(x[1]==="/"){if((s=a.pop())[0]!==x[3])throw"Bad state: "+s}else x[0].charAt(x[0].length-2)!=="/"&&a.push([x[3],!0]);break;case"annotation":if(x[1]==="/"){if((s=a.pop())[0]!==x[3])throw"Bad state: "+s;A.t=k,O.length&&(A.R=O),A.a=G,H.push(A)}else x[0].charAt(x[0].length-2)!=="/"&&a.push([x[3],!1]);G="",U=0,k="",b=0,O=[];break;case"creator":x[1]==="/"?G=n.slice(U,x.index):U=x.index+x[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(x[1]==="/"){if((s=a.pop())[0]!==x[3])throw"Bad state: "+s}else x[0].charAt(x[0].length-2)!=="/"&&a.push([x[3],!1]);k="",b=0,O=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(x[1]==="/"){if(V[c.name]=u,(s=a.pop())[0]!==x[3])throw"Bad state: "+s}else x[0].charAt(x[0].length-2)!=="/"&&(u="",c=Je(x[0],!1),a.push([x[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(a[a.length-1][0]){case"time-style":case"date-style":i=Je(x[0],!1),u+=$x[x[3]][i.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(a[a.length-1][0]){case"time-style":case"date-style":i=Je(x[0],!1),u+=$x[x[3]][i.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(x[0].slice(-2)==="/>")break;if(x[1]==="/")switch(a[a.length-1][0]){case"number-style":case"date-style":case"time-style":u+=n.slice(f,x.index);break}else f=x.index+x[0].length;break;case"named-range":i=Je(x[0],!1),fe=ah(i["cell-range-address"]);var ye={Name:i.name,Ref:fe[0]+"!"+fe[1]};ne&&(ye.Sheet=y.length),ge.Names.push(ye);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(a[a.length-1][0])>-1)break;if(x[1]==="/"&&(!E||!E["string-value"])){var Ze=rM(n.slice(b,x.index));k=(k.length>0?k+`
`:"")+Ze[0]}else Je(x[0],!1),b=x.index+x[0].length;break;case"s":break;case"database-range":if(x[1]==="/")break;try{fe=ah(Je(x[0])["target-range-address"]),m[fe[0]]["!autofilter"]={ref:fe[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(x[1]!=="/"){if(K=Je(x[0],!1),!K.href)break;K.Target=pt(K.href),delete K.href,K.Target.charAt(0)=="#"&&K.Target.indexOf(".")>-1?(fe=ah(K.Target.slice(1)),K.Target="#"+fe[0]+"!"+fe[1]):K.Target.match(/^\.\.[\\\/]/)&&(K.Target=K.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(x[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(r.WTF)throw new Error(x)}}var j={Sheets:m,SheetNames:y,Workbook:ge};return r.bookSheets&&delete j.Sheets,j}function Ux(e,t){t=t||{},Bn(e,"META-INF/manifest.xml")&&P3(lr(e,"META-INF/manifest.xml"),t);var r=kn(e,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var n=n2(kt(r),t);return Bn(e,"meta.xml")&&(n.Props=q_(lr(e,"meta.xml"))),n}function zx(e,t){return n2(e,t)}var nM=(function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),t="<office:document-styles "+Zl({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return ar+t}})(),Vx=(function(){var e=function(s){return bt(s).replace(/  +/g,function(i){return'<text:s text:c="'+i.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},t=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,n=function(s,i,c){var u=[];u.push('      <table:table table:name="'+bt(i.SheetNames[c])+`" table:style-name="ta1">
`);var f=0,h=0,p=fn(s["!ref"]||"A1"),m=s["!merges"]||[],y=0,w=Array.isArray(s);if(s["!cols"])for(h=0;h<=p.e.c;++h)u.push("        <table:table-column"+(s["!cols"][h]?' table:style-name="co'+s["!cols"][h].ods+'"':"")+`></table:table-column>
`);var x="",_=s["!rows"]||[];for(f=0;f<p.s.r;++f)x=_[f]?' table:style-name="ro'+_[f].ods+'"':"",u.push("        <table:table-row"+x+`></table:table-row>
`);for(;f<=p.e.r;++f){for(x=_[f]?' table:style-name="ro'+_[f].ods+'"':"",u.push("        <table:table-row"+x+`>
`),h=0;h<p.s.c;++h)u.push(t);for(;h<=p.e.c;++h){var E=!1,k={},b="";for(y=0;y!=m.length;++y)if(!(m[y].s.c>h)&&!(m[y].s.r>f)&&!(m[y].e.c<h)&&!(m[y].e.r<f)){(m[y].s.c!=h||m[y].s.r!=f)&&(E=!0),k["table:number-columns-spanned"]=m[y].e.c-m[y].s.c+1,k["table:number-rows-spanned"]=m[y].e.r-m[y].s.r+1;break}if(E){u.push(r);continue}var O=qe({r:f,c:h}),z=w?(s[f]||[])[h]:s[O];if(z&&z.f&&(k["table:formula"]=bt(EL(z.f)),z.F&&z.F.slice(0,O.length)==O)){var L=fn(z.F);k["table:number-matrix-columns-spanned"]=L.e.c-L.s.c+1,k["table:number-matrix-rows-spanned"]=L.e.r-L.s.r+1}if(!z){u.push(t);continue}switch(z.t){case"b":b=z.v?"TRUE":"FALSE",k["office:value-type"]="boolean",k["office:boolean-value"]=z.v?"true":"false";break;case"n":b=z.w||String(z.v||0),k["office:value-type"]="float",k["office:value"]=z.v||0;break;case"s":case"str":b=z.v==null?"":z.v,k["office:value-type"]="string";break;case"d":b=z.w||Rt(z.v).toISOString(),k["office:value-type"]="date",k["office:date-value"]=Rt(z.v).toISOString(),k["table:style-name"]="ce1";break;default:u.push(t);continue}var P=e(b);if(z.l&&z.l.Target){var J=z.l.Target;J=J.charAt(0)=="#"?"#"+bL(J.slice(1)):J,J.charAt(0)!="#"&&!J.match(/^\w+:/)&&(J="../"+J),P=Oe("text:a",P,{"xlink:href":J.replace(/&/g,"&amp;")})}u.push("          "+Oe("table:table-cell",Oe("text:p",P,{}),k)+`
`)}u.push(`        </table:table-row>
`)}return u.push(`      </table:table>
`),u.join("")},a=function(s,i){s.push(` <office:automatic-styles>
`),s.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),s.push(`   <number:month number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:day number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:year/>
`),s.push(`  </number:date-style>
`);var c=0;i.SheetNames.map(function(f){return i.Sheets[f]}).forEach(function(f){if(f&&f["!cols"]){for(var h=0;h<f["!cols"].length;++h)if(f["!cols"][h]){var p=f["!cols"][h];if(p.width==null&&p.wpx==null&&p.wch==null)continue;Es(p),p.ods=c;var m=f["!cols"][h].wpx+"px";s.push('  <style:style style:name="co'+c+`" style:family="table-column">
`),s.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+m+`"/>
`),s.push(`  </style:style>
`),++c}}});var u=0;i.SheetNames.map(function(f){return i.Sheets[f]}).forEach(function(f){if(f&&f["!rows"]){for(var h=0;h<f["!rows"].length;++h)if(f["!rows"][h]){f["!rows"][h].ods=u;var p=f["!rows"][h].hpx+"px";s.push('  <style:style style:name="ro'+u+`" style:family="table-row">
`),s.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+p+`"/>
`),s.push(`  </style:style>
`),++u}}}),s.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),s.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),s.push(`  </style:style>
`),s.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),s.push(` </office:automatic-styles>
`)};return function(i,c){var u=[ar],f=Zl({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),h=Zl({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});c.bookType=="fods"?(u.push("<office:document"+f+h+`>
`),u.push(G_().replace(/office:document-meta/g,"office:meta"))):u.push("<office:document-content"+f+`>
`),a(u,i),u.push(`  <office:body>
`),u.push(`    <office:spreadsheet>
`);for(var p=0;p!=i.SheetNames.length;++p)u.push(n(i.Sheets[i.SheetNames[p]],i,p));return u.push(`    </office:spreadsheet>
`),u.push(`  </office:body>
`),c.bookType=="fods"?u.push("</office:document>"):u.push("</office:document-content>"),u.join("")}})();function a2(e,t){if(t.bookType=="fods")return Vx(e,t);var r=Cg(),n="",a=[],s=[];return n="mimetype",nt(r,n,"application/vnd.oasis.opendocument.spreadsheet"),n="content.xml",nt(r,n,Vx(e,t)),a.push([n,"text/xml"]),s.push([n,"ContentFile"]),n="styles.xml",nt(r,n,nM(e,t)),a.push([n,"text/xml"]),s.push([n,"StylesFile"]),n="meta.xml",nt(r,n,ar+G_()),a.push([n,"text/xml"]),s.push([n,"MetadataFile"]),n="manifest.rdf",nt(r,n,D3(s)),a.push([n,"application/rdf+xml"]),n="META-INF/manifest.xml",nt(r,n,I3(a)),r}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function po(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function Jh(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):kt(As(e))}function aM(e){return typeof TextEncoder<"u"?new TextEncoder().encode(e):bn(xa(e))}function sM(e,t){e:for(var r=0;r<=e.length-t.length;++r){for(var n=0;n<t.length;++n)if(e[r+n]!=t[n])continue e;return!0}return!1}function ks(e){var t=e.reduce(function(a,s){return a+s.length},0),r=new Uint8Array(t),n=0;return e.forEach(function(a){r.set(a,n),n+=a.length}),r}function Wx(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function oM(e,t){for(var r=(e[t+15]&127)<<7|e[t+14]>>1,n=e[t+14]&1,a=t+13;a>=t;--a)n=n*256+e[a];return(e[t+15]&128?-n:n)*Math.pow(10,r-6176)}function iM(e,t,r){var n=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,a=r/Math.pow(10,n-6176);e[t+15]|=n>>7,e[t+14]|=(n&127)<<1;for(var s=0;a>=1;++s,a/=256)e[t+s]=a&255;e[t+15]|=r>=0?0:128}function ic(e,t){var r=t?t[0]:0,n=e[r]&127;e:if(e[r++]>=128&&(n|=(e[r]&127)<<7,e[r++]<128||(n|=(e[r]&127)<<14,e[r++]<128)||(n|=(e[r]&127)<<21,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,28),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,35),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,42),++r,e[r++]<128)))break e;return t&&(t[0]=r),n}function St(e){var t=new Uint8Array(7);t[0]=e&127;var r=1;e:if(e>127){if(t[r-1]|=128,t[r]=e>>7&127,++r,e<=16383||(t[r-1]|=128,t[r]=e>>14&127,++r,e<=2097151)||(t[r-1]|=128,t[r]=e>>21&127,++r,e<=268435455)||(t[r-1]|=128,t[r]=e/256>>>21&127,++r,e<=34359738367)||(t[r-1]|=128,t[r]=e/65536>>>21&127,++r,e<=4398046511103))break e;t[r-1]|=128,t[r]=e/16777216>>>21&127,++r}return t.slice(0,r)}function Kt(e){var t=0,r=e[t]&127;e:if(e[t++]>=128){if(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128))break e;r|=(e[t]&127)<<28}return r}function xt(e){for(var t=[],r=[0];r[0]<e.length;){var n=r[0],a=ic(e,r),s=a&7;a=Math.floor(a/8);var i=0,c;if(a==0)break;switch(s){case 0:{for(var u=r[0];e[r[0]++]>=128;);c=e.slice(u,r[0])}break;case 5:i=4,c=e.slice(r[0],r[0]+i),r[0]+=i;break;case 1:i=8,c=e.slice(r[0],r[0]+i),r[0]+=i;break;case 2:i=ic(e,r),c=e.slice(r[0],r[0]+i),r[0]+=i;break;case 3:case 4:default:throw new Error("PB Type ".concat(s," for Field ").concat(a," at offset ").concat(n))}var f={data:c,type:s};t[a]==null?t[a]=[f]:t[a].push(f)}return t}function Cr(e){var t=[];return e.forEach(function(r,n){r.forEach(function(a){a.data&&(t.push(St(n*8+a.type)),a.type==2&&t.push(St(a.data.length)),t.push(a.data))})}),ks(t)}function ep(e,t){return e?.map(function(r){return t(r.data)})||[]}function Nn(e){for(var t,r=[],n=[0];n[0]<e.length;){var a=ic(e,n),s=xt(e.slice(n[0],n[0]+a));n[0]+=a;var i={id:Kt(s[1][0].data),messages:[]};s[2].forEach(function(c){var u=xt(c.data),f=Kt(u[3][0].data);i.messages.push({meta:u,data:e.slice(n[0],n[0]+f)}),n[0]+=f}),(t=s[3])!=null&&t[0]&&(i.merge=Kt(s[3][0].data)>>>0>0),r.push(i)}return r}function ai(e){var t=[];return e.forEach(function(r){var n=[];n[1]=[{data:St(r.id),type:0}],n[2]=[],r.merge!=null&&(n[3]=[{data:St(+!!r.merge),type:0}]);var a=[];r.messages.forEach(function(i){a.push(i.data),i.meta[3]=[{type:0,data:St(i.data.length)}],n[2].push({data:Cr(i.meta),type:2})});var s=Cr(n);t.push(St(s.length)),t.push(s),a.forEach(function(i){return t.push(i)})}),ks(t)}function lM(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],n=ic(t,r),a=[];r[0]<t.length;){var s=t[r[0]]&3;if(s==0){var i=t[r[0]++]>>2;if(i<60)++i;else{var c=i-59;i=t[r[0]],c>1&&(i|=t[r[0]+1]<<8),c>2&&(i|=t[r[0]+2]<<16),c>3&&(i|=t[r[0]+3]<<24),i>>>=0,i++,r[0]+=c}a.push(t.slice(r[0],r[0]+i)),r[0]+=i;continue}else{var u=0,f=0;if(s==1?(f=(t[r[0]]>>2&7)+4,u=(t[r[0]++]&224)<<3,u|=t[r[0]++]):(f=(t[r[0]++]>>2)+1,s==2?(u=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(u=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),a=[ks(a)],u==0)throw new Error("Invalid offset 0");if(u>a[0].length)throw new Error("Invalid offset beyond length");if(f>=u)for(a.push(a[0].slice(-u)),f-=u;f>=a[a.length-1].length;)a.push(a[a.length-1]),f-=a[a.length-1].length;a.push(a[0].slice(-u,-u+f))}}var h=ks(a);if(h.length!=n)throw new Error("Unexpected length: ".concat(h.length," != ").concat(n));return h}function Mn(e){for(var t=[],r=0;r<e.length;){var n=e[r++],a=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(lM(n,e.slice(r,r+a))),r+=a}if(r!==e.length)throw new Error("data is not a valid framed stream!");return ks(t)}function si(e){for(var t=[],r=0;r<e.length;){var n=Math.min(e.length-r,268435455),a=new Uint8Array(4);t.push(a);var s=St(n),i=s.length;t.push(s),n<=60?(i++,t.push(new Uint8Array([n-1<<2]))):n<=256?(i+=2,t.push(new Uint8Array([240,n-1&255]))):n<=65536?(i+=3,t.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(i+=4,t.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(i+=5,t.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),t.push(e.slice(r,r+n)),i+=n,a[0]=0,a[1]=i&255,a[2]=i>>8&255,a[3]=i>>16&255,r+=n}return ks(t)}function cM(e,t,r,n){var a=po(e),s=a.getUint32(4,!0),i=(n>1?12:8)+Wx(s&(n>1?3470:398))*4,c=-1,u=-1,f=NaN,h=new Date(2001,0,1);s&512&&(c=a.getUint32(i,!0),i+=4),i+=Wx(s&(n>1?12288:4096))*4,s&16&&(u=a.getUint32(i,!0),i+=4),s&32&&(f=a.getFloat64(i,!0),i+=8),s&64&&(h.setTime(h.getTime()+a.getFloat64(i,!0)*1e3),i+=8);var p;switch(e[2]){case 0:break;case 2:p={t:"n",v:f};break;case 3:p={t:"s",v:t[u]};break;case 5:p={t:"d",v:h};break;case 6:p={t:"b",v:f>0};break;case 7:p={t:"n",v:f/86400};break;case 8:p={t:"e",v:0};break;case 9:if(c>-1)p={t:"s",v:r[c]};else if(u>-1)p={t:"s",v:t[u]};else if(!isNaN(f))p={t:"n",v:f};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return p}function uM(e,t,r){var n=po(e),a=n.getUint32(8,!0),s=12,i=-1,c=-1,u=NaN,f=NaN,h=new Date(2001,0,1);a&1&&(u=oM(e,s),s+=16),a&2&&(f=n.getFloat64(s,!0),s+=8),a&4&&(h.setTime(h.getTime()+n.getFloat64(s,!0)*1e3),s+=8),a&8&&(c=n.getUint32(s,!0),s+=4),a&16&&(i=n.getUint32(s,!0),s+=4);var p;switch(e[1]){case 0:break;case 2:p={t:"n",v:u};break;case 3:p={t:"s",v:t[c]};break;case 5:p={t:"d",v:h};break;case 6:p={t:"b",v:f>0};break;case 7:p={t:"n",v:f/86400};break;case 8:p={t:"e",v:0};break;case 9:if(i>-1)p={t:"s",v:r[i]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(a&31," : ").concat(e.slice(0,4)));break;case 10:p={t:"n",v:u};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(a&31," : ").concat(e.slice(0,4)))}return p}function oh(e,t){var r=new Uint8Array(32),n=po(r),a=12,s=0;switch(r[0]=5,e.t){case"n":r[1]=2,iM(r,a,e.v),s|=1,a+=16;break;case"b":r[1]=6,n.setFloat64(a,e.v?1:0,!0),s|=2,a+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[1]=3,n.setUint32(a,t.indexOf(e.v),!0),s|=8,a+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(8,s,!0),r.slice(0,a)}function ih(e,t){var r=new Uint8Array(32),n=po(r),a=12,s=0;switch(r[0]=3,e.t){case"n":r[2]=2,n.setFloat64(a,e.v,!0),s|=32,a+=8;break;case"b":r[2]=6,n.setFloat64(a,e.v?1:0,!0),s|=32,a+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[2]=3,n.setUint32(a,t.indexOf(e.v),!0),s|=16,a+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(4,s,!0),r.slice(0,a)}function fM(e,t,r){switch(e[0]){case 0:case 1:case 2:case 3:return cM(e,t,r,e[0]);case 5:return uM(e,t,r);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function Ur(e){var t=xt(e);return ic(t[1][0].data)}function Hx(e,t){var r=xt(t.data),n=Kt(r[1][0].data),a=r[3],s=[];return(a||[]).forEach(function(i){var c=xt(i.data),u=Kt(c[1][0].data)>>>0;switch(n){case 1:s[u]=Jh(c[3][0].data);break;case 8:{var f=e[Ur(c[9][0].data)][0],h=xt(f.data),p=e[Ur(h[1][0].data)][0],m=Kt(p.meta[1][0].data);if(m!=2001)throw new Error("2000 unexpected reference to ".concat(m));var y=xt(p.data);s[u]=y[3].map(function(w){return Jh(w.data)}).join("")}break}}),s}function dM(e,t){var r,n,a,s,i,c,u,f,h,p,m,y,w,x,_=xt(e),E=Kt(_[1][0].data)>>>0,k=Kt(_[2][0].data)>>>0,b=((n=(r=_[8])==null?void 0:r[0])==null?void 0:n.data)&&Kt(_[8][0].data)>0||!1,O,z;if((s=(a=_[7])==null?void 0:a[0])!=null&&s.data&&t!=0)O=(c=(i=_[7])==null?void 0:i[0])==null?void 0:c.data,z=(f=(u=_[6])==null?void 0:u[0])==null?void 0:f.data;else if((p=(h=_[4])==null?void 0:h[0])!=null&&p.data&&t!=1)O=(y=(m=_[4])==null?void 0:m[0])==null?void 0:y.data,z=(x=(w=_[3])==null?void 0:w[0])==null?void 0:x.data;else throw"NUMBERS Tile missing ".concat(t," cell storage");for(var L=b?4:1,P=po(O),J=[],V=0;V<O.length/2;++V){var le=P.getUint16(V*2,!0);le<65535&&J.push([V,le])}if(J.length!=k)throw"Expected ".concat(k," cells, found ").concat(J.length);var ee=[];for(V=0;V<J.length-1;++V)ee[J[V][0]]=z.subarray(J[V][1]*L,J[V+1][1]*L);return J.length>=1&&(ee[J[J.length-1][0]]=z.subarray(J[J.length-1][1]*L)),{R:E,cells:ee}}function hM(e,t){var r,n=xt(t.data),a=(r=n?.[7])!=null&&r[0]?Kt(n[7][0].data)>>>0>0?1:0:-1,s=ep(n[5],function(i){return dM(i,a)});return{nrows:Kt(n[4][0].data)>>>0,data:s.reduce(function(i,c){return i[c.R]||(i[c.R]=[]),c.cells.forEach(function(u,f){if(i[c.R][f])throw new Error("Duplicate cell r=".concat(c.R," c=").concat(f));i[c.R][f]=u}),i},[])}}function gM(e,t,r){var n,a=xt(t.data),s={s:{r:0,c:0},e:{r:0,c:0}};if(s.e.r=(Kt(a[6][0].data)>>>0)-1,s.e.r<0)throw new Error("Invalid row varint ".concat(a[6][0].data));if(s.e.c=(Kt(a[7][0].data)>>>0)-1,s.e.c<0)throw new Error("Invalid col varint ".concat(a[7][0].data));r["!ref"]=rt(s);var i=xt(a[4][0].data),c=Hx(e,e[Ur(i[4][0].data)][0]),u=(n=i[17])!=null&&n[0]?Hx(e,e[Ur(i[17][0].data)][0]):[],f=xt(i[3][0].data),h=0;f[1].forEach(function(p){var m=xt(p.data),y=e[Ur(m[2][0].data)][0],w=Kt(y.meta[1][0].data);if(w!=6002)throw new Error("6001 unexpected reference to ".concat(w));var x=hM(e,y);x.data.forEach(function(_,E){_.forEach(function(k,b){var O=qe({r:h+E,c:b}),z=fM(k,c,u);z&&(r[O]=z)})}),h+=x.nrows})}function pM(e,t){var r=xt(t.data),n={"!ref":"A1"},a=e[Ur(r[2][0].data)],s=Kt(a[0].meta[1][0].data);if(s!=6001)throw new Error("6000 unexpected reference to ".concat(s));return gM(e,a[0],n),n}function mM(e,t){var r,n=xt(t.data),a={name:(r=n[1])!=null&&r[0]?Jh(n[1][0].data):"",sheets:[]},s=ep(n[2],Ur);return s.forEach(function(i){e[i].forEach(function(c){var u=Kt(c.meta[1][0].data);u==6e3&&a.sheets.push(pM(e,c))})}),a}function vM(e,t){var r=sp(),n=xt(t.data),a=ep(n[1],Ur);if(a.forEach(function(s){e[s].forEach(function(i){var c=Kt(i.meta[1][0].data);if(c==2){var u=mM(e,i);u.sheets.forEach(function(f,h){op(r,f,h==0?u.name:u.name+"_"+h,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function lh(e){var t,r,n,a,s={},i=[];if(e.FullPaths.forEach(function(u){if(u.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(u){if(u.name.match(/\.iwa$/)){var f;try{f=Mn(u.content)}catch(p){return console.log("?? "+u.content.length+" "+(p.message||p))}var h;try{h=Nn(f)}catch(p){return console.log("## "+(p.message||p))}h.forEach(function(p){s[p.id]=p.messages,i.push(p.id)})}}),!i.length)throw new Error("File has no messages");var c=((a=(n=(r=(t=s?.[1])==null?void 0:t[0])==null?void 0:r.meta)==null?void 0:n[1])==null?void 0:a[0].data)&&Kt(s[1][0].meta[1][0].data)==1&&s[1][0];if(c||i.forEach(function(u){s[u].forEach(function(f){var h=Kt(f.meta[1][0].data)>>>0;if(h==1)if(!c)c=f;else throw new Error("Document has multiple roots")})}),!c)throw new Error("Cannot find Document root");return vM(s,c)}function xM(e,t,r){var n,a,s,i;if(!((n=e[6])!=null&&n[0])||!((a=e[7])!=null&&a[0]))throw"Mutation only works on post-BNC storages!";var c=((i=(s=e[8])==null?void 0:s[0])==null?void 0:i.data)&&Kt(e[8][0].data)>0||!1;if(c)throw"Math only works with normal offsets";for(var u=0,f=po(e[7][0].data),h=0,p=[],m=po(e[4][0].data),y=0,w=[],x=0;x<t.length;++x){if(t[x]==null){f.setUint16(x*2,65535,!0),m.setUint16(x*2,65535);continue}f.setUint16(x*2,h,!0),m.setUint16(x*2,y,!0);var _,E;switch(typeof t[x]){case"string":_=oh({t:"s",v:t[x]},r),E=ih({t:"s",v:t[x]},r);break;case"number":_=oh({t:"n",v:t[x]},r),E=ih({t:"n",v:t[x]},r);break;case"boolean":_=oh({t:"b",v:t[x]},r),E=ih({t:"b",v:t[x]},r);break;default:throw new Error("Unsupported value "+t[x])}p.push(_),h+=_.length,w.push(E),y+=E.length,++u}for(e[2][0].data=St(u);x<e[7][0].data.length/2;++x)f.setUint16(x*2,65535,!0),m.setUint16(x*2,65535,!0);return e[6][0].data=ks(p),e[3][0].data=ks(w),u}function yM(e,t){if(!t||!t.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var n=fn(r["!ref"]);n.s.r=n.s.c=0;var a=!1;n.e.c>9&&(a=!0,n.e.c=9),n.e.r>49&&(a=!0,n.e.r=49),a&&console.error("The Numbers writer is currently limited to ".concat(rt(n)));var s=Tf(r,{range:n,header:1}),i=["~Sh33tJ5~"];s.forEach(function(G){return G.forEach(function(U){typeof U=="string"&&i.push(U)})});var c={},u=[],f=Ve.read(t.numbers,{type:"base64"});f.FileIndex.map(function(G,U){return[G,f.FullPaths[U]]}).forEach(function(G){var U=G[0],W=G[1];if(U.type==2&&U.name.match(/\.iwa/)){var ne=U.content,xe=Mn(ne),ve=Nn(xe);ve.forEach(function(me){u.push(me.id),c[me.id]={deps:[],location:W,type:Kt(me.messages[0].meta[1][0].data)}})}}),u.sort(function(G,U){return G-U});var h=u.filter(function(G){return G>1}).map(function(G){return[G,St(G)]});f.FileIndex.map(function(G,U){return[G,f.FullPaths[U]]}).forEach(function(G){var U=G[0];if(G[1],!!U.name.match(/\.iwa/)){var W=Nn(Mn(U.content));W.forEach(function(ne){ne.messages.forEach(function(xe){h.forEach(function(ve){ne.messages.some(function(me){return Kt(me.meta[1][0].data)!=11006&&sM(me.data,ve[1])})&&c[ve[0]].deps.push(ne.id)})})})}});for(var p=Ve.find(f,c[1].location),m=Nn(Mn(p.content)),y,w=0;w<m.length;++w){var x=m[w];x.id==1&&(y=x)}var _=Ur(xt(y.messages[0].data)[1][0].data);for(p=Ve.find(f,c[_].location),m=Nn(Mn(p.content)),w=0;w<m.length;++w)x=m[w],x.id==_&&(y=x);for(_=Ur(xt(y.messages[0].data)[2][0].data),p=Ve.find(f,c[_].location),m=Nn(Mn(p.content)),w=0;w<m.length;++w)x=m[w],x.id==_&&(y=x);for(_=Ur(xt(y.messages[0].data)[2][0].data),p=Ve.find(f,c[_].location),m=Nn(Mn(p.content)),w=0;w<m.length;++w)x=m[w],x.id==_&&(y=x);var E=xt(y.messages[0].data);{E[6][0].data=St(n.e.r+1),E[7][0].data=St(n.e.c+1);var k=Ur(E[46][0].data),b=Ve.find(f,c[k].location),O=Nn(Mn(b.content));{for(var z=0;z<O.length&&O[z].id!=k;++z);if(O[z].id!=k)throw"Bad ColumnRowUIDMapArchive";var L=xt(O[z].messages[0].data);L[1]=[],L[2]=[],L[3]=[];for(var P=0;P<=n.e.c;++P){var J=[];J[1]=J[2]=[{type:0,data:St(P+420690)}],L[1].push({type:2,data:Cr(J)}),L[2].push({type:0,data:St(P)}),L[3].push({type:0,data:St(P)})}L[4]=[],L[5]=[],L[6]=[];for(var V=0;V<=n.e.r;++V)J=[],J[1]=J[2]=[{type:0,data:St(V+726270)}],L[4].push({type:2,data:Cr(J)}),L[5].push({type:0,data:St(V)}),L[6].push({type:0,data:St(V)});O[z].messages[0].data=Cr(L)}b.content=si(ai(O)),b.size=b.content.length,delete E[46];var le=xt(E[4][0].data);{le[7][0].data=St(n.e.r+1);var ee=xt(le[1][0].data),X=Ur(ee[2][0].data);b=Ve.find(f,c[X].location),O=Nn(Mn(b.content));{if(O[0].id!=X)throw"Bad HeaderStorageBucket";var he=xt(O[0].messages[0].data);for(V=0;V<s.length;++V){var Ie=xt(he[2][0].data);Ie[1][0].data=St(V),Ie[4][0].data=St(s[V].length),he[2][V]={type:he[2][0].type,data:Cr(Ie)}}O[0].messages[0].data=Cr(he)}b.content=si(ai(O)),b.size=b.content.length;var Ee=Ur(le[2][0].data);b=Ve.find(f,c[Ee].location),O=Nn(Mn(b.content));{if(O[0].id!=Ee)throw"Bad HeaderStorageBucket";for(he=xt(O[0].messages[0].data),P=0;P<=n.e.c;++P)Ie=xt(he[2][0].data),Ie[1][0].data=St(P),Ie[4][0].data=St(n.e.r+1),he[2][P]={type:he[2][0].type,data:Cr(Ie)};O[0].messages[0].data=Cr(he)}b.content=si(ai(O)),b.size=b.content.length;var Te=Ur(le[4][0].data);(function(){for(var G=Ve.find(f,c[Te].location),U=Nn(Mn(G.content)),W,ne=0;ne<U.length;++ne){var xe=U[ne];xe.id==Te&&(W=xe)}var ve=xt(W.messages[0].data);{ve[3]=[];var me=[];i.forEach(function(j,yt){me[1]=[{type:0,data:St(yt)}],me[2]=[{type:0,data:St(1)}],me[3]=[{type:2,data:aM(j)}],ve[3].push({type:2,data:Cr(me)})})}W.messages[0].data=Cr(ve);var ye=ai(U),Ze=si(ye);G.content=Ze,G.size=G.content.length})();var oe=xt(le[3][0].data);{var ge=oe[1][0];delete oe[2];var K=xt(ge.data);{var fe=Ur(K[2][0].data);(function(){for(var G=Ve.find(f,c[fe].location),U=Nn(Mn(G.content)),W,ne=0;ne<U.length;++ne){var xe=U[ne];xe.id==fe&&(W=xe)}var ve=xt(W.messages[0].data);{delete ve[6],delete oe[7];var me=new Uint8Array(ve[5][0].data);ve[5]=[];for(var ye=0,Ze=0;Ze<=n.e.r;++Ze){var j=xt(me);ye+=xM(j,s[Ze],i),j[1][0].data=St(Ze),ve[5].push({data:Cr(j),type:2})}ve[1]=[{type:0,data:St(n.e.c+1)}],ve[2]=[{type:0,data:St(n.e.r+1)}],ve[3]=[{type:0,data:St(ye)}],ve[4]=[{type:0,data:St(n.e.r+1)}]}W.messages[0].data=Cr(ve);var yt=ai(U),ot=si(yt);G.content=ot,G.size=G.content.length})()}ge.data=Cr(K)}le[3][0].data=Cr(oe)}E[4][0].data=Cr(le)}y.messages[0].data=Cr(E);var H=ai(m),A=si(H);return p.content=A,p.size=p.content.length,f}function s2(e){return function(r){for(var n=0;n!=e.length;++n){var a=e[n];r[a[0]]===void 0&&(r[a[0]]=a[1]),a[2]==="n"&&(r[a[0]]=Number(r[a[0]]))}}}function tp(e){s2([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function rp(e){s2([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function wM(e){return ct.WS.indexOf(e)>-1?"sheet":e==ct.CS?"chart":e==ct.DS?"dialog":e==ct.MS?"macro":e&&e.length?e:"sheet"}function _M(e,t){if(!e)return 0;try{e=t.map(function(n){return n.id||(n.id=n.strRelID),[n.name,e["!id"][n.id].Target,wM(e["!id"][n.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function SM(e,t,r,n,a,s,i,c,u,f,h,p){try{s[n]=Ll(kn(e,r,!0),t);var m=lr(e,t),y;switch(c){case"sheet":y=W6(m,t,a,u,s[n],f,h,p);break;case"chart":if(y=H6(m,t,a,u,s[n],f,h,p),!y||!y["!drawel"])break;var w=Al(y["!drawel"].Target,t),x=tc(w),_=OR(kn(e,w,!0),Ll(kn(e,x,!0),w)),E=Al(_,w),k=tc(E);y=x6(kn(e,E,!0),E,u,Ll(kn(e,k,!0),E),f,y);break;case"macro":y=G6(m,t,a,u,s[n],f,h,p);break;case"dialog":y=q6(m,t,a,u,s[n],f,h,p);break;default:throw new Error("Unrecognized sheet type "+c)}i[n]=y;var b=[];s&&s[n]&&Xt(s[n]).forEach(function(O){var z="";if(s[n][O].Type==ct.CMNT){z=Al(s[n][O].Target,t);var L=Y6(lr(e,z,!0),z,u);if(!L||!L.length)return;Ix(y,L,!1)}s[n][O].Type==ct.TCMNT&&(z=Al(s[n][O].Target,t),b=b.concat(FR(lr(e,z,!0),u)))}),b&&b.length&&Ix(y,b,!0,u.people||[])}catch(O){if(u.WTF)throw O}}function Rn(e){return e.charAt(0)=="/"?e.slice(1):e}function EM(e,t){if(Di(),t=t||{},tp(t),Bn(e,"META-INF/manifest.xml")||Bn(e,"objectdata.xml"))return Ux(e,t);if(Bn(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof lh<"u"){if(e.FileIndex)return lh(e);var r=Ve.utils.cfb_new();return Yv(e).forEach(function(Ie){nt(r,Ie,RI(e,Ie))}),lh(r)}throw new Error("Unsupported NUMBERS file")}if(!Bn(e,"[Content_Types].xml"))throw Bn(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):Bn(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=Yv(e),a=C3(kn(e,"[Content_Types].xml")),s=!1,i,c;if(a.workbooks.length===0&&(c="xl/workbook.xml",lr(e,c,!0)&&a.workbooks.push(c)),a.workbooks.length===0){if(c="xl/workbook.bin",!lr(e,c,!0))throw new Error("Could not find workbook");a.workbooks.push(c),s=!0}a.workbooks[0].slice(-3)=="bin"&&(s=!0);var u={},f={};if(!t.bookSheets&&!t.bookProps){if(Nl=[],a.sst)try{Nl=J6(lr(e,Rn(a.sst)),a.sst,t)}catch(Ie){if(t.WTF)throw Ie}t.cellStyles&&a.themes.length&&(u=X6(kn(e,a.themes[0].replace(/^\//,""),!0)||"",a.themes[0],t)),a.style&&(f=K6(lr(e,Rn(a.style)),a.style,u,t))}a.links.map(function(Ie){try{var Ee=Ll(kn(e,tc(Rn(Ie))),Ie);return Z6(lr(e,Rn(Ie)),Ee,Ie,t)}catch{}});var h=V6(lr(e,Rn(a.workbooks[0])),a.workbooks[0],t),p={},m="";a.coreprops.length&&(m=lr(e,Rn(a.coreprops[0]),!0),m&&(p=q_(m)),a.extprops.length!==0&&(m=lr(e,Rn(a.extprops[0]),!0),m&&R3(m,p,t)));var y={};(!t.bookSheets||t.bookProps)&&a.custprops.length!==0&&(m=kn(e,Rn(a.custprops[0]),!0),m&&(y=N3(m,t)));var w={};if((t.bookSheets||t.bookProps)&&(h.Sheets?i=h.Sheets.map(function(Ee){return Ee.name}):p.Worksheets&&p.SheetNames.length>0&&(i=p.SheetNames),t.bookProps&&(w.Props=p,w.Custprops=y),t.bookSheets&&typeof i<"u"&&(w.SheetNames=i),t.bookSheets?w.SheetNames:t.bookProps))return w;i={};var x={};t.bookDeps&&a.calcchain&&(x=Q6(lr(e,Rn(a.calcchain)),a.calcchain));var _=0,E={},k,b;{var O=h.Sheets;p.Worksheets=O.length,p.SheetNames=[];for(var z=0;z!=O.length;++z)p.SheetNames[z]=O[z].name}var L=s?"bin":"xml",P=a.workbooks[0].lastIndexOf("/"),J=(a.workbooks[0].slice(0,P+1)+"_rels/"+a.workbooks[0].slice(P+1)+".rels").replace(/^\//,"");Bn(e,J)||(J="xl/_rels/workbook."+L+".rels");var V=Ll(kn(e,J,!0),J.replace(/_rels.*/,"s5s"));(a.metadata||[]).length>=1&&(t.xlmeta=e5(lr(e,Rn(a.metadata[0])),a.metadata[0],t)),(a.people||[]).length>=1&&(t.people=LR(lr(e,Rn(a.people[0])),t)),V&&(V=_M(V,h.Sheets));var le=lr(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(_=0;_!=p.Worksheets;++_){var ee="sheet";if(V&&V[_]?(k="xl/"+V[_][1].replace(/[\/]?xl\//,""),Bn(e,k)||(k=V[_][1]),Bn(e,k)||(k=J.replace(/_rels\/.*$/,"")+V[_][1]),ee=V[_][2]):(k="xl/worksheets/sheet"+(_+1-le)+"."+L,k=k.replace(/sheet0\./,"sheet.")),b=k.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),t&&t.sheets!=null)switch(typeof t.sheets){case"number":if(_!=t.sheets)continue e;break;case"string":if(p.SheetNames[_].toLowerCase()!=t.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(t.sheets)){for(var X=!1,he=0;he!=t.sheets.length;++he)typeof t.sheets[he]=="number"&&t.sheets[he]==_&&(X=1),typeof t.sheets[he]=="string"&&t.sheets[he].toLowerCase()==p.SheetNames[_].toLowerCase()&&(X=1);if(!X)continue e}}SM(e,k,b,p.SheetNames[_],_,E,i,ee,t,h,u,f)}return w={Directory:a,Workbook:h,Props:p,Custprops:y,Deps:x,Sheets:i,SheetNames:p.SheetNames,Strings:Nl,Styles:f,Themes:u,SSF:Lt(Ge)},t&&t.bookFiles&&(e.files?(w.keys=n,w.files=e.files):(w.keys=[],w.files={},e.FullPaths.forEach(function(Ie,Ee){Ie=Ie.replace(/^Root Entry[\/]/,""),w.keys.push(Ie),w.files[Ie]=e.FileIndex[Ee]}))),t&&t.bookVBA&&(a.vba.length>0?w.vbaraw=lr(e,Rn(a.vba[0]),!0):a.defaults&&a.defaults.bin===VR&&(w.vbaraw=lr(e,"xl/vbaProject.bin",!0))),w}function bM(e,t){var r=t||{},n="Workbook",a=Ve.find(e,n);try{if(n="/!DataSpaces/Version",a=Ve.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(eF(a.content),n="/!DataSpaces/DataSpaceMap",a=Ve.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var s=rF(a.content);if(s.length!==1||s[0].comps.length!==1||s[0].comps[0].t!==0||s[0].name!=="StrongEncryptionDataSpace"||s[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",a=Ve.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var i=nF(a.content);if(i.length!=1||i[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",a=Ve.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);sF(a.content)}catch{}if(n="/EncryptionInfo",a=Ve.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var c=oF(a.content);if(n="/EncryptedPackage",a=Ve.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(c[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(c[1],a.content,r.password||"",r);if(c[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(c[1],a.content,r.password||"",r);throw new Error("File is password-protected")}function kM(e,t){return t.bookType=="ods"?a2(e,t):t.bookType=="numbers"?yM(e,t):t.bookType=="xlsb"?TM(e,t):CM(e,t)}function TM(e,t){ci=1024,e&&!e.SSF&&(e.SSF=Lt(Ge)),e&&e.SSF&&(Di(),Bf(e.SSF),t.revssf=$f(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Ml?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r=t.bookType=="xlsb"?"bin":"xml",n=DS.indexOf(t.bookType)>-1,a=Ug();rp(t=t||{});var s=Cg(),i="",c=0;if(t.cellXfs=[],Is(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),i="docProps/core.xml",nt(s,i,K_(e.Props,t)),a.coreprops.push(i),Et(t.rels,2,i,ct.CORE_PROPS),i="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var u=[],f=0;f<e.SheetNames.length;++f)(e.Workbook.Sheets[f]||{}).Hidden!=2&&u.push(e.SheetNames[f]);e.Props.SheetNames=u}for(e.Props.Worksheets=e.Props.SheetNames.length,nt(s,i,Y_(e.Props)),a.extprops.push(i),Et(t.rels,3,i,ct.EXT_PROPS),e.Custprops!==e.Props&&Xt(e.Custprops||{}).length>0&&(i="docProps/custom.xml",nt(s,i,Q_(e.Custprops)),a.custprops.push(i),Et(t.rels,4,i,ct.CUST_PROPS)),c=1;c<=e.SheetNames.length;++c){var h={"!id":{}},p=e.Sheets[e.SheetNames[c-1]],m=(p||{})["!type"]||"sheet";switch(m){case"chart":default:i="xl/worksheets/sheet"+c+"."+r,nt(s,i,r5(c-1,i,t,e,h)),a.sheets.push(i),Et(t.wbrels,-1,"worksheets/sheet"+c+"."+r,ct.WS[0])}if(p){var y=p["!comments"],w=!1,x="";y&&y.length>0&&(x="xl/comments"+c+"."+r,nt(s,x,s5(y,x)),a.comments.push(x),Et(h,-1,"../comments"+c+"."+r,ct.CMNT),w=!0),p["!legacy"]&&w&&nt(s,"xl/drawings/vmlDrawing"+c+".vml",IS(c,p["!comments"])),delete p["!comments"],delete p["!legacy"]}h["!id"].rId1&&nt(s,tc(i),gi(h))}return t.Strings!=null&&t.Strings.length>0&&(i="xl/sharedStrings."+r,nt(s,i,a5(t.Strings,i,t)),a.strs.push(i),Et(t.wbrels,-1,"sharedStrings."+r,ct.SST)),i="xl/workbook."+r,nt(s,i,t5(e,i)),a.workbooks.push(i),Et(t.rels,1,i,ct.WB),i="xl/theme/theme1.xml",nt(s,i,qg(e.Themes,t)),a.themes.push(i),Et(t.wbrels,-1,"theme/theme1.xml",ct.THEME),i="xl/styles."+r,nt(s,i,n5(e,i,t)),a.styles.push(i),Et(t.wbrels,-1,"styles."+r,ct.STY),e.vbaraw&&n&&(i="xl/vbaProject.bin",nt(s,i,e.vbaraw),a.vba.push(i),Et(t.wbrels,-1,"vbaProject.bin",ct.VBA)),i="xl/metadata."+r,nt(s,i,o5(i)),a.metadata.push(i),Et(t.wbrels,-1,"metadata."+r,ct.XLMETA),nt(s,"[Content_Types].xml",H_(a,t)),nt(s,"_rels/.rels",gi(t.rels)),nt(s,"xl/_rels/workbook."+r+".rels",gi(t.wbrels)),delete t.revssf,delete t.ssf,s}function CM(e,t){ci=1024,e&&!e.SSF&&(e.SSF=Lt(Ge)),e&&e.SSF&&(Di(),Bf(e.SSF),t.revssf=$f(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Ml?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r="xml",n=DS.indexOf(t.bookType)>-1,a=Ug();rp(t=t||{});var s=Cg(),i="",c=0;if(t.cellXfs=[],Is(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),i="docProps/core.xml",nt(s,i,K_(e.Props,t)),a.coreprops.push(i),Et(t.rels,2,i,ct.CORE_PROPS),i="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var u=[],f=0;f<e.SheetNames.length;++f)(e.Workbook.Sheets[f]||{}).Hidden!=2&&u.push(e.SheetNames[f]);e.Props.SheetNames=u}e.Props.Worksheets=e.Props.SheetNames.length,nt(s,i,Y_(e.Props)),a.extprops.push(i),Et(t.rels,3,i,ct.EXT_PROPS),e.Custprops!==e.Props&&Xt(e.Custprops||{}).length>0&&(i="docProps/custom.xml",nt(s,i,Q_(e.Custprops)),a.custprops.push(i),Et(t.rels,4,i,ct.CUST_PROPS));var h=["SheetJ5"];for(t.tcid=0,c=1;c<=e.SheetNames.length;++c){var p={"!id":{}},m=e.Sheets[e.SheetNames[c-1]],y=(m||{})["!type"]||"sheet";switch(y){case"chart":default:i="xl/worksheets/sheet"+c+"."+r,nt(s,i,VS(c-1,t,e,p)),a.sheets.push(i),Et(t.wbrels,-1,"worksheets/sheet"+c+"."+r,ct.WS[0])}if(m){var w=m["!comments"],x=!1,_="";if(w&&w.length>0){var E=!1;w.forEach(function(k){k[1].forEach(function(b){b.T==!0&&(E=!0)})}),E&&(_="xl/threadedComments/threadedComment"+c+"."+r,nt(s,_,RR(w,h,t)),a.threadedcomments.push(_),Et(p,-1,"../threadedComments/threadedComment"+c+"."+r,ct.TCMNT)),_="xl/comments"+c+"."+r,nt(s,_,OS(w)),a.comments.push(_),Et(p,-1,"../comments"+c+"."+r,ct.CMNT),x=!0}m["!legacy"]&&x&&nt(s,"xl/drawings/vmlDrawing"+c+".vml",IS(c,m["!comments"])),delete m["!comments"],delete m["!legacy"]}p["!id"].rId1&&nt(s,tc(i),gi(p))}return t.Strings!=null&&t.Strings.length>0&&(i="xl/sharedStrings."+r,nt(s,i,xS(t.Strings,t)),a.strs.push(i),Et(t.wbrels,-1,"sharedStrings."+r,ct.SST)),i="xl/workbook."+r,nt(s,i,KS(e)),a.workbooks.push(i),Et(t.rels,1,i,ct.WB),i="xl/theme/theme1.xml",nt(s,i,qg(e.Themes,t)),a.themes.push(i),Et(t.wbrels,-1,"theme/theme1.xml",ct.THEME),i="xl/styles."+r,nt(s,i,TS(e,t)),a.styles.push(i),Et(t.wbrels,-1,"styles."+r,ct.STY),e.vbaraw&&n&&(i="xl/vbaProject.bin",nt(s,i,e.vbaraw),a.vba.push(i),Et(t.wbrels,-1,"vbaProject.bin",ct.VBA)),i="xl/metadata."+r,nt(s,i,PS()),a.metadata.push(i),Et(t.wbrels,-1,"metadata."+r,ct.XLMETA),h.length>1&&(i="xl/persons/person.xml",nt(s,i,NR(h)),a.people.push(i),Et(t.wbrels,-1,"persons/person.xml",ct.PEOPLE)),nt(s,"[Content_Types].xml",H_(a,t)),nt(s,"_rels/.rels",gi(t.rels)),nt(s,"xl/_rels/workbook."+r+".rels",gi(t.wbrels)),delete t.revssf,delete t.ssf,s}function np(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=Tn(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function AM(e,t){return Ve.find(e,"EncryptedPackage")?bM(e,t):QS(e,t)}function PM(e,t){var r,n=e,a=t||{};return a.type||(a.type=st&&Buffer.isBuffer(e)?"buffer":"base64"),r=w_(n,a),EM(r,a)}function o2(e,t){var r=0;e:for(;r<e.length;)switch(e.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return Kh(e.slice(r),t);default:break e}return Si.to_workbook(e,t)}function IM(e,t){var r="",n=np(e,t);switch(t.type){case"base64":r=Tn(e);break;case"binary":r=e;break;case"buffer":r=e.toString("binary");break;case"array":r=uo(e);break;default:throw new Error("Unrecognized type "+t.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(r=kt(r)),t.type="binary",o2(r,t)}function OM(e,t){var r=e;return t.type=="base64"&&(r=Tn(r)),r=Xl.utils.decode(1200,r.slice(2),"str"),t.type="binary",o2(r,t)}function DM(e){return e.match(/[^\x00-\x7F]/)?xa(e):e}function ch(e,t,r,n){return n?(r.type="string",Si.to_workbook(e,r)):Si.to_workbook(t,r)}function Yh(e,t){Sg();var r=t||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return Yh(new Uint8Array(e),(r=Lt(r),r.type="array",r));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var n=e,a=[0,0,0,0],s=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),mi={},r.dateNF&&(mi.dateNF=r.dateNF),r.type||(r.type=st&&Buffer.isBuffer(e)?"buffer":"base64"),r.type=="file"&&(r.type=st?"buffer":"binary",n=TI(e),typeof Uint8Array<"u"&&!st&&(r.type="array")),r.type=="string"&&(s=!0,r.type="binary",r.codepage=65001,n=DM(e)),r.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var i=new ArrayBuffer(3),c=new Uint8Array(i);if(c.foo="bar",!c.foo)return r=Lt(r),r.type="array",Yh(Eg(n),r)}switch((a=np(n,r))[0]){case 208:if(a[1]===207&&a[2]===17&&a[3]===224&&a[4]===161&&a[5]===177&&a[6]===26&&a[7]===225)return AM(Ve.read(n,r),r);break;case 9:if(a[1]<=8)return QS(n,r);break;case 60:return Kh(n,r);case 73:if(a[1]===73&&a[2]===42&&a[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(a[1]===68)return MD(n,r);break;case 84:if(a[1]===65&&a[2]===66&&a[3]===76)return mS.to_workbook(n,r);break;case 80:return a[1]===75&&a[2]<9&&a[3]<9?PM(n,r):ch(e,n,r,s);case 239:return a[3]===60?Kh(n,r):ch(e,n,r,s);case 255:if(a[1]===254)return OM(n,r);if(a[1]===0&&a[2]===2&&a[3]===0)return oo.to_workbook(n,r);break;case 0:if(a[1]===0&&(a[2]>=2&&a[3]===0||a[2]===0&&(a[3]===8||a[3]===9)))return oo.to_workbook(n,r);break;case 3:case 131:case 139:case 140:return qh.to_workbook(n,r);case 123:if(a[1]===92&&a[2]===114&&a[3]===116)return ES.to_workbook(n,r);break;case 10:case 13:case 32:return IM(n,r);case 137:if(a[1]===80&&a[2]===78&&a[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return ND.indexOf(a[0])>-1&&a[2]<=12&&a[3]<=31?qh.to_workbook(n,r):ch(e,n,r,s)}function i2(e,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return mc(t.file,Ve.write(e,{type:st?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");default:throw new Error("Unrecognized type "+t.type)}return Ve.write(e,t)}function FM(e,t){var r=Lt(t||{}),n=kM(e,r);return RM(n,r)}function RM(e,t){var r={},n=st?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(t.compression&&(r.compression="DEFLATE"),t.password)r.type=n;else switch(t.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");case"buffer":case"file":r.type=n;break;default:throw new Error("Unrecognized type "+t.type)}var a=e.FullPaths?Ve.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!t.compression}):e.generate(r);if(typeof Deno<"u"&&typeof a=="string"){if(t.type=="binary"||t.type=="base64")return a;a=new Uint8Array(Mf(a))}return t.password&&typeof encrypt_agile<"u"?i2(encrypt_agile(a,t.password),t):t.type==="file"?mc(t.file,a):t.type=="string"?kt(a):a}function LM(e,t){var r=t||{},n=D5(e,r);return i2(n,r)}function ma(e,t,r){r||(r="");var n=r+e;switch(t.type){case"base64":return Jl(xa(n));case"binary":return xa(n);case"string":return e;case"file":return mc(t.file,n,"utf8");case"buffer":return st?Wa(n,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(n):ma(n,{type:"binary"}).split("").map(function(a){return a.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function NM(e,t){switch(t.type){case"base64":return Jl(e);case"binary":return e;case"string":return e;case"file":return mc(t.file,e,"binary");case"buffer":return st?Wa(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function nf(e,t){switch(t.type){case"string":case"base64":case"binary":for(var r="",n=0;n<e.length;++n)r+=String.fromCharCode(e[n]);return t.type=="base64"?Jl(r):t.type=="string"?kt(r):r;case"file":return mc(t.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+t.type)}}function l2(e,t){Sg(),A6(e);var r=Lt(t||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var n=l2(e,r);return r.type="array",Mf(n)}var a=0;if(r.sheet&&(typeof r.sheet=="number"?a=r.sheet:a=e.SheetNames.indexOf(r.sheet),!e.SheetNames[a]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return ma(k5(e,r),r);case"slk":case"sylk":return ma(pS.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"htm":case"html":return ma(e2(e.Sheets[e.SheetNames[a]],r),r);case"txt":return NM(c2(e.Sheets[e.SheetNames[a]],r),r);case"csv":return ma(ap(e.Sheets[e.SheetNames[a]],r),r,"\uFEFF");case"dif":return ma(mS.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"dbf":return nf(qh.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"prn":return ma(Si.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"rtf":return ma(ES.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"eth":return ma(vS.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"fods":return ma(a2(e,r),r);case"wk1":return nf(oo.sheet_to_wk1(e.Sheets[e.SheetNames[a]],r),r);case"wk3":return nf(oo.book_to_wk3(e,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),nf(ZS(e,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),LM(e,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return FM(e,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function MM(e,t,r,n,a,s,i,c){var u=rr(r),f=c.defval,h=c.raw||!Object.prototype.hasOwnProperty.call(c,"raw"),p=!0,m=a===1?[]:{};if(a!==1)if(Object.defineProperty)try{Object.defineProperty(m,"__rowNum__",{value:r,enumerable:!1})}catch{m.__rowNum__=r}else m.__rowNum__=r;if(!i||e[r])for(var y=t.s.c;y<=t.e.c;++y){var w=i?e[r][y]:e[n[y]+u];if(w===void 0||w.t===void 0){if(f===void 0)continue;s[y]!=null&&(m[s[y]]=f);continue}var x=w.v;switch(w.t){case"z":if(x==null)break;continue;case"e":x=x==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+w.t)}if(s[y]!=null){if(x==null)if(w.t=="e"&&x===null)m[s[y]]=null;else if(f!==void 0)m[s[y]]=f;else if(h&&x===null)m[s[y]]=null;else continue;else m[s[y]]=h&&(w.t!=="n"||w.t==="n"&&c.rawNumbers!==!1)?x:$a(w,x,c);x!=null&&(p=!1)}}return{row:m,isempty:p}}function Tf(e,t){if(e==null||e["!ref"]==null)return[];var r={t:"n",v:0},n=0,a=1,s=[],i=0,c="",u={s:{r:0,c:0},e:{r:0,c:0}},f=t||{},h=f.range!=null?f.range:e["!ref"];switch(f.header===1?n=1:f.header==="A"?n=2:Array.isArray(f.header)?n=3:f.header==null&&(n=0),typeof h){case"string":u=mt(h);break;case"number":u=mt(e["!ref"]),u.s.r=h;break;default:u=h}n>0&&(a=0);var p=rr(u.s.r),m=[],y=[],w=0,x=0,_=Array.isArray(e),E=u.s.r,k=0,b={};_&&!e[E]&&(e[E]=[]);var O=f.skipHidden&&e["!cols"]||[],z=f.skipHidden&&e["!rows"]||[];for(k=u.s.c;k<=u.e.c;++k)if(!(O[k]||{}).hidden)switch(m[k]=zt(k),r=_?e[E][k]:e[m[k]+p],n){case 1:s[k]=k-u.s.c;break;case 2:s[k]=m[k];break;case 3:s[k]=f.header[k-u.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),c=i=$a(r,null,f),x=b[i]||0,!x)b[i]=1;else{do c=i+"_"+x++;while(b[c]);b[i]=x,b[c]=1}s[k]=c}for(E=u.s.r+a;E<=u.e.r;++E)if(!(z[E]||{}).hidden){var L=MM(e,u,E,m,n,s,_,f);(L.isempty===!1||(n===1?f.blankrows!==!1:f.blankrows))&&(y[w++]=L.row)}return y.length=w,y}var Gx=/"/g;function BM(e,t,r,n,a,s,i,c){for(var u=!0,f=[],h="",p=rr(r),m=t.s.c;m<=t.e.c;++m)if(n[m]){var y=c.dense?(e[r]||[])[m]:e[n[m]+p];if(y==null)h="";else if(y.v!=null){u=!1,h=""+(c.rawNumbers&&y.t=="n"?y.v:$a(y,null,c));for(var w=0,x=0;w!==h.length;++w)if((x=h.charCodeAt(w))===a||x===s||x===34||c.forceQuotes){h='"'+h.replace(Gx,'""')+'"';break}h=="ID"&&(h='"ID"')}else y.f!=null&&!y.F?(u=!1,h="="+y.f,h.indexOf(",")>=0&&(h='"'+h.replace(Gx,'""')+'"')):h="";f.push(h)}return c.blankrows===!1&&u?null:f.join(i)}function ap(e,t){var r=[],n=t??{};if(e==null||e["!ref"]==null)return"";var a=mt(e["!ref"]),s=n.FS!==void 0?n.FS:",",i=s.charCodeAt(0),c=n.RS!==void 0?n.RS:`
`,u=c.charCodeAt(0),f=new RegExp((s=="|"?"\\|":s)+"+$"),h="",p=[];n.dense=Array.isArray(e);for(var m=n.skipHidden&&e["!cols"]||[],y=n.skipHidden&&e["!rows"]||[],w=a.s.c;w<=a.e.c;++w)(m[w]||{}).hidden||(p[w]=zt(w));for(var x=0,_=a.s.r;_<=a.e.r;++_)(y[_]||{}).hidden||(h=BM(e,a,_,p,i,u,s,n),h!=null&&(n.strip&&(h=h.replace(f,"")),(h||n.blankrows!==!1)&&r.push((x++?c:"")+h)));return delete n.dense,r.join("")}function c2(e,t){t||(t={}),t.FS="	",t.RS=`
`;var r=ap(e,t);return r}function jM(e){var t="",r,n="";if(e==null||e["!ref"]==null)return[];var a=mt(e["!ref"]),s="",i=[],c,u=[],f=Array.isArray(e);for(c=a.s.c;c<=a.e.c;++c)i[c]=zt(c);for(var h=a.s.r;h<=a.e.r;++h)for(s=rr(h),c=a.s.c;c<=a.e.c;++c)if(t=i[c]+s,r=f?(e[h]||[])[c]:e[t],n="",r!==void 0){if(r.F!=null){if(t=r.F,!r.f)continue;n=r.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}u[u.length]=t+"="+n}return u}function u2(e,t,r){var n=r||{},a=+!n.skipHeader,s=e||{},i=0,c=0;if(s&&n.origin!=null)if(typeof n.origin=="number")i=n.origin;else{var u=typeof n.origin=="string"?Vt(n.origin):n.origin;i=u.r,c=u.c}var f,h={s:{c:0,r:0},e:{c,r:i+t.length-1+a}};if(s["!ref"]){var p=mt(s["!ref"]);h.e.c=Math.max(h.e.c,p.e.c),h.e.r=Math.max(h.e.r,p.e.r),i==-1&&(i=p.e.r+1,h.e.r=i+t.length-1+a)}else i==-1&&(i=0,h.e.r=t.length-1+a);var m=n.header||[],y=0;t.forEach(function(x,_){Xt(x).forEach(function(E){(y=m.indexOf(E))==-1&&(m[y=m.length]=E);var k=x[E],b="z",O="",z=qe({c:c+y,r:i+_+a});f=lc(s,z),k&&typeof k=="object"&&!(k instanceof Date)?s[z]=k:(typeof k=="number"?b="n":typeof k=="boolean"?b="b":typeof k=="string"?b="s":k instanceof Date?(b="d",n.cellDates||(b="n",k=pr(k)),O=n.dateNF||Ge[14]):k===null&&n.nullError&&(b="e",k=0),f?(f.t=b,f.v=k,delete f.w,delete f.R,O&&(f.z=O)):s[z]=f={t:b,v:k},O&&(f.z=O))})}),h.e.c=Math.max(h.e.c,c+m.length-1);var w=rr(i);if(a)for(y=0;y<m.length;++y)s[zt(y+c)+w]={t:"s",v:m[y]};return s["!ref"]=rt(h),s}function $M(e,t){return u2(null,e,t)}function lc(e,t,r){if(typeof t=="string"){if(Array.isArray(e)){var n=Vt(t);return e[n.r]||(e[n.r]=[]),e[n.r][n.c]||(e[n.r][n.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?lc(e,qe(t)):lc(e,qe({r:t,c:r||0}))}function UM(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function sp(){return{SheetNames:[],Sheets:{}}}function op(e,t,r,n){var a=1;if(!r)for(;a<=65535&&e.SheetNames.indexOf(r="Sheet"+a)!=-1;++a,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&e.SheetNames.indexOf(r)>=0){var s=r.match(/(^.*?)(\d+)$/);a=s&&+s[2]||0;var i=s&&s[1]||r;for(++a;a<=65535&&e.SheetNames.indexOf(r=i+a)!=-1;++a);}if(qS(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function zM(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var n=UM(e,t);switch(e.Workbook.Sheets[n]||(e.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[n].Hidden=r}function VM(e,t){return e.z=t,e}function f2(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}function WM(e,t,r){return f2(e,"#"+t,r)}function HM(e,t,r){e.c||(e.c=[]),e.c.push({t,a:r||"SheetJS"})}function GM(e,t,r,n){for(var a=typeof t!="string"?t:mt(t),s=typeof t=="string"?t:rt(t),i=a.s.r;i<=a.e.r;++i)for(var c=a.s.c;c<=a.e.c;++c){var u=lc(e,i,c);u.t="n",u.F=s,delete u.v,i==a.s.r&&c==a.s.c&&(u.f=r,n&&(u.D=!0))}return e}var Fa={encode_col:zt,encode_row:rr,encode_cell:qe,encode_range:rt,decode_col:Lg,decode_row:Rg,split_cell:a3,decode_cell:Vt,decode_range:fn,format_cell:$a,sheet_add_aoa:B_,sheet_add_json:u2,sheet_add_dom:t2,aoa_to_sheet:Fi,json_to_sheet:$M,table_to_sheet:r2,table_to_book:eM,sheet_to_csv:ap,sheet_to_txt:c2,sheet_to_json:Tf,sheet_to_html:e2,sheet_to_formulae:jM,sheet_to_row_object_array:Tf,sheet_get_cell:lc,book_new:sp,book_append_sheet:op,book_set_sheet_visibility:zM,cell_set_number_format:VM,cell_set_hyperlink:f2,cell_set_internal_link:WM,cell_add_comment:HM,sheet_set_array_formula:GM,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};(async()=>{if(jA()){console.log(" Detectados datos antiguos en localStorage, migrando a IndexedDB...");try{await $A(),UA();try{localStorage.setItem("virtual_zone_migration_done","true")}catch{}console.log(" Migracin completada exitosamente")}catch(e){console.error(" Error durante la migracin:",e),console.log(" Continuando con datos existentes...")}}else console.log(" No se requiere migracin de datos")})();setTimeout(()=>{const e=localStorage.getItem("virtual_zone_players"),t=e&&e.length>1e4;!localStorage.getItem("virtual_zone_salaries_updated")&&!t?(console.log(" Iniciando La Virtual Zone - Ajustando datos de mercado (primera vez)..."),va()):console.log(" Datos de mercado ya inicializados o datos existentes preservados")},1e3);setTimeout(()=>{console.log(" Sincronizando torneos con clubes actuales..."),Z(async()=>{const{useDataStore:e}=await Promise.resolve().then(()=>Kl);return{useDataStore:e}},void 0).then(({useDataStore:e})=>{e.getState().initializeTournamentSync(),console.log(" Torneos sincronizados con clubes actuales")})},1500);setTimeout(()=>{window.updatePlayerMarketData=va,window.forceCompleteMarketUpdate=Dw,window.checkCompleteMarketStatus=Lw,window.refreshClubsFromSeed=async()=>{console.log(" Refrescando clubes desde datos seed..."),console.log(` Intentando guardar ${lt.length} clubes...`);try{localStorage.removeItem("virtual_zone_clubs"),localStorage.removeItem("virtual_zone_clubs_updated"),await En(lt),localStorage.setItem("virtual_zone_clubs_updated","true");const e=await $t();if(console.log(` Guardados ${e.length} clubes en IndexedDB`),e.length!==lt.length){console.error(` ERROR: Se esperaban ${lt.length} clubes pero se guardaron ${e.length}`),console.log(" Intentando guardar nuevamente..."),await En(lt);const t=await $t();console.log(` Reintento: ${t.length} clubes guardados`)}typeof window<"u"&&window.useDataStore&&(await window.useDataStore.getState().refreshClubs(),console.log(" Store de datos refrescado")),console.log(` Proceso completado: ${e.length} clubes disponibles`)}catch(e){console.error(" Error al refrescar clubes:",e)}},window.refreshUsersFromSeed=()=>{console.log(" Refrescando usuarios desde datos seed..."),localStorage.removeItem("virtual_zone_users");const e=Gl.map(t=>({...t,clubId:void 0,club:void 0}));localStorage.setItem("virtual_zone_users",JSON.stringify(e)),console.log(` Refrescados ${e.length} usuarios desde seed data`),console.log(" Todos los DTs ahora estn disponibles (sin club asignado)")},window.countMatches=async()=>{try{console.log(" Contando partidos...");const e=await Nf();console.log(`
 ESTADSTICAS DE PARTIDOS:`),console.log(""),console.log(`Total de partidos: ${e.length}`),console.log(`
Por estado:`),console.log(`   Programados: ${e.filter(r=>r.status==="scheduled").length}`),console.log(`   En vivo: ${e.filter(r=>r.status==="live").length}`),console.log(`   Finalizados: ${e.filter(r=>r.status==="finished").length}`);const t={};return e.forEach(r=>{const n=r.tournamentId||"Sin torneo";t[n]||(t[n]=0),t[n]++}),Object.keys(t).length>0&&(console.log(`
Por torneo:`),Object.entries(t).forEach(([r,n])=>{console.log(`   ${r}: ${n} partidos`)})),e.length>0&&(console.log(`
Primeros 5 partidos:`),e.slice(0,5).forEach((r,n)=>{console.log(`  ${n+1}. ${r.homeTeam} vs ${r.awayTeam} (${r.status})`)})),console.log(`
`),{total:e.length,scheduled:e.filter(r=>r.status==="scheduled").length,live:e.filter(r=>r.status==="live").length,finished:e.filter(r=>r.status==="finished").length,byTournament:t}}catch(e){return console.error(" Error contando partidos:",e),null}},window.forceUpdateClubs=async()=>{console.log(" Forzando actualizacin completa de clubes...");try{localStorage.removeItem("virtual_zone_clubs"),localStorage.removeItem("virtual_zone_clubs_updated"),localStorage.removeItem("virtual_zone_initialized");for(let t=localStorage.length-1;t>=0;t--){const r=localStorage.key(t);r&&(r.includes("club")||r.includes("player"))&&localStorage.removeItem(r)}console.log(` Guardando ${lt.length} clubes...`),await En(lt),localStorage.setItem("virtual_zone_clubs_updated","true");const e=await $t();if(console.log(` Verificacin: ${e.length} clubes guardados`),e.length!==lt.length){console.error(` ERROR: Se esperaban ${lt.length} pero se guardaron ${e.length}`),console.log(" Intentando guardar nuevamente..."),await En(lt);const t=await $t();console.log(` Resultado final: ${t.length} clubes`)}typeof window<"u"&&window.useDataStore&&(await window.useDataStore.getState().refreshClubs(),console.log(" Store refrescado")),console.log(` Actualizacin forzada completada: ${e.length} clubes disponibles`)}catch(e){console.error(" Error en forceUpdateClubs:",e)}},window.seedClubs=lt,window.forceUpdatePlayers=()=>{console.log(" ADVERTENCIA: Esta funcin regenerar TODOS los jugadores desde datos seed"),console.log("Esto BORRAR todas las ediciones y cambios realizados por usuarios"),console.log("Ests seguro? Si no quieres perder los cambios, usa forceRegeneratePlayersFromSeed() en su lugar"),confirm("Ests seguro de que quieres regenerar TODOS los jugadores? Esto borrar todas las ediciones.")?(localStorage.removeItem("virtual_zone_players"),localStorage.removeItem("virtual_zone_players_updated"),Sr(er),localStorage.setItem("virtual_zone_players_updated","true"),console.log(` Regenerados ${er.length} jugadores desde datos seed (${lt.length} clubes  23 jugadores)`),console.log(" Recarga la pgina para ver los cambios")):console.log(" Operacin cancelada")},window.forceRegeneratePlayersFromSeed=()=>{console.log(" Regenerando jugadores desde datos seed (preservando estructura)..."),localStorage.removeItem("virtual_zone_players"),localStorage.removeItem("virtual_zone_players_updated"),dg(),localStorage.setItem("virtual_zone_players_updated","true");const e=$r();console.log(` Regenerados ${e.length} jugadores desde datos seed usando regeneratePlayersFromService()`),console.log(" Recarga la pgina para ver los cambios")},window.checkClubsStatus=async()=>{const e=await $t(),t=await $r(),r=lt.length*23;console.log(" Estado actual de clubes:"),console.log(`- Clubes en localStorage: ${e.length}`),console.log(`- Clubes en seed data: ${lt.length}`),console.log(`- Estado clubes actualizado: ${localStorage.getItem("virtual_zone_clubs_updated")?"":""}`),console.log(`
 Estado actual de jugadores:`),console.log(`- Jugadores en localStorage: ${t.length}`),console.log(`- Jugadores esperados: ${r}`),console.log(`- Estado jugadores actualizado: ${localStorage.getItem("virtual_zone_players_updated")?"":""}`),console.log(`
 Clubes actuales:`),e.slice(0,10).forEach((a,s)=>{console.log(`  ${s+1}. ${a.name} (${a.id})`)}),e.length>10&&console.log(`  ... y ${e.length-10} clubes ms`);const n=e.filter(a=>a.id.startsWith("club4")&&parseInt(a.id.replace("club",""))>=41);console.log(`
 Clubes nuevos (41-48): ${n.length} encontrados`),n.length>0&&n.forEach(a=>console.log(`   ${a.name}`)),console.log(`
 Resumen: ${e.length===lt.length&&t.length===r?" Todo correcto":" Problema detectado"}`)},window.testRefreshUsersButton=()=>{console.log(' Probando el botn "Refrescar" de la seccin Usuarios...');const e=Dh();console.log(` Estado inicial: ${e.length} usuarios`),console.log(`
1 Ejecutando refreshUsersFromSeed()...`);try{window.refreshUsersFromSeed(),console.log(" refreshUsersFromSeed() ejecutado")}catch(t){console.log(" Error ejecutando refreshUsersFromSeed():",t);return}setTimeout(()=>{console.log(`
2 Verificando estado despus del refresh...`);const t=Dh();console.log(` Estado despus: ${t.length} usuarios`);const r=e.length!==t.length;console.log(` Cantidad de usuarios cambi: ${r?"S":"NO"}`);const n=Gl.length;console.log(` Usuarios esperados en seed: ${n}`);const a=t.length===n;return console.log(` Datos consistentes: ${a?"S":"NO"}`),a?(console.log(`
 El botn "Refrescar" funciona correctamente!`),console.log("Los usuarios han sido restaurados desde los datos seed.")):(console.log(`
 Posible problema con el botn "Refrescar"`),console.log("La cantidad de usuarios no coincide con los datos seed.")),console.log(`
 Ejemplo de usuarios restaurados:`),t.slice(0,3).forEach((s,i)=>{console.log(`   ${i+1}. ${s.username} (${s.email}) - Rol: ${s.role}`)}),{success:a,initialCount:e.length,finalCount:t.length,expectedCount:n,users:t}},1e3)},window.testRefreshClubsButton=async()=>{console.log(' Probando el botn "Refrescar" de la seccin Clubes...');const e=await $t();console.log(` Estado inicial: ${e.length} clubes`),console.log(`
1 Ejecutando refreshClubsFromSeed()...`);try{window.refreshClubsFromSeed(),console.log(" refreshClubsFromSeed() ejecutado")}catch(t){console.log(" Error ejecutando refreshClubsFromSeed():",t);return}setTimeout(async()=>{console.log(`
2 Verificando estado despus del refresh...`);const t=await $t();console.log(` Estado despus: ${t.length} clubes`);const r=e.length!==t.length;console.log(` Cantidad de clubes cambi: ${r?"S":"NO"}`);const n=window.seedClubs?window.seedClubs.length:"desconocido";console.log(` Clubes esperados en seed: ${n}`);const a=t.length===parseInt(n);return console.log(` Datos consistentes: ${a?"S":"NO"}`),a?(console.log(`
 El botn "Refrescar" funciona correctamente!`),console.log("Los clubes han sido restaurados desde los datos seed.")):(console.log(`
 Posible problema con el botn "Refrescar"`),console.log("La cantidad de clubes no coincide con los datos seed.")),console.log(`
 Ejemplo de clubes restaurados:`),t.slice(0,3).forEach((s,i)=>{console.log(`   ${i+1}. ${s.name} (${s.id}) - Presupuesto: ${s.budget.toLocaleString()}`)}),{success:a,initialCount:e.length,finalCount:t.length,expectedCount:parseInt(n),clubs:t}},1500)},window.checkClubBackupStatus=()=>{console.log(" Verificando estado de backups de clubes...");const e=localStorage.getItem("virtual_zone_clubs_backup"),t=localStorage.getItem("virtual_zone_clubs_updated");if(console.log(` Flag de actualizacin: ${t?" Presente":" Ausente"}`),e)try{const r=JSON.parse(e);console.log(` Backup encontrado: ${r.length} clubes`),r.length>0&&(console.log(" Muestra de backup:"),r.slice(0,3).forEach((n,a)=>{console.log(`  ${a+1}. ${n.name} (${n.budget?.toLocaleString()||"N/A"})`)})),$t().then(n=>{const a=r.filter(s=>!n.some(i=>i.id===s.id));a.length>0?console.log(` ${a.length} clubes en backup no estn en BD actual`):console.log(" Backup sincronizado con BD actual")})}catch(r){console.error(" Error parseando backup:",r)}else console.log(" No hay backup disponible");return{hasBackup:!!e,isUpdated:t==="true",backupSize:e?e.length:0}},window.checkClubChangesPersistence=()=>{console.log(" Verificando persistencia de cambios en clubes...");const e=$t(),r=window.useDataStore?.getState()?.clubs||[];console.log(` Total de clubes: ${e.length} (IndexedDB) vs ${r.length} (Store)`);const n=[];e.forEach((s,i)=>{const c=r.find(u=>u.id===s.id);if(c){const u={id:s.id,name:s.name,differences:{}};["name","logo","budget","playStyle","manager"].forEach(f=>{s[f]!==c[f]&&(u.differences[f]={indexeddb:s[f],store:c[f]})}),Object.keys(u.differences).length>0&&n.push(u)}else n.push({id:s.id,name:s.name,issue:"Club existe en IndexedDB pero no en Store"})}),n.length===0?console.log(" Todos los clubes estn sincronizados correctamente entre IndexedDB y Store"):(console.log(" Se encontraron diferencias:"),n.forEach(s=>console.log("  ",s)));const a=e.filter(s=>s.name.includes("Editado")||s.budget>1e8);return console.log(` Clubes con posibles cambios recientes: ${a.length}`),a.slice(0,3).forEach(s=>{console.log(`   ${s.name}: Presupuesto ${s.budget.toLocaleString()}`)}),{totalClubs:e.length,storeClubs:r.length,differences:n.length,recentChanges:a.length,isSynchronized:n.length===0}},window.diagnoseClubsIssue=()=>{console.log(" Diagnstico completo de clubes:"),console.log(` Datos seed: ${lt.length} clubes`),$t().then(e=>{console.log(` Datos en IndexedDB: ${e.length} clubes`);const t=lt.map(c=>c.id).sort(),r=e.map(c=>c.id).sort(),n=t.filter(c=>!r.includes(c)),a=r.filter(c=>!t.includes(c));if(console.log(` Clubes faltantes: ${n.length}`,n),console.log(` Clubes extra: ${a.length}`,a),typeof window<"u"&&window.useDataStore){const c=window.useDataStore.getState();console.log(` Datos en store: ${c.clubs?.length||0} clubes`),console.log(` Store inicializado: ${c.isDataLoaded}`)}console.log(" Primeros 5 clubes en seed:"),lt.slice(0,5).forEach((c,u)=>console.log(`  ${u+1}. ${c.name} (${c.id})`)),console.log(" Primeros 5 clubes en DB:"),e.slice(0,5).forEach((c,u)=>console.log(`  ${u+1}. ${c.name} (${c.id})`));const s=e.length===lt.length,i=n.length===0;return console.log(`
 Todos los clubes presentes: ${s}`),console.log(` IDs correctos: ${i}`),(!s||!i)&&console.log(`
 SOLUCIN: Ejecutar window.forceUpdateClubs() para restaurar todos los clubes`),{seedCount:lt.length,dbCount:e.length,missingClubs:n,extraClubs:a,hasAllClubs:s,hasCorrectIds:i}}).catch(e=>{console.error(" Error al acceder a IndexedDB:",e)})},window.checkClubFinances=e=>{const t=$r(),r=$t(),n=localStorage.getItem("virtual_zone_transfers"),a=n?JSON.parse(n):[],s=r.find(E=>E.name.toLowerCase().replace(/\s+/g,"-")===e?.toLowerCase().replace(/\s+/g,"-"));if(!s){console.log(` Club "${e}" no encontrado`),console.log("Clubes disponibles:",r.map(E=>E.name).slice(0,5));return}console.log(` Verificando finanzas de: ${s.name}`),console.log(` Presupuesto base: ${s.budget.toLocaleString()}`);const i=t.filter(E=>E.clubId===s.id),c=a.filter(E=>E.fromClub===s.name||E.toClub===s.name);console.log(`
 Plantilla:`),console.log(`    ${i.length} jugadores`),console.log(`    Media general: ${i.length>0?Math.round(i.reduce((E,k)=>E+k.overall,0)/i.length):0}`);const u=i.reduce((E,k)=>E+(k.transferValue||k.value||0),0),f=i.reduce((E,k)=>E+(k.contract?.salary||0),0),h=c.filter(E=>E.fromClub===s.name).reduce((E,k)=>E+(k.fee||k.value||0),0),p=c.filter(E=>E.toClub===s.name).reduce((E,k)=>E+(k.fee||k.value||0),0),m=h,y=p+f,w=m-y,x=s.budget+w;console.log(`    Valor de mercado: ${u.toLocaleString()}`),console.log(`    Salarios totales: ${f.toLocaleString()}`),console.log(`
 Balance financiero:`),console.log(`    Ingresos por ventas: +${h.toLocaleString()}`),console.log(`    Gastos por compras: -${p.toLocaleString()}`),console.log(`    Gastos por salarios: -${f.toLocaleString()}`),console.log(`    Balance neto: ${w>=0?"+":""}${w.toLocaleString()}`),console.log(`    Valor neto total: ${x.toLocaleString()}`),console.log(`
 Transferencias (${c.length}):`),c.slice(0,5).forEach(E=>{const k=E.toClub===s.name;console.log(`    ${E.playerName}: ${E.fromClub}  ${E.toClub} (${k?"-":"+"}${(E.fee||E.value||0).toLocaleString()})`)}),c.length>5&&console.log(`   ... y ${c.length-5} transferencias ms`);const _=[];return i.length===0&&_.push("No hay jugadores en la plantilla"),f===0&&i.length>0&&_.push("Los jugadores no tienen salarios asignados"),u===0&&i.length>0&&_.push("Los jugadores no tienen valores de mercado"),_.length>0?(console.log(`
 Posibles problemas:`),_.forEach(E=>console.log(`    ${E}`))):console.log(`
 Datos de finanzas parecen correctos`),{club:s.name,players:i.length,transfers:c.length,budget:s.budget,squadValue:u,totalSalaries:f,income:h,expenses:p,netBalance:w,netWorth:x,issues:_}},window.testSalaryValueAdjustments=()=>{console.log(" Probando funciones de ajuste de salarios y valores...");const e=window.checkDataIntegrity();console.log(`
 ADVERTENCIA: Estos botones ahora ajustan TODOS los valores segn tablas de mercado`),console.log("Esto sobrescribir cualquier edicin manual que hayas hecho"),confirm("Ests seguro de ejecutar la prueba? Esto cambiar TODOS los salarios y valores.")?(console.log(`
1 Probando ajuste de salarios...`),Z(async()=>{const{adjustAllPlayerSalaries:t}=await Promise.resolve().then(()=>Pv);return{adjustAllPlayerSalaries:t}},void 0).then(({adjustAllPlayerSalaries:t})=>{const r=t();console.log(`Resultado: ${r.updated} jugadores ajustados`),console.log(`
2 Probando ajuste de valores de mercado...`),Z(async()=>{const{adjustAllPlayerMarketValues:n}=await Promise.resolve().then(()=>Pv);return{adjustAllPlayerMarketValues:n}},void 0).then(({adjustAllPlayerMarketValues:n})=>{const a=n();console.log(`Resultado: ${a.updated} jugadores ajustados`),console.log(`
3 Verificando estado final...`);const s=window.checkDataIntegrity();console.log(`
 Comparacin antes/despus:`),console.log("- Todos los salarios ajustados a valores de tabla de mercado"),console.log("- Todos los valores de mercado ajustados a valores de tabla de mercado"),console.log(`- Imgenes personalizadas: ${e.playersWithImages}  ${s.playersWithImages} (deberan preservarse)`);const i=s.playersWithImages===e.playersWithImages;return console.log(`
${i?"":""} Prueba ${i?"EXITOSA":"FALLIDA"}`),console.log(i?"Las imgenes se preservaron correctamente, pero salarios y valores fueron ajustados!":"ERROR: Las imgenes tambin se perdieron"),{salaryAdjustments:r.updated,valueAdjustments:a.updated,imagesPreserved:i,initial:e,final:s}})})):console.log(" Prueba cancelada por el usuario")},window.checkDataIntegrity=()=>{const e=$r(),t=$t(),r=localStorage.getItem("virtual_zone_transfers");console.log(" Verificando integridad de datos:"),console.log(`- Jugadores en localStorage: ${e.length}`),console.log(`- Clubes en localStorage: ${t.length}`),console.log(`- Transfers en localStorage: ${r?JSON.parse(r).length:0}`);const n=e.filter(f=>(f.contract?.salary||0)>1e5||(f.transferValue||0)>5e5),a=e.filter(f=>f.image&&f.image!=="/default.png"),s=e.filter(f=>(f.contract?.salary||0)<1e5&&(f.contract?.salary||0)>0),i=e.filter(f=>(f.transferValue||0)<5e5&&(f.transferValue||0)>0);console.log(`- Jugadores con datos editados: ${n.length}`),console.log(`- Jugadores con imgenes personalizadas: ${a.length}`),console.log(`- Jugadores con salarios bajos (< 100k): ${s.length}`),console.log(`- Jugadores con valores bajos (< 500k): ${i.length}`);const c=localStorage.getItem("virtual_zone_salaries_updated"),u=localStorage.getItem("virtual_zone_market_values_updated");return console.log(`- Salarios actualizados: ${c?"":""}`),console.log(`- Valores de mercado actualizados: ${u?"":""}`),n.length>0&&(console.log(" Se detectaron datos editados manualmente"),console.log(' Los botones "Ajustar Salarios/Valores" SOBRESCRIBIRN estos valores')),console.log(' Los botones "Ajustar Salarios/Valores" funcionarn en TODOS los casos:'),console.log(`    Afectarn a todos los ${e.length} jugadores`),console.log("    Ajustarn salarios y valores segn tablas de mercado oficiales"),console.log("    PRESERVARN las imgenes personalizadas"),a.length>0&&(console.log(" Jugadores con imgenes personalizadas:"),a.slice(0,3).forEach(f=>{console.log(`    ${f.name}: ${f.image.startsWith("data:")?"Base64":"URL"} (${f.image.length} chars)`)})),{players:e.length,clubs:t.length,transfers:r?JSON.parse(r).length:0,editedPlayers:n.length,playersWithImages:a.length,lowSalaryPlayers:s.length,lowValuePlayers:i.length,salariesUpdated:!!c,marketValuesUpdated:!!u}},window.exportPlayersData=()=>{console.log(" Exportando datos de jugadores a Excel...");try{const{useDataStore:e}=require("./store/dataStore"),t=e.getState().players,r=e.getState().clubs;if(!t||t.length===0){console.error(" No hay jugadores para exportar");return}(async()=>{try{const n=(x,_=1e3)=>!x||x.length<=_?x:x.substring(0,_-3)+"...",a=x=>{if(!x)return"";try{const E=new URL(x).pathname;return E.substring(E.lastIndexOf("/")+1)||n(x,100)}catch{return n(x,100)}},s=t.map(x=>({ID:x.id,Nombre:n(x.name,100),Edad:x.age,Posicin:x.position,Media:x.overall,Valor:x.transferValue,Salario:x.contract?.salary||0,Club:n(r.find(_=>_.id===x.clubId)?.name||"Sin club",50),Imagen:a(x.image||""),Altura:x.height||"",Peso:x.weight||"",Nacionalidad:n(x.nationality||"",50),Dorsal:x.dorsal||"",Ataque:x.attributes?.shooting||"",Defensa:x.attributes?.defending||"",Velocidad:x.attributes?.pace||"",Tcnica:x.attributes?.passing||"",Fuerza:x.attributes?.physical||"",Mental:x.attributes?.defending||"",Portera:x.attributes?.goalkeeping||"",Resistencia_Lesiones:x.injuryResistance||2,Partidos:x.matches||0,Transferible:x.transferListed?"S":"No"})),i=Fa.json_to_sheet(s),c=[{wch:15},{wch:25},{wch:8},{wch:12},{wch:8},{wch:12},{wch:12},{wch:20},{wch:30},{wch:10},{wch:10},{wch:15},{wch:8},{wch:8},{wch:8},{wch:10},{wch:8},{wch:8},{wch:8},{wch:10},{wch:18},{wch:10},{wch:12}];i["!cols"]=c;const u=Fa.book_new();Fa.book_append_sheet(u,i,"Jugadores");const f=[{Propiedad:"Versin",Valor:"1.0"},{Propiedad:"Fecha Exportacin",Valor:new Date().toISOString()},{Propiedad:"Total Jugadores",Valor:t.length},{Propiedad:"Aplicacin",Valor:"Virtual Zone"}],h=Fa.json_to_sheet(f);Fa.book_append_sheet(u,h,"Metadata");const p=l2(u,{bookType:"xlsx",type:"array"}),m=new Blob([p],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),y=URL.createObjectURL(m),w=document.createElement("a");w.href=y,w.download=`virtual-zone-players-${new Date().toISOString().split("T")[0]}.xlsx`,document.body.appendChild(w),w.click(),document.body.removeChild(w),URL.revokeObjectURL(y),console.log(` Exportados ${t.length} jugadores a Excel`)}catch(n){console.error(" Error procesando XLSX:",n)}})().catch(n=>{console.error(" Error en la funcin de exportacin:",n)})}catch(e){console.error(" Error exportando jugadores:",e)}},window.importPlayersData=e=>{console.log(" Importando datos de jugadores...");try{if(e instanceof ArrayBuffer||e instanceof Uint8Array)(async()=>{try{const t=Yh(e,{type:"array"}),n=["Jugadores","Atributos","Habilidades","Estilos_Juego"].filter(w=>!t.SheetNames.includes(w));if(n.length>0)throw new Error(`El archivo Excel no contiene las hojas requeridas: ${n.join(", ")}`);const a=Fa.sheet_to_json(t.Sheets.Jugadores),s=Fa.sheet_to_json(t.Sheets.Atributos),i=Fa.sheet_to_json(t.Sheets.Habilidades),c=Fa.sheet_to_json(t.Sheets.Estilos_Juego),{useDataStore:u}=require("./store/dataStore"),f=u.getState(),h=f.clubs,y=a.map((w,x)=>{const _=w.ID;if(!_)return console.warn(`Player at index ${x} has no ID, skipping`),null;const E=s.find(he=>he.ID===_),k=i.find(he=>he.ID===_),b=c.find(he=>he.ID===_),O=(w.ID_Club??w.Club_ID??w.ClubId??w["ID Club"]??w.Id_Club??w.id_club??w.IDCLUB??w.IdClub??"").toString().trim(),z=(w.Club??"").toString().trim(),L=O.toLowerCase(),P=z.toLowerCase(),J=L==="libre"||L==="free"||O===""||O==="0"||P==="libre"||P==="free",V=!J&&O?h.find(he=>he.id===O):void 0,le=!J&&z?h.find(he=>he.name===z):void 0,ee=V||le;return{id:_,name:w.Nombre||`Jugador ${x+1}`,age:parseInt(w.Edad)||20,position:w.Posicin||"DC",overall:parseInt(w.Media)||50,transferValue:parseInt(w.Valor)||0,clubId:J?"libre":ee?.id||void 0,image:w.Imagen||void 0,height:w.Altura?parseInt(w.Altura):void 0,weight:w.Peso?parseInt(w.Peso):void 0,nationality:w.Nacionalidad||"Argentina",dorsal:w.Dorsal?parseInt(w.Dorsal):void 0,injuryResistance:parseInt(w.Resistencia_Lesiones)||2,matches:parseInt(w.Partidos)||0,transferListed:w.Transferible==="S",contract:{salary:parseInt(w.Salario)||0,expires:new Date(new Date().setFullYear(new Date().getFullYear()+3)).toISOString()},attributes:{shooting:E&&(parseInt(E.Tiro)||parseInt(E.Ataque))||40,defending:E&&(parseInt(E.Defensa_Legacy)||parseInt(E.Defensa))||40,pace:E&&(parseInt(E.Ritmo)||parseInt(E.Velocidad))||40,passing:E&&(parseInt(E.Pase)||parseInt(E.Tcnica))||40,physical:E&&(parseInt(E.Fisico)||parseInt(E.Fuerza))||40,goalkeeping:E&&(parseInt(E.Portero_Legacy)||parseInt(E.Portera))||40,offensiveAwareness:E&&parseInt(E.Ataque_Ofensivo)||40,ballControl:E&&parseInt(E.Control_Balon)||40,dribbling:E&&parseInt(E.Dribbling)||40,tightPossession:E&&parseInt(E.Posesion_Balon)||40,lowPass:E&&parseInt(E.Pase_Ras)||40,loftedPass:E&&parseInt(E.Pase_Bomb)||40,finishing:E&&parseInt(E.Finalizacion)||40,heading:E&&parseInt(E.Cabeceador)||40,setPieceTaking:E&&parseInt(E.Balon_Parado)||40,curl:E&&parseInt(E.Efecto)||40,speed:E&&(parseInt(E.Ritmo)||parseInt(E.Velocidad))||40,acceleration:E&&parseInt(E.Aceleracion)||40,kickingPower:E&&parseInt(E.Potencia_Tiro)||40,jumping:E&&parseInt(E.Salto)||40,physicalContact:E&&parseInt(E.Contacto_Fisico)||40,balance:E&&parseInt(E.Equilibrio)||40,stamina:E&&parseInt(E.Resistencia)||40,defensiveAwareness:E&&parseInt(E.Actitud_Defensiva)||40,ballWinning:E&&parseInt(E.Recuperacion_Balon)||40,aggression:E&&parseInt(E.Agresividad)||40,catching:E&&parseInt(E.Agarre)||40,reflexes:E&&parseInt(E.Reflejos)||40,coverage:E&&parseInt(E.Cobertura)||40,gkHandling:E&&parseInt(E.Actitud_Portero)||40},skills:{scissorKick:k&&yesNoToBool(k.Tijera)||!1,doubleTouch:k&&yesNoToBool(k.Doble_Toque)||!1,flipFlap:k&&yesNoToBool(k.Gambeta)||!1,marseilleTurn:k&&yesNoToBool(k.Marsellesa)||!1,rainbow:k&&yesNoToBool(k.Sombrerito)||!1,chopTurn:k&&yesNoToBool(k.Cortada)||!1,cutBehindAndTurn:k&&yesNoToBool(k.Amago_Por_Detras)||!1,scotchMove:k&&yesNoToBool(k.Rebote_Interior)||!1,stepOnSkillControl:k&&yesNoToBool(k.Pisar_Balon)||!1,heading:k&&yesNoToBool(k.Cabeceador)||!1,longRangeDrive:k&&yesNoToBool(k.Caonero)||!1,chipShotControl:k&&yesNoToBool(k.Sombrero)||!1,longRanger:k&&yesNoToBool(k.Tiro_Larga_Distancia)||!1,knuckleShot:k&&yesNoToBool(k.Tiro_Empeine)||!1,dippingShot:k&&yesNoToBool(k.Disparo_Descendente)||!1,risingShot:k&&yesNoToBool(k.Disparo_Ascendente)||!1,acrobaticFinishing:k&&yesNoToBool(k.Finalizacion_Acrobatica)||!1,heelTrick:k&&yesNoToBool(k.Taconazo)||!1,firstTimeShot:k&&yesNoToBool(k.Remate_Primer_Toque)||!1,oneTouchPass:k&&yesNoToBool(k.Pase_Primer_Toque)||!1,throughPassing:k&&yesNoToBool(k.Pase_Profundidad)||!1,weightedPass:k&&yesNoToBool(k.Pase_Profundidad_2)||!1,pinpointCrossing:k&&yesNoToBool(k.Centro_Cruzado)||!1,outsideCurler:k&&yesNoToBool(k.Centro_Rosca)||!1,rabona:k&&yesNoToBool(k.Rabona)||!1,noLookPass:k&&yesNoToBool(k.Pase_Sin_Mirar)||!1,lowLoftedPass:k&&yesNoToBool(k.Pase_Bomb_Bajo)||!1,giantKill:k&&yesNoToBool(k.Patadon_Corto)||!1,longThrow:k&&yesNoToBool(k.Patadon_Largo)||!1,longThrow2:k&&yesNoToBool(k.Saque_Largo_Banda)||!1,gkLongThrow:k&&yesNoToBool(k.Saque_Meta_Largo)||!1,penaltySpecialist:k&&yesNoToBool(k.Especialista_Penales)||!1,gkPenaltySaver:k&&yesNoToBool(k.Parapenales)||!1,fightingSpirit:k&&yesNoToBool(k.Malicia)||!1,manMarking:k&&yesNoToBool(k.Marcar_Hombre)||!1,trackBack:k&&yesNoToBool(k.Delantero_Atrasado)||!1,interception:k&&yesNoToBool(k.Interceptor)||!1,acrobaticClear:k&&yesNoToBool(k.Despeje_Acrobatico)||!1,captaincy:k&&yesNoToBool(k.Capitania)||!1,superSub:k&&yesNoToBool(k.Super_Refuerzo)||!1,comPlayingStyles:k&&yesNoToBool(k.Espiritu_Lucha)||!1},playingStyles:{goalPoacher:b&&yesNoToBool(b.Cazagoles)||!1,dummyRunner:b&&yesNoToBool(b.Seuelo)||!1,foxInTheBox:b&&yesNoToBool(b.Hombre_De_Area)||!1,targetMan:b&&yesNoToBool(b.Referente)||!1,classicNo10:b&&yesNoToBool(b.Creador_De_Jugadas)||!1,prolificWinger:b&&yesNoToBool(b.Extremo_Prolifico)||!1,roamingFlank:b&&yesNoToBool(b.Extremo_Movil)||!1,crossSpecialist:b&&yesNoToBool(b.Especialista_Centros)||!1,holePlayer:b&&yesNoToBool(b.Jugador_Huecos)||!1,boxToBox:b&&yesNoToBool(b.Omnipresente)||!1,theDestroyer:b&&yesNoToBool(b.El_Destructor)||!1,orchestrator:b&&yesNoToBool(b.Organizador)||!1,anchor:b&&yesNoToBool(b.Medio_Escudo)||!1,offensiveFullback:b&&yesNoToBool(b.Lateral_Ofensivo)||!1,fullbackFinisher:b&&yesNoToBool(b.Lateral_Finalizador)||!1,defensiveFullback:b&&yesNoToBool(b.Lateral_Defensivo)||!1,buildUp:b&&yesNoToBool(b.Creacion)||!1,extraFrontman:b&&yesNoToBool(b.Atacante_Extra)||!1,offensiveGoalkeeper:b&&yesNoToBool(b.Portero_Ofensivo)||!1,defensiveGoalkeeper:b&&yesNoToBool(b.Portero_Defensivo)||!1}}}).filter(w=>w!==null).filter(w=>w.id&&w.name&&w.position&&typeof w.overall=="number").map(w=>{const x=!w.clubId||w.clubId==="libre"||w.clubId==="free";return{...w,clubId:x?"libre":w.clubId,transferListed:x?!0:!!w.transferListed}});console.log(`Importando ${y.length} jugadores desde Excel...`),f.updatePlayers(y),console.log(`Importacin completada: ${y.length} jugadores desde Excel`)}catch(t){console.error(" Error procesando XLSX:",t)}})().catch(t=>{console.error(" Error en la funcin de importacin:",t)});else{if(!e||!e.players||!Array.isArray(e.players))throw new Error('Datos invlidos: se esperaba un objeto con array "players"');const{useDataStore:t}=require("./store/dataStore"),r=t.getState(),n=e.players.filter(s=>s.id&&s.name&&s.position&&typeof s.overall=="number");if(n.length===0)throw new Error("No se encontraron jugadores vlidos");console.log(` Importando ${n.length} jugadores desde JSON...`);const a=n.map(s=>{const i=(s.club||s.clubName||"").toString().trim().toLowerCase();if(!s.clubId&&(!i||i==="libre"||i==="free")||s.clubId==="libre"||s.clubId==="free")return{...s,clubId:"libre",transferListed:!0};if(!s.clubId&&i){const u=(r.clubs||[]).find(f=>f.name.toLowerCase()===i);if(u)return{...s,clubId:u.id}}return s});r.updatePlayers(a),console.log(` Importacin completada: ${n.length} jugadores desde JSON`)}}catch(t){console.error(" Error importando jugadores:",t)}},window.testClubPersistence=async()=>{console.log(" Probando persistencia de ediciones de clubes...");let e=0;for(;!window.dataStore&&e<50;)await new Promise(t=>setTimeout(t,100)),e++;try{const t=window.dataStore;if(!t){console.error(" El store global no se inicializ. Revisa la consola para errores.");return}if((!t.clubs||t.clubs.length===0)&&(console.log(" Esperando que se carguen los datos..."),await new Promise(c=>setTimeout(c,1e3)),!t.clubs||t.clubs.length===0)){console.error(" No hay clubes disponibles. Verifica que los datos se hayan cargado correctamente.");return}const r=t.clubs[0];if(!r){console.error(" No hay clubes para probar");return}console.log(` Probando con el club: ${r.name}`),console.log(`   Presupuesto original: ${r.budget}`);const n=r.budget+999999,a={...r,budget:n,description:`Test persistence - ${Date.now()}`};console.log(`   Nuevo presupuesto: ${n}`),console.log(" Guardando cambios..."),await t.updateClub(a),console.log(" Cambios guardados en BD"),console.log(" Verificando persistencia..."),await t.refreshClubs();const i=t.clubs.find(c=>c.id===r.id);if(i&&i.budget===n){console.log(" XITO: Los cambios se mantuvieron correctamente"),console.log(`   Presupuesto verificado: ${i.budget}`),console.log(" Restaurando valor original...");const c={...i,budget:r.budget,description:r.description};await t.updateClub(c),console.log(" Valor restaurado al original"),console.log(" Test completado exitosamente!")}else console.error(" ERROR: Los cambios NO se mantuvieron"),console.log(`   Esperado: ${n}`),console.log(`   Encontrado: ${i?.budget||"undefined"}`),console.log(" Esto indica un problema de persistencia que necesita ser investigado")}catch(t){console.error(" Error en test de persistencia:",t),console.log(" Posibles causas:"),console.log("   - Error de conexin a IndexedDB"),console.log("   - Problema en la funcin updateClub"),console.log("   - Error de permisos de almacenamiento")}},window.cleanLocalStorage=()=>{console.log(" Limpiando localStorage para liberar espacio...");try{const e=Object.keys(localStorage);console.log(` localStorage antes: ${e.length} items`);const t=e.filter(s=>s.includes("backup")||s.includes("virtual_zone")||s.includes("market")||s.includes("player"));console.log(` Encontrados ${t.length} items de backup para limpiar`);const r=t.filter(s=>!s.includes("clubs_updated")&&!s.includes("backup_light"));r.forEach(s=>{localStorage.removeItem(s),console.log(` Eliminado: ${s}`)});const n=Object.keys(localStorage);console.log(` localStorage despus: ${n.length} items`),console.log(` Espacio liberado: ${e.length-n.length} items`);const a=r.length*5e3;console.log(` Tamao aproximado liberado: ~${(a/1024).toFixed(1)} KB`)}catch(e){console.error(" Error limpiando localStorage:",e)}},window.cleanDuplicateUsers=()=>{console.log(" Eliminando usuarios duplicados...");try{Z(()=>Promise.resolve().then(()=>wl),void 0).then(async({listUsers:e,deleteUser:t})=>{const r=e();console.log(` Encontrados ${r.length} usuarios totales`);const n=new Set,a=[];if(r.forEach(s=>{n.has(s.id)?a.push(s):n.add(s.id)}),console.log(` Encontrados ${a.length} usuarios duplicados`),a.length>0){for(const s of a)try{await t(s.id),console.log(` Eliminado usuario duplicado: ${s.username} (ID: ${s.id})`)}catch(i){console.error(` Error eliminando usuario ${s.username}:`,i)}console.log(` Eliminados ${a.length} usuarios duplicados`)}else console.log(" No se encontraron usuarios duplicados")})}catch(e){console.error(" Error limpiando usuarios duplicados:",e)}},window.cleanDuplicateClubs=()=>{console.log(" Eliminando clubes duplicados...");try{Z(()=>Promise.resolve().then(()=>Kd),void 0).then(async e=>{const t=await e.listClubs();console.log(` Encontrados ${t.length} clubes totales`);const r=new Set,n=[];if(t.forEach(a=>{r.has(a.id)?n.push(a):r.add(a.id)}),console.log(` Encontrados ${n.length} clubes duplicados`),n.length>0){for(const a of n)try{await e.deleteClub(a.id),console.log(` Eliminado club duplicado: ${a.name} (ID: ${a.id})`)}catch(s){console.error(` Error eliminando club ${a.name}:`,s)}console.log(` Eliminados ${n.length} clubes duplicados`)}else console.log(" No se encontraron clubes duplicados")})}catch(e){console.error(" Error limpiando clubes duplicados:",e)}},window.checkImportedPlayersPersistence=async()=>{console.log(" Verificando persistencia de jugadores importados...");try{const[e,t]=await Promise.all([$t(),$r()]);console.log(` Datos actuales: ${e.length} clubes, ${t.length} jugadores`);const r=t.filter(s=>s.clubId),n=r.filter(s=>e.some(i=>i.id===s.clubId));if(console.log(` Jugadores con club asignado: ${r.length}/${t.length}`),console.log(` Jugadores con club vlido: ${n.length}/${r.length}`),r.length>n.length){console.log(" PROBLEMA: Algunos jugadores tienen clubs invlidos o inexistentes");const s=r.filter(i=>!e.some(c=>c.id===i.clubId));console.log("Jugadores con club invlido:",s.slice(0,5).map(i=>`${i.name} -> ${i.clubId}`))}const a={};return n.forEach(s=>{const i=e.find(c=>c.id===s.clubId)?.name||"Club desconocido";a[i]=(a[i]||0)+1}),console.log(" Distribucin de jugadores por club:"),Object.entries(a).sort(([,s],[,i])=>i-s).slice(0,10).forEach(([s,i])=>{console.log(`   ${s}: ${i} jugadores`)}),{totalPlayers:t.length,playersWithClub:r.length,playersWithValidClub:n.length,clubsCount:e.length,clubDistribution:a}}catch(e){return console.error(" Error verificando persistencia:",e),null}},window.checkImportDataIntegrity=async()=>{console.log(" Verificando integridad de datos despus de importar...");try{await ht.getAll("clubs"),console.log(" IndexedDB accessible");const e=await $t();console.log(` Clubs cargados: ${e.length}`);const t=await $r();console.log(` Players cargados: ${t.length}`);const r=t.filter(a=>a.clubId),n=r.filter(a=>e.some(s=>s.id===a.clubId));return console.log(` Players con club: ${r.length}`),console.log(` Asignaciones vlidas: ${n.length}`),n.length===r.length?(console.log(" INTEGRIDAD: Todos los datos estn consistentes"),{status:"OK",clubs:e.length,players:t.length,validAssignments:n.length}):(console.log(" INTEGRIDAD: Hay inconsistencias en las asignaciones"),{status:"WARNING",clubs:e.length,players:t.length,validAssignments:n.length})}catch(e){return console.error(" INTEGRIDAD: Error accediendo a los datos:",e),{status:"ERROR",error:e.message}}},window.checkClubAssignmentsPersistence=async()=>{console.log(" DIAGNSTICO: Verificando persistencia de asignaciones de club...");try{const[e,t]=await Promise.all([$t(),$r()]);console.log(` Estado actual: ${e.length} clubes, ${t.length} jugadores`);const r=t.filter(u=>u.clubId),n=t.filter(u=>!u.clubId);console.log(` Jugadores con club asignado: ${r.length}/${t.length}`),console.log(` Jugadores sin club asignado: ${n.length}/${t.length}`);const a=r.filter(u=>e.some(f=>f.id===u.clubId)),s=r.filter(u=>!e.some(f=>f.id===u.clubId));console.log(` Asignaciones vlidas: ${a.length}/${r.length}`),console.log(` Asignaciones invlidas: ${s.length}/${r.length}`),s.length>0&&(console.log(" Jugadores con asignaciones invlidas:"),s.slice(0,10).forEach(u=>{console.log(`    ${u.name} (ID: ${u.id}) -> Club: ${u.clubId} (NO EXISTE)`)}),s.length>10&&console.log(`   ... y ${s.length-10} ms`));const i={};r.forEach(u=>{u.clubId&&(i[u.clubId]=(i[u.clubId]||0)+1)}),console.log(" Distribucin de jugadores por club:"),e.forEach(u=>{const f=i[u.id]||0;console.log(`   ${f===23?"":f===0?"":""} ${u.name}: ${f} jugadores`)});const c=e.filter(u=>!i[u.id]);return c.length>0&&(console.log(` Clubs sin jugadores: ${c.length}`),c.forEach(u=>console.log(`    ${u.name}`))),{totalPlayers:t.length,playersWithClub:r.length,playersWithoutClub:n.length,validAssignments:a.length,invalidAssignments:s.length,clubsWithoutPlayers:c.length}}catch(e){return console.error(" Error en diagnstico de persistencia:",e),{error:e.message}}},window.fixClubAssignments=async()=>{console.log(" Iniciando reparacin de asignaciones de club...");try{const[e,t]=await Promise.all([$t(),$r()]);console.log(` Datos actuales: ${e.length} clubes, ${t.length} jugadores`);const r=await fixClubAssignments(e);return r.fixed>0?(console.log(` Reparadas ${r.fixed} asignaciones de club`),console.log(" Actualizando estado de la aplicacin..."),await useDataStore.getState().refreshPlayers(),console.log(" Estado actualizado. Los cambios deberan reflejarse en la UI.")):console.log(" No se encontraron asignaciones para reparar"),r}catch(e){return console.error(" Error ejecutando reparacin:",e),{error:e.message}}},window.fixPlayerClubAssignments=async()=>{console.log(" Iniciando correccin de asignaciones clubId en jugadores...");try{const e=await $t(),t=await $r();console.log(` Datos actuales: ${e.length} clubes, ${t.length} jugadores`);const r={};e.forEach(s=>{r[s.name.toLowerCase().replace(/\s+/g,"-")]=s.id});let n=0;const a=[];return t.forEach(s=>{s.clubId&&s.clubId.startsWith("club")?e.some(c=>c.id===s.clubId)||console.log(` Jugador ${s.name} tiene clubId invlido: ${s.clubId}`):s.clubId&&!s.clubId.startsWith("club")&&console.log(` Jugador ${s.name} tiene clubId no estndar: ${s.clubId}`)}),console.log(" Recomendacin: Ejecutar forceRegeneratePlayersFromSeed() para asignaciones correctas"),console.log("   Esto regenerar todos los jugadores con los nuevos IDs de clubes."),{totalPlayers:t.length,playersWithClub:t.filter(s=>s.clubId).length,fixed:n,recommendation:"Ejecutar forceRegeneratePlayersFromSeed() para correccin completa"}}catch(e){return console.error(" Error corrigiendo asignaciones:",e),{error:e.message}}},window.resetAllData=()=>{console.log(" Reiniciando todos los datos desde cero..."),localStorage.clear(),En(lt),Sr(er),localStorage.setItem("virtual_zone_clubs_updated","true"),localStorage.setItem("virtual_zone_players_updated","true"),console.log(` Reiniciados ${lt.length} clubes y ${er.length} jugadores desde datos seed`),console.log(" Recarga la pgina para ver los cambios")},console.log(" Funciones disponibles en consola:"),console.log("    updatePlayerMarketData() - Ajustar datos de mercado automticamente"),console.log("    forceCompleteMarketUpdate() - Forzar actualizacin completa"),console.log("    checkCompleteMarketStatus() - Verificar estado completo"),console.log("    refreshClubsFromSeed() - Refrescar clubes desde datos seed"),console.log("    refreshUsersFromSeed() - Refrescar usuarios desde datos seed"),console.log("    forceUpdateClubs() - Forzar actualizacin completa de clubes"),console.log("    forceUpdatePlayers() -  PELIGROSO: Regenerar TODOS los jugadores (borra ediciones)"),console.log("    forceRegeneratePlayersFromSeed() - Regenerar jugadores desde seed data"),console.log("    checkClubsStatus() - Verificar estado actual de clubes y jugadores"),console.log("    checkDataIntegrity() - Verificar integridad de datos, ediciones e imgenes"),console.log('    checkClubFinances("Club Name") - Verificar datos financieros de un club especfico'),console.log("    diagnoseClubsIssue() -  DIAGNSTICO: Verificar problema con los 48 clubes"),console.log("    checkClubChangesPersistence() -  Verificar si los cambios de clubes se mantienen"),console.log("    checkClubBackupStatus() -  Verificar estado de backups de clubes"),console.log("    exportPlayersData() -  Exportar todos los jugadores a Excel (.xlsx)"),console.log("    importPlayersData(data) -  Importar jugadores desde JSON o Excel"),console.log('    testRefreshClubsButton() - Probar si el botn "Refrescar" de Clubes funciona'),console.log('    testRefreshUsersButton() - Probar si el botn "Refrescar" de Usuarios funciona'),console.log("    testSalaryValueAdjustments() -  Probar ajuste TOTAL de salarios/valores (sobrescribe todo)"),console.log("    resetAllData() - Reiniciar todos los datos desde cero"),console.log("    checkImportedPlayersPersistence() -  Verificar si los jugadores importados mantienen sus clubs"),console.log("    checkImportDataIntegrity() -  Verificar integridad de datos despus de importar"),console.log("    checkClubAssignmentsPersistence() -  DIAGNSTICO: Verificar si los clubs de jugadores se mantienen al recargar"),console.log("    fixClubAssignments() -  Reparar asignaciones de club perdidas"),console.log("    fixPlayerClubAssignments() -  Corregir clubId de jugadores despus de reorganizacin de clubes"),console.log("    testClubPersistence() -  Probar que las ediciones de clubes se mantengan"),console.log("    cleanLocalStorage() -  Limpiar localStorage para liberar espacio"),console.log("    cleanDuplicateUsers() -  Eliminar usuarios duplicados"),console.log("    cleanDuplicateClubs() -  Eliminar clubes duplicados"),console.log("    migrateToSupabase() -  Migrar TODOS los datos de IndexedDB a Supabase"),console.log("    toggleSupabaseMode() -  Cambiar entre modo IndexedDB y Supabase"),console.log("    createAdminUser() -  Crear usuario admin en Supabase"),console.log("    fixAdminRole() -  Arreglar rol de admin para usuario actual"),console.log("    recreateAdminUser() -  Eliminar y recrear usuario admin"),console.log("    testProfileUpdate() -  Probar actualizacin de perfil"),console.log("    testClubAssignment() -  Probar asignacin de club a DT"),console.log("    assignClubToAdmin(clubId) -  Asignar club al admin manualmente"),console.log("    checkUserClubStatus() -  Verificar estado del club del usuario"),console.log("    forceRefreshUserProfile() -  Forzar actualizacin del perfil desde Supabase"),console.log("    checkSupabaseProfile() -  Verificar perfil directamente en Supabase"),console.log("    testReloadPersistence() -  Probar persistencia despus de recarga"),console.log("    testClubPersistenceAfterTimeout() -  Probar persistencia despus de timeout"),console.log("    diagnoseSupabase() -  Diagnosticar configuracin de Supabase"),console.log("    refreshPlayerFromSupabase(playerId) -  Actualizar un jugador especfico desde Supabase"),console.log("    syncPlayerClub(playerId, clubId) -  Sincronizar club de un jugador desde Supabase"),console.log("    diagnoseAdminSync() -  DIAGNSTICO: Verificar sincronizacin Panel Admin con Supabase"),console.log("    checkPlayerSync(playerIdOrName) -  Verificar sincronizacin de jugador especfico"),console.log("    syncAllPlayersToSupabase() -  Sincronizar TODOS los jugadores a Supabase"),console.log("    initializePosts() -  Inicializar posts con datos seed en Supabase"),console.log("    clearPosts() -  Eliminar TODOS los posts de Supabase"),console.log("    syncPostsToSupabase() -  Sincronizar posts a Supabase"),console.log("    checkSupabaseTableSchema(tableName) -  Verificar esquema de tabla en Supabase"),console.log("    checkRLSPolicies(tableName) -  Verificar polticas RLS de tabla"),console.log("    generateRLSPolicies(tableName) -  Generar SQL para polticas RLS correctas"),console.log("    testPlayerEditSync(playerIdOrName) -  Probar edicin y sincronizacin de jugador"),console.log("    checkClubSync(clubIdOrName) -  Verificar sincronizacin de club especfico"),console.log("    syncAllClubsToSupabase() -  Sincronizar TODOS los clubs a Supabase"),console.log("    syncAllTournamentsToSupabase() -  Sincronizar TODOS los torneos a Supabase"),console.log("    migrateAllMatchesToSupabase() -  Migrar TODOS los partidos a Supabase"),window.diagnoseAdminSync=async()=>{console.log(" DIAGNSTICO: Verificando sincronizacin Panel Admin con Supabase"),console.log("=".repeat(60));const{config:e}=await Z(async()=>{const{config:n}=await Promise.resolve().then(()=>ft);return{config:n}},void 0);if(console.log("1  ESTADO DEL MODO:"),console.log(`   Modo Supabase: ${e.useSupabase?" HABILITADO":" DESHABILITADO"}`),console.log(`   URL Supabase: ${e.supabase.url?" CONFIGURADA":" NO CONFIGURADA"}`),console.log(`   API Key: ${e.supabase.anonKey?" CONFIGURADA":" NO CONFIGURADA"}`),!e.useSupabase){console.log(" No ests en modo Supabase. Los cambios solo se guardan localmente."),console.log(" Ejecuta: await toggleSupabaseMode(true)");return}console.log(`
2  CONEXIN A SUPABASE:`);try{const{getSupabaseClient:n}=await Z(async()=>{const{getSupabaseClient:c}=await Promise.resolve().then(()=>dt);return{getSupabaseClient:c}},void 0),a=n(),{data:s,error:i}=await a.from("profiles").select("count").limit(1);i?console.log(" Error de conexin:",i.message):console.log(" Conexin exitosa a Supabase")}catch(n){console.log(" Error al verificar conexin:",n)}console.log(`
3  USUARIO ACTUAL:`);const r=(await Z(()=>Promise.resolve().then(()=>vn),void 0).then(n=>n.useAuthStore.getState())).user;if(!r){console.log(" No hay usuario autenticado");return}console.log(`   Usuario: ${r.username} (${r.email})`),console.log(`   ID: ${r.id}`),console.log(`   Rol: ${r.role}`),console.log(`   Roles: ${JSON.stringify(r.roles)}`),console.log(`
4  PERFIL EN SUPABASE:`);try{const{getSupabaseClient:n}=await Z(async()=>{const{getSupabaseClient:c}=await Promise.resolve().then(()=>dt);return{getSupabaseClient:c}},void 0),a=n(),{data:s,error:i}=await a.from("profiles").select("*").eq("id",r.id).single();if(i)console.log(" Error obteniendo perfil de Supabase:",i.message);else if(s){console.log(" Perfil encontrado en Supabase"),console.log(`   Email: ${s.email}`),console.log(`   Username: ${s.username}`),console.log(`   Role: ${s.role}`),console.log(`   ltima actualizacin: ${s.updated_at}`);const c=s.role===r.role;console.log(`    Comparacin rol: ${c?"":""} (${s.role} vs ${r.role})`)}else console.log(" Perfil no encontrado en Supabase")}catch(n){console.log(" Error al verificar perfil:",n)}console.log(`
5  PERMISOS DE ESCRITURA:`);try{const{getSupabaseClient:n}=await Z(async()=>{const{getSupabaseClient:c}=await Promise.resolve().then(()=>dt);return{getSupabaseClient:c}},void 0),a=n(),s={last_login:new Date().toISOString()},{error:i}=await a.from("profiles").update(s).eq("id",r.id);i?(console.log(" Error de permisos de escritura:",i.message),console.log(" Verifica las polticas RLS en Supabase")):console.log(" Permisos de escritura OK")}catch(n){console.log(" Error al verificar permisos:",n)}console.log(`
6  CAMBIOS RECIENTES:`);try{const{getSupabaseClient:n}=await Z(async()=>{const{getSupabaseClient:c}=await Promise.resolve().then(()=>dt);return{getSupabaseClient:c}},void 0),a=n(),{data:s,error:i}=await a.from("profiles").select("username, email, role, updated_at").order("updated_at",{ascending:!1}).limit(5);i?console.log(" Error obteniendo cambios recientes:",i.message):s&&s.length>0?(console.log(" Cambios recientes encontrados:"),s.forEach((c,u)=>{const f=new Date(Date.now()-new Date(c.updated_at).getTime()).getMinutes();console.log(`   ${u+1}. ${c.username} (${c.role}) - hace ${f}min`)})):console.log(" No se encontraron cambios recientes")}catch(n){console.log(" Error al verificar cambios recientes:",n)}console.log(`
7  RECOMENDACIONES:`),console.log("    Si ves  en alguna verificacin, hay problemas de sincronizacin"),console.log("    Ejecuta: await fixAdminRole() si los roles no coinciden"),console.log("    Ejecuta: await forceRefreshUserProfile() para forzar sincronizacin"),console.log("    Verifica las polticas RLS en tu panel de Supabase"),console.log(`
`+"=".repeat(60)),console.log(" Diagnstico completado. Revisa los resultados arriba.")},window.checkPlayerSync=async e=>{console.log(` Verificando sincronizacin del jugador: ${e}`),console.log("=".repeat(60));const{config:t}=await Z(async()=>{const{config:a}=await Promise.resolve().then(()=>ft);return{config:a}},void 0);if(!t.useSupabase){console.log(" No ests en modo Supabase");return}let r=e,n=e;e.startsWith("imp-")||e.match(/^\d+$/)?r=e:n=e,console.log("1  BUSCANDO EN IndexedDB:");try{const s=await(await Z(()=>Promise.resolve().then(()=>af),void 0)).listPlayers();let i=null;if(r!==n&&(i=s.find(c=>c.id===r)),i||(i=s.find(c=>c.name.toLowerCase().includes(n.toLowerCase())||c.id===e)),!i){console.log(" Jugador no encontrado en IndexedDB");return}console.log(" Jugador encontrado en IndexedDB:"),console.log(`   ID: ${i.id}`),console.log(`   Nombre: ${i.name}`),console.log(`   Posicin: ${i.position}`),console.log(`   Valor: ${i.marketValue?.toLocaleString()||"N/A"}`),console.log(`   Salario: ${i.salary?.toLocaleString()||"N/A"}`),console.log(`   Club: ${i.club||"Libre"}`),console.log(`   Atributos principales: ${JSON.stringify(i.attributes||{})}`),r=i.id}catch(a){console.log(" Error buscando en IndexedDB:",a);return}console.log(`
2  BUSCANDO EN SUPABASE:`);try{const{getSupabaseClient:a}=await Z(async()=>{const{getSupabaseClient:u}=await Promise.resolve().then(()=>dt);return{getSupabaseClient:u}},void 0),s=a(),{data:i,error:c}=await s.from("players").select("*").eq("id",r).single();if(c){c.code==="PGRST116"?(console.log(" Jugador no encontrado en Supabase"),console.log(" El jugador existe localmente pero no est sincronizado")):console.log(" Error consultando Supabase:",c.message);return}console.log(" Jugador encontrado en Supabase:"),console.log(`   ID: ${i.id}`),console.log(`   Nombre: ${i.name}`),console.log(`   Posicin: ${i.position}`),console.log(`   Valor: ${i.transfer_value?.toLocaleString()||"N/A"}`),console.log(`   Club ID: ${i.club_id||"N/A"}`),console.log(`   Atributos: ${JSON.stringify(i.attributes||{})}`),console.log(`   ltima actualizacin: ${i.updated_at}`)}catch(a){console.log(" Error consultando Supabase:",a)}console.log(`
3  COMPARACIN DE DATOS:`),console.log("   (Compara manualmente los valores mostrados arriba)"),console.log("    Coinciden: Los datos estn sincronizados"),console.log("    Difieren: Hay problemas de sincronizacin"),console.log(`
`+"=".repeat(60)),console.log(" Verificacin completada.")},window.checkRLSPolicies=async(e="players")=>{console.log(` Verificando polticas RLS para tabla '${e}'`),console.log("=".repeat(60));const{config:t}=await Z(async()=>{const{config:r}=await Promise.resolve().then(()=>ft);return{config:r}},void 0);if(!t.useSupabase){console.error(" No ests en modo Supabase");return}try{const{getSupabaseClient:r}=await Z(async()=>{const{getSupabaseClient:i}=await Promise.resolve().then(()=>dt);return{getSupabaseClient:i}},void 0),n=r();console.log(` Probando permisos de operaciones...
`),console.log("1 SELECT (lectura):");try{const{data:i,error:c}=await n.from(e).select("*").limit(1);c?(console.log(`    Error: ${c.message}`),c.message.includes("RLS")&&console.log("    Problema: Poltica RLS bloqueando SELECT")):console.log(`    OK - Encontrados ${i?.length||0} registros`)}catch(i){console.log(`    Error inesperado: ${i}`)}console.log(`
2 INSERT (insercin):`);const a=`test-rls-${Date.now()}`;let s=null;if(e==="players")s={id:a,name:"Test RLS Player",position:"PT",attributes:{test:!0}};else if(e==="matches"){let i=null;try{const{data:c}=await n.from("tournaments").select("id").limit(1);i=c&&c.length>0?c[0].id:null}catch{}s={id:a,tournament_id:i,round:1,date:new Date().toISOString(),home_team:"Test FC",away_team:"RLS United",status:"scheduled",scorers:[],highlights:[]}}else s={id:a};try{const{data:i,error:c}=await n.from(e).insert(s).select();c?(console.log(`    Error: ${c.message}`),c.message.includes("RLS")?console.log("    Problema: Poltica RLS bloqueando INSERT"):c.message.includes("violates")&&console.log("    Problema: Violacin de restricciones de tabla")):(console.log("    OK - Insertado registro de prueba"),await n.from(e).delete().eq("id",s.id),console.log("    Registro de prueba eliminado"))}catch(i){console.log(`    Error inesperado: ${i}`)}console.log(`
3 UPDATE (actualizacin):`);try{const{data:i,error:c}=await n.from(e).select("id").limit(1);if(c||!i||i.length===0)console.log("    No hay registros existentes para probar UPDATE");else{const u=i[0].id,f=e==="players"?{updated_at:new Date().toISOString()}:{updated_at:new Date().toISOString()},{data:h,error:p}=await n.from(e).update(f).eq("id",u).select();p?(console.log(`    Error: ${p.message}`),p.message.includes("RLS")&&console.log("    Problema: Poltica RLS bloqueando UPDATE")):console.log("    OK - Actualizado registro existente")}}catch(i){console.log(`    Error inesperado: ${i}`)}console.log(`
4 DELETE (eliminacin):`);try{const i=`test-rls-${Date.now()}`,{data:c,error:u}=await n.from(e).delete().eq("id",i);u?(console.log(`    Error: ${u.message}`),u.message.includes("RLS")&&console.log("    Problema: Poltica RLS bloqueando DELETE")):console.log("    OK - DELETE permitido (aunque no haba registro)")}catch(i){console.log(`    Error inesperado: ${i}`)}console.log(`
 RESUMEN Y RECOMENDACIONES:`),console.log(" Si ves errores RLS, las polticas de seguridad estn demasiado restrictivas"),console.log(" Soluciones posibles:"),console.log("    Deshabilitar RLS temporalmente para testing: ALTER TABLE players DISABLE ROW LEVEL SECURITY;"),console.log("    Crear polticas RLS que permitan operaciones para usuarios autenticados"),console.log("    Revisar permisos del usuario admin en Supabase Dashboard"),console.log("    Usar Service Role Key para operaciones admin (ms peligroso)"),console.log(`
 POLTICAS RLS RECOMENDADAS para tabla players:`),console.log("    ENABLE ROW LEVEL SECURITY en la tabla"),console.log("    Poltica SELECT: Permitir a usuarios autenticados ver todos los players"),console.log("    Poltica INSERT: Permitir a admins (role = 'admin') insertar players"),console.log("    Poltica UPDATE: Permitir a admins actualizar players"),console.log("    Poltica DELETE: Permitir a admins eliminar players")}catch(r){console.error(" Error verificando polticas RLS:",r)}},window.checkClubSync=async e=>{console.log(` Verificando sincronizacin del club: ${e}`),console.log("=".repeat(60));try{const{listClubs:t}=await Z(async()=>{const{listClubs:u}=await Promise.resolve().then(()=>Kd);return{listClubs:u}},void 0),{getSupabaseClient:r}=await Z(async()=>{const{getSupabaseClient:u}=await Promise.resolve().then(()=>dt);return{getSupabaseClient:u}},void 0);console.log("1  BUSCANDO EN IndexedDB:");const n=await t();let a=null;if(n&&n.length>0&&(a=n.find(u=>u.id===e||u.name.toLowerCase().includes(e.toLowerCase()))),a)console.log(" Club encontrado en IndexedDB:"),console.log(`   ID: ${a.id}`),console.log(`   Nombre: ${a.name}`),console.log(`   Logo: ${a.logo}`),console.log(`   Presupuesto: ${a.budget.toLocaleString()}`),console.log(`   Estadio: ${a.stadium}`),console.log(`   Manager: ${a.manager}`);else{console.log(" Club NO encontrado en IndexedDB");return}console.log(`
2  BUSCANDO EN SUPABASE:`);const s=r(),{data:i,error:c}=await s.from("clubs").select("*").eq("id",a.id).single();if(c){console.log(" Error buscando en Supabase:",c.message);return}i?(console.log(" Club encontrado en Supabase:"),console.log(`   ID: ${i.id}`),console.log(`   Nombre: ${i.name}`),console.log(`   Logo: ${i.logo}`),console.log(`   Presupuesto: ${i.budget?.toLocaleString()||"N/A"}`),console.log(`   Estadio: ${i.stadium||"N/A"}`),console.log(`   Manager: ${i.manager||"N/A"}`),console.log(`   ltima actualizacin: ${i.updated_at||"N/A"}`)):console.log(" Club NO encontrado en Supabase"),console.log(`
3  COMPARACIN DE DATOS:`),i&&(a.name===i.name&&a.logo===i.logo&&a.budget===i.budget&&a.stadium===i.stadium&&a.manager===i.manager?console.log(" Coinciden: Los datos estn sincronizados"):(console.log(" Difieren: Hay problemas de sincronizacin"),console.log("   Diferencias encontradas:"),a.name!==i.name&&console.log(`   - Nombre: "${a.name}" vs "${i.name}"`),a.logo!==i.logo&&console.log(`   - Logo: "${a.logo}" vs "${i.logo}"`),a.budget!==i.budget&&console.log(`   - Presupuesto: ${a.budget} vs ${i.budget}`),a.stadium!==i.stadium&&console.log(`   - Estadio: "${a.stadium}" vs "${i.stadium}"`),a.manager!==i.manager&&console.log(`   - Manager: "${a.manager}" vs "${i.manager}"`))),console.log(`
`+"=".repeat(60)),console.log(" Verificacin completada.")}catch(t){console.error(" Error en checkClubSync:",t)}},window.generateRLSPolicies=(e="clubs")=>{console.log(` Generando polticas RLS para tabla '${e}'`),console.log("=".repeat(60)),console.log(` EJECUTAR ESTE SQL en Supabase SQL Editor:
`);const r=["tournaments","blog_posts","matches"].includes(e)?`-- Poltica SELECT: Permitir lectura pblica
CREATE POLICY "Public read access for ${e}" ON ${e}
  FOR SELECT USING (true);`:`-- Poltica SELECT: Permitir a usuarios autenticados ver todos los registros
CREATE POLICY "${e}_select_policy" ON ${e}
  FOR SELECT
  USING (auth.role() = 'authenticated');`,n=`
-- Habilitar RLS en la tabla ${e}
ALTER TABLE ${e} ENABLE ROW LEVEL SECURITY;

${r}

-- Poltica ALL: Permitir a usuarios con rol 'admin' todas las operaciones de modificacin
CREATE POLICY "Admin full access for ${e}" ON ${e}
  FOR ALL USING (
    EXISTS (
      SELECT 1 FROM profiles
      WHERE profiles.id = auth.uid()
      AND profiles.role = 'admin'
    )
  );

-- Verificar polticas creadas
SELECT schemaname, tablename, policyname, permissive, roles, cmd, qual, with_check
FROM pg_policies
WHERE tablename = '${e}'
ORDER BY policyname;
`;console.log(n),console.log(`
`+"=".repeat(60)),console.log(" INSTRUCCIONES:"),console.log("1. Ve a tu Supabase Dashboard"),console.log("2. Ve a SQL Editor"),console.log("3. Copia y pega el SQL de arriba"),console.log("4. Ejecuta el SQL"),console.log("5. Verifica que las polticas se crearon correctamente"),console.log('6. Prueba nuevamente la sincronizacin: await checkRLSPolicies("players")'),console.log(`
 NOTA: Asegrate de que el usuario admin tenga role = "admin" en la tabla profiles`)},window.testPlayerEditSync=async e=>{console.log(` Probando edicin y sincronizacin del jugador: ${e}`),console.log("=".repeat(70));try{const t=await Z(()=>Promise.resolve().then(()=>af),void 0),r=await t.listPlayers();let n=null;if(e.startsWith("imp-")||e.match(/^\d+$/)?n=r.find(i=>i.id===e):n=r.find(i=>i.name.toLowerCase().includes(e.toLowerCase())||i.id===e),!n){console.log(" Jugador no encontrado");return}console.log(" Jugador encontrado:"),console.log(`   ID: ${n.id}`),console.log(`   Nombre: ${n.name}`),console.log(`   Atributos actuales: ${JSON.stringify(n.attributes||{})}`);const a={...n.attributes,reflexes:99,catching:95,goalkeeping:97,testSync:!0},s={...n,attributes:a,marketValue:(n.marketValue||0)+1e6};console.log(`
 Aplicando cambios...`),console.log(`   Atributos modificados: ${JSON.stringify(a)}`),console.log(`   Nuevo valor: ${s.marketValue?.toLocaleString()}`),await t.updatePlayer(s),console.log(`
 Jugador actualizado localmente`),await new Promise(i=>setTimeout(i,2e3)),console.log(`
 Verificando sincronizacin...`),await window.checkPlayerSync(n.id),console.log(`
 Prueba completada!`),console.log("    Si los atributos coinciden:  Sincronizacin funcionando"),console.log("    Si hay diferencias:  Problemas de sincronizacin")}catch(t){console.error(" Error en la prueba:",t)}},window.checkSupabaseTableSchema=async(e="players")=>{console.log(` Verificando esquema de tabla '${e}' en Supabase...`);const{config:t}=await Z(async()=>{const{config:r}=await Promise.resolve().then(()=>ft);return{config:r}},void 0);if(!t.useSupabase){console.error(" No ests en modo Supabase");return}try{const{getSupabaseClient:r}=await Z(async()=>{const{getSupabaseClient:u}=await Promise.resolve().then(()=>dt);return{getSupabaseClient:u}},void 0),n=r();console.log(" Consultando informacin de la tabla...");const{data:a,error:s}=await n.from(e).select("*").limit(1);if(s){console.error(" Error obteniendo datos de muestra:",s.message);return}if(!a||a.length===0){console.log(" La tabla est vaca, no se puede determinar el esquema");return}const i=a[0],c=Object.keys(i);if(console.log(" Columnas encontradas en la tabla:"),c.forEach((u,f)=>{const h=i[u],p=Array.isArray(h)?"array":typeof h=="object"&&h!==null?"object":typeof h;console.log(`   ${f+1}. ${u}: ${p}`)}),console.log(`
 Total de columnas: ${c.length}`),e==="players"){console.log(`
 Verificacin especfica para tabla players:`);const u=["id","name","position","attributes"],f=["market_value","salary","club","club_id","matches","dorsal","height","weight","updated_at"];u.forEach(h=>{c.includes(h)?console.log(`    ${h} (requerido)`):console.log(`    ${h} (requerido - FALTA)`)}),f.forEach(h=>{c.includes(h)?console.log(`    ${h} (opcional)`):console.log(`    ${h} (opcional - no existe)`)})}}catch(r){console.error(" Error verificando esquema de tabla:",r)}},window.migrateAllMatchesToSupabase=async()=>{try{const{migrateAllMatchesToSupabase:e}=await Z(async()=>{const{migrateAllMatchesToSupabase:r}=await Promise.resolve().then(()=>Bh);return{migrateAllMatchesToSupabase:r}},void 0);console.log(" Iniciando migracin de todos los partidos a Supabase...");const t=await e();return console.log(" Migracin completada:",t),alert(` Migracin completada:
${t.tournaments} torneos
${t.matches} partidos
${t.errors.length} errores`),t}catch(e){throw console.error(" Error en migrateAllMatchesToSupabase:",e),alert(` Error: ${e instanceof Error?e.message:"Error desconocido"}`),e}},window.migrateMatchesFromTournaments=async e=>{try{const{migrateMatchesFromTournaments:t}=await Z(async()=>{const{migrateMatchesFromTournaments:n}=await import("./migrateMatchesToTable-Bg7xo81o.js");return{migrateMatchesFromTournaments:n}},[]);console.log(" Iniciando migracin de partidos desde tournaments.matches a tabla matches...");const r=await t(e||{});return console.log(" Migracin completada:",r),alert(` Migracin completada:
${r.tournamentsProcessed} torneos procesados
${r.matchesMigrated} partidos migrados
${r.matchesSkipped} partidos saltados
${r.errors.length} errores`),r}catch(t){throw console.error(" Error en migrateMatchesFromTournaments:",t),alert(` Error: ${t instanceof Error?t.message:"Error desconocido"}`),t}},console.log(" Nueva funcin disponible:"),console.log("   window.migrateMatchesFromTournaments({ dryRun: true }) // Probar primero"),console.log("   window.migrateMatchesFromTournaments({ clearTournamentMatches: true }) // Migrar y limpiar"),window.syncAllClubsToSupabase=async()=>{console.log(" Sincronizando todos los clubs de IndexedDB a Supabase...");try{const{listClubs:e}=await Z(async()=>{const{listClubs:c}=await Promise.resolve().then(()=>Kd);return{listClubs:c}},void 0),{getSupabaseClient:t}=await Z(async()=>{const{getSupabaseClient:c}=await Promise.resolve().then(()=>dt);return{getSupabaseClient:c}},void 0),r=await e(),n=t();console.log(` Sincronizando ${r.length} clubs...`);const a=50;let s=0,i=0;for(let c=0;c<r.length;c+=a){const u=r.slice(c,c+a);console.log(`   Procesando lote ${Math.floor(c/a)+1}/${Math.ceil(r.length/a)} (${u.length} clubs)...`);for(const f of u)try{const{error:h}=await n.from("clubs").upsert({id:f.id,name:f.name,logo:f.logo,foundedYear:f.foundedYear,stadium:f.stadium,budget:f.budget,manager:f.manager,playStyle:f.playStyle,primaryColor:f.primaryColor,secondaryColor:f.secondaryColor,description:f.description,reputation:f.reputation,fanBase:f.fanBase,updated_at:new Date().toISOString()},{onConflict:"id"});if(h){if(console.error(`    Error sincronizando club ${f.name}:`,h),i++,i>5)break}else s++}catch(h){console.error(`    Error procesando club ${f.name}:`,h),i++}}console.log(` Sincronizacin completada: ${s} exitosos, ${i} errores`)}catch(e){console.error(" Error en syncAllClubsToSupabase:",e)}},window.syncAllPlayersToSupabase=async()=>{console.log(" Sincronizando TODOS los jugadores a Supabase...");const{config:e}=await Z(async()=>{const{config:t}=await Promise.resolve().then(()=>ft);return{config:t}},void 0);if(!e.useSupabase){console.error(" Debes estar en modo Supabase para sincronizar"),console.log("Ejecuta: await toggleSupabaseMode(true)");return}try{const r=await(await Z(()=>Promise.resolve().then(()=>af),void 0)).listPlayers();if(console.log(` Encontrados ${r.length} jugadores para sincronizar`),r.length===0){console.log(" No hay jugadores para sincronizar");return}const{getSupabaseClient:n}=await Z(async()=>{const{getSupabaseClient:f}=await Promise.resolve().then(()=>dt);return{getSupabaseClient:f}},void 0),a=n(),s=r.map(f=>{const h=!f.clubId||f.clubId==="libre"||f.clubId==="free";return{id:f.id,name:f.name,age:f.age||25,position:f.position,nationality:f.nationality||"Argentina",club_id:h?null:f.clubId,overall:f.overall||50,potential:f.potential||f.overall||50,transfer_listed:f.transferListed||!1,transfer_value:f.marketValue||0,image:f.image||"",attributes:f.attributes,skills:f.skills||[],playing_styles:f.playingStyles||[],contract:f.contract||{expires:new Date().toISOString(),salary:0},form:f.form||3,goals:f.goals||0,assists:f.assists||0,appearances:f.appearances||0,matches:f.matches||0,dorsal:f.dorsal||1,injury_resistance:f.injuryResistance||50,height:f.height,weight:f.weight,updated_at:new Date().toISOString()}});console.log(" Sincronizando jugadores...");const i=100;let c=0,u=0;for(let f=0;f<s.length;f+=i){const h=s.slice(f,f+i);console.log(` Sincronizando lote ${Math.floor(f/i)+1}/${Math.ceil(s.length/i)} (${h.length} jugadores)...`);try{const{error:p}=await a.from("players").upsert(h,{onConflict:"id"});p?(console.error(` Error en lote ${Math.floor(f/i)+1}:`,p),u+=h.length):(c+=h.length,console.log(` Lote ${Math.floor(f/i)+1} sincronizado (${h.length} jugadores)`))}catch(p){console.error(` Error inesperado en lote ${Math.floor(f/i)+1}:`,p),u+=h.length}}console.log(" Sincronizacin completada!"),console.log(` Jugadores sincronizados: ${c}`),u>0&&console.log(` Errores: ${u}`),console.log(" Los cambios realizados en Panel Admin ahora se vern en Supabase")}catch(t){console.error(" Error sincronizando jugadores:",t)}},window.syncAllTournamentsToSupabase=async()=>{console.log(" Sincronizando TODOS los torneos a Supabase...");try{const{config:e}=await Z(async()=>{const{config:s}=await Promise.resolve().then(()=>ft);return{config:s}},void 0);if(!e.useSupabase){console.error(" Debes habilitar Supabase antes de sincronizar torneos"),console.log("Ejecuta: await toggleSupabaseMode(true)");return}const{syncAllTournamentsToSupabase:t}=await Z(async()=>{const{syncAllTournamentsToSupabase:s}=await Promise.resolve().then(()=>Bh);return{syncAllTournamentsToSupabase:s}},void 0),r=await t(),n=`Torneos sincronizados: ${r.synced}/${r.total}`,a=r.failed?` | Fallidos: ${r.failed}`:"";console.log(` ${n}${a}`),r.failed&&r.errors.length&&console.warn(" Torneos con errores:",r.errors),alert(` Sincronizacin completada.
${n}${a}`)}catch(e){console.error(" Error en syncAllTournamentsToSupabase:",e),alert(` Error sincronizando torneos: ${e instanceof Error?e.message:"Error desconocido"}`)}},window.initializePosts=async()=>{console.log(" Inicializando posts en Supabase...");const{config:e}=await Z(async()=>{const{config:t}=await Promise.resolve().then(()=>ft);return{config:t}},void 0);if(!e.useSupabase){console.error(" Debes estar en modo Supabase para inicializar posts"),console.log("Ejecuta: await toggleSupabaseMode(true)");return}try{const{initializePosts:t}=await Z(async()=>{const{initializePosts:r}=await Promise.resolve().then(()=>qd);return{initializePosts:r}},void 0);await t(),console.log(" Posts inicializados exitosamente")}catch(t){console.error(" Error inicializando posts:",t)}},window.clearPosts=async()=>{console.log(" Eliminando todos los posts de Supabase...");const{config:e}=await Z(async()=>{const{config:t}=await Promise.resolve().then(()=>ft);return{config:t}},void 0);if(!e.useSupabase){console.error(" Debes estar en modo Supabase para limpiar posts"),console.log("Ejecuta: await toggleSupabaseMode(true)");return}try{const{clearPosts:t}=await Z(async()=>{const{clearPosts:r}=await Promise.resolve().then(()=>qd);return{clearPosts:r}},void 0);await t(),console.log(" Posts eliminados exitosamente")}catch(t){console.error(" Error eliminando posts:",t)}},window.syncPostsToSupabase=async()=>{console.log(" Sincronizando posts a Supabase...");const{config:e}=await Z(async()=>{const{config:t}=await Promise.resolve().then(()=>ft);return{config:t}},void 0);if(!e.useSupabase){console.error(" Debes estar en modo Supabase para sincronizar posts"),console.log("Ejecuta: await toggleSupabaseMode(true)");return}try{const{listPosts:t}=await Z(async()=>{const{listPosts:n}=await Promise.resolve().then(()=>qd);return{listPosts:n}},void 0),r=await t();if(console.log(` Encontrados ${r.length} posts para sincronizar`),r.length===0){console.log(" No hay posts para sincronizar");return}console.log(" Posts ya estn sincronizados en Supabase")}catch(t){console.error(" Error sincronizando posts:",t)}},window.migrateToSupabase=async()=>{console.log(" Iniciando migracin completa a Supabase...");const{config:e}=await Z(async()=>{const{config:t}=await Promise.resolve().then(()=>ft);return{config:t}},void 0);if(!e.useSupabase){console.error(" Supabase no est habilitado. Ejecuta: toggleSupabaseMode()");return}try{const{getSupabaseClient:t}=await Z(async()=>{const{getSupabaseClient:i}=await Promise.resolve().then(()=>dt);return{getSupabaseClient:i}},void 0),r=t();console.log(" Migrando clubs...");const n=await ht.getAll("clubs");if(console.log(`   Encontrados ${n.length} clubs localmente`),console.log("   Primer club de ejemplo:",n[0]),n.length>0){let i=0,c=0;for(const u of n)try{const{error:f}=await r.from("clubs").upsert({id:u.id,name:u.name,logo:u.logo,foundedYear:u.foundedYear,stadium:u.stadium,budget:u.budget,manager:u.manager,playStyle:u.playStyle,primaryColor:u.primaryColor,secondaryColor:u.secondaryColor,description:u.description,reputation:u.reputation,fanBase:u.fanBase},{onConflict:"id"});if(f){if(console.error(`    Error migrando club ${u.name}:`,f),c++,c>3)break}else i++}catch(f){console.error(`    Exception migrando club ${u.name}:`,f),c++}console.log(` Migrados ${i} clubs exitosamente`),c>0&&console.log(` ${c} clubs fallaron`)}console.log(" Migrando players...");const a=await ht.getAll("players");if(console.log(`   Encontrados ${a.length} players localmente`),console.log("   Primer player de ejemplo:",a[0]),a.length>0){const i=a.map(u=>({id:u.id,name:u.name||"Unknown Player",age:u.age||18,position:u.position||"DEL",nationality:u.nationality||"Desconocida",club_id:u.clubId||null,overall:u.overall||50,potential:u.potential||u.overall||50,transfer_listed:u.transferListed||!1,transfer_value:u.transferValue||0,image:u.image||"/default.png",attributes:u.attributes||{},skills:u.skills||{},playing_styles:u.playingStyles||{},contract:u.contract||{},form:u.form||50,goals:u.goals||0,assists:u.assists||0,appearances:u.appearances||0,matches:u.matches||0,dorsal:u.dorsal||null,injury_resistance:u.injuryResistance||50,height:u.height||null,weight:u.weight||null}));console.log("   Player mapeado de ejemplo:",i[0]);const{error:c}=await r.from("players").upsert(i,{onConflict:"id"});if(c)throw c;console.log(` Migrados ${a.length} players`)}console.log(" Migrando tournaments...");const s=await ht.getAll("tournaments");if(console.log(`   Encontrados ${s.length} tournaments localmente`),s.length>0){console.log("   Primer tournament de ejemplo:",s[0]);const i=s.map(u=>({id:u.id,name:u.name,type:u.type,logo:u.logo,start_date:u.startDate,end_date:u.endDate,status:u.status||"upcoming",teams:u.teams||[],rounds:u.rounds||1,matches:u.matches||[],description:u.description||"",winner:u.winner||null,top_scorer:u.topScorer||null}));console.log("   Tournament mapeado de ejemplo:",i[0]);const{error:c}=await r.from("tournaments").upsert(i,{onConflict:"id"});if(c)throw c;console.log(` Migrados ${s.length} tournaments`)}console.log(" Migracin completada exitosamente!"),console.log(" Ahora puedes usar Supabase como backend principal")}catch(t){console.error(" Error en migracin:",t)}},window.toggleSupabaseMode=async()=>{const{config:e}=await Z(async()=>{const{config:r}=await Promise.resolve().then(()=>ft);return{config:r}},void 0),t=!e.useSupabase;e.useSupabase=t,localStorage.setItem("virtual_zone_use_supabase",t.toString()),console.log(` Modo Supabase: ${t?"HABILITADO":"DESHABILITADO"}`),console.log(" Para aplicar cambios: recarga la pgina (F5)"),t?(console.log(" Modo hbrido activado:"),console.log("    Supabase como backend principal"),console.log("    IndexedDB como cache offline"),console.log("    Sincronizacin automtica")):(console.log(" Modo legacy activado:"),console.log("    IndexedDB como nico backend"),console.log("    Funcionalidad offline completa"))},window.createAdminUser=async()=>{console.log(" Creando usuario admin...");const{config:e}=await Z(async()=>{const{config:t}=await Promise.resolve().then(()=>ft);return{config:t}},void 0);if(!e.useSupabase){console.error(" Debes estar en modo Supabase para crear admin"),console.log("Ejecuta: await toggleSupabaseMode()");return}try{const{getSupabaseClient:t}=await Z(async()=>{const{getSupabaseClient:f}=await Promise.resolve().then(()=>dt);return{getSupabaseClient:f}},void 0),r=t(),n="admin@lavirtualzone.com",a="admin123",s="admin";console.log(` Creando usuario admin: ${n}`);const{data:i,error:c}=await r.auth.signUp({email:n,password:a,options:{data:{username:s,role:"admin"}}});if(c)if(c.message.includes("already registered")){console.log(" El usuario admin ya existe, actualizando perfil...");const{data:f,error:h}=await r.auth.signInWithPassword({email:n,password:a});if(h){console.error(" Error al iniciar sesin con admin existente:",h);return}console.log(" Sesin admin iniciada")}else throw c;else console.log(" Usuario admin creado en auth");await new Promise(f=>setTimeout(f,2e3));const{data:{user:u}}=await r.auth.getUser();if(u){const{error:f}=await r.from("profiles").upsert({id:u.id,username:s,email:n,role:"admin",status:"active",created_at:new Date().toISOString(),updated_at:new Date().toISOString()},{onConflict:"id"});f?console.error(" Error creando perfil admin:",f):console.log(" Perfil admin creado/actualizado")}console.log(" Usuario admin listo!"),console.log(`    Email: ${n}`),console.log(`    Password: ${a}`),console.log(`    Username: ${s}`),console.log("    Role: admin")}catch(t){console.error(" Error creando usuario admin:",t)}},window.fixAdminRole=async()=>{console.log(" Arreglando rol de admin...");const{config:e}=await Z(async()=>{const{config:t}=await Promise.resolve().then(()=>ft);return{config:t}},void 0);if(!e.useSupabase){console.error(" Debes estar en modo Supabase");return}try{const{getSupabaseClient:t}=await Z(async()=>{const{getSupabaseClient:u}=await Promise.resolve().then(()=>dt);return{getSupabaseClient:u}},void 0),r=t(),{data:{user:n},error:a}=await r.auth.getUser();if(a||!n){console.error(" No hay usuario autenticado");return}console.log(` Verificando perfil de: ${n.email}`);const{data:s,error:i}=await r.from("profiles").select("*").eq("id",n.id).single();if(i){console.error(" Error obteniendo perfil:",i);return}console.log(" Perfil actual:",s);const{error:c}=await r.from("profiles").update({role:"admin",status:"active",updated_at:new Date().toISOString()}).eq("id",n.id);c?console.error(" Error actualizando rol:",c):(console.log(" Rol actualizado a admin"),console.log(" Recargando datos de usuario..."),console.log(" Recarga la pgina para ver los cambios"))}catch(t){console.error(" Error arreglando rol admin:",t)}},window.recreateAdminUser=async()=>{console.log(" Eliminando y recreando usuario admin...");const{config:e}=await Z(async()=>{const{config:t}=await Promise.resolve().then(()=>ft);return{config:t}},void 0);if(!e.useSupabase){console.error(" Debes estar en modo Supabase para recrear admin"),console.log("Ejecuta: await toggleSupabaseMode()");return}try{const{getSupabaseClient:t}=await Z(async()=>{const{getSupabaseClient:h}=await Promise.resolve().then(()=>dt);return{getSupabaseClient:h}},void 0),r=t(),n="admin@lavirtualzone.com",a="admin123",s="admin";console.log(` Eliminando usuario admin existente: ${n}`),console.log(" Cerrando cualquier sesin activa..."),await r.auth.signOut(),await new Promise(h=>setTimeout(h,500));const{data:i,error:c}=await r.from("profiles").select("id").eq("email",n);if(c)console.log(" No se pudieron obtener perfiles existentes (posiblemente no hay ninguno):",c.message);else if(i&&i.length>0){console.log(` Encontrados ${i.length} perfiles, eliminando...`);for(const h of i){const{error:p}=await r.from("profiles").delete().eq("id",h.id);p?console.error(` Error eliminando perfil ${h.id}:`,p):console.log(` Perfil ${h.id} eliminado`)}}else console.log(" No se encontraron perfiles existentes");console.log(" Verificando si el usuario existe en auth...");try{const{data:h,error:p}=await r.auth.signInWithPassword({email:n,password:a});if(p)console.log(" Usuario no existe en auth o contrasea incorrecta:",p.message);else{console.log(" Usuario encontrado en auth, intentando eliminar...");try{const{error:m}=await r.auth.admin.deleteUser(h.user.id);m?console.log(" No se pudo eliminar de auth:",m.message):console.log(" Usuario eliminado de auth")}catch(m){console.log(" Error eliminando de auth:",m.message)}await r.auth.signOut(),await new Promise(m=>setTimeout(m,500))}}catch{console.log(" No se pudo verificar existencia del usuario en auth")}await new Promise(h=>setTimeout(h,1e3)),console.log(" Creando nuevo usuario admin...");const{data:u,error:f}=await r.auth.signUp({email:n,password:a,options:{data:{username:s,role:"admin"}}});if(f)if(f.message.includes("already registered")||f.message.includes("User already registered")){console.log(" Usuario ya existe, intentando actualizar perfil existente...");try{const{data:h,error:p}=await r.auth.signInWithPassword({email:n,password:a});if(p)throw console.error(" Error al iniciar sesin con usuario existente:",p),new Error("No se puede acceder al usuario admin existente");console.log(" Sesin iniciada con usuario existente");const{error:m}=await r.from("profiles").upsert({id:h.user.id,username:s,email:n,role:"admin",status:"active",updated_at:new Date().toISOString()},{onConflict:"id"});if(m)throw console.error(" Error actualizando perfil admin:",m),m;console.log(" Perfil admin actualizado correctamente"),await r.auth.signOut()}catch(h){throw console.error(" Error actualizando usuario existente:",h),h}}else throw console.error(" Error creando usuario admin:",f),f;else{console.log(" Usuario admin creado en auth"),await new Promise(p=>setTimeout(p,2e3));const{data:{user:h}}=await r.auth.getUser();if(h){const{error:p}=await r.from("profiles").upsert({id:h.id,username:s,email:n,role:"admin",status:"active",created_at:new Date().toISOString(),updated_at:new Date().toISOString()},{onConflict:"id"});p?console.error(" Error creando perfil admin:",p):console.log(" Perfil admin creado correctamente")}}console.log(" Usuario admin recreado/actualizado exitosamente!"),console.log(` Email: ${n}`),console.log(` Password: ${a}`),console.log(" Recarga la pgina y inicia sesin como admin")}catch(t){console.error(" Error recreando usuario admin:",t),console.log(" Posibles soluciones:"),console.log("    Verifica que tengas permisos de admin en Supabase"),console.log("    Revisa la configuracin de Supabase en .env"),console.log("    Intenta ejecutar fixAdminRole() en su lugar")}},window.testSessionRecovery=async()=>{console.log(" Probando recuperacin de sesin..."),console.log(" Estado actual de authStore:");const e=await Z(()=>Promise.resolve().then(()=>vn),void 0).then(t=>t.useAuthStore.getState());console.log("   isAuthenticated:",e.isAuthenticated),console.log("   isLoading:",e.isLoading),console.log("   user:",e.user?`${e.user.username} (${e.user.role})`:"null"),e.isLoading&&(console.log(" Esperando que termine la inicializacin..."),setTimeout(async()=>{const t=await Z(()=>Promise.resolve().then(()=>vn),void 0).then(r=>r.useAuthStore.getState());console.log(" Estado despus de inicializacin:"),console.log("   isAuthenticated:",t.isAuthenticated),console.log("   isLoading:",t.isLoading),console.log("   user:",t.user?`${t.user.username} (${t.user.role})`:"null")},3e3))},window.testProfileUpdate=async()=>{if(console.log(" Probando actualizacin de perfil..."),!(await Z(()=>Promise.resolve().then(()=>vn),void 0).then(t=>t.useAuthStore.getState())).user){console.error(" No hay usuario autenticado");return}try{console.log(" Intentando actualizar perfil con datos de prueba...");const t={bio:"Test bio from console",location:"Test location"};await Z(()=>Promise.resolve().then(()=>wl),void 0).then(async({updateUser:r})=>{const n=await r(t);console.log(" Actualizacin exitosa:",n)})}catch(t){console.error(" Error en actualizacin de perfil:",t)}},window.testClubAssignment=async()=>{if(console.log(" Probando asignacin de club a DT..."),!(await Z(()=>Promise.resolve().then(()=>vn),void 0).then(t=>t.useAuthStore.getState())).user){console.error(" No hay usuario autenticado");return}try{console.log(" Intentando asignar club al usuario admin...");const t={clubId:"club1",bio:"Admin con club asignado"};await Z(()=>Promise.resolve().then(()=>wl),void 0).then(async({updateUser:r})=>{const n=await r(t);console.log(" Asignacin exitosa:",n),console.log(" Club asignado:",n.club_id||n.clubId)})}catch(t){console.error(" Error en asignacin de club:",t)}},window.assignClubToAdmin=async(e="club1")=>{console.log(" Asignando club al admin manualmente...");const t=await Z(()=>Promise.resolve().then(()=>Kl),void 0).then(a=>a.useDataStore.getState());if(!(await Z(()=>Promise.resolve().then(()=>vn),void 0).then(a=>a.useAuthStore.getState())).user){console.error(" No hay usuario autenticado");return}const n=t.clubs.find(a=>a.id===e);if(!n){console.error(` Club con ID '${e}' no encontrado`),console.log(" Clubs disponibles:",t.clubs.map(a=>`${a.id}: ${a.name}`).slice(0,5));return}try{console.log(` Asignando club '${n.name}' (${e}) al admin...`);const{updateUser:a}=await Z(async()=>{const{updateUser:i}=await Promise.resolve().then(()=>wl);return{updateUser:i}},void 0),s=await a({clubId:e,club:n.name,bio:`DT de ${n.name}`});console.log(" Club asignado exitosamente:",{username:s.username,clubId:s.clubId||s.club_id,club:s.club}),console.log(" Recarga la pgina para ver el Dashboard del DT")}catch(a){console.error(" Error asignando club:",a)}},window.checkUserClubStatus=async()=>{console.log(" Verificando estado del club del usuario...");const e=await Z(()=>Promise.resolve().then(()=>vn),void 0).then(a=>a.useAuthStore.getState()),t=await Z(()=>Promise.resolve().then(()=>Kl),void 0).then(a=>a.useDataStore.getState());console.log(" Usuario actual:",{username:e.user?.username,role:e.user?.role,clubId:e.user?.clubId,club:e.user?.club}),console.log(" Clubs disponibles:",t.clubs.length);const r=e.user?.role==="dt"||e.user?.roles&&e.user.roles.includes("dt"),n=!!e.user?.clubId;if(console.log(" Estado del DT:",{hasRoleDT:r,hasClubId:n,shouldShowDTDashboard:r&&n}),n&&e.user?.clubId){const a=t.clubs.find(s=>s.id===e.user?.clubId);console.log(" Club encontrado:",a?a.name:"NINGUNO")}console.log(" Si shouldShowDTDashboard es false, el usuario NO ver el dashboard de DT")},window.forceRefreshUserProfile=async()=>{console.log(" Forzando actualizacin del perfil de usuario desde Supabase...");try{const e=await Z(()=>Promise.resolve().then(()=>vn),void 0).then(n=>n.useAuthStore.getState()),{getSupabaseCurrentUser:t}=await Z(async()=>{const{getSupabaseCurrentUser:n}=await Promise.resolve().then(()=>wl);return{getSupabaseCurrentUser:n}},void 0);if(!e.user){console.error(" No hay usuario autenticado");return}console.log(" Obteniendo perfil actualizado desde Supabase...");const r=await t();r?((await Z(()=>Promise.resolve().then(()=>vn),void 0).then(a=>a.useAuthStore)).setState({user:r}),console.log(" Perfil actualizado:",{username:r.username,role:r.role,clubId:r.clubId,club:r.club}),console.log(" Estado actualizado. Recarga la pgina para ver los cambios.")):console.error(" No se pudo obtener el perfil actualizado")}catch(e){console.error(" Error forzando actualizacin:",e)}},window.checkSupabaseProfile=async()=>{console.log(" Verificando perfil directamente en Supabase...");try{const{getSupabaseClient:e}=await Z(async()=>{const{getSupabaseClient:s}=await Promise.resolve().then(()=>dt);return{getSupabaseClient:s}},void 0),t=e(),r=await Z(()=>Promise.resolve().then(()=>vn),void 0).then(s=>s.useAuthStore.getState());if(!r.user){console.error(" No hay usuario autenticado");return}console.log(" Consultando perfil en Supabase para user ID:",r.user.id);const{data:n,error:a}=await t.from("profiles").select("*").eq("id",r.user.id).single();if(a){console.error(" Error consultando Supabase:",a);return}console.log(" Perfil en Supabase:",n),n.club_id?console.log(" El usuario S tiene club asignado en Supabase:",n.club_id):console.log(" El usuario NO tiene club asignado en Supabase")}catch(e){console.error(" Error verificando Supabase:",e)}},window.testReloadPersistence=async()=>{console.log(" Probando persistencia despus de recarga..."),await checkUserClubStatus(),console.log(" Simulando recarga - ejecutando initializeAuth nuevamente...");const{useAuthStore:e}=await Z(async()=>{const{useAuthStore:t}=await Promise.resolve().then(()=>vn);return{useAuthStore:t}},void 0);await e.getState().initializeAuth(),setTimeout(async()=>{await checkUserClubStatus(),await checkSupabaseProfile()},2e3)},window.testClubPersistenceAfterTimeout=async()=>{console.log(" Probando persistencia del club despus de timeout de Supabase..."),await checkUserClubStatus();const e=await Z(()=>Promise.resolve().then(()=>vn),void 0).then(t=>t.useAuthStore.getState());e.user?.clubId||(console.log(" Asignando club para la prueba..."),await assignClubToAdmin("club18")),console.log(" Verificando asignacin inicial..."),await checkUserClubStatus(),console.log(" Simulando timeout de Supabase..."),setTimeout(async()=>{console.log(" Verificando estado despus del timeout simulado..."),await checkUserClubStatus(),e.user?.clubId?console.log(" XITO: El club se mantiene despus del timeout"):console.log(" FALLO: El club se perdi despus del timeout")},1e3)},window.diagnoseSupabase=async()=>{console.log(" Diagnstico completo de Supabase...");try{console.log(" Variables de entorno:"),console.log("   VITE_SUPABASE_URL:"," Configurada"),console.log("   VITE_SUPABASE_ANON_KEY:"," Configurada");const{config:e}=await Z(async()=>{const{config:c}=await Promise.resolve().then(()=>ft);return{config:c}},void 0);console.log("   useSupabase:",e.useSupabase),console.log(" Probando creacin de cliente...");const{getSupabaseClient:t}=await Z(async()=>{const{getSupabaseClient:c}=await Promise.resolve().then(()=>dt);return{getSupabaseClient:c}},void 0),r=t();if(console.log("   Cliente creado:",!!r),r){console.log(" Probando estado de autenticacin...");const{data:{session:c},error:u}=await r.auth.getSession();u?console.error(" Error obteniendo sesin:",u.message):(console.log("   Sesin activa:",!!c),c&&(console.log("   Usuario:",c.user.email),console.log("   Expira:",new Date(c.expires_at*1e3).toLocaleString()))),console.log(" Probando conexin a base de datos...");const f=Date.now(),{data:h,error:p}=await r.from("profiles").select("count",{count:"exact",head:!0}),m=Date.now();p?console.error(" Error de BD:",p.message):console.log(` Conexin exitosa (${m-f}ms)`),console.log(" Probando rate limiting...");const y=[];for(let b=0;b<5;b++)y.push(r.from("profiles").select("count",{count:"exact",head:!0}));const w=Date.now(),x=await Promise.allSettled(y),_=Date.now(),E=x.filter(b=>b.status==="fulfilled").length,k=x.filter(b=>b.status==="rejected").length;console.log(`   Resultados: ${E} exitosos, ${k} fallidos (${_-w}ms)`),k>0&&console.warn(" Posible rate limiting detectado")}console.log(" Probando llamadas de autenticacin...");try{const c=Date.now(),{data:{session:u},error:f}=await r.auth.getSession(),h=Date.now();f?console.error(" Error en auth.getSession():",f.message):console.log(` Auth getSession OK (${h-c}ms)`)}catch(c){console.error(" Exception en auth.getSession():",c)}console.log(" Probando mltiples llamadas auth...");const n=[];for(let c=0;c<3;c++)n.push(r.auth.getSession());const a=await Promise.allSettled(n),s=a.filter(c=>c.status==="fulfilled").length,i=a.filter(c=>c.status==="rejected").length;console.log(`   Auth calls: ${s} exitosos, ${i} fallidos`),console.log(" Probando conectividad bsica...");try{const c=await fetch("https://httpbin.org/status/200",{method:"HEAD"});console.log("   Internet:",c.ok?" OK":" Problemas")}catch{console.log("   Internet:  Sin conexin")}console.log(" Probando localStorage...");try{const c="supabase_test_"+Date.now();localStorage.setItem(c,"test"),localStorage.removeItem(c),console.log("   localStorage:  OK")}catch{console.log("   localStorage:  Problemas")}}catch(e){console.error(" Error en diagnstico:",e)}}},2e3);window.refreshPlayerFromSupabase=async e=>{console.log(` Refrescando jugador ${e} desde Supabase...`);try{const{getSupabaseClient:t}=await Z(async()=>{const{getSupabaseClient:u}=await Promise.resolve().then(()=>dt);return{getSupabaseClient:u}},void 0),r=t(),{data:n,error:a}=await r.from("players").select("*").eq("id",e).single();if(a){console.error(" Error obteniendo jugador de Supabase:",a.message);return}if(!n){console.log(" Jugador no encontrado en Supabase");return}console.log(" Datos de Supabase:",n);const s=await Z(()=>Promise.resolve().then(()=>Kl),void 0).then(u=>u.useDataStore.getState()),c=s.players.map(u=>u.id===e?{...u,clubId:n.club_id}:u);await s.updatePlayers(c),console.log(` Jugador ${e} actualizado. Nuevo clubId: ${n.club_id}`),console.log(" Los cambios deberan reflejarse en la UI")}catch(t){console.error(" Error refrescando jugador:",t)}};window.syncPlayerClub=async(e,t)=>{console.log(` Sincronizando club de jugador ${e} a ${t}...`);try{const r=await Z(()=>Promise.resolve().then(()=>Kl),void 0).then(i=>i.useDataStore.getState()),n=r.players,a=n.findIndex(i=>i.id===e);if(a===-1){console.error(` Jugador ${e} no encontrado localmente`);return}const s=[...n];s[a]={...s[a],clubId:t},await r.updatePlayers(s),console.log(` Jugador ${e} actualizado localmente con clubId: ${t}`),console.log(" Los cambios deberan reflejarse inmediatamente en la UI")}catch(r){console.error(" Error sincronizando club del jugador:",r)}};window.syncTournamentsFromSupabase=async()=>{console.log(" Sincronizando torneos desde Supabase...");try{const{config:e}=await Z(async()=>{const{config:r}=await Promise.resolve().then(()=>ft);return{config:r}},void 0);if(!e.useSupabase){console.log(" Supabase no est habilitado");return}const{forceSyncTournamentsFromSupabase:t}=await Z(async()=>{const{forceSyncTournamentsFromSupabase:r}=await Promise.resolve().then(()=>Bh);return{forceSyncTournamentsFromSupabase:r}},void 0);await t(),console.log(" Torneos sincronizados desde Supabase"),console.log(" Los cambios deberan reflejarse inmediatamente en el Panel Admin")}catch(e){console.error(" Error sincronizando torneos desde Supabase:",e)}};ob.createRoot(document.getElementById("root")).render(R.jsx(ue.StrictMode,{children:R.jsx(ik,{future:{v7_startTransition:!0,v7_relativeSplatPath:!0},children:R.jsx(qP,{})})}));export{S4 as $,pk as A,uB as B,vk as C,Y4 as D,DA as E,fB as F,dB as G,wk as H,XA as I,JA as J,KA as K,ut as L,Ek as M,KM as N,qM as O,XM as P,Jb as Q,Xx as R,kk as S,Ck as T,Pk as U,Dh as V,Aw as W,ly as X,Pw as Y,k4 as Z,Z as _,Nf as a,w4 as a0,b4 as a1,E4 as a2,A4 as a3,T4 as a4,C4 as a5,Fh as a6,i4 as a7,l4 as a8,c4 as a9,FA as aA,ft as aB,dt as aC,hf as aD,Bh as aE,Kl as aF,bA as aa,wA as ab,pw as ac,Oh as ad,SA as ae,$t as af,lB as ag,iB as ah,f4 as ai,Hw as aj,u4 as ak,Gw as al,cB as am,QA as an,Fa as ao,l2 as ap,Yh as aq,$r as ar,VA as as,Mw as at,Bw as au,WA as av,lt as aw,aB as ax,nB as ay,qA as az,wi as b,yg as c,mr as d,sB as e,J4 as f,oB as g,rB as h,h4 as i,R as j,qr as k,Jw as l,uc as m,Tk as n,Sk as o,JM as p,X4 as q,ue as r,kw as s,ql as t,_4 as u,Tw as v,IA as w,Ke as x,nr as y,Q4 as z};
