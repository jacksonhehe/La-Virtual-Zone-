const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-DTVNIeXw.js","assets/index-CXie0_SM.css"])))=>i.map(i=>d[i]);
import{r as d,j as e,X as _,f as H,a3 as K,l as I,a as L,_ as Q,a4 as U,a5 as X}from"./index-DTVNIeXw.js";import{N as J}from"./NewMatchModal-DGRI6wOS.js";import{A as Y}from"./alert-triangle-DVGXW8FO.js";import{u as Z}from"./usePagination-ao8LDY8Q.js";import{T as F,E as ee}from"./trash-DCyXKyGY.js";import{P as te}from"./plus-CV1eRhkB.js";import{S as ae}from"./search-BFl4Rdls.js";import{F as se}from"./filter-CklMjZET.js";import{C as re}from"./calendar-ChXpFKNL.js";import{C as ne}from"./chevron-left-DnlDT4R9.js";import{C as oe}from"./chevron-right-B_saB9ia.js";const le=({match:c,onClose:g,onSave:h,teams:f})=>{const[j,p]=d.useState(""),[E,w]=d.useState(""),[b,C]=d.useState(""),[y,k]=d.useState(""),[M,P]=d.useState(""),[m,z]=d.useState("scheduled"),[N,q]=d.useState(1),[v,S]=d.useState(null);d.useEffect(()=>{const o=new Date(c.date),r=new Date(o.getTime()-o.getTimezoneOffset()*6e4);p(r.toISOString().slice(0,16)),w(c.homeTeam),C(c.awayTeam),k(c.homeScore?.toString()||""),P(c.awayScore?.toString()||""),z(c.status),q(c.round)},[c]);const D=o=>{if(o.preventDefault(),S(null),!j||!E||!b){S("Completa fecha y equipos");return}if(E===b){S("Los equipos deben ser distintos");return}if(m==="finished"&&(y===""||M==="")){S("Los partidos finalizados deben tener resultado");return}const r={date:new Date(j).toISOString(),homeTeam:E,awayTeam:b,status:m,round:N};(m==="finished"||m==="live")&&(r.homeScore=y?parseInt(y):void 0,r.awayScore=M?parseInt(M):void 0),h(r)};return e.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[e.jsx("div",{className:"absolute inset-0 bg-black/70",onClick:g}),e.jsxs("div",{className:"relative bg-gray-800 rounded-lg shadow-xl w-full max-w-md p-6 max-h-[90vh] overflow-y-auto",children:[e.jsx("button",{onClick:g,className:"absolute top-4 right-4 text-gray-400 hover:text-white",children:e.jsx(_,{size:20})}),e.jsx("h3",{className:"text-xl font-bold mb-4",children:"Editar Partido"}),c.tournamentName&&e.jsxs("p",{className:"text-sm text-gray-400 mb-4",children:["Torneo: ",c.tournamentName]}),e.jsxs("form",{onSubmit:D,className:"space-y-4",children:[v&&e.jsx("div",{className:"p-3 bg-red-500/20 text-red-400 rounded-lg text-sm",children:v}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Fecha y hora"}),e.jsx("input",{type:"datetime-local",className:"input w-full",value:j,onChange:o=>p(o.target.value),required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Equipo local"}),e.jsx("select",{className:"input w-full",value:E,onChange:o=>w(o.target.value),required:!0,children:f.map(o=>e.jsx("option",{value:o,children:o},o))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Equipo visitante"}),e.jsx("select",{className:"input w-full",value:b,onChange:o=>C(o.target.value),required:!0,children:f.map(o=>e.jsx("option",{value:o,children:o},o))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Ronda"}),e.jsx("input",{type:"number",className:"input w-full",value:N,onChange:o=>q(parseInt(o.target.value)||1),min:"1",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Estado"}),e.jsxs("select",{className:"input w-full",value:m,onChange:o=>z(o.target.value),required:!0,children:[e.jsx("option",{value:"scheduled",children:"Programado"}),e.jsx("option",{value:"live",children:"En vivo"}),e.jsx("option",{value:"finished",children:"Finalizado"})]})]}),(m==="live"||m==="finished")&&e.jsx(e.Fragment,{children:e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Goles local"}),e.jsx("input",{type:"number",className:"input w-full",value:y,onChange:o=>k(o.target.value),min:"0",required:m==="finished"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Goles visitante"}),e.jsx("input",{type:"number",className:"input w-full",value:M,onChange:o=>P(o.target.value),min:"0",required:m==="finished"})]})]})}),e.jsxs("div",{className:"flex justify-end gap-2 pt-2",children:[e.jsx("button",{type:"button",className:"btn-outline",onClick:g,children:"Cancelar"}),e.jsx("button",{type:"submit",className:"btn-primary",children:"Guardar cambios"})]})]})]})]})},R=({open:c,title:g,description:h,confirmLabel:f="Confirmar",cancelLabel:j="Cancelar",tone:p="primary",onConfirm:E,onCancel:w})=>{if(!c)return null;const b=p==="danger"?"btn-primary bg-red-600 hover:bg-red-700 border-red-600":"btn-primary";return e.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[e.jsx("div",{className:"absolute inset-0 bg-black/70",onClick:w}),e.jsxs("div",{className:"relative bg-gray-800 rounded-lg shadow-xl w-full max-w-md p-6",children:[e.jsx("button",{onClick:w,className:"absolute top-4 right-4 text-gray-400 hover:text-white","aria-label":"Cerrar",children:e.jsx(_,{size:20})}),e.jsxs("div",{className:"flex items-start mb-4",children:[e.jsx(Y,{className:"text-yellow-400 mr-3 flex-shrink-0",size:22}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold mb-1",children:g}),h&&e.jsx("p",{className:"text-sm text-gray-300",children:h})]})]}),e.jsxs("div",{className:"flex justify-end space-x-2 pt-2",children:[e.jsx("button",{className:"btn-outline",onClick:w,children:j}),e.jsx("button",{className:b,onClick:E,children:f})]})]})]})},be=()=>{const[c,g]=d.useState([]),[h,f]=d.useState([]),[j,p]=d.useState([]),[E,w]=d.useState(!1),[b,C]=d.useState(null),[y,k]=d.useState(null),[M,P]=d.useState(!1),[m,z]=d.useState(""),[N,q]=d.useState(""),[v,S]=d.useState(""),[D,o]=d.useState(50);d.useEffect(()=>{let t=!0;return(async()=>{try{const[s,u]=await Promise.all([I(),L()]);if(!t)return;g(s);const l=[];u.forEach(n=>{const i=s.find(x=>x.id===n.tournamentId);i?l.push({...n,tournamentName:i.name,tournamentLogo:i.logo}):l.push({...n,tournamentName:"Torneo no encontrado",tournamentLogo:""})}),l.sort((n,i)=>new Date(i.date).getTime()-new Date(n.date).getTime()),f(l),p(l)}catch(s){console.error("Error cargando partidos:",s)}})(),()=>{t=!1}},[]),d.useEffect(()=>{let t=[...h];if(m&&(t=t.filter(a=>a.tournamentId===m)),N&&(t=t.filter(a=>a.status===N)),v){const a=v.toLowerCase();t=t.filter(s=>s.homeTeam.toLowerCase().includes(a)||s.awayTeam.toLowerCase().includes(a)||s.tournamentName.toLowerCase().includes(a))}p(t)},[h,m,N,v]);const r=Z({items:j,perPage:D,initialPage:1}),A=d.useRef(`${m}-${N}-${v}`);d.useEffect(()=>{const t=`${m}-${N}-${v}`;A.current!==t&&(r.set(1),A.current=t)},[m,N,v]);const O=async t=>{try{const a=t.tournamentId||m||c[0]?.id;if(!a){alert("No hay torneos disponibles. Crea un torneo primero.");return}if(!c.find(x=>x.id===a)){alert("Torneo no encontrado");return}const{addMatch:u}=await Q(async()=>{const{addMatch:x}=await import("./index-DTVNIeXw.js").then(T=>T.aE);return{addMatch:x}},__vite__mapDeps([0,1]));await u(a,{date:t.date,homeTeam:t.homeTeam,awayTeam:t.awayTeam});const[l,n]=await Promise.all([I(),L()]);g(l);const i=[];n.forEach(x=>{const T=l.find(V=>V.id===x.tournamentId);T&&i.push({...x,tournamentName:T.name,tournamentLogo:T.logo})}),i.sort((x,T)=>new Date(T.date).getTime()-new Date(x.date).getTime()),f(i),p(i),w(!1)}catch(a){console.error("Error creando partido:",a),alert("Error al crear el partido. Por favor, intenta de nuevo.")}},W=async(t,a,s)=>{try{await U(a,t,s);const[u,l]=await Promise.all([I(),L()]);g(u);const n=[];l.forEach(i=>{const x=u.find(T=>T.id===i.tournamentId);x&&n.push({...i,tournamentName:x.name,tournamentLogo:x.logo})}),n.sort((i,x)=>new Date(x.date).getTime()-new Date(i.date).getTime()),f(n),p(n),C(null)}catch(u){console.error("Error actualizando partido:",u),alert("Error al actualizar el partido. Por favor, intenta de nuevo.")}},B=async(t,a)=>{try{await X(a,t);const[s,u]=await Promise.all([I(),L()]);g(s);const l=[];u.forEach(n=>{const i=s.find(x=>x.id===n.tournamentId);i&&l.push({...n,tournamentName:i.name,tournamentLogo:i.logo})}),l.sort((n,i)=>new Date(i.date).getTime()-new Date(n.date).getTime()),f(l),p(l),k(null)}catch(s){console.error("Error eliminando partido:",s),alert("Error al eliminar el partido. Por favor, intenta de nuevo.")}},$=d.useMemo(()=>{const t=new Set;return c.forEach(a=>{a.teams?.forEach(s=>t.add(s))}),Array.from(t).sort()},[c]),G=t=>{const a={scheduled:"bg-gray-700 text-gray-300",live:"bg-red-600 text-white animate-pulse",finished:"bg-green-700 text-white"};return e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${a[t]||a.scheduled}`,children:t==="scheduled"?"Programado":t==="live"?"En vivo":"Finalizado"})};return e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold",children:"Gestión de Partidos"}),e.jsx("p",{className:"text-gray-400 text-sm mt-1",children:"Administra todos los partidos de los torneos"})]}),e.jsxs("div",{className:"flex gap-2",children:[h.length>0&&e.jsxs("button",{className:"btn-outline flex items-center text-red-400 border-red-400/30 hover:bg-red-400/10",onClick:t=>{t.preventDefault(),console.log("Botón eliminar todos clickeado, total de partidos:",h.length),P(!0)},children:[e.jsx(F,{size:16,className:"mr-2"}),"Eliminar todos (",h.length,")"]}),e.jsxs("button",{className:"btn-primary flex items-center",onClick:()=>{if(c.length===0){alert("No hay torneos disponibles. Crea un torneo primero.");return}w(!0)},children:[e.jsx(te,{size:16,className:"mr-2"}),"Nuevo partido"]})]})]}),e.jsx("div",{className:"bg-dark-light rounded-lg border border-gray-800 p-4 mb-6",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx(ae,{size:18,className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Buscar por equipos o torneo...",className:"input pl-10 w-full",value:v,onChange:t=>S(t.target.value)})]}),e.jsx("div",{children:e.jsxs("select",{className:"input w-full",value:m,onChange:t=>z(t.target.value),children:[e.jsx("option",{value:"",children:"Todos los torneos"}),c.map(t=>e.jsx("option",{value:t.id,children:t.name},t.id))]})}),e.jsx("div",{children:e.jsxs("select",{className:"input w-full",value:N,onChange:t=>q(t.target.value),children:[e.jsx("option",{value:"",children:"Todos los estados"}),e.jsx("option",{value:"scheduled",children:"Programado"}),e.jsx("option",{value:"live",children:"En vivo"}),e.jsx("option",{value:"finished",children:"Finalizado"})]})}),e.jsx("div",{className:"flex items-center gap-2",children:(m||N||v)&&e.jsxs("button",{className:"btn-outline flex items-center",onClick:()=>{z(""),q(""),S("")},children:[e.jsx(se,{size:16,className:"mr-2"}),"Limpiar filtros"]})})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[e.jsxs("div",{className:"bg-dark-light rounded-lg border border-gray-800 p-4",children:[e.jsx("p",{className:"text-gray-400 text-sm mb-1",children:"Total de partidos"}),e.jsx("h3",{className:"text-2xl font-bold text-white",children:j.length}),j.length!==h.length&&e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["de ",h.length," totales"]})]}),e.jsxs("div",{className:"bg-dark-light rounded-lg border border-gray-800 p-4",children:[e.jsx("p",{className:"text-gray-400 text-sm mb-1",children:"Programados"}),e.jsx("h3",{className:"text-2xl font-bold text-yellow-400",children:j.filter(t=>t.status==="scheduled").length})]}),e.jsxs("div",{className:"bg-dark-light rounded-lg border border-gray-800 p-4",children:[e.jsx("p",{className:"text-gray-400 text-sm mb-1",children:"En vivo"}),e.jsx("h3",{className:"text-2xl font-bold text-red-400",children:j.filter(t=>t.status==="live").length})]}),e.jsxs("div",{className:"bg-dark-light rounded-lg border border-gray-800 p-4",children:[e.jsx("p",{className:"text-gray-400 text-sm mb-1",children:"Finalizados"}),e.jsx("h3",{className:"text-2xl font-bold text-green-400",children:j.filter(t=>t.status==="finished").length})]})]}),e.jsx("div",{className:"bg-dark-light rounded-lg border border-gray-800 overflow-hidden",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-dark-lighter text-xs uppercase text-gray-400 border-b border-gray-800",children:[e.jsx("th",{className:"px-4 py-3 text-left",children:"Torneo"}),e.jsx("th",{className:"px-4 py-3 text-left",children:"Fecha"}),e.jsx("th",{className:"px-4 py-3 text-left",children:"Local"}),e.jsx("th",{className:"px-4 py-3 text-center",children:"Resultado"}),e.jsx("th",{className:"px-4 py-3 text-left",children:"Visitante"}),e.jsx("th",{className:"px-4 py-3 text-center",children:"Ronda"}),e.jsx("th",{className:"px-4 py-3 text-center",children:"Estado"}),e.jsx("th",{className:"px-4 py-3 text-center",children:"Acciones"})]})}),e.jsx("tbody",{children:r.items.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:8,className:"px-4 py-8 text-center text-gray-400",children:h.length===0?"No hay partidos. Crea un torneo y añade partidos primero.":"No se encontraron partidos con los filtros seleccionados."})}):r.items.map(t=>e.jsxs("tr",{className:"border-b border-gray-800 hover:bg-dark-lighter transition-colors",children:[e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("img",{src:t.tournamentLogo,alt:t.tournamentName,className:"w-6 h-6 rounded"}),e.jsx("span",{className:"font-medium text-sm",children:t.tournamentName})]})}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(re,{size:14,className:"text-gray-400"}),e.jsx("span",{children:H(t.date)})]})}),e.jsx("td",{className:"px-4 py-3 font-medium",children:t.homeTeam}),e.jsx("td",{className:"px-4 py-3 text-center",children:t.status==="finished"&&t.homeScore!==void 0&&t.awayScore!==void 0?e.jsxs("span",{className:"text-lg font-bold",children:[t.homeScore," - ",t.awayScore]}):t.status==="live"?e.jsx("span",{className:"text-red-400 font-bold animate-pulse",children:"LIVE"}):e.jsx("span",{className:"text-gray-500",children:"-"})}),e.jsx("td",{className:"px-4 py-3 font-medium",children:t.awayTeam}),e.jsx("td",{className:"px-4 py-3 text-center",children:e.jsxs("span",{className:"px-2 py-1 bg-gray-700 rounded text-xs",children:["R",t.round]})}),e.jsx("td",{className:"px-4 py-3 text-center",children:G(t.status)}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx("button",{className:"p-2 text-gray-400 hover:text-primary transition-colors",onClick:()=>C(t),title:"Editar",children:e.jsx(ee,{size:16})}),e.jsx("button",{className:"p-2 text-gray-400 hover:text-red-400 transition-colors",onClick:()=>k(t),title:"Eliminar",children:e.jsx(F,{size:16})})]})})]},t.id))})]})})}),r.totalPages>1&&e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-center gap-4 mt-6 mb-6",children:[e.jsx("div",{className:"flex items-center gap-2 text-sm text-gray-400",children:e.jsxs("span",{children:["Mostrando ",(r.page-1)*D+1," - ",Math.min(r.page*D,r.total)," de ",r.total," partidos"]})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("select",{value:D,onChange:t=>{o(Number(t.target.value)),r.set(1)},className:"px-3 py-2 bg-gray-700/60 border border-gray-600/60 rounded-lg text-white text-sm focus:border-primary/60 focus:outline-none focus:ring-2 focus:ring-primary/20",children:[e.jsx("option",{value:25,children:"25 por página"}),e.jsx("option",{value:50,children:"50 por página"}),e.jsx("option",{value:100,children:"100 por página"})]}),e.jsxs("button",{onClick:r.prev,disabled:r.page===1,className:"px-4 py-2 bg-dark-light border border-gray-800 rounded-lg disabled:opacity-50 disabled:cursor-not-allowed hover:bg-dark-lighter transition-colors flex items-center gap-2",children:[e.jsx(ne,{size:18}),e.jsx("span",{className:"hidden sm:inline",children:"Anterior"})]}),e.jsx("div",{className:"flex items-center gap-1",children:Array.from({length:Math.min(5,r.totalPages)},(t,a)=>{let s;return r.totalPages<=5||r.page<=3?s=a+1:r.page>=r.totalPages-2?s=r.totalPages-4+a:s=r.page-2+a,e.jsx("button",{onClick:()=>r.set(s),className:`px-3 py-2 rounded-lg text-sm font-medium transition-colors ${r.page===s?"bg-primary text-white":"bg-dark-light border border-gray-800 text-gray-300 hover:bg-dark-lighter"}`,children:s},s)})}),e.jsxs("button",{onClick:r.next,disabled:r.page===r.totalPages,className:"px-4 py-2 bg-dark-light border border-gray-800 rounded-lg disabled:opacity-50 disabled:cursor-not-allowed hover:bg-dark-lighter transition-colors flex items-center gap-2",children:[e.jsx("span",{className:"hidden sm:inline",children:"Siguiente"}),e.jsx(oe,{size:18})]})]})]}),E&&e.jsx(J,{onClose:()=>w(!1),onCreate:O,teams:$,tournaments:c,defaultTournamentId:m||c[0]?.id}),b&&e.jsx(le,{match:b,onClose:()=>C(null),onSave:t=>W(b.id,b.tournamentId,t),teams:$}),y&&e.jsx(R,{open:!!y,title:"Eliminar partido",description:`¿Estás seguro de que deseas eliminar el partido entre ${y.homeTeam} y ${y.awayTeam}? Esta acción no se puede deshacer.`,confirmLabel:"Eliminar",cancelLabel:"Cancelar",tone:"danger",onConfirm:()=>B(y.id,y.tournamentId),onCancel:()=>k(null)}),e.jsx(R,{open:M,title:"Eliminar todos los partidos",description:`¿Estás seguro de que deseas eliminar TODOS los partidos (${h.length} partidos)? Esta acción no se puede deshacer.`,confirmLabel:"Eliminar todos",cancelLabel:"Cancelar",tone:"danger",onConfirm:async()=>{try{console.log("Iniciando eliminación de todos los partidos...");const t=await K();console.log(`Partidos eliminados: ${t}`),f([]),p([]),P(!1),setTimeout(async()=>{try{const[a,s]=await Promise.all([I(),L()]);g(a);const u=[];s.forEach(l=>{const n=a.find(i=>i.id===l.tournamentId);n&&u.push({...l,tournamentName:n.name,tournamentLogo:n.logo})}),u.sort((l,n)=>new Date(n.date).getTime()-new Date(l.date).getTime()),f(u),p(u)}catch(a){console.error("Error recargando partidos después de eliminar:",a)}},500),alert(`✅ Se eliminaron ${t} partidos exitosamente.`)}catch(t){console.error("Error eliminando todos los partidos:",t),alert(`Error al eliminar los partidos: ${t instanceof Error?t.message:"Error desconocido"}`);try{const[a,s]=await Promise.all([I(),L()]);g(a);const u=[];s.forEach(l=>{const n=a.find(i=>i.id===l.tournamentId);n&&u.push({...l,tournamentName:n.name,tournamentLogo:n.logo})}),u.sort((l,n)=>new Date(n.date).getTime()-new Date(l.date).getTime()),f(u),p(u)}catch(a){console.error("Error recargando partidos:",a)}}},onCancel:()=>{console.log("Cancelando eliminación"),P(!1)}})]})};export{be as default};
